/* empty css                    */import"./vue.3ee76ad7.js";import{q as hi,C as o,ab as K,t as J,aF as b,a1 as N,aL as Kt,bv as ti,G as Pe,as as Gt,_ as S,az as ii,a2 as h,J as Z,O as T,aK as Zt,a0 as R,I as Se,a8 as f,a9 as s,b7 as oe,aI as en,aG as tn,u as kl,b2 as et,aD as Nl,w as $t,b3 as Jt,ap as dr,aH as ji,A as st,$ as H,b9 as mn,ar as Ht,bt as In,bc as $l,T as mr,j as Jr,l as At,bw as Cn,ay as Wr,aM as Et,aO as xe,z as Yt,bo as Zr,bs as pr,am as Ji,av as Ml,H as fr,bx as Qr,a7 as Kr,ai as Yr,bf as ea}from"./@vue.6b211d3c.js";import{L as Mn}from"./lz-string.dccec454.js";import{c as vr}from"./nanoevents.1080beb7.js";import{Y as ta}from"./vue-next-select.9f66f268.js";import{D as na}from"./vuedraggable.b67c00d5.js";import{p as ia}from"./vue-textarea-autosize.35804eaf.js";import{A as gr,T as la,R as ra,B as aa,u as sa,E as Hl}from"./@pixi.7dd8aed6.js";import{s as oa,u as bi}from"./vue-toastification.4e7d1d70.js";import"./earcut.b6f90e68.js";import"./sortablejs.a68aa018.js";import"./ismobilejs.5c6954b9.js";import"./eventemitter3.dc5195d7.js";import"./url.832c6d94.js";import"./querystring.ed407679.js";const ua=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))l(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const u of a.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&l(u)}).observe(document,{childList:!0,subtree:!0});function n(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerpolicy&&(a.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?a.credentials="include":i.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function l(i){if(i.ep)return;i.ep=!0;const a=n(i);fetch(i.href,a)}};ua();const ca="modulepreload",Jl={},da="./",Mi=function(t,n){return!n||n.length===0?t():Promise.all(n.map(l=>{if(l=`${da}${l}`,l in Jl)return;Jl[l]=!0;const i=l.endsWith(".css"),a=i?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${a}`))return;const u=document.createElement("link");if(u.rel=i?"stylesheet":ca,i||(u.as="script",u.crossOrigin=""),u.href=l,document.head.appendChild(u),i)return new Promise((c,d)=>{u.addEventListener("load",c),u.addEventListener("error",()=>d(new Error(`Unable to preload CSS for ${l}`)))})})).then(()=>t())},ma="./projInfo-schema.json",pa="Kronos",fa="A game about flowers, time, and focus",va="kronos",ga="thepaperpilot",ha="",ba="",ya="0.3",wa="",_a=!1,Ca=!1,Sa=2,ka=!0,Na="banner.png",$a="pwa-192x192.png",Ma=["main"],Pa=3600,xa=1,Ia=!0,Ta="base64";var Be={$schema:ma,title:pa,description:fa,id:va,author:ga,discordName:ha,discordLink:ba,versionNumber:ya,versionTitle:wa,allowGoBack:_a,defaultShowSmall:Ca,defaultDecimalsShown:Sa,useHeader:ka,banner:Na,logo:$a,initialTabs:Ma,maxTickLength:Pa,offlineLimit:xa,enablePausing:Ia,exportEncoding:Ta};const Fa=hi({id:"",devSpeed:null,name:"",tabs:[],time:-1,autosave:!0,offlineProd:!0,offlineTime:null,timePlayed:0,keepGoing:!1,modID:"",modVersion:"",layers:{}});var U=window.player=Fa;function Pl(e){return JSON.stringify(e,(t,n)=>o(n))}var me=(e,t)=>{const n=e.__vccOpts||e;for(const[l,i]of t)n[l]=i;return n};const Ea=["onClick"],Da=K({__name:"FeedbackButton",props:{left:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=J(!1),l=J(null);function i(){t("click"),l.value&&clearTimeout(l.value),n.value=!1,Gt(()=>{n.value=!0,l.value=setTimeout(()=>n.value=!1,500)})}return(a,u)=>(b(),N("button",{onClick:ti(i,["stop"]),class:Pe(["feedback",{activated:n.value,left:e.left}])},[Kt(a.$slots,"default",{},void 0,!0)],10,Ea))}});var xl=me(Da,[["__scopeId","data-v-01a1b95c"]]);const Ki=e=>(en("data-v-ac351c02"),e=e(),tn(),e),qa={class:"error"},Aa={class:"error-title"},La={class:"error-details",style:{"margin-top":"-10px"}},Oa={key:0},ja={class:"instructions"},Ra=["href"],Ba=Ki(()=>h("span",{class:"material-icons",style:{"font-size":"16px"}},"content_paste",-1)),Va=Ki(()=>h("span",{style:{"margin-left":"8px","font-size":"medium"}},"Copy Save",-1)),Ga=Ki(()=>h("br",null,null,-1)),za={key:0,style:{"margin-top":"20px"}},Ua=Ki(()=>h("h3",null,"Other errors",-1)),Xa=[Ua],Ha={class:"error-details"},Ja={key:0,style:{"margin-top":"10px"}},Wa={key:1,style:{"margin-top":"10px"}},Za=K({__name:"Error",props:{errors:null},setup(e){const t=e,n=S(()=>t.errors[0]),l=S(()=>t.errors.map(u=>u.stack==null?[]:u.stack.split(`
`))),i=S(()=>t.errors.map(u=>u.cause==null?[]:(typeof u.cause=="string"?u.cause:JSON.stringify(u.cause)).split(`
`)));function a(){let u=Pl(U);switch(Be.exportEncoding){default:console.warn(`Unknown save encoding: ${Be.exportEncoding}. Defaulting to lz`);case"lz":u=Mn.compressToUTF16(u);break;case"base64":u=btoa(unescape(encodeURIComponent(u)));break;case"plain":break}console.log(u);const c=document.createElement("textarea");c.value=u,document.body.appendChild(c),c.select(),c.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(c)}return ii(()=>{U.autosave=!1,U.devSpeed=0}),(u,c)=>(b(),N("div",qa,[h("h1",Aa,Z(o(n).name)+": "+Z(o(n).message),1),h("div",La,[o(n).cause?(b(),N("div",Oa,[(b(!0),N(T,null,Zt(o(i)[0],d=>(b(),N("div",{key:d},Z(d),1))),128))])):R("",!0),o(n).stack?(b(),N("div",{key:1,style:Se(o(n).cause?"margin-top: 10px":"")},[(b(!0),N(T,null,Zt(o(l)[0],d=>(b(),N("div",{key:d},Z(d),1))),128))],4)):R("",!0)]),h("div",ja,[f(" Check the console for more details, and consider sharing it with the developers on "),h("a",{href:o(Be).discordLink||"https://discord.gg/yJ4fjnjU54",class:"discord-link"},"discord",8,Ra),f("! "),s(xl,{onClick:a,class:"button",style:{display:"inline-flex"}},{default:oe(()=>[Ba,Va]),_:1}),Ga,e.errors.length>1?(b(),N("div",za,Xa)):R("",!0),(b(!0),N(T,null,Zt(e.errors.slice(1),(d,m)=>(b(),N("div",{key:m,style:{"margin-top":"20px"}},[h("details",Ha,[h("summary",null,Z(d.name)+": "+Z(d.message),1),d.cause?(b(),N("div",Ja,[(b(!0),N(T,null,Zt(o(i)[m+1],g=>(b(),N("div",{key:g},Z(g),1))),128))])):R("",!0),d.stack?(b(),N("div",Wa,[(b(!0),N(T,null,Zt(o(l)[m+1],g=>(b(),N("div",{key:g},Z(g),1))),128))])):R("",!0)])]))),128))])]))}});var hr=me(Za,[["__scopeId","data-v-ac351c02"]]);class Qa{constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}get size(){return this.map.size}get(t){const n=this.map.get(t);if(n!==void 0)return n!==this.first&&(n===this.last?(this.last=n.prev,this.last.next=void 0):(n.prev.next=n.next,n.next.prev=n.prev),n.next=this.first,this.first.prev=n,this.first=n),n.value}set(t,n){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");const l=new Ka(t,n);for(this.first===void 0?(this.first=l,this.last=l):(l.next=this.first,this.first.prev=l,this.first=l),this.map.set(t,l);this.map.size>this.maxSize;){const i=this.last;this.map.delete(i.key),this.last=i.prev,this.last.next=void 0}}}class Ka{constructor(t,n){this.next=void 0,this.prev=void 0,this.key=t,this.value=n}}const cl=17,Ya=9e15,es=Math.log10(9e15),ts=1/9e15,ns=308,is=-324,Wl=5,ls=(1<<10)-1,rs=function(){const e=[];for(let n=is+1;n<=ns;n++)e.push(Number("1e"+n));const t=323;return function(n){return e[n+t]}}(),Zn=[2,Math.E,3,4,5,6,7,8,9,10],as=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],ss=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]];let M=function(t){return r.fromValue_noAlloc(t)},fe=function(e,t,n){return r.fromComponents(e,t,n)},_e=function(t,n,l){return r.fromComponents_noNormalize(t,n,l)};const jn=function(t,n){const l=n+1,i=Math.ceil(Math.log10(Math.abs(t))),a=Math.round(t*Math.pow(10,l-i))*Math.pow(10,i-l);return parseFloat(a.toFixed(Math.max(l-i,0)))},dl=function(e){return Math.sign(e)*Math.log10(Math.abs(e))},os=function(e){if(!isFinite(e))return e;if(e<-50)return e===Math.trunc(e)?Number.NEGATIVE_INFINITY:0;let t=1;for(;e<10;)t=t*e,++e;e-=1;let n=.9189385332046727;n=n+(e+.5)*Math.log(e),n=n-e;const l=e*e;let i=e;return n=n+1/(12*i),i=i*l,n=n+1/(360*i),i=i*l,n=n+1/(1260*i),i=i*l,n=n+1/(1680*i),i=i*l,n=n+1/(1188*i),i=i*l,n=n+691/(360360*i),i=i*l,n=n+7/(1092*i),i=i*l,n=n+3617/(122400*i),Math.exp(n)/t},br=.5671432904097838,Zl=function(e,t=1e-10){let n,l;if(!Number.isFinite(e)||e===0)return e;if(e===1)return br;e<10?n=0:n=Math.log(e)-Math.log(Math.log(e));for(let i=0;i<100;++i){if(l=(e*Math.exp(-n)+n*n)/(n+1),Math.abs(l-n)<t*Math.abs(l))return l;n=l}throw Error(`Iteration failed to converge: ${e.toString()}`)};function Ql(e,t=1e-10){let n,l,i,a;if(!Number.isFinite(e.mag)||e.eq(r.dZero))return e;if(e.eq(r.dOne))return r.fromNumber(br);n=r.ln(e);for(let u=0;u<100;++u){if(l=n.neg().exp(),i=n.sub(e.mul(l)),a=n.sub(i.div(n.add(1).sub(n.add(2).mul(i).div(r.mul(2,n).add(2))))),r.abs(a.sub(n)).lt(r.abs(a).mul(t)))return a;n=a}throw Error(`Iteration failed to converge: ${e.toString()}`)}const C=class{constructor(e){this.sign=0,this.mag=0,this.layer=0,e instanceof C?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"&&this.fromString(e)}get m(){if(this.sign===0)return 0;if(this.layer===0){const e=Math.floor(Math.log10(this.mag));let t;return this.mag===5e-324?t=5:t=this.mag/rs(e),this.sign*t}else if(this.layer===1){const e=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,e)}else return this.sign}set m(e){this.layer<=2?this.fromMantissaExponent(e,this.e):(this.sign=Math.sign(e),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(e){this.fromMantissaExponent(this.m,e)}get s(){return this.sign}set s(e){e===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=e}get mantissa(){return this.m}set mantissa(e){this.m=e}get exponent(){return this.e}set exponent(e){this.e=e}static fromComponents(e,t,n){return new C().fromComponents(e,t,n)}static fromComponents_noNormalize(e,t,n){return new C().fromComponents_noNormalize(e,t,n)}static fromMantissaExponent(e,t){return new C().fromMantissaExponent(e,t)}static fromMantissaExponent_noNormalize(e,t){return new C().fromMantissaExponent_noNormalize(e,t)}static fromDecimal(e){return new C().fromDecimal(e)}static fromNumber(e){return new C().fromNumber(e)}static fromString(e){return new C().fromString(e)}static fromValue(e){return new C().fromValue(e)}static fromValue_noAlloc(e){if(e instanceof C)return e;if(typeof e=="string"){const t=C.fromStringCache.get(e);return t!==void 0?t:C.fromString(e)}else return typeof e=="number"?C.fromNumber(e):C.dZero}static abs(e){return M(e).abs()}static neg(e){return M(e).neg()}static negate(e){return M(e).neg()}static negated(e){return M(e).neg()}static sign(e){return M(e).sign}static sgn(e){return M(e).sign}static round(e){return M(e).round()}static floor(e){return M(e).floor()}static ceil(e){return M(e).ceil()}static trunc(e){return M(e).trunc()}static add(e,t){return M(e).add(t)}static plus(e,t){return M(e).add(t)}static sub(e,t){return M(e).sub(t)}static subtract(e,t){return M(e).sub(t)}static minus(e,t){return M(e).sub(t)}static mul(e,t){return M(e).mul(t)}static multiply(e,t){return M(e).mul(t)}static times(e,t){return M(e).mul(t)}static div(e,t){return M(e).div(t)}static divide(e,t){return M(e).div(t)}static recip(e){return M(e).recip()}static reciprocal(e){return M(e).recip()}static reciprocate(e){return M(e).reciprocate()}static cmp(e,t){return M(e).cmp(t)}static cmpabs(e,t){return M(e).cmpabs(t)}static compare(e,t){return M(e).cmp(t)}static isNaN(e){return e=M(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag)}static isFinite(e){return e=M(e),isFinite(e.sign)&&isFinite(e.layer)&&isFinite(e.mag)}static eq(e,t){return M(e).eq(t)}static equals(e,t){return M(e).eq(t)}static neq(e,t){return M(e).neq(t)}static notEquals(e,t){return M(e).notEquals(t)}static lt(e,t){return M(e).lt(t)}static lte(e,t){return M(e).lte(t)}static gt(e,t){return M(e).gt(t)}static gte(e,t){return M(e).gte(t)}static max(e,t){return M(e).max(t)}static min(e,t){return M(e).min(t)}static minabs(e,t){return M(e).minabs(t)}static maxabs(e,t){return M(e).maxabs(t)}static clamp(e,t,n){return M(e).clamp(t,n)}static clampMin(e,t){return M(e).clampMin(t)}static clampMax(e,t){return M(e).clampMax(t)}static cmp_tolerance(e,t,n){return M(e).cmp_tolerance(t,n)}static compare_tolerance(e,t,n){return M(e).cmp_tolerance(t,n)}static eq_tolerance(e,t,n){return M(e).eq_tolerance(t,n)}static equals_tolerance(e,t,n){return M(e).eq_tolerance(t,n)}static neq_tolerance(e,t,n){return M(e).neq_tolerance(t,n)}static notEquals_tolerance(e,t,n){return M(e).notEquals_tolerance(t,n)}static lt_tolerance(e,t,n){return M(e).lt_tolerance(t,n)}static lte_tolerance(e,t,n){return M(e).lte_tolerance(t,n)}static gt_tolerance(e,t,n){return M(e).gt_tolerance(t,n)}static gte_tolerance(e,t,n){return M(e).gte_tolerance(t,n)}static pLog10(e){return M(e).pLog10()}static absLog10(e){return M(e).absLog10()}static log10(e){return M(e).log10()}static log(e,t){return M(e).log(t)}static log2(e){return M(e).log2()}static ln(e){return M(e).ln()}static logarithm(e,t){return M(e).logarithm(t)}static pow(e,t){return M(e).pow(t)}static pow10(e){return M(e).pow10()}static pow_base(e,t){return M(e).pow_base(t)}static root(e,t){return M(e).root(t)}static factorial(e,t){return M(e).factorial()}static gamma(e,t){return M(e).gamma()}static lngamma(e,t){return M(e).lngamma()}static exp(e){return M(e).exp()}static sqr(e){return M(e).sqr()}static sqrt(e){return M(e).sqrt()}static cube(e){return M(e).cube()}static cbrt(e){return M(e).cbrt()}static tetrate(e,t=2,n=_e(1,0,1)){return M(e).tetrate(t,n)}static iteratedexp(e,t=2,n=_e(1,0,1)){return M(e).iteratedexp(t,n)}static iteratedlog(e,t=10,n=1){return M(e).iteratedlog(t,n)}static layeradd10(e,t){return M(e).layeradd10(t)}static layeradd(e,t,n=10){return M(e).layeradd(t,n)}static slog(e,t=10){return M(e).slog(t)}static lambertw(e){return M(e).lambertw()}static ssqrt(e){return M(e).ssqrt()}static pentate(e,t=2,n=_e(1,0,1)){return M(e).pentate(t,n)}static sin(e){return M(e).sin()}static cos(e){return M(e).cos()}static tan(e){return M(e).tan()}static asin(e){return M(e).asin()}static acos(e){return M(e).acos()}static atan(e){return M(e).atan()}static sinh(e){return M(e).sinh()}static cosh(e){return M(e).cosh()}static tanh(e){return M(e).tanh()}static asinh(e){return M(e).asinh()}static acosh(e){return M(e).acosh()}static atanh(e){return M(e).atanh()}static affordGeometricSeries(e,t,n,l){return this.affordGeometricSeries_core(M(e),M(t),M(n),l)}static sumGeometricSeries(e,t,n,l){return this.sumGeometricSeries_core(e,M(t),M(n),l)}static affordArithmeticSeries(e,t,n,l){return this.affordArithmeticSeries_core(M(e),M(t),M(n),M(l))}static sumArithmeticSeries(e,t,n,l){return this.sumArithmeticSeries_core(M(e),M(t),M(n),M(l))}static efficiencyOfPurchase(e,t,n){return this.efficiencyOfPurchase_core(M(e),M(t),M(n))}static randomDecimalForTesting(e){if(Math.random()*20<1)return _e(0,0,0);const t=Math.random()>.5?1:-1;if(Math.random()*20<1)return _e(t,0,1);const n=Math.floor(Math.random()*(e+1));let l=n===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(l=Math.trunc(l));let i=Math.pow(10,l);return Math.random()>.9&&(i=Math.trunc(i)),fe(t,n,i)}static affordGeometricSeries_core(e,t,n,l){const i=t.mul(n.pow(l));return C.floor(e.div(i).mul(n.sub(1)).add(1).log10().div(n.log10()))}static sumGeometricSeries_core(e,t,n,l){return t.mul(n.pow(l)).mul(C.sub(1,n.pow(e))).div(C.sub(1,n))}static affordArithmeticSeries_core(e,t,n,l){const a=t.add(l.mul(n)).sub(n.div(2)),u=a.pow(2);return a.neg().add(u.add(n.mul(e).mul(2)).sqrt()).div(n).floor()}static sumArithmeticSeries_core(e,t,n,l){const i=t.add(l.mul(n));return e.div(2).mul(i.mul(2).plus(e.sub(1).mul(n)))}static efficiencyOfPurchase_core(e,t,n){return e.div(t).add(e.div(n))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<ts)return this.layer+=1,this.mag=Math.log10(this.mag),this;let e=Math.abs(this.mag),t=Math.sign(this.mag);if(e>=Ya)return this.layer+=1,this.mag=t*Math.log10(e),this;for(;e<es&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=t*Math.pow(10,e),e=Math.abs(this.mag),t=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this.normalize(),this}fromComponents_noNormalize(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this}fromMantissaExponent(e,t){return this.layer=1,this.sign=Math.sign(e),e=Math.abs(e),this.mag=t+Math.log10(e),this.normalize(),this}fromMantissaExponent_noNormalize(e,t){return this.fromMantissaExponent(e,t),this}fromDecimal(e){return this.sign=e.sign,this.layer=e.layer,this.mag=e.mag,this}fromNumber(e){return this.mag=Math.abs(e),this.sign=Math.sign(e),this.layer=0,this.normalize(),this}fromString(e){const t=e,n=C.fromStringCache.get(t);if(n!==void 0)return this.fromDecimal(n);e=e.replace(",","");const l=e.split("^^^");if(l.length===2){const y=parseFloat(l[0]),k=parseFloat(l[1]),B=l[1].split(";");let V=1;if(B.length===2&&(V=parseFloat(B[1]),isFinite(V)||(V=1)),isFinite(y)&&isFinite(k)){const P=C.pentate(y,k,V);return this.sign=P.sign,this.layer=P.layer,this.mag=P.mag,C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}}const i=e.split("^^");if(i.length===2){const y=parseFloat(i[0]),k=parseFloat(i[1]),B=i[1].split(";");let V=1;if(B.length===2&&(V=parseFloat(B[1]),isFinite(V)||(V=1)),isFinite(y)&&isFinite(k)){const P=C.tetrate(y,k,V);return this.sign=P.sign,this.layer=P.layer,this.mag=P.mag,C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}}const a=e.split("^");if(a.length===2){const y=parseFloat(a[0]),k=parseFloat(a[1]);if(isFinite(y)&&isFinite(k)){const B=C.pow(y,k);return this.sign=B.sign,this.layer=B.layer,this.mag=B.mag,C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}}e=e.trim().toLowerCase();let u,c,d=e.split("pt");if(d.length===2){u=10,c=parseFloat(d[0]),d[1]=d[1].replace("(",""),d[1]=d[1].replace(")","");let y=parseFloat(d[1]);if(isFinite(y)||(y=1),isFinite(u)&&isFinite(c)){const k=C.tetrate(u,c,y);return this.sign=k.sign,this.layer=k.layer,this.mag=k.mag,C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}}if(d=e.split("p"),d.length===2){u=10,c=parseFloat(d[0]),d[1]=d[1].replace("(",""),d[1]=d[1].replace(")","");let y=parseFloat(d[1]);if(isFinite(y)||(y=1),isFinite(u)&&isFinite(c)){const k=C.tetrate(u,c,y);return this.sign=k.sign,this.layer=k.layer,this.mag=k.mag,C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}}const m=e.split("e"),g=m.length-1;if(g===0){const y=parseFloat(e);if(isFinite(y))return this.fromNumber(y),C.fromStringCache.size>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}else if(g===1){const y=parseFloat(e);if(isFinite(y)&&y!==0)return this.fromNumber(y),C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}const p=e.split("e^");if(p.length===2){this.sign=1,p[0].charAt(0)=="-"&&(this.sign=-1);let y="";for(let k=0;k<p[1].length;++k){const B=p[1].charCodeAt(k);if(B>=43&&B<=57||B===101)y+=p[1].charAt(k);else return this.layer=parseFloat(y),this.mag=parseFloat(p[1].substr(k+1)),this.normalize(),C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}}if(g<1)return this.sign=0,this.layer=0,this.mag=0,C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this;const w=parseFloat(m[0]);if(w===0)return this.sign=0,this.layer=0,this.mag=0,C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this;let _=parseFloat(m[m.length-1]);if(g>=2){const y=parseFloat(m[m.length-2]);isFinite(y)&&(_*=Math.sign(y),_+=dl(y))}if(!isFinite(w))this.sign=m[0]==="-"?-1:1,this.layer=g,this.mag=_;else if(g===1)this.sign=Math.sign(w),this.layer=1,this.mag=_+Math.log10(Math.abs(w));else if(this.sign=Math.sign(w),this.layer=g,g===2){const y=C.mul(fe(1,2,_),M(w));return this.sign=y.sign,this.layer=y.layer,this.mag=y.mag,C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}else this.mag=_;return this.normalize(),C.fromStringCache.maxSize>=1&&C.fromStringCache.set(t,C.fromDecimal(this)),this}fromValue(e){return e instanceof C?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(e){return isNaN(this.m)?Number.NaN:this.m===0?0:jn(this.m,e)}magnitudeWithDecimalPlaces(e){return isNaN(this.mag)?Number.NaN:this.mag===0?0:jn(this.mag,e)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=Wl?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(e){return this.layer===0?(this.sign*this.mag).toExponential(e):this.toStringWithDecimalPlaces(e)}toFixed(e){return this.layer===0?(this.sign*this.mag).toFixed(e):this.toStringWithDecimalPlaces(e)}toPrecision(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.exponent-1):this.toExponential(e-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(e){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(e):jn(this.m,e)+"e"+jn(this.e,e):this.layer===1?jn(this.m,e)+"e"+jn(this.e,e):this.layer<=Wl?(this.sign===-1?"-":"")+"e".repeat(this.layer)+jn(this.mag,e):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+jn(this.mag,e)}abs(){return _e(this.sign===0?0:1,this.layer,this.mag)}neg(){return _e(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?C.dZero:this.layer===0?fe(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?C.dZero:this.layer===0?fe(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?C.dZero:this.layer===0?fe(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?C.dZero:this.layer===0?fe(this.sign,0,Math.trunc(this.mag)):this}add(e){const t=M(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer)||this.sign===0)return t;if(t.sign===0)return this;if(this.sign===-t.sign&&this.layer===t.layer&&this.mag===t.mag)return _e(0,0,0);let n,l;if(this.layer>=2||t.layer>=2)return this.maxabs(t);if(C.cmpabs(this,t)>0?(n=this,l=t):(n=t,l=this),n.layer===0&&l.layer===0)return C.fromNumber(n.sign*n.mag+l.sign*l.mag);const i=n.layer*Math.sign(n.mag),a=l.layer*Math.sign(l.mag);if(i-a>=2)return n;if(i===0&&a===-1){if(Math.abs(l.mag-Math.log10(n.mag))>cl)return n;{const u=Math.pow(10,Math.log10(n.mag)-l.mag),c=l.sign+n.sign*u;return fe(Math.sign(c),1,l.mag+Math.log10(Math.abs(c)))}}if(i===1&&a===0){if(Math.abs(n.mag-Math.log10(l.mag))>cl)return n;{const u=Math.pow(10,n.mag-Math.log10(l.mag)),c=l.sign+n.sign*u;return fe(Math.sign(c),1,Math.log10(l.mag)+Math.log10(Math.abs(c)))}}if(Math.abs(n.mag-l.mag)>cl)return n;{const u=Math.pow(10,n.mag-l.mag),c=l.sign+n.sign*u;return fe(Math.sign(c),1,l.mag+Math.log10(Math.abs(c)))}}plus(e){return this.add(e)}sub(e){return this.add(M(e).neg())}subtract(e){return this.sub(e)}minus(e){return this.sub(e)}mul(e){const t=M(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer))return t;if(this.sign===0||t.sign===0)return _e(0,0,0);if(this.layer===t.layer&&this.mag===-t.mag)return _e(this.sign*t.sign,0,1);let n,l;if(this.layer>t.layer||this.layer==t.layer&&Math.abs(this.mag)>Math.abs(t.mag)?(n=this,l=t):(n=t,l=this),n.layer===0&&l.layer===0)return C.fromNumber(n.sign*l.sign*n.mag*l.mag);if(n.layer>=3||n.layer-l.layer>=2)return fe(n.sign*l.sign,n.layer,n.mag);if(n.layer===1&&l.layer===0)return fe(n.sign*l.sign,1,n.mag+Math.log10(l.mag));if(n.layer===1&&l.layer===1)return fe(n.sign*l.sign,1,n.mag+l.mag);if(n.layer===2&&l.layer===1){const i=fe(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(fe(Math.sign(l.mag),l.layer-1,Math.abs(l.mag)));return fe(n.sign*l.sign,i.layer+1,i.sign*i.mag)}if(n.layer===2&&l.layer===2){const i=fe(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(fe(Math.sign(l.mag),l.layer-1,Math.abs(l.mag)));return fe(n.sign*l.sign,i.layer+1,i.sign*i.mag)}throw Error("Bad arguments to mul: "+this+", "+e)}multiply(e){return this.mul(e)}times(e){return this.mul(e)}div(e){const t=M(e);return this.mul(t.recip())}divide(e){return this.div(e)}divideBy(e){return this.div(e)}dividedBy(e){return this.div(e)}recip(){return this.mag===0?C.dNaN:this.layer===0?fe(this.sign,0,1/this.mag):fe(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(e){const t=M(e);return this.sign>t.sign?1:this.sign<t.sign?-1:this.sign*this.cmpabs(e)}cmpabs(e){const t=M(e),n=this.mag>0?this.layer:-this.layer,l=t.mag>0?t.layer:-t.layer;return n>l?1:n<l?-1:this.mag>t.mag?1:this.mag<t.mag?-1:0}compare(e){return this.cmp(e)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(e){const t=M(e);return this.sign===t.sign&&this.layer===t.layer&&this.mag===t.mag}equals(e){return this.eq(e)}neq(e){return!this.eq(e)}notEquals(e){return this.neq(e)}lt(e){return this.cmp(e)===-1}lte(e){return!this.gt(e)}gt(e){return this.cmp(e)===1}gte(e){return!this.lt(e)}max(e){const t=M(e);return this.lt(t)?t:this}min(e){const t=M(e);return this.gt(t)?t:this}maxabs(e){const t=M(e);return this.cmpabs(t)<0?t:this}minabs(e){const t=M(e);return this.cmpabs(t)>0?t:this}clamp(e,t){return this.max(e).min(t)}clampMin(e){return this.max(e)}clampMax(e){return this.min(e)}cmp_tolerance(e,t){const n=M(e);return this.eq_tolerance(n,t)?0:this.cmp(n)}compare_tolerance(e,t){return this.cmp_tolerance(e,t)}eq_tolerance(e,t){const n=M(e);if(t==null&&(t=1e-7),this.sign!==n.sign||Math.abs(this.layer-n.layer)>1)return!1;let l=this.mag,i=n.mag;return this.layer>n.layer&&(i=dl(i)),this.layer<n.layer&&(l=dl(l)),Math.abs(l-i)<=t*Math.max(Math.abs(l),Math.abs(i))}equals_tolerance(e,t){return this.eq_tolerance(e,t)}neq_tolerance(e,t){return!this.eq_tolerance(e,t)}notEquals_tolerance(e,t){return this.neq_tolerance(e,t)}lt_tolerance(e,t){const n=M(e);return!this.eq_tolerance(n,t)&&this.lt(n)}lte_tolerance(e,t){const n=M(e);return this.eq_tolerance(n,t)||this.lt(n)}gt_tolerance(e,t){const n=M(e);return!this.eq_tolerance(n,t)&&this.gt(n)}gte_tolerance(e,t){const n=M(e);return this.eq_tolerance(n,t)||this.gt(n)}pLog10(){return this.lt(C.dZero)?C.dZero:this.log10()}absLog10(){return this.sign===0?C.dNaN:this.layer>0?fe(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):fe(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?C.dNaN:this.layer>0?fe(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):fe(this.sign,0,Math.log10(this.mag))}log(e){return e=M(e),this.sign<=0||e.sign<=0||e.sign===1&&e.layer===0&&e.mag===1?C.dNaN:this.layer===0&&e.layer===0?fe(this.sign,0,Math.log(this.mag)/Math.log(e.mag)):C.div(this.log10(),e.log10())}log2(){return this.sign<=0?C.dNaN:this.layer===0?fe(this.sign,0,Math.log2(this.mag)):this.layer===1?fe(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?fe(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):fe(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?C.dNaN:this.layer===0?fe(this.sign,0,Math.log(this.mag)):this.layer===1?fe(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?fe(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):fe(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(e){return this.log(e)}pow(e){const t=M(e),n=this,l=t;if(n.sign===0)return l.eq(0)?_e(1,0,1):n;if(n.sign===1&&n.layer===0&&n.mag===1)return n;if(l.sign===0)return _e(1,0,1);if(l.sign===1&&l.layer===0&&l.mag===1)return n;const i=n.absLog10().mul(l).pow10();return this.sign===-1?Math.abs(l.toNumber()%2)%2===1?i.neg():Math.abs(l.toNumber()%2)%2===0?i:C.dNaN:i}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return C.dNaN;let e=this;if(e.layer===0){const t=Math.pow(10,e.sign*e.mag);if(Number.isFinite(t)&&Math.abs(t)>=.1)return fe(1,0,t);if(e.sign===0)return C.dOne;e=_e(e.sign,e.layer+1,Math.log10(e.mag))}return e.sign>0&&e.mag>=0?fe(e.sign,e.layer+1,e.mag):e.sign<0&&e.mag>=0?fe(-e.sign,e.layer+1,-e.mag):C.dOne}pow_base(e){return M(e).pow(this)}root(e){const t=M(e);return this.pow(t.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?C.exp(C.mul(this,C.ln(this).sub(1))):C.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(_e(1,0,24)))return C.fromNumber(os(this.sign*this.mag));const e=this.mag-1;let t=.9189385332046727;t=t+(e+.5)*Math.log(e),t=t-e;const n=e*e;let l=e,i=12*l,a=1/i,u=t+a;if(u===t||(t=u,l=l*n,i=360*l,a=1/i,u=t-a,u===t))return C.exp(t);t=u,l=l*n,i=1260*l;let c=1/i;return t=t+c,l=l*n,i=1680*l,c=1/i,t=t-c,C.exp(t)}else return this.layer===1?C.exp(C.mul(this,C.ln(this).sub(1))):C.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?C.dOne:this.layer===0&&this.mag<=709.7?C.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?fe(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?fe(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):fe(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return C.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return fe(1,2,Math.log10(this.mag)-.3010299956639812);{const e=C.div(_e(this.sign,this.layer-1,this.mag),_e(1,0,2));return e.layer+=1,e.normalize(),e}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(e=2,t=_e(1,0,1)){if(e===1)return C.pow(this,t);if(e===0)return new C(t);if(this.eq(C.dOne))return C.dOne;if(this.eq(-1))return C.pow(this,t);if(e===Number.POSITIVE_INFINITY){const i=this.toNumber();if(i<=1.444667861009766&&i>=.06598803584531254){if(i>1.444667861009099)return C.fromNumber(Math.E);const a=C.ln(this).neg();return a.lambertw().div(a)}else return i>1.444667861009766?C.fromNumber(Number.POSITIVE_INFINITY):C.dNaN}if(this.eq(C.dZero)){let i=Math.abs((e+1)%2);return i>1&&(i=2-i),C.fromNumber(i)}if(e<0)return C.iteratedlog(t,this,-e);t=M(t);const n=e;e=Math.trunc(e);const l=n-e;if(this.gt(C.dZero)&&this.lte(1.444667861009766)){e=Math.min(1e4,e);for(let i=0;i<e;++i){const a=t;if(t=this.pow(t),a.eq(t))return t}if(l!=0){const i=this.pow(t);return t.mul(1-l).add(i.mul(l))}return t}l!==0&&(t.eq(C.dOne)?this.gt(10)?t=this.pow(l):(t=C.fromNumber(C.tetrate_critical(this.toNumber(),l)),this.lt(2)&&(t=t.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?t=t.layeradd10(l):t=t.layeradd(l,this));for(let i=0;i<e;++i){if(t=this.pow(t),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(t.layer-this.layer>3)return _e(t.sign,t.layer+(e-i-1),t.mag);if(i>1e4)return t}return t}iteratedexp(e=2,t=_e(1,0,1)){return this.tetrate(e,t)}iteratedlog(e=10,t=1){if(t<0)return C.tetrate(e,-t,this);e=M(e);let n=C.fromDecimal(this);const l=t;t=Math.trunc(t);const i=l-t;if(n.layer-e.layer>3){const a=Math.min(t,n.layer-e.layer-3);t-=a,n.layer-=a}for(let a=0;a<t;++a){if(n=n.log(e),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(a>1e4)return n}return i>0&&i<1&&(e.eq(10)?n=n.layeradd10(-i):n=n.layeradd(-i,e)),n}slog(e=10,t=100){let n=.001,l=!1,i=!1,a=this.slog_internal(e).toNumber();for(let u=1;u<t;++u){const d=new C(e).tetrate(a).gt(this);if(u>1&&i!=d&&(l=!0),i=d,l?n/=2:n*=2,n=Math.abs(n)*(d?-1:1),a+=n,n===0)break}return C.fromNumber(a)}slog_internal(e=10){if(e=M(e),e.lte(C.dZero)||e.eq(C.dOne))return C.dNaN;if(e.lt(C.dOne))return this.eq(C.dOne)?C.dZero:this.eq(C.dZero)?C.dNegOne:C.dNaN;if(this.mag<0||this.eq(C.dZero))return C.dNegOne;let t=0,n=C.fromDecimal(this);if(n.layer-e.layer>3){const l=n.layer-e.layer-3;t+=l,n.layer-=l}for(let l=0;l<100;++l)if(n.lt(C.dZero))n=C.pow(e,n),t-=1;else{if(n.lte(C.dOne))return C.fromNumber(t+C.slog_critical(e.toNumber(),n.toNumber()));t+=1,n=C.log(n,e)}return C.fromNumber(t)}static slog_critical(e,t){return e>10?t-1:C.critical_section(e,t,ss)}static tetrate_critical(e,t){return C.critical_section(e,t,as)}static critical_section(e,t,n){t*=10,t<0&&(t=0),t>10&&(t=10),e<2&&(e=2),e>10&&(e=10);let l=0,i=0;for(let u=0;u<Zn.length;++u)if(Zn[u]==e){l=n[u][Math.floor(t)],i=n[u][Math.ceil(t)];break}else if(Zn[u]<e&&Zn[u+1]>e){const c=(e-Zn[u])/(Zn[u+1]-Zn[u]);l=n[u][Math.floor(t)]*(1-c)+n[u+1][Math.floor(t)]*c,i=n[u][Math.ceil(t)]*(1-c)+n[u+1][Math.ceil(t)]*c;break}const a=t-Math.floor(t);return l<=0||i<=0?l*(1-a)+i*a:Math.pow(e,Math.log(l)/Math.log(e)*(1-a)+Math.log(i)/Math.log(e)*a)}layeradd10(e){e=C.fromValue_noAlloc(e).toNumber();const t=C.fromDecimal(this);if(e>=1){t.mag<0&&t.layer>0?(t.sign=0,t.mag=0,t.layer=0):t.sign===-1&&t.layer==0&&(t.sign=1,t.mag=-t.mag);const n=Math.trunc(e);e-=n,t.layer+=n}if(e<=-1){const n=Math.trunc(e);if(e-=n,t.layer+=n,t.layer<0)for(let l=0;l<100;++l){if(t.layer++,t.mag=Math.log10(t.mag),!isFinite(t.mag))return t.sign===0&&(t.sign=1),t.layer<0&&(t.layer=0),t.normalize();if(t.layer>=0)break}}for(;t.layer<0;)t.layer++,t.mag=Math.log10(t.mag);return t.sign===0&&(t.sign=1,t.mag===0&&t.layer>=1&&(t.layer-=1,t.mag=1)),t.normalize(),e!==0?t.layeradd(e,10):t}layeradd(e,t){const l=this.slog(t).toNumber()+e;return l>=0?C.tetrate(t,l):Number.isFinite(l)?l>=-1?C.log(C.tetrate(t,l+1),t):C.log(C.log(C.tetrate(t,l+2),t),t):C.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return C.fromNumber(Zl(this.toNumber()));if(this.layer===0)return C.fromNumber(Zl(this.sign*this.mag));if(this.layer===1)return Ql(this);if(this.layer===2)return Ql(this);if(this.layer>=3)return _e(this.sign,this.layer-1,this.mag);throw new Error("Unhandled behavior in lambertw()")}ssqrt(){if(this.sign==1&&this.layer>=3)return _e(this.sign,this.layer-1,this.mag);const e=this.ln();return e.div(e.lambertw())}pentate(e=2,t=_e(1,0,1)){t=M(t);const n=e;e=Math.trunc(e);const l=n-e;l!==0&&(t.eq(C.dOne)?(++e,t=C.fromNumber(l)):this.eq(10)?t=t.layeradd10(l):t=t.layeradd(l,this));for(let i=0;i<e;++i){if(t=this.tetrate(t.toNumber()),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(i>10)return t}return t}sin(){return this.mag<0?this:this.layer===0?C.fromNumber(Math.sin(this.sign*this.mag)):_e(0,0,0)}cos(){return this.mag<0?C.dOne:this.layer===0?C.fromNumber(Math.cos(this.sign*this.mag)):_e(0,0,0)}tan(){return this.mag<0?this:this.layer===0?C.fromNumber(Math.tan(this.sign*this.mag)):_e(0,0,0)}asin(){return this.mag<0?this:this.layer===0?C.fromNumber(Math.asin(this.sign*this.mag)):_e(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?C.fromNumber(Math.acos(this.toNumber())):this.layer===0?C.fromNumber(Math.acos(this.sign*this.mag)):_e(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?C.fromNumber(Math.atan(this.sign*this.mag)):C.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return C.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return C.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?_e(Number.NaN,Number.NaN,Number.NaN):C.ln(this.add(1).div(C.fromNumber(1).sub(this))).div(2)}ascensionPenalty(e){return e===0?this:this.root(C.pow(10,e))}egg(){return this.add(9)}lessThanOrEqualTo(e){return this.cmp(e)<1}lessThan(e){return this.cmp(e)<0}greaterThanOrEqualTo(e){return this.cmp(e)>-1}greaterThan(e){return this.cmp(e)>0}};let r=C;r.fromStringCache=new Qa(ls);r.dZero=_e(0,0,0);r.dOne=_e(1,0,1);r.dNegOne=_e(-1,0,1);r.dTwo=_e(1,0,2);r.dTen=_e(1,0,10);r.dNaN=_e(Number.NaN,Number.NaN,Number.NaN);r.dInf=_e(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);r.dNegInf=_e(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);r.dNumberMax=fe(1,0,Number.MAX_VALUE);r.dNumberMin=fe(1,0,Number.MIN_VALUE);M=r.fromValue_noAlloc;fe=r.fromComponents;_e=r.fromComponents_noNormalize;r.fromMantissaExponent;r.fromMantissaExponent_noNormalize;const us=new r(1);function Ni(e,t,n=!0){let l=r.log10(e).floor(),i=r.div(e,r.pow(10,l));i.toStringWithDecimalPlaces(t)==="10"&&(i=us,l=l.add(1));const a=l.gte(1e9)?dn(l,Math.max(Math.max(t,3),Be.defaultDecimalsShown)):l.gte(1e4)?Wi(l,0):l.toStringWithDecimalPlaces(0);return n?i.toStringWithDecimalPlaces(t)+"e"+a:"e"+a}function Wi(e,t){if(e==null)return"NaN";if(e=new r(e),e.mag<.001)return 0 .toFixed(t);const l=e.toStringWithDecimalPlaces(t).split(".");return l[0]=l[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),l.length==1?l[0]:l[0]+"."+l[1]}function yr(e,t){return e==null?"NaN":(e=new r(e),e.mag<1e-4?0 .toFixed(t):(e.mag<.1&&t!==0&&(t=Math.max(Math.max(t,e.log10().negate().ceil().toNumber()),Be.defaultDecimalsShown)),e.toStringWithDecimalPlaces(t)))}const cs=new r("eeee1000"),ds=new r("e100000"),Kl=new r("e1000"),wr=new r(1e9),ms=new r(1e6),ps=new r(1e3),fs=new r(.98),vs=new r(.001),_r=new r(0);function dn(e,t,n){if(t==null&&(t=Be.defaultDecimalsShown),n=n!=null?n:Be.defaultShowSmall,e=new r(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag))return"NaN";if(e.sign<0)return"-"+dn(e.neg(),t);if(e.mag===Number.POSITIVE_INFINITY)return"Infinity";if(e.gte(cs)){const l=e.slog();return l.gte(ms)?"F"+dn(l.floor()):r.pow(10,l.sub(l.floor())).toStringWithDecimalPlaces(3)+"F"+Wi(l.floor(),0)}else{if(e.gte(ds))return Ni(e,0,!1);if(e.gte(Kl))return Ni(e,0);if(e.gte(wr))return Ni(e,t);if(e.gte(ps))return Wi(e,0);if(e.gte(vs)||!n)return yr(e,t);if(e.eq(_r))return 0 .toFixed(t)}return e=Sr(e),e.lt(Kl)?Ni(e,t).replace(/([^(?:e|F)]*)$/,"-$1"):dn(e,t)+"\u207B\xB9"}function jt(e){return e=new r(e),e.sign<0?"-"+jt(e.neg()):e.gte(wr)||e.lte(fs)&&!e.eq(_r)?dn(e):dn(e,0)}function Cr(e){return r.lt(e,0)?"-"+Cr(r.neg(e)):r.gt(e,2**51)?dn(r.div(e,31536e3))+"y":(e=new r(e).toNumber(),e<60?dn(e)+"s":e<3600?jt(Math.floor(e/60))+"m "+dn(e%60)+"s":e<86400?jt(Math.floor(e/3600))+"h "+jt(Math.floor(e/60)%60)+"m "+jt(e%60)+"s":e<31536e3?jt(Math.floor(e/84600)%365)+"d "+jt(Math.floor(e/3600)%24)+"h "+jt(Math.floor(e/60)%60)+"m":jt(Math.floor(e/31536e3))+"y "+jt(Math.floor(e/84600)%365)+"d "+jt(Math.floor(e/3600)%24)+"h")}function gs(e,t,n){e=new r(e);let l=e.toStringWithDecimalPlaces(t);return new r(l).gte(n)&&(l=r.sub(n,Math.pow(.1,t)).toStringWithDecimalPlaces(t)),l}function hs(e,t){return dn(e,t,!0)}function Sr(e){let t=r.log10(e).ceil();const n=r.div(e,r.pow(10,t));return t=t.neg(),e=new r(10).pow(t).times(n),e}var bs=Object.freeze(Object.defineProperty({__proto__:null,default:r,exponentialFormat:Ni,commaFormat:Wi,regularFormat:yr,format:dn,formatWhole:jt,formatTime:Cr,toPlaces:gs,formatSmall:hs,invertOOM:Sr},Symbol.toStringTag,{value:"Module"}));const{exponentialFormat:ys,commaFormat:ws,regularFormat:_s,format:Oe,formatWhole:ge,formatTime:zn,toPlaces:Cs,formatSmall:Di,invertOOM:Ss}=bs;window.Decimal=r;window.exponentialFormat=ys;window.commaFormat=ws;window.regularFormat=_s;window.format=Oe;window.formatWhole=ge;window.formatTime=zn;window.toPlaces=Cs;window.formatSmall=Di;window.invertOOM=Ss;function cn(e){let t=e.replace(/([A-Z])/g," $1");return t=t.charAt(0).toUpperCase()+t.slice(1),t}function ks(e){return(e[0]+e.slice(1).replace(/[A-Z]/g,t=>`-${t}`)).toLowerCase()}function hl(e){return typeof e=="function"}var Me=(e=>(e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right",e.Default="Up",e))(Me||{});const Pi=Symbol("DoNotCache");function E(e,t){const n=e[t];hl(n)&&n.length===0&&!n[Pi]?e[t]=S(n.bind(e)):hl(n)&&(e[t]=n.bind(e),e[t][Pi]=!0)}function Ue(e){return hl(e)&&!e[Pi]&&(e=S(e)),e}const tt=Symbol("Component"),je=Symbol("GatherProps");let Ns=0;function fn(e="feature-"){return e+Ns++}var Ge=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.None=2]="None",e))(Ge||{});function ft(e){const t=o(e);return t!==2&&t!==!1}function En(e){return o(e)===1}function $(e){return e[Pi]=!0,e}function Ye(e,t,n){e[t]===void 0&&n!=null&&(e[t]=n)}var ht=window.state=kl({lastTenTicks:[],hasNaN:!1,NaNPath:[],errors:hi([])});const Qn={variables:{"--foreground":"#dfdfdf","--background":"#0f0f0f","--feature-foreground":"#0f0f0f","--tooltip-background":"rgba(0, 0, 0, 0.75)","--raised-background":"#0f0f0f","--points":"#ffffff","--locked":"#bf8f8f","--highlighted":"#333","--bought":"#77bf5f","--danger":"rgb(220, 53, 69)","--link":"#02f2f2","--outline":"#dfdfdf","--accent1":"#627a82","--accent2":"#658262","--accent3":"#7c6282","--border-radius":"15px","--modal-border":"solid 2px var(--color)","--feature-margin":"0px"},floatingTabs:!0,mergeAdjacent:!0,showPin:!0};var Il=(e=>(e.Classic="classic",e.Paper="paper",e.Nordic="nordic",e.Aqua="aqua",e))(Il||{}),yi={classic:Qn,paper:{...Qn,variables:{...Qn.variables,"--background":"#2a323d","--feature-foreground":"#000","--raised-background":"#333c4a","--locked":"#3a3e45","--bought":"#5C8A58","--outline":"#333c4a","--border-radius":"4px","--modal-border":"","--feature-margin":"5px"},floatingTabs:!1},nordic:{...Qn,variables:{...Qn.variables,"--foreground":"#D8DEE9","--background":"#2E3440","--feature-foreground":"#000","--raised-background":"#3B4252","--points":"#E5E9F0","--locked":"#4c566a","--highlighted":"#434c5e","--bought":"#8FBCBB","--danger":"#D08770","--link":"#88C0D0","--outline":"#3B4252","--accent1":"#B48EAD","--accent2":"#A3BE8C","--accent3":"#EBCB8B","--border-radius":"4px","--modal-border":"solid 2px #3B4252","--feature-margin":"5px"},floatingTabs:!1},aqua:{...Qn,variables:{...Qn.variables,"--foreground":"#bfdfff","--background":"#001f3f","--tooltip-background":"rgba(0, 15, 31, 0.75)","--raised-background":"#001f3f","--points":"#dfefff","--locked":"#c4a7b3","--outline":"#bfdfff"}}};const zt=vr();"fonts"in document&&(document.fonts.onloadingdone=()=>zt.emit("fontsLoaded"));var $s=Object.freeze(Object.defineProperty({__proto__:null,globalBus:zt},Symbol.toStringTag,{value:"Module"}));function kr(e={}){return Object.assign({id:`${Be.id}-0`,name:"Default Save",tabs:Be.initialTabs.slice(),time:Date.now(),autosave:!0,offlineProd:!0,offlineTime:0,timePlayed:0,keepGoing:!1,modID:Be.id,modVersion:Be.versionNumber,layers:{}},e)}function sn(e){const t=Mn.compressToUTF16(Pl(e!=null?e:U));return localStorage.setItem((e!=null?e:U).id,t),t}async function Ms(){xs();try{let e=localStorage.getItem(qe.active);if(e==null){await Yn(fi());return}if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=Mn.decompressFromUTF16(e);else throw"Unable to determine save encoding";const t=JSON.parse(e);if(t.modID!==Be.id){await Yn(fi());return}t.id=qe.active,await Yn(t)}catch(e){console.error(`Failed to load save. Falling back to new save.
`,e),await Yn(fi())}}function fi(){const e=Gi(),t=kr({id:e});return sn(t),qe.saves.push(e),t}function Gi(){let e,t=0;do e=`${Be.id}-${t++}`;while(localStorage.getItem(e)!=null);return e}const Tl=J(!1);async function Yn(e){console.info("Loading save",e),Tl.value=!0;const{layers:t,removeLayer:n,addLayer:l}=await Mi(()=>Promise.resolve().then(function(){return ku}),void 0),{fixOldSave:i,getInitialLayers:a}=await Mi(()=>Promise.resolve().then(function(){return nf}),void 0);for(const u in t){const c=t[u];c&&n(c)}a(e).forEach(u=>l(u,e)),e=kr(e),e.offlineProd&&e.time!=null&&e.time&&e.devSpeed!==0&&(e.offlineTime==null&&(e.offlineTime=0),e.offlineTime+=Math.min(e.offlineTime+(Date.now()-e.time)/1e3,Be.offlineLimit*3600)),e.time=Date.now(),e.modVersion!==Be.versionNumber&&(i(e.modVersion,e),e.modVersion=Be.versionNumber),Object.assign(U,e),qe.active=U.id,zt.emit("onLoad")}setInterval(()=>{U.autosave&&sn()},1e3);window.onbeforeunload=()=>{U.autosave&&sn()};window.save=sn;const Ps=window.hardReset=async()=>{await Yn(fi())};window.deleteLowerSaves=()=>{const e=Object.values(qe.saves).indexOf(U.id)+1;Object.values(qe.saves).slice(e).forEach(t=>localStorage.removeItem(t)),qe.saves=qe.saves.slice(0,e)};const xi=hi({active:"",saves:[],showTPS:!0,theme:Il.Nordic,unthrottled:!1,alignUnits:!1});et(xi,e=>{const t=Mn.compressToUTF16(JSON.stringify(e));localStorage.setItem(Be.id,t)},{deep:!0});var qe=window.settings=xi;window.hardResetSettings=()=>{const e={active:"",saves:[],showTPS:!0,theme:Il.Nordic,alignUnits:!1};zt.emit("loadSettings",e),Object.assign(xi,e),Ps()};function xs(){try{let e=localStorage.getItem(Be.id);if(e!=null&&e!==""){if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=Mn.decompressFromUTF16(e);else{console.warn("Unable to determine settings encoding",e);return}const t=JSON.parse(e);typeof t=="object"&&Object.assign(xi,t)}zt.emit("loadSettings",xi)}catch{}}const Nr=hi([]);function Is(e){Nr.push(e)}const Ts=hi([]),Fs=hi([]),Es={class:"table"},Yi=K({__name:"Column",setup(e){const t=S(()=>yi[qe.theme].mergeAdjacent);return(n,l)=>(b(),N("div",Es,[h("div",{class:Pe(["col",{mergeAdjacent:o(t)}])},[Kt(n.$slots,"default")],2)]))}}),Ds={class:"table"},Ii=K({__name:"Row",setup(e){const t=S(()=>yi[qe.theme].mergeAdjacent);return(n,l)=>(b(),N("div",Ds,[h("div",{class:Pe(["row",{mergeAdjacent:o(t)}])},[Kt(n.$slots,"default")],2)]))}});function el(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!dr(e)}function ve(e,t="span"){return typeof e=="function"?K({render:e}):typeof e=="string"?e.length>0?(e=e.trim(),e.charAt(0)!=="<"&&(e=`<${t}>${e}</${t}>`),K({template:e})):K({render:()=>({})}):e}function We(e){if(gn(e))return typeof e=="function"?e():ve(e);const t=e[tt];return s(t,e[je](),null)}function zi(...e){let t;return s(Ii,null,el(t=e.map(We))?t:{default:()=>[t]})}function Ti(...e){let t;return s(Yi,null,el(t=e.map(We))?t:{default:()=>[t]})}function at(e){if(gn(e))return typeof e=="function"?e():typeof e=="string"?s(T,null,[e]):s(e,null,null);const t=e[tt];return s(t,e[je](),null)}function bl(...e){let t;return s(Ii,null,el(t=e.map(at))?t:{default:()=>[t]})}function li(...e){let t;return s(Yi,null,el(t=e.map(at))?t:{default:()=>[t]})}function yl(e,t){return e.reduce((n,l)=>s(T,null,[n,t,l]))}function gn(e){return typeof e=="string"?!0:typeof e=="object"?e==null?!1:"render"in e||"component"in e:typeof e=="function"&&e[Pi]===!0}function $r(e,t){const n=J(null),l=J(void 0);function i(c){n.value||(n.value=setInterval(u,250)),l.value=c}function a(){n.value&&(clearInterval(n.value),n.value=null)}function u(){t&&t.value?t.value():e&&e.value&&e.value(l.value)}return Nl(a),{start:i,stop:a,handleHolding:u}}function ri(e,t){const n=S(()=>e.filter(l=>ft(l.visibility)&&t(l)));return{firstFeature:S(()=>n.value[0]),collapsedContent:$(()=>Ti(...n.value.slice(1))),hasCollapsedContent:S(()=>n.value.length>1)}}function ni(e,t="div"){const n=$t();return Jt(()=>{n.value=ve(rt(e),t)}),n}function Dn(e,t="div"){const n=$t(null);return Jt(()=>{const l=rt(e);n.value=l==""||l==null?null:ve(l,t)}),n}function rt(e){return o(o(e))}function j(...e){return e.includes(Object)||e.push(Object),e}function Mr(e){const t=J(!1),n=e[je].bind(e);return e[je]=()=>({...n(),onPointerenter:()=>t.value=!0,onPointerleave:()=>t.value=!1}),t}function qs(e){return Object.keys(e).reduce((t,n)=>(t[ks(n)]=e[n],t),{})}const As=K({__name:"Context",emits:["updateNodes"],setup(e,{emit:t}){var g;const n=J({}),l=new ResizeObserver(c),i=J(null);ii(()=>{const p=i.value;p!=null&&l.observe(p)});let a=!0,u=J((g=i.value)==null?void 0:g.getBoundingClientRect());function c(){a&&(a=!1,Gt(()=>{var p;u.value=(p=i.value)==null?void 0:p.getBoundingClientRect(),Object.values(n.value).filter(w=>w).forEach(w=>w.rect=w.element.getBoundingClientRect()),t("updateNodes",n.value),a=!0}))}zt.on("fontsLoaded",c);const d={attributes:!1,childList:!0,subtree:!1};ji(Fl,(p,w)=>{const _=new MutationObserver(()=>m(p));_.observe(w,d),n.value[p]={element:w,observer:_,rect:w.getBoundingClientRect()},c()}),ji(El,p=>{var w;(w=n.value[p])==null||w.observer.disconnect(),n.value[p]=void 0,c()}),ji(Dl,n),ji(ql,u);function m(p){const w=n.value[p];w!=null&&(w.rect=w.element.getBoundingClientRect(),t("updateNodes",n.value))}return(p,w)=>(b(),N(T,null,[Kt(p.$slots,"default",{},void 0,!0),h("div",{ref_key:"resizeListener",ref:i,class:"resize-listener"},null,512)],64))}});var Pr=me(As,[["__scopeId","data-v-2b1dc1bc"]]);const Ls=["onPointerdown"],Os={class:"modal-wrapper"},js={class:"modal-container"},Rs={class:"modal-header"},Bs={class:"modal-body"},Vs={class:"modal-footer"},Gs=h("div",{class:"modal-default-flex-grow"},null,-1),Un=K({__name:"Modal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const i=st(e),a=S(()=>o(i.modelValue)||c.value);function u(){n("update:modelValue",!1)}const c=J(!1),d=J(null),m=S(()=>{var g,p;return(p=(g=d.value)==null?void 0:g.nodes)!=null?p:null});return t({isOpen:a,nodes:m}),(g,p)=>(b(),H(mr,{to:"#modal-root"},[s($l,{name:"modal",onBeforeEnter:p[0]||(p[0]=w=>c.value=!0),onAfterLeave:p[1]||(p[1]=w=>c.value=!1)},{default:oe(()=>[mn(h("div",Ht({class:"modal-mask",onPointerdown:ti(u,["self"])},g.$attrs),[h("div",Os,[h("div",js,[h("div",Rs,[Kt(g.$slots,"header",{shown:o(a)},()=>[f(" default header ")])]),h("div",Bs,[s(Pr,{ref_key:"contextRef",ref:d},{default:oe(()=>[Kt(g.$slots,"body",{shown:o(a)},()=>[f(" default body ")])]),_:3},512)]),h("div",Vs,[Kt(g.$slots,"footer",{shown:o(a)},()=>[h("div",{class:"modal-default-footer"},[Gs,h("button",{class:"button modal-default-button",onClick:u}," Close ")])])])])])],16,Ls),[[In,e.modelValue]])]),_:3})]))}}),Rn=Symbol("ProxyState");function ct(e,t={}){const n=t;let l=!1,i=!1;function a(){return l||(i&&console.error("Cyclical dependency detected. Cannot evaluate lazy proxy."),i=!0,Object.assign(n,e.call(n,n)),l=!0),n}return new Proxy(n,{get(u,c){if(c===Rn)return a();const d=a()[c];return d!=null&&typeof d=="object"&&_n in d?d[_n]:d},set(u,c,d){return a()[c]=d,!0},has(u,c){return c===Rn?!0:Reflect.has(a(),c)},ownKeys(){return Reflect.ownKeys(a())},getOwnPropertyDescriptor(u,c){return l||(Object.assign(n,e.call(n,n)),l=!0),Object.getOwnPropertyDescriptor(u,c)}})}const xr=r.ln(10);function Ui(e){return e}function Ci(e,...t){const n=t.find(l=>D(l));return n==null?(console.error("Could not invert due to no input being a variable"),0):n.invert(e)}function zs(e,t){return D(t)?t.invert(r.neg(e)):(console.error("Could not invert due to no input being a variable"),0)}function Us(e,t){return D(t)?t.isIntegrable()?v.neg(t.getIntegralFormula(e)):(console.error("Could not integrate due to variable not being integrable"),v.constant(0)):(console.error("Could not integrate due to no input being a variable"),v.constant(0))}function Xs(e){return v.neg(e)}function Hs(e,t,n){return D(t)?t.invert(r.sub(e,bt(n))):D(n)?n.invert(r.sub(e,bt(t))):(console.error("Could not invert due to no input being a variable"),0)}function Js(e,t,n){var l,i;if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const a=t.getIntegralFormula(e);return v.times(n,(l=t.innermostVariable)!=null?l:0).add(a)}else if(D(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const a=n.getIntegralFormula(e);return v.times(t,(i=n.innermostVariable)!=null?i:0).add(a)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Ws(e,t,n){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=t.getIntegralFormula(e);return v.add(l,n)}else if(D(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=n.getIntegralFormula(e);return v.add(l,t)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Zs(e,t,n){return D(t)?t.invert(r.add(e,bt(n))):D(n)?n.invert(r.sub(bt(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function Qs(e,t,n){var l,i;if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const a=t.getIntegralFormula(e);return v.sub(a,v.times(n,(l=t.innermostVariable)!=null?l:0))}else if(D(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const a=n.getIntegralFormula(e);return v.times(t,(i=n.innermostVariable)!=null?i:0).sub(a)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Ks(e,t,n){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=t.getIntegralFormula(e);return v.sub(l,n)}else if(D(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=n.getIntegralFormula(e);return v.sub(l,t)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Ys(e,t,n){return D(t)?t.invert(r.div(e,bt(n))):D(n)?n.invert(r.div(e,bt(t))):(console.error("Could not invert due to no input being a variable"),0)}function eo(e,t,n){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=t.getIntegralFormula(e);return v.times(l,n)}else if(D(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=n.getIntegralFormula(e);return v.times(l,t)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function to(e,t,n){return D(t)?v.div(e,n):D(n)?v.div(e,t):(console.error("Could not apply substitution due to no input being a variable"),v.constant(0))}function no(e,t,n){return D(t)?t.invert(r.mul(e,bt(n))):D(n)?n.invert(r.div(bt(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function io(e,t,n){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=t.getIntegralFormula(e);return v.div(l,n)}else if(D(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=n.getIntegralFormula(e);return v.div(t,l)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function lo(e,t,n){return D(t)?v.mul(e,n):D(n)?v.mul(e,t):(console.error("Could not apply substitution due to no input being a variable"),v.constant(0))}function ro(e,t){return D(t)?t.invert(r.recip(e)):(console.error("Could not invert due to no input being a variable"),0)}function ao(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.ln(n)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function so(e,t){return D(t)?t.invert(r.pow10(e)):(console.error("Could not invert due to no input being a variable"),0)}function oo(e){return r.ln(e).sub(1).times(e).div(xr)}function uo(e,t){if(D(t)){const n=xr.times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function co(e,t){return D(t)?t.isIntegrable()?new v({inputs:[t.getIntegralFormula(e)],evaluate:oo,invert:uo}):(console.error("Could not integrate due to variable not being integrable"),v.constant(0)):(console.error("Could not integrate due to no input being a variable"),v.constant(0))}function mo(e,t,n){return D(t)?t.invert(r.pow(bt(n),e)):D(n)?n.invert(r.root(bt(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function po(e,t){return r.ln(e).sub(1).times(e).div(r.ln(t))}function fo(e,t,n){if(D(t)){const l=r.ln(bt(n)).times(e);return t.invert(l.div(l.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function vo(e,t,n){return D(t)?t.isIntegrable()?new v({inputs:[t.getIntegralFormula(e),n],evaluate:po,invert:fo}):(console.error("Could not integrate due to variable not being integrable"),v.constant(0)):(console.error("Could not integrate due to no input being a variable"),v.constant(0))}function go(e,t){return D(t)?t.invert(r.pow(2,e)):(console.error("Could not invert due to no input being a variable"),0)}function ho(e){return r.ln(e).sub(1).times(e).div(r.ln(2))}function bo(e,t){if(D(t)){const n=r.ln(2).times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}return console.error("Could not invert due to no input being a variable"),0}function yo(e,t){return D(t)?t.isIntegrable()?new v({inputs:[t.getIntegralFormula(e)],evaluate:ho,invert:bo}):(console.error("Could not integrate due to variable not being integrable"),v.constant(0)):(console.error("Could not integrate due to no input being a variable"),v.constant(0))}function wo(e,t){return D(t)?t.invert(r.exp(e)):(console.error("Could not invert due to no input being a variable"),0)}function _o(e){return r.ln(e).sub(1).times(e)}function Co(e,t){return D(t)?t.invert(r.div(e,r.div(e,Math.E).lambertw())):(console.error("Could not invert due to no input being a variable"),0)}function So(e,t){return D(t)?t.isIntegrable()?new v({inputs:[t.getIntegralFormula(e)],evaluate:_o,invert:Co}):(console.error("Could not integrate due to variable not being integrable"),v.constant(0)):(console.error("Could not integrate due to no input being a variable"),v.constant(0))}function ko(e,t,n){return D(t)?t.invert(r.root(e,bt(n))):D(n)?n.invert(r.ln(e).div(r.ln(bt(t)))):(console.error("Could not invert due to no input being a variable"),0)}function No(e,t,n){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=t.getIntegralFormula(e),i=v.add(n,1);return v.pow(l,i).div(i)}else if(D(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=n.getIntegralFormula(e);return v.pow(t,l).div(v.ln(t))}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function $o(e,t){return D(t)?t.invert(r.root(e,10)):(console.error("Could not invert due to no input being a variable"),0)}function Mo(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.pow10(n).div(v.ln(10))}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Po(e,t,n){return D(t)?t.invert(r.ln(e).div(r.ln(bt(n)))):D(n)?n.invert(r.root(bt(t),e)):(console.error("Could not invert due to no input being a variable"),0)}function xo(e,t,n){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=t.getIntegralFormula(e);return v.pow(n,l).div(v.ln(n))}else if(D(n)){if(!n.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=n.getIntegralFormula(e),i=v.add(t,1);return v.pow(l,i).div(i)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Io(e,t,n){return D(t)?t.invert(r.root(e,r.recip(bt(n)))):D(n)?n.invert(r.ln(bt(t)).div(r.ln(e))):(console.error("Could not invert due to no input being a variable"),0)}function To(e,t,n){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const l=t.getIntegralFormula(e);return v.pow(l,v.recip(n).add(1)).times(n).div(v.add(n,1))}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Fo(e,t){return D(t)?t.invert(r.ln(e)):(console.error("Could not invert due to no input being a variable"),0)}function Eo(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.exp(n)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Do(e,t=2,n=r.fromComponents_noNormalize(1,0,1)){const l=r.minabs(t,1e308).toNumber();return r.tetrate(e,l,n)}function qo(e,t,n,l){return D(t)?t.invert(r.ssqrt(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ao(e,t=2,n=r.fromComponents_noNormalize(1,0,1)){const l=r.minabs(t,1e308).toNumber();return r.iteratedexp(e,l,new r(n))}function Lo(e,t,n,l){return D(t)?t.invert(r.iteratedlog(e,Math.E,r.minabs(1e308,bt(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function Oo(e,t=10,n=2){const l=r.minabs(n,1e308).toNumber();return r.iteratedlog(e,t,l)}function jo(e,t=10){const n=r.minabs(t,1e308).toNumber();return r.slog(e,n)}function Ro(e,t,n){return D(t)?t.invert(r.tetrate(e,r.minabs(1e308,bt(n)).toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function Bo(e,t,n){const l=r.minabs(t,1e308).toNumber();return r.layeradd(e,l,n)}function Vo(e,t,n,l){return D(t)?t.invert(r.layeradd(e,r.minabs(1e308,bt(n)).negate().toNumber())):(console.error("Could not invert due to no input being a variable"),0)}function Go(e,t){return D(t)?t.invert(r.pow(Math.E,e).times(e)):(console.error("Could not invert due to no input being a variable"),0)}function zo(e,t){return D(t)?t.invert(r.tetrate(e,2)):(console.error("Could not invert due to no input being a variable"),0)}function Uo(e,t,n){const l=r.minabs(t,1e308).toNumber();return r.pentate(e,l,n)}function Xo(e,t){return D(t)?t.invert(r.asin(e)):(console.error("Could not invert due to no input being a variable"),0)}function Ho(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.cos(n).neg()}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Jo(e,t){return D(t)?t.invert(r.acos(e)):(console.error("Could not invert due to no input being a variable"),0)}function Wo(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.sin(n)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Zo(e,t){return D(t)?t.invert(r.atan(e)):(console.error("Could not invert due to no input being a variable"),0)}function Qo(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.cos(n).ln().neg()}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function Ko(e,t){return D(t)?t.invert(r.sin(e)):(console.error("Could not invert due to no input being a variable"),0)}function Yo(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.asin(n).times(n).add(v.sqrt(v.sub(1,v.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function eu(e,t){return D(t)?t.invert(r.cos(e)):(console.error("Could not invert due to no input being a variable"),0)}function tu(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.acos(n).times(n).sub(v.sqrt(v.sub(1,v.pow(n,2))))}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function nu(e,t){return D(t)?t.invert(r.tan(e)):(console.error("Could not invert due to no input being a variable"),0)}function iu(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.atan(n).times(n).sub(v.ln(v.pow(n,2).add(1)).div(2))}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function lu(e,t){return D(t)?t.invert(r.asinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function ru(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.cosh(n)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function au(e,t){return D(t)?t.invert(r.acosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function su(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.sinh(n)}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function ou(e,t){return D(t)?t.invert(r.atanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function uu(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.cosh(n).ln()}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function cu(e,t){return D(t)?t.invert(r.sinh(e)):(console.error("Could not invert due to no input being a variable"),0)}function du(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.asinh(n).times(n).sub(v.pow(n,2).add(1).sqrt())}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function mu(e,t){return D(t)?t.invert(r.cosh(e)):(console.error("Could not invert due to no input being a variable"),0)}function pu(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.acosh(n).times(n).sub(v.add(n,1).sqrt().times(v.sub(n,1).sqrt()))}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function fu(e,t){return D(t)?t.invert(r.tanh(e)):(console.error("Could not invert due to no input being a variable"),0)}function vu(e,t){if(D(t)){if(!t.isIntegrable())return console.error("Could not integrate due to variable not being integrable"),v.constant(0);const n=t.getIntegralFormula(e);return v.atanh(n).times(n).add(v.sub(1,v.pow(n,2)).ln().div(2))}return console.error("Could not integrate due to no input being a variable"),v.constant(0)}function wi(e){return(t,n)=>new v({inputs:[t,n],evaluate:e,invert:Ui})}function D(e){return e instanceof vt&&e.hasVariable()}function bt(e,t){return e instanceof vt?e.evaluate(t):o(e)}function gu(){return v.pow(this,2).div(2)}function hu(){return this}const _t=class{constructor(e){this.negate=this.neg,this.negated=this.neg,this.sgn=this.sign,this.plus=this.add,this.subtract=this.sub,this.minus=this.sub,this.multiply=this.mul,this.times=this.mul,this.divide=this.div,this.divideBy=this.div,this.dividedBy=this.div,this.reciprocal=this.recip,this.reciprocate=this.recip,this.logarithm=this.log;let t;"inputs"in e&&(e.inputs=e.inputs.map(n=>typeof n=="object"&&_n in n?n[_n]:n)),"variable"in e?(typeof e.variable=="object"&&_n in e.variable&&(e.variable=e.variable[_n]),t=this.setupVariable(e)):"evaluate"in e?t=this.setupFormula(e):t=this.setupConstant(e),this.inputs=t.inputs,this.internalVariables=t.internalVariables,this.innermostVariable=t.innermostVariable,this.internalEvaluate=t.internalEvaluate,this.internalInvert=t.internalInvert,this.internalIntegrate=t.internalIntegrate,this.internalIntegrateInner=t.internalIntegrateInner,this.applySubstitution=t.applySubstitution}setupVariable({variable:e}){return{inputs:[e],internalVariables:1,innermostVariable:e,internalIntegrate:gu,internalIntegrateInner:hu,applySubstitution:Ui}}setupConstant({inputs:e}){return e.length!==1&&console.error("Evaluate function is required if inputs is not length 1"),{inputs:e,internalVariables:0}}setupFormula(e){var w,_;const{inputs:t,evaluate:n,invert:l,integrate:i,integrateInner:a,applySubstitution:u}=e,c=t.reduce((y,k)=>y+(k instanceof _t?k.internalVariables:0),0),d=t.find(y=>y instanceof _t&&y.hasVariable()),m=c===1?d==null?void 0:d.innermostVariable:void 0,g=(w=d==null?void 0:d.isInvertible())!=null?w:!1,p=(_=d==null?void 0:d.isIntegrable())!=null?_:!1;return{inputs:t,internalEvaluate:n,internalInvert:g?l:void 0,internalIntegrate:p?i:void 0,internalIntegrateInner:a,applySubstitution:u,innermostVariable:m,internalVariables:c}}isInvertible(){return this.hasVariable()&&(this.internalInvert!=null||this.internalEvaluate==null)}isIntegrable(){return this.hasVariable()&&this.internalIntegrate!=null}isIntegralInvertible(){return this.isIntegrable()?this.getIntegralFormula().isInvertible():!1}hasVariable(){return this.internalVariables===1}evaluate(e){var t,n,l;return(l=(n=(t=this.internalEvaluate)==null?void 0:t.call(this,...this.inputs.map(i=>bt(i,e))))!=null?n:this.hasVariable()?e:null)!=null?l:bt(this.inputs[0])}equals(e){return this.inputs.length===e.inputs.length&&this.inputs.every((t,n)=>t instanceof _t&&e.inputs[n]instanceof _t?t.equals(e.inputs[n]):!(t instanceof _t)&&!(e.inputs[n]instanceof _t)&&r.eq(o(t),o(e.inputs[n])))&&this.internalEvaluate===e.internalEvaluate&&this.internalInvert===e.internalInvert&&this.internalIntegrate===e.internalIntegrate&&this.internalVariables===e.internalVariables}static constant(e){return new v({inputs:[e]})}static variable(e){return new v({variable:e})}static step(e,t,n){const l=n(v.variable(0)),i=Ue(t);function a(c){return r.lt(c,o(i))?c:r.add(l.evaluate(r.sub(c,o(i))),o(i))}function u(c,d){return D(d)&&l.isInvertible()?(r.gt(c,o(i))&&(c=r.add(l.invert(r.sub(c,o(i))),o(i))),d.invert(c)):(console.error("Could not invert due to no input being a variable"),0)}return new v({inputs:[e],evaluate:a,invert:l.isInvertible()&&l.hasVariable()?u:void 0})}static if(e,t,n,l){const i=J(0),a=v.variable(i),u=n(a),c=l==null?void 0:l(a),d=Ue(t);function m(p){return o(d)?(i.value=p,u.evaluate()):c?(i.value=p,c.evaluate()):p}function g(p,w){return!D(w)||!u.isInvertible()||c!=null&&!c.isInvertible()?(console.error("Could not invert due to no input being a variable"),0):o(d)?w.invert(u.invert(p)):c?w.invert(c.invert(p)):w.invert(p)}return new v({inputs:[e],evaluate:m,invert:u.isInvertible()&&u.hasVariable()?g:void 0})}static conditional(e,t,n,l){return v.if(e,t,n,l)}static abs(e){return new v({inputs:[e],evaluate:r.abs})}static neg(e){return new v({inputs:[e],evaluate:r.neg,invert:zs,applySubstitution:Xs,integrate:Us})}static sign(e){return new v({inputs:[e],evaluate:r.sign})}static round(e){return new v({inputs:[e],evaluate:r.round,invert:Ci})}static floor(e){return new v({inputs:[e],evaluate:r.floor,invert:Ci})}static ceil(e){return new v({inputs:[e],evaluate:r.ceil,invert:Ci})}static trunc(e){return new v({inputs:[e],evaluate:r.trunc,invert:Ci})}static add(e,t){return new v({inputs:[e,t],evaluate:r.add,invert:Hs,integrate:Js,integrateInner:Ws,applySubstitution:Ui})}static sub(e,t){return new v({inputs:[e,t],evaluate:r.sub,invert:Zs,integrate:Qs,integrateInner:Ks,applySubstitution:Ui})}static mul(e,t){return new v({inputs:[e,t],evaluate:r.mul,invert:Ys,integrate:eo,applySubstitution:to})}static div(e,t){return new v({inputs:[e,t],evaluate:r.div,invert:no,integrate:io,applySubstitution:lo})}static recip(e){return new v({inputs:[e],evaluate:r.recip,invert:ro,integrate:ao})}static clamp(e,t,n){return new v({inputs:[e,t,n],evaluate:r.clamp,invert:Ci})}static pLog10(e){return new v({inputs:[e],evaluate:r.pLog10})}static absLog10(e){return new v({inputs:[e],evaluate:r.absLog10})}static log10(e){return new v({inputs:[e],evaluate:r.log10,invert:so,integrate:co})}static log(e,t){return new v({inputs:[e,t],evaluate:r.log,invert:mo,integrate:vo})}static log2(e){return new v({inputs:[e],evaluate:r.log2,invert:go,integrate:yo})}static ln(e){return new v({inputs:[e],evaluate:r.ln,invert:wo,integrate:So})}static pow(e,t){return new v({inputs:[e,t],evaluate:r.pow,invert:ko,integrate:No})}static pow10(e){return new v({inputs:[e],evaluate:r.pow10,invert:$o,integrate:Mo})}static pow_base(e,t){return new v({inputs:[e,t],evaluate:r.pow_base,invert:Po,integrate:xo})}static root(e,t){return new v({inputs:[e,t],evaluate:r.root,invert:Io,integrate:To})}static factorial(e){return new v({inputs:[e],evaluate:r.factorial})}static gamma(e){return new v({inputs:[e],evaluate:r.gamma})}static lngamma(e){return new v({inputs:[e],evaluate:r.lngamma})}static exp(e){return new v({inputs:[e],evaluate:r.exp,invert:Fo,integrate:Eo})}static sqr(e){return v.pow(e,2)}static sqrt(e){return v.root(e,2)}static cube(e){return v.pow(e,3)}static cbrt(e){return v.root(e,3)}static tetrate(e,t=2,n=r.fromComponents_noNormalize(1,0,1)){return new v({inputs:[e,t,n],evaluate:Do,invert:qo})}static iteratedexp(e,t=2,n=r.fromComponents_noNormalize(1,0,1)){return new v({inputs:[e,t,n],evaluate:Ao,invert:Lo})}static iteratedlog(e,t=10,n=1){return new v({inputs:[e,t,n],evaluate:Oo})}static slog(e,t=10){return new v({inputs:[e,t],evaluate:jo,invert:Ro})}static layeradd10(e,t){return new v({inputs:[e,t],evaluate:r.layeradd10})}static layeradd(e,t,n=10){return new v({inputs:[e,t,n],evaluate:Bo,invert:Vo})}static lambertw(e){return new v({inputs:[e],evaluate:r.lambertw,invert:Go})}static ssqrt(e){return new v({inputs:[e],evaluate:r.ssqrt,invert:zo})}static pentate(e,t=2,n=r.fromComponents_noNormalize(1,0,1)){return new v({inputs:[e,t,n],evaluate:Uo})}static sin(e){return new v({inputs:[e],evaluate:r.sin,invert:Ko,integrate:Ho})}static cos(e){return new v({inputs:[e],evaluate:r.cos,invert:eu,integrate:Wo})}static tan(e){return new v({inputs:[e],evaluate:r.tan,invert:nu,integrate:Qo})}static asin(e){return new v({inputs:[e],evaluate:r.asin,invert:Xo,integrate:Yo})}static acos(e){return new v({inputs:[e],evaluate:r.acos,invert:Jo,integrate:tu})}static atan(e){return new v({inputs:[e],evaluate:r.atan,invert:Zo,integrate:iu})}static sinh(e){return new v({inputs:[e],evaluate:r.sinh,invert:cu,integrate:ru})}static cosh(e){return new v({inputs:[e],evaluate:r.cosh,invert:mu,integrate:su})}static tanh(e){return new v({inputs:[e],evaluate:r.tanh,invert:fu,integrate:uu})}static asinh(e){return new v({inputs:[e],evaluate:r.asinh,invert:lu,integrate:du})}static acosh(e){return new v({inputs:[e],evaluate:r.acosh,invert:au,integrate:pu})}static atanh(e){return new v({inputs:[e],evaluate:r.atanh,invert:ou,integrate:vu})}step(e,t){return v.step(this,e,t)}if(e,t){return v.if(this,e,t)}conditional(e,t){return v.if(this,e,t)}abs(){return v.abs(this)}neg(){return v.neg(this)}sign(){return v.sign(this)}round(){return v.round(this)}floor(){return v.floor(this)}ceil(){return v.ceil(this)}trunc(){return v.trunc(this)}add(e){return v.add(this,e)}sub(e){return v.sub(this,e)}mul(e){return v.mul(this,e)}div(e){return v.div(this,e)}recip(){return v.recip(this)}max(e){return v.max(this,e)}min(e){return v.min(this,e)}maxabs(e){return v.maxabs(this,e)}minabs(e){return v.minabs(this,e)}clamp(e,t){return v.clamp(this,e,t)}clampMin(e){return v.clampMin(this,e)}clampMax(e){return v.clampMax(this,e)}pLog10(){return v.pLog10(this)}absLog10(){return v.absLog10(this)}log10(){return v.log10(this)}log(e){return v.log(this,e)}log2(){return v.log2(this)}ln(){return v.ln(this)}pow(e){return v.pow(this,e)}pow10(){return v.pow10(this)}pow_base(e){return v.pow_base(this,e)}root(e){return v.root(this,e)}factorial(){return v.factorial(this)}gamma(){return v.gamma(this)}lngamma(){return v.lngamma(this)}exp(){return v.exp(this)}sqr(){return v.pow(this,2)}sqrt(){return v.root(this,2)}cube(){return v.pow(this,3)}cbrt(){return v.root(this,3)}tetrate(e=2,t=r.fromComponents_noNormalize(1,0,1)){return v.tetrate(this,e,t)}iteratedexp(e=2,t=r.fromComponents_noNormalize(1,0,1)){return v.iteratedexp(this,e,t)}iteratedlog(e=10,t=1){return v.iteratedlog(this,e,t)}slog(e=10){return v.slog(this,e)}layeradd10(e){return v.layeradd10(this,e)}layeradd(e,t){return v.layeradd(this,e,t)}lambertw(){return v.lambertw(this)}ssqrt(){return v.ssqrt(this)}pentate(e=2,t=r.fromComponents_noNormalize(1,0,1)){return v.pentate(this,e,t)}sin(){return v.sin(this)}cos(){return v.cos(this)}tan(){return v.tan(this)}asin(){return v.asin(this)}acos(){return v.acos(this)}atan(){return v.atan(this)}sinh(){return v.sinh(this)}cosh(){return v.cosh(this)}tanh(){return v.tanh(this)}asinh(){return v.asinh(this)}acosh(){return v.acosh(this)}atanh(){return v.atanh(this)}};let vt=_t;vt.negate=_t.neg;vt.negated=_t.neg;vt.sgn=_t.sign;vt.plus=_t.add;vt.subtract=_t.sub;vt.minus=_t.sub;vt.multiply=_t.mul;vt.times=_t.mul;vt.divide=_t.div;vt.divideBy=_t.div;vt.dividedBy=_t.div;vt.reciprocal=_t.recip;vt.reciprocate=_t.recip;vt.max=wi(r.max);vt.min=wi(r.min);vt.minabs=wi(r.minabs);vt.maxabs=wi(r.maxabs);vt.clampMin=wi(r.clampMin);vt.clampMax=wi(r.clampMax);vt.logarithm=_t.log;class v extends vt{invert(t){return this.internalInvert&&this.hasVariable()?this.internalInvert.call(this,t,...this.inputs):this.inputs.length===1&&this.hasVariable()?t:(console.error("Cannot invert non-invertible formula"),0)}evaluateIntegral(t){return this.isIntegrable()?this.getIntegralFormula().evaluate(t):(console.error("Cannot evaluate integral of formula without integral"),0)}invertIntegral(t){return!this.isIntegrable()||!this.getIntegralFormula().isInvertible()?(console.error("Cannot invert integral of formula without invertible integral"),0):this.getIntegralFormula().invert(t)}calculateConstantOfIntegration(){const t=this.getIntegralFormula().evaluate(1),n=r.add(this.evaluate(0),this.evaluate(1)).div(2);return r.sub(n,t)}getIntegralFormula(t){if(this.integralFormula!=null&&t==null)return this.integralFormula;if(t==null){if(this.applySubstitution==null){if(t=[],this.internalIntegrate==null)return console.error("Cannot integrate formula with non-integrable operation"),v.constant(0);let n=this.internalIntegrate.call(this,t,...this.inputs);t.forEach(l=>n=l(n)),this.integralFormula=n}else if(this.internalIntegrate)this.integralFormula=this.internalIntegrate.call(this,void 0,...this.inputs);else if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())this.integralFormula=this;else return console.error("Cannot integrate formula without variable"),v.constant(0);return this.integralFormula}else return this.applySubstitution==null?(console.error("Cannot have two complex operations in an integrable formula"),v.constant(0)):(t.push(n=>this.applySubstitution.call(this,n,...this.inputs)),this.internalIntegrateInner?this.internalIntegrateInner.call(this,t,...this.inputs):this.internalIntegrate?this.internalIntegrate.call(this,t,...this.inputs):this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable()?this:(console.error("Cannot integrate formula without variable"),v.constant(0)))}}function bu(e,t,n=!0,l,i=r.dInf){const a=Ue(n),u=Ue(l),c=Ue(i);return S(()=>{var w,_,y,k;const d=o(c);if(r.eq(d,1))return r.gte(t.value,e.evaluate())?r.dOne:r.dZero;const m=o(a),g=(w=o(u))!=null?w:m?10:0;let p=0;if(r.gt(d,g)){if(!e.isInvertible())return console.error("Cannot calculate max affordable of non-invertible formula with more maxBulkAmount than directSum"),0;if(m){if(!e.isIntegralInvertible())return console.error("Cannot calculate max affordable of formula with non-invertible integral"),0;p=r.floor(e.invertIntegral(r.add(t.value,e.evaluateIntegral()))).sub((_=o(e.innermostVariable))!=null?_:0)}else p=r.floor(e.invert(t.value))}if(p=r.clampMax(p,d),g>0){const B=p;p=r.sub(p,g).clampMin(0);let V;for(m?V=Xi(e,p,!0,0):V=e.evaluate(r.add((y=o(e.innermostVariable))!=null?y:0,p));r.lt(p,d)&&r.lt(p,Number.MAX_SAFE_INTEGER)&&r.add(B,1).gte(p);){const P=e.evaluate(p.add((k=o(e.innermostVariable))!=null?k:0));if(r.add(V,P).lte(t.value))p=p.add(1),V=r.add(V,P);else break}}return p})}function Xi(e,t,n=!0,l){var d;if(r.eq(t,1))return e.evaluate();const i=(d=o(e.innermostVariable))!=null?d:0;let a=r.add(t,i);const u=a;l!=null||(l=n?10:0),a=a.sub(l).clampMin(i);let c=0;if(r.gt(t,l)){if(!e.isInvertible())return console.error("Cannot calculate cost with indirect sum of non-invertible formula"),0;if(n){if(!e.isIntegrable())return console.error("Cannot calculate cost with cumulative cost of non-integrable formula"),0;if(c=r.sub(e.evaluateIntegral(a),e.evaluateIntegral()),u.gt(1e308))return r.add(c,r.sub(u,a).times(e.evaluate(a)))}else if(c=e.evaluate(a),a=a.add(1),u.gt(1e308))return r.sub(u,a).add(1).times(c)}for(let m=a.toNumber();m<u.toNumber();m++)c=r.add(c,e.evaluate(m));return c}const Vn=Symbol("PersistentState"),gi=Symbol("DefaultValue"),Zi=Symbol("StackTrace"),wl=Symbol("Deleted"),_n=Symbol("NonPersistent"),ei=Symbol("SaveDataPath"),_l=Symbol("SkipPersistence");function yu(){var e,t;return(t=(e=new Error().stack)==null?void 0:e.split(`
`).slice(3,5).map(n=>n.trim()).join(`
`))!=null?t:""}function Yl(e,t){var n;r.isNaN(t)&&(ht.hasNaN||(U.autosave=!1,ht.hasNaN=!0,ht.NaNPath=e[ei],ht.NaNPersistent=e),console.error(`Attempted to save NaN value to ${(n=e[ei])==null?void 0:n.join(".")}`)),e[Vn].value=t}function W(e,t=!0){const n=At(e)?e:J(e);At(e)&&(e=e.value);const l=S({get(){return n.value},set(a){t?Yl(i,a):i[Vn].value=a}});l[gi]=e;const i={get value(){return n.value},set value(a){t?Yl(i,a):i[Vn].value=a},__v_isRef:!0,[Vn]:n,[gi]:e,[Zi]:yu(),[wl]:!1,[_n]:l,[ei]:void 0};return vn.length===0?console.warn("Creating a persistent ref outside of a layer. This is not officially supported",i,`
Created at:
`+i[Zi]):vi[vn[vn.length-1]].add(i),i}function wu(e){return e!=null&&typeof e=="object"&&Vn in e}function Ut(e){return!(Rn in e)&&_n in e?e[_n]:new Proxy(e,{get(t,n){if(n!==Vn)return n===_l?!0:t[n]},set(t,n,l){return t[n]=l,!0},has(t,n){return n===Vn?!1:n==_l?!0:Reflect.has(t,n)}})}zt.on("addLayer",(e,t)=>{const n=[],l=(i,a=[])=>{let u=!1;return Object.keys(i).forEach(c=>{let d=i[c];if(d!=null&&typeof d=="object"){if(d[_l]===!0)return;if(Rn in d&&(d=d[Rn]),wu(d)){if(u=!0,d[wl]){console.warn("Deleted persistent ref present in returned object. Ignoring...",d,`
Created at:
`+d[Zi]);return}vi[e.id].delete(d);const m=[e.id,...a,c];d[ei]!=null&&JSON.stringify(m)!==JSON.stringify(d[ei])&&console.error(`Persistent ref is being saved to \`${m.join(".")}\` when it's already present at \`${d[ei].join(".")}\`.`,"This can cause unexpected behavior when loading saves between updates."),d[ei]=m;const g=a.reduce((w,_)=>(_ in w||(w[_]={}),w[_]),t),p=g[c];g[c]=d[Vn],Jr(g)?p!=null?g[c]=p:g[c]=d[gi]:p!=null?g[c].value=p:g[c].value=d[gi]}else!(d instanceof r)&&!(d instanceof v)&&!At(d)&&!n.includes(d)&&(typeof d.type=="symbol"&&n.push(d),l(d,[...a,c])&&(Cn(d)&&!Cn(i)?console.warn("Found array that contains persistent values when adding layer. Keep in mind changing the order of elements in the array will mess with existing player saves.",Rn in i?i[Rn]:i,c):u=!0))}}),u};l(e[Rn]),vi[e.id].forEach(i=>{i[wl]||console.error(`Created persistent ref in ${e.id} without registering it to the layer!`,`Make sure to include everything persistent in the returned object.

Created at:
`+i[Zi])}),vi[e.id].clear()});const Fl=Symbol("RegisterNode"),El=Symbol("UnregisterNode"),Dl=Symbol("Nodes"),ql=Symbol("Bounds"),Xt=kl({});window.layers=Xt;const vi={},vn=[];function qn(e,t){return ct(()=>{const n={},l=n.emitter=vr();if(n.on=l.on.bind(l),n.emit=l.emit.bind(l),n.nodes=J({}),n.id=e,vn.push(e),vi[e]=new Set,n.minimized=W(!1,!1),Object.assign(n,t.call(n,n)),vn[vn.length-1]==null||vn[vn.length-1]!==e)throw new Error(`Adding layers stack in invalid state. This should not happen
Stack: ${vn}
Trying to pop ${n.id}`);vn.pop(),E(n,"color"),E(n,"display"),E(n,"classes"),E(n,"style"),E(n,"name"),Ye(n,"name",n.id),E(n,"minWidth"),Ye(n,"minWidth",600),E(n,"minimizable"),Ye(n,"minimizable",!0),E(n,"minimizedDisplay");const i=n.style;return n.style=S(()=>{var u,c;let a=o(n.minWidth);return(typeof a=="number"||!Number.isNaN(parseInt(a)))&&(a=a+"px"),[(u=o(i))!=null?u:"",(c=n.minimized)!=null&&c.value?{flexGrow:"0",flexShrink:"0",width:"60px",minWidth:"",flexBasis:"",margin:"0"}:{flexGrow:"",flexShrink:"",width:"",minWidth:a,flexBasis:a,margin:""}]}),n})}function Sn(e,t){if(console.info("Adding layer",e.id),Xt[e.id]){console.error("Attempted to add layer with same ID as existing layer",e.id,Xt[e.id]);return}Ye(t,"layers",{}),t.layers[e.id]==null&&(t.layers[e.id]={}),Xt[e.id]=e,zt.emit("addLayer",e,t.layers[e.id])}function _u(e){return Xt[e]}function Ir(e){console.info("Removing layer",e.id),zt.emit("removeLayer",e),Xt[e.id]=void 0}function Cu(e){Ir(e),Sn(e,U)}function Su(e){const t=J(!1);return{openModal:()=>t.value=!0,modal:$(()=>s(Un,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},{header:()=>s("h2",null,[o(e.name)]),body:o(e.display)}))}}zt.on("update",function(t){Object.values(Xt).forEach(n=>{n==null||n.emit("preUpdate",t)}),Object.values(Xt).forEach(n=>{n==null||n.emit("update",t)}),Object.values(Xt).forEach(n=>{n==null||n.emit("postUpdate",t)})});var ku=Object.freeze(Object.defineProperty({__proto__:null,RegisterNodeInjectionKey:Fl,UnregisterNodeInjectionKey:El,NodesInjectionKey:Dl,BoundsInjectionKey:ql,layers:Xt,persistentRefs:vi,addingLayers:vn,createLayer:qn,addLayer:Sn,getLayer:_u,removeLayer:Ir,reloadLayer:Cu,setupLayerModal:Su},Symbol.toStringTag,{value:"Module"}));const Nu=K({components:{Context:Pr,ErrorVue:hr},props:{index:{type:Number,required:!0},display:{type:j(Object,String,Function),required:!0},minimizedDisplay:j(Object,String,Function),minimized:{type:Object,required:!0},name:{type:j(String),required:!0},color:j(String),minimizable:j(Boolean),nodes:{type:Object,required:!0}},emits:["setMinimized"],setup(e){const{display:t,index:n,minimized:l,minimizedDisplay:i}=st(e),a=ni(t),u=Dn(i),c=S(()=>Be.allowGoBack&&n.value>0&&!rt(l));function d(){U.tabs.splice(o(e.index),1/0)}function m(p){e.nodes.value=p}const g=J([]);return Wr((p,w,_)=>(console.warn(`Error caught in "${e.name}" layer`,p,w,_),g.value.push(p instanceof Error?p:new Error(JSON.stringify(p))),!1)),{component:a,minimizedComponent:u,showGoBack:c,updateNodes:m,unref:o,goBack:d,errors:g}}}),$u={key:1};function Mu(e,t,n,l,i,a){const u=Et("ErrorVue"),c=Et("Context");return e.errors.length>0?(b(),H(u,{key:0,errors:e.errors},null,8,["errors"])):(b(),N("div",Ht({key:1,class:"layer-container",style:{"--layer-color":e.unref(e.color)}},e.$attrs),[e.showGoBack?(b(),N("button",{key:0,class:"goBack",onClick:t[0]||(t[0]=(...d)=>e.goBack&&e.goBack(...d))},"\u274C")):R("",!0),e.unref(e.minimized)?(b(),N("button",{key:1,class:"layer-tab minimized",onClick:t[1]||(t[1]=d=>e.$emit("setMinimized",!1))},[e.minimizedComponent?(b(),H(xe(e.minimizedComponent),{key:0})):(b(),N("div",$u,Z(e.unref(e.name)),1))])):(b(),N("div",{key:2,class:Pe(["layer-tab",{showGoBack:e.showGoBack}])},[s(c,{onUpdateNodes:e.updateNodes},{default:oe(()=>[(b(),H(xe(e.component)))]),_:1},8,["onUpdateNodes"])],2)),e.unref(e.minimizable)?(b(),N("button",{key:3,class:"minimize",onClick:t[2]||(t[2]=d=>e.$emit("setMinimized",!0))}," \u25BC ")):R("",!0)],16))}var Pu=me(Nu,[["render",Mu],["__scopeId","data-v-a9f5b1da"]]);const Tr=e=>(en("data-v-4b4bda40"),e=e(),tn(),e),xu=Tr(()=>h("h2",null,"Changelog",-1)),Iu=Tr(()=>h("details",{open:""},[h("summary",null,[f("v0.0 Initial Commit - "),h("time",null,"2021-09-04")]),f(" This is the first release :D "),h("ul",null,[h("li",{class:"feature"},"Did everything"),h("li",{class:"fix"},"Had some fun"),h("li",{class:"breaking"},"Removed everything"),h("li",{class:"balancing"},"Created some bugs to fix later")])],-1)),Tu=K({__name:"Changelog",setup(e,{expose:t}){const n=J(!1);return t({open(){n.value=!0}}),(l,i)=>(b(),H(Un,{modelValue:n.value,"onUpdate:modelValue":i[0]||(i[0]=a=>n.value=a)},{header:oe(()=>[xu]),body:oe(()=>[Iu]),_:1},8,["modelValue"]))}});var Fu=me(Tu,[["__scopeId","data-v-4b4bda40"]]),Eu=K({props:{element:Object,display:{type:j(Object,String,Function),required:!0},style:j(Object,String,Array),classes:j(Object),direction:j(String),xoffset:j(String),yoffset:j(String),pinned:Object},setup(e){const{element:t,display:n,pinned:l}=st(e),i=J(!1),a=S(()=>(rt(l)||i.value)&&u.value),u=Dn(n),c=$t(ve($(()=>{const g=rt(t);return g==null?"":at(g)})));function d(g){const p=l;g.shiftKey&&p&&(p.value=!p.value,g.stopPropagation(),g.preventDefault())}const m=S(()=>rt(l)&&yi[qe.theme].showPin);return{Direction:Me,isHovered:i,isShown:a,comp:u,elementComp:c,unref:o,togglePinned:d,showPin:m}}});const Du={key:0,class:"material-icons pinned"};function qu(e,t,n,l,i,a){return b(),N("div",{class:Pe(["tooltip-container",{shown:e.isShown,...e.unref(e.classes)}]),onMouseenter:t[0]||(t[0]=u=>e.isHovered=!0),onMouseleave:t[1]||(t[1]=u=>e.isHovered=!1),onClickCapture:t[2]||(t[2]=(...u)=>e.togglePinned&&e.togglePinned(...u))},[Kt(e.$slots,"default",{},void 0,!0),e.elementComp?(b(),H(xe(e.elementComp),{key:0})):R("",!0),s($l,{name:"fade"},{default:oe(()=>{var u;return[e.isShown?(b(),N("div",{key:0,class:Pe(["tooltip",{top:e.unref(e.direction)===e.Direction.Up,left:e.unref(e.direction)===e.Direction.Left,right:e.unref(e.direction)===e.Direction.Right,bottom:e.unref(e.direction)===e.Direction.Down,...e.unref(e.classes)}]),style:Se([{"--xoffset":e.unref(e.xoffset)||"0px","--yoffset":e.unref(e.yoffset)||"0px"},(u=e.unref(e.style))!=null?u:{}])},[e.showPin?(b(),N("span",Du,"push_pin")):R("",!0),e.comp?(b(),H(xe(e.comp),{key:1})):R("",!0)],6)):R("",!0)]}),_:1})],34)}var it=me(Eu,[["render",qu],["__scopeId","data-v-be7a60de"]]);const ai=e=>(en("data-v-10effbe8"),e=e(),tn(),e),Au={class:"info-modal-header"},Lu=["src","alt"],Ou={class:"info-modal-title"},ju={key:0},Ru={key:0},Bu={key:0},Vu=ai(()=>h("div",null," Made in Profectus, by thepaperpilot with inspiration from Acameada and Jacorb ",-1)),Gu=ai(()=>h("br",null,null,-1)),zu=ai(()=>h("br",null,null,-1)),Uu=["href"],Xu=ai(()=>h("span",{class:"material-icons info-modal-discord"},"discord",-1)),Hu=ai(()=>h("div",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",class:"info-modal-discord-link",target:"_blank"},[h("span",{class:"material-icons info-modal-discord"},"discord"),f(" Profectus & Friends ")])],-1)),Ju=ai(()=>h("div",null,[h("a",{href:"https://discord.gg/F3xveHV",class:"info-modal-discord-link",target:"_blank"},[h("span",{class:"material-icons info-modal-discord"},"discord"),f(" The Modding Tree ")])],-1)),Wu=ai(()=>h("br",null,null,-1));var Zu=K({__name:"Info",props:{changelog:null},setup(e,{expose:t}){const n=e,{title:l,logo:i,author:a,discordName:u,discordLink:c,versionNumber:d,versionTitle:m}=Be,g=st(n),p=J(!1),w=S(()=>zn(U.timePlayed)),_=S(()=>ve($(()=>s(T,null,[Ts.map(We)]))));t({open(){p.value=!0}});function y(){var k;(k=o(g.changelog))==null||k.open()}return(k,B)=>(b(),H(Un,{modelValue:p.value,"onUpdate:modelValue":B[0]||(B[0]=V=>p.value=V)},{header:oe(()=>[h("div",Au,[o(i)?(b(),N("img",{key:0,class:"info-modal-logo",src:o(i),alt:o(l)},null,8,Lu)):R("",!0),h("div",Ou,[h("h2",null,Z(o(l)),1),h("h4",null,[f(" v"+Z(o(d)),1),o(m)?(b(),N("span",ju,": "+Z(o(m)),1)):R("",!0)])])])]),body:oe(({shown:V})=>[V?(b(),N("div",Ru,[o(a)?(b(),N("div",Bu,"By "+Z(o(a)),1)):R("",!0),Vu,Gu,h("div",{class:"link",onClick:y},"Changelog"),zu,h("div",null,[o(c)?(b(),N("a",{key:0,href:o(c),class:"info-modal-discord-link",target:"_blank"},[Xu,f(" "+Z(o(u)),1)],8,Uu)):R("",!0)]),Hu,Ju,Wu,h("div",null,"Time Played: "+Z(o(w)),1),(b(),H(xe(o(_))))])):R("",!0)]),_:1},8,["modelValue"]))}});var Qu=me(Zu,[["__scopeId","data-v-10effbe8"]]);const Ku={class:"field"},Yu={key:0,class:"field-title"},Al=K({__name:"Select",props:{title:null,modelValue:null,options:null,placeholder:null,closeOnSelect:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){var u;const n=e,l=Dn(Yt(n,"title"),"span"),i=J((u=n.options.find(c=>c.value===n.modelValue))!=null?u:null);et(Yt(n,"modelValue"),c=>{var d;rt(i)!==c&&(i.value=(d=n.options.find(m=>m.value===c))!=null?d:null)});function a(c){t("update:modelValue",c.value)}return(c,d)=>(b(),N("div",Ku,[o(l)?(b(),N("span",Yu,[(b(),H(xe(o(l))))])):R("",!0),s(o(ta),{options:e.options,modelValue:i.value,"onUpdate:modelValue":[d[0]||(d[0]=m=>i.value=m),a],min:1,"label-by":"label",placeholder:e.placeholder,"close-on-select":e.closeOnSelect},null,8,["options","modelValue","placeholder","close-on-select"])]))}});const ec={class:"field"},tc=K({__name:"Toggle",props:{title:null,modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,l=S(()=>{var a;return ve((a=o(n.title))!=null?a:"<span></span>","span")}),i=S({get(){return!!n.modelValue},set(a){t("update:modelValue",a)}});return(a,u)=>(b(),N("label",ec,[mn(h("input",{type:"checkbox",class:"toggle","onUpdate:modelValue":u[0]||(u[0]=c=>At(i)?i.value=c:null)},null,512),[[Zr,o(i)]]),(b(),H(xe(o(l))))]))}});var $n=me(tc,[["__scopeId","data-v-11046116"]]);const nc={class:"header"},ic=h("h2",null,"Settings",-1),lc={class:"option-tabs"},rc={key:0},ac={key:1};var sc=K({__name:"Options",setup(e,{expose:t}){const n=J(!1),l=J("behaviour");function i(se){return se==l.value}function a(se){l.value=se}t({isTab:i,setTab:a,save:sn,open(){n.value=!0}});const u=Object.keys(yi).map(se=>({label:cn(se),value:se})),c=S(()=>ve($(()=>s(T,null,[Nr.map(We)])))),{showTPS:d,theme:m,unthrottled:g,alignUnits:p}=st(qe),{autosave:w,offlineProd:_}=st(U),y=S({get(){return U.devSpeed===0},set(se){U.devSpeed=se?0:null}}),k=$(()=>s("span",{class:"option-title"},[f("Unthrottled"),s("desc",null,[f("Allow the game to run as fast as possible. Not battery friendly.")])])),B=$(()=>s("span",{class:"option-title"},[f("Offline Production"),s(it,{display:"Save-specific",direction:Me.Right},{default:()=>[f("*")]}),s("desc",null,[f("Simulate production that occurs while the game is closed.")])])),V=$(()=>s("span",{class:"option-title"},[f("Autosave"),s(it,{display:"Save-specific",direction:Me.Right},{default:()=>[f("*")]}),s("desc",null,[f("Automatically save the game every second or when the game is closed.")])])),P=$(()=>s("span",{class:"option-title"},[f("Pause game"),s(it,{display:"Save-specific",direction:Me.Right},{default:()=>[f("*")]}),s("desc",null,[f("Stop everything from moving.")])])),x=$(()=>s("span",{class:"option-title"},[f("Theme"),s("desc",null,[f("How the game looks.")])])),X=$(()=>s("span",{class:"option-title"},[f("Show TPS"),s("desc",null,[f("Show TPS meter at the bottom-left corner of the page.")])])),te=$(()=>s("span",{class:"option-title"},[f("Align modifier units"),s("desc",null,[f("Align numbers to the beginning of the unit in modifier view.")])]));return(se,G)=>(b(),H(Un,{modelValue:n.value,"onUpdate:modelValue":G[10]||(G[10]=Q=>n.value=Q)},{header:oe(()=>[h("div",nc,[ic,h("div",lc,[h("button",{class:Pe({selected:i("behaviour")}),onClick:G[0]||(G[0]=Q=>a("behaviour"))},"Behaviour",2),h("button",{class:Pe({selected:i("appearance")}),onClick:G[1]||(G[1]=Q=>a("appearance"))},"Appearance",2)])])]),body:oe(()=>[i("behaviour")?(b(),N("div",rc,[s($n,{title:o(k),modelValue:o(g),"onUpdate:modelValue":G[2]||(G[2]=Q=>At(g)?g.value=Q:null)},null,8,["title","modelValue"]),o(Be).enablePausing?(b(),H($n,{key:0,title:o(P),modelValue:o(y),"onUpdate:modelValue":G[3]||(G[3]=Q=>At(y)?y.value=Q:null)},null,8,["title","modelValue"])):R("",!0),s($n,{title:o(B),modelValue:o(_),"onUpdate:modelValue":G[4]||(G[4]=Q=>At(_)?_.value=Q:null)},null,8,["title","modelValue"]),s($n,{title:o(V),modelValue:o(w),"onUpdate:modelValue":G[5]||(G[5]=Q=>At(w)?w.value=Q:null)},null,8,["title","modelValue"]),o(w)?R("",!0):(b(),H(xl,{key:1,class:"button save-button",onClick:G[6]||(G[6]=Q=>o(sn)())},{default:oe(()=>[f("Manually save")]),_:1}))])):R("",!0),i("appearance")?(b(),N("div",ac,[s(Al,{title:o(x),options:o(u),modelValue:o(m),"onUpdate:modelValue":G[7]||(G[7]=Q=>At(m)?m.value=Q:null)},null,8,["title","options","modelValue"]),(b(),H(xe(o(c)))),s($n,{title:o(X),modelValue:o(d),"onUpdate:modelValue":G[8]||(G[8]=Q=>At(d)?d.value=Q:null)},null,8,["title","modelValue"]),s($n,{title:o(te),modelValue:o(p),"onUpdate:modelValue":G[9]||(G[9]=Q=>At(p)?p.value=Q:null)},null,8,["title","modelValue"])])):R("",!0)]),_:1},8,["modelValue"]))}});const oc=["onSubmit"],uc={class:"field"},cc={key:0,class:"field-title"},dc=["placeholder"],mc=K({__name:"Text",props:{title:null,modelValue:null,textArea:{type:Boolean},placeholder:null,maxHeight:null,submitOnBlur:{type:Boolean}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:t}){const n=e,l=Dn(Yt(n,"title"),"span"),i=$t(null);ii(()=>{var d;(d=i.value)==null||d.focus()});const a=S({get(){var d;return(d=o(n.modelValue))!=null?d:""},set(d){t("update:modelValue",d)}});function u(){t("submit")}function c(){n.submitOnBlur!==!1?t("submit"):t("cancel")}return(d,m)=>(b(),N("form",{onSubmit:ti(u,["prevent"])},[h("div",uc,[o(l)?(b(),N("span",cc,[(b(),H(xe(o(l))))])):R("",!0),e.textArea?(b(),H(o(ia),{key:1,modelValue:o(a),"onUpdate:modelValue":m[0]||(m[0]=g=>At(a)?a.value=g:null),placeholder:e.placeholder,maxHeight:e.maxHeight,onBlur:c,ref_key:"field",ref:i},null,8,["modelValue","placeholder","maxHeight"])):mn((b(),N("input",{key:2,type:"text","onUpdate:modelValue":m[1]||(m[1]=g=>At(a)?a.value=g:null),placeholder:e.placeholder,class:Pe({fullWidth:!e.title}),onBlur:c,ref_key:"field",ref:i},null,42,dc)),[[pr,o(a)]])])],40,oc))}});var Fr=me(mc,[["__scopeId","data-v-90bd4994"]]);const pc=K({__name:"Node",props:{id:null},setup(e){const n=st(e),l=Ji(Fl,()=>{}),i=Ji(El,()=>{}),a=$t(null),u=S(()=>a.value&&a.value.parentElement);return et([u,n.id],([c,d],[m,g])=>{m&&i(o(g)),c&&l(d,c)}),Nl(()=>i(o(n.id))),(c,d)=>(b(),N("div",{class:"node",ref_key:"node",ref:a},null,512))}});var Xn=me(pc,[["__scopeId","data-v-a48cb382"]]);const fc={},vc={class:"notif"};function gc(e,t){return b(),N("div",vc,"!")}var Tn=me(fc,[["render",gc],["__scopeId","data-v-66323fd4"]]);const $e=K({__name:"Spacer",props:{width:{default:"8px"},height:{default:"17px"}},setup(e){return(t,n)=>(b(),N("div",{style:Se({width:e.width,height:e.height})},null,4))}});gr.registerPlugin(la);ra.registerPlugin("batch",aa);var hc=K({props:{style:j(String,Object,Array),classes:j(Object),onInit:{type:Function,required:!0},id:{type:String,required:!0},onContainerResized:Function,onHotReload:Function},setup(e){const t=$t(null),n=new ResizeObserver(a),l=$t(null);ii(()=>{var c,d;const u=l.value;u!=null&&(n.observe(u),t.value=new gr({resizeTo:u,backgroundAlpha:0}),(c=l.value)==null||c.appendChild(t.value.view),(d=e.onInit)==null||d.call(e,t.value)),a(),e.onHotReload&&Gt(e.onHotReload)}),Ml(()=>{var u;(u=t.value)==null||u.destroy()});let i=!0;function a(){i&&(i=!1,Gt(()=>{var u;l.value!=null&&((u=e.onContainerResized)==null||u.call(e,l.value.getBoundingClientRect())),i=!0}))}return zt.on("fontsLoaded",a),{unref:o,resizeListener:l}}});function bc(e,t,n,l,i,a){return b(),N("div",{ref:"resizeListener",class:Pe(["resize-listener",e.unref(e.classes)]),style:Se(e.unref(e.style))},null,6)}var yc=me(hc,[["render",bc],["__scopeId","data-v-2cea0e1c"]]);const wc=Symbol("Particles");function tl(e){return ct(t=>{var a,u;const n=(a=e==null?void 0:e.call(t,t))!=null?a:{};n.id=fn("particles-"),n.type=wc,n[tt]=yc,n.app=$t(null),n.addEmitter=c=>{const d=n;return d.app.value?Promise.resolve(new Hl(d.app.value.stage,c)):new Promise(m=>{l.push({resolve:m,config:c})})};let l=[];function i(c){const d=n;d.app.value=c,l.forEach(({resolve:m,config:g})=>m(new Hl(c.stage,g))),l=[]}return n.onContainerResized=(u=n.onContainerResized)==null?void 0:u.bind(n),n[je]=function(){const{id:c,style:d,classes:m,onContainerResized:g,onHotReload:p}=this;return{id:c,style:o(d),classes:m,onContainerResized:g,onHotReload:p,onInit:i}},n})}window.upgradeConfig=sa;function pn(e,t="points",n=0,l=void 0){const i=At(e)?e:W(e);if(i.displayName=t,i.precision=n,i.small=l,!At(e)){const a=i[_n];a.displayName=t,a.precision=n,a.small=l}return i}function nl(e){const t=W(e.value);return et(e,n=>{Tl.value||r.gt(n,t.value)&&(t.value=n)}),t}function _c(e){const t=W(e.value);return et(e,(n,l)=>{Tl.value||r.gt(n,l)&&(t.value=r.add(t.value,r.sub(n,l)))}),t}new r("10^^8");new r("1e100");function Pn(e,t){const n=t!=null?t:e.value;return r.eq(e.precision,0)?ge(e.small?n:r.floor(n)):Oe(n,e.precision,e.small)}function Si(e){return"displayName"in e?e:o(e)}const Cc={key:0},Sc={key:0,class:"mark star"},kc=["src"],Nc=K({__name:"MarkNode",props:{mark:{type:[Boolean,String]}},setup(e){return(t,n)=>e.mark?(b(),N("div",Cc,[e.mark===!0?(b(),N("div",Sc)):(b(),N("img",{key:1,class:"mark",src:e.mark},null,8,kc))])):R("",!0)}});var qi=me(Nc,[["__scopeId","data-v-2207999f"]]);function Er(e){return ct(t=>{var l;const n=e.call(t,t);return n.partialDisplay=i=>s("span",{style:o(n.requirementMet)?"":"color: var(--danger)"},[Pn(n.resource,n.cost instanceof v?Xi(n.cost,i!=null?i:1,o(n.cumulativeCost),o(n.directSum)):o(n.cost))," ",n.resource.displayName]),n.display=i=>s("div",null,[o(n.requiresPay)?"Costs: ":"Requires: ",Pn(n.resource,n.cost instanceof v?Xi(n.cost,i!=null?i:1,o(n.cumulativeCost),o(n.directSum)):o(n.cost))," ",n.resource.displayName]),E(n,"visibility"),Ye(n,"visibility",Ge.Visible),E(n,"cost"),E(n,"requiresPay"),Ye(n,"requiresPay",!0),E(n,"cumulativeCost"),Ye(n,"cumulativeCost",!0),E(n,"maxBulkAmount"),Ye(n,"maxBulkAmount",1),E(n,"directSum"),Ye(n,"pay",function(i){const a=n.cost instanceof v?Xi(n.cost,i!=null?i:1,o(n.cumulativeCost),o(n.directSum)):o(n.cost);n.resource.value=r.sub(n.resource.value,a).max(0)}),n.canMaximize=S(()=>{var c;if(!(n.cost instanceof v))return!1;const i=o(n.maxBulkAmount);if(r.lte(i,1))return!1;const a=o(n.cumulativeCost),u=(c=o(n.directSum))!=null?c:a?10:0;return r.lte(i,u)?!0:!(!n.cost.isInvertible()||a===!0&&!n.cost.isIntegrable())}),n.cost instanceof v?n.requirementMet=bu(n.cost,n.resource,(l=n.cumulativeCost)!=null?l:!0,n.directSum,n.maxBulkAmount):n.requirementMet=S(()=>r.gte(n.resource.value,o(n.cost))?1:0),n})}function Ll(e){return ct(()=>({requirementMet:S(()=>ft(e.visibility)),visibility:Ge.None,requiresPay:!1}))}function he(e,t){return ct(()=>({requirementMet:Ue(e),partialDisplay:t==null?void 0:$(()=>at(t)),display:t==null?void 0:$(()=>s(T,null,[f("Req: "),at(t)])),visibility:t==null?Ge.None:Ge.Visible,requiresPay:!1}))}function il(e){if(Cn(e))return e.every(il);const t=o(e.requirementMet);return typeof t=="boolean"?t:r.gt(t,0)}function Dr(e){if(Cn(e))return e.map(Dr).reduce(r.min);const t=o(e.requirementMet);return typeof t=="boolean"?t?r.dInf:0:r.gt(t,1)&&o(e.canMaximize)!==!0?1:t}function ll(e,t=1){var n,l;if(Cn(e)&&(e=e.filter(i=>ft(i.visibility)),e.length===1&&(e=e[0])),Cn(e)){e=e.filter(u=>"partialDisplay"in u);const i=e.filter(u=>o(u.requiresPay)),a=e.filter(u=>!o(u.requiresPay));return s(T,null,[i.length>0?s("div",null,[f("Costs:")," ",yl(i.map(u=>u.partialDisplay(t)),s(T,null,[f(", ")]))]):null,a.length>0?s("div",null,[f("Requires:")," ",yl(a.map(u=>u.partialDisplay(t)),s(T,null,[f(", ")]))]):null])}return(l=(n=e.display)==null?void 0:n.call(e))!=null?l:s(T,null,null)}function qr(e,t=1){var n;Cn(e)?e.filter(l=>o(l.requiresPay)).forEach(l=>{var i;return(i=l.pay)==null?void 0:i.call(l,t)}):o(e.requiresPay)&&((n=e.pay)==null||n.call(e,t))}var $c=K({props:{display:{type:j(String,Object,Function),required:!0},visibility:{type:j(Number,Boolean),required:!0},style:j(String,Object,Array),classes:j(Object),requirements:{type:Object,required:!0},canPurchase:{type:j(Boolean),required:!0},bought:{type:j(Boolean),required:!0},mark:j(Boolean,String),id:{type:String,required:!0},purchase:{type:Function,required:!0}},components:{Node:Xn,MarkNode:qi},setup(e){const{display:t,requirements:n,bought:l}=st(e),i=$t("");return Jt(()=>{const a=rt(t);if(a==null){i.value="";return}if(gn(a)){i.value=ve(a);return}const u=ve(a.title||"","h3"),c=ve(a.description,"div"),d=ve(a.effectDisplay||"");i.value=ve($(()=>s("span",null,[a.title!=null?s("div",null,[s(u,null,null)]):null,s(c,null,null),a.effectDisplay!=null?s("div",null,[f("Currently: "),s(d,null,null)]):null,l.value?null:s(T,null,[s("br",null,null),ll(n.value)])])))}),{component:i,unref:o,Visibility:Ge,isVisible:ft,isHidden:En}}});const Mc=["disabled"];function Pc(e,t,n,l,i,a){var d;const u=Et("MarkNode"),c=Et("Node");return e.isVisible(e.visibility)?(b(),N("button",{key:0,style:Se([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(d=e.unref(e.style))!=null?d:{}]),onClick:t[0]||(t[0]=(...m)=>e.purchase&&e.purchase(...m)),class:Pe({feature:!0,upgrade:!0,can:e.unref(e.canPurchase),locked:!e.unref(e.canPurchase),bought:e.unref(e.bought),...e.unref(e.classes)}),disabled:!e.unref(e.canPurchase)},[e.unref(e.component)?(b(),H(xe(e.unref(e.component)),{key:0})):R("",!0),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(c,{id:e.id},null,8,["id"])],14,Mc)):R("",!0)}var xc=me($c,[["render",Pc],["__scopeId","data-v-9be6bac0"]]);const Ic=Symbol("Upgrade");function Tc(e,...t){const n=W(!1,!1),l=t.reduce((i,a)=>{var u;return Object.assign(i,(u=a.getPersistentData)==null?void 0:u.call(a))},{});return ct(i=>{var d,m;const a=e.call(i,i);a.id=fn("upgrade-"),a.type=Ic,a[tt]=xc;for(const g of t)(d=g.preConstruct)==null||d.call(g,a);a.bought=n,Object.assign(a,l),a.canPurchase=S(()=>!n.value&&il(a.requirements)),a.purchase=function(){var p;const g=a;!o(g.canPurchase)||(qr(a.requirements),n.value=!0,(p=g.onPurchase)==null||p.call(g))};const u=Ll(a);Cn(a.requirements)?a.requirements.unshift(u):a.requirements=[u,a.requirements],E(a,"visibility"),Ye(a,"visibility",Ge.Visible),E(a,"classes"),E(a,"style"),E(a,"display"),E(a,"mark");for(const g of t)(m=g.postConstruct)==null||m.call(g,a);const c=t.reduce((g,p)=>{var w;return Object.assign(g,(w=p.getGatheredProps)==null?void 0:w.call(p,a))},{});return a[je]=function(){const{display:g,visibility:p,style:w,classes:_,requirements:y,canPurchase:k,bought:B,mark:V,id:P,purchase:x}=this;return{display:g,visibility:p,style:o(w),classes:_,requirements:y,canPurchase:k,bought:B,mark:V,id:P,purchase:x,...c}},a})}const Fc=K({__name:"Collapsible",props:{collapsed:null,display:null,content:null},setup(e){const t=e,n=ni(Yt(t,"display")),l=ni(Yt(t,"content"));return(i,a)=>(b(),H(Yi,{class:"collapsible-container"},{default:oe(()=>[h("button",{onClick:a[0]||(a[0]=u=>e.collapsed.value=!e.collapsed.value),class:"feature collapsible-toggle"},[(b(),H(xe(o(n))))]),e.collapsed.value?R("",!0):(b(),H(xe(o(l)),{key:0}))]),_:1}))}});var si=me(Fc,[["__scopeId","data-v-a72c16aa"]]),Ec=K({props:{display:{type:j(Object,String,Function),required:!0},visibility:{type:j(Number,Boolean),required:!0},style:j(Object,String,Array),classes:j(Object),onClick:Function,onHold:Function,canClick:{type:j(Boolean),required:!0},small:Boolean,mark:j(Boolean,String),id:{type:String,required:!0}},components:{Node:Xn,MarkNode:qi},setup(e){const{display:t,onClick:n,onHold:l}=st(e),i=$t("");Jt(()=>{var g;const c=rt(t);if(c==null){i.value="";return}if(gn(c)){i.value=ve(c);return}const d=ve((g=c.title)!=null?g:"","h3"),m=ve(c.description,"div");i.value=ve($(()=>s("span",null,[c.title!=null?s("div",null,[s(d,null,null)]):null,s(m,null,null)])))});const{start:a,stop:u}=$r(n,l);return{start:a,stop:u,comp:i,Visibility:Ge,isVisible:ft,isHidden:En,unref:o}}});function Dc(e,t,n,l,i,a){var d;const u=Et("MarkNode"),c=Et("Node");return e.isVisible(e.visibility)?(b(),N("button",{key:0,style:Se([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(d=e.unref(e.style))!=null?d:[]]),onClick:t[0]||(t[0]=(...m)=>e.onClick&&e.onClick(...m)),onMousedown:t[1]||(t[1]=(...m)=>e.start&&e.start(...m)),onMouseleave:t[2]||(t[2]=(...m)=>e.stop&&e.stop(...m)),onMouseup:t[3]||(t[3]=(...m)=>e.stop&&e.stop(...m)),onTouchstartPassive:t[4]||(t[4]=(...m)=>e.start&&e.start(...m)),onTouchendPassive:t[5]||(t[5]=(...m)=>e.stop&&e.stop(...m)),onTouchcancelPassive:t[6]||(t[6]=(...m)=>e.stop&&e.stop(...m)),class:Pe({feature:!0,clickable:!0,can:e.unref(e.canClick),locked:!e.unref(e.canClick),small:e.small,...e.unref(e.classes)})},[e.unref(e.comp)?(b(),H(xe(e.unref(e.comp)),{key:0})):R("",!0),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(c,{id:e.id},null,8,["id"])],38)):R("",!0)}var $i=me(Ec,[["render",Dc],["__scopeId","data-v-03ca8bd6"]]);const qc=Symbol("Clickable");function Bn(e,...t){const n=t.reduce((l,i)=>{var a;return Object.assign(l,(a=i.getPersistentData)==null?void 0:a.call(i))},{});return ct(l=>{var u,c,d;const i=(u=e==null?void 0:e.call(l,l))!=null?u:{};i.id=fn("clickable-"),i.type=qc,i[tt]=$i;for(const m of t)(c=m.preConstruct)==null||c.call(m,i);if(Object.assign(i,n),E(i,"visibility"),Ye(i,"visibility",Ge.Visible),E(i,"canClick"),Ye(i,"canClick",!0),E(i,"classes"),E(i,"style"),E(i,"mark"),E(i,"display"),i.onClick){const m=i.onClick.bind(i);i.onClick=function(g){o(i.canClick)!==!1&&m(g)}}if(i.onHold){const m=i.onHold.bind(i);i.onHold=function(){o(i.canClick)!==!1&&m()}}for(const m of t)(d=m.postConstruct)==null||d.call(m,i);const a=t.reduce((m,g)=>{var p;return Object.assign(m,(p=g.getGatheredProps)==null?void 0:p.call(g,i))},{});return i[je]=function(){const{display:m,visibility:g,style:p,classes:w,onClick:_,onHold:y,canClick:k,small:B,mark:V,id:P}=this;return{display:m,visibility:g,style:o(p),classes:w,onClick:_,onHold:y,canClick:k,small:B,mark:V,id:P,...a}},i})}const Ac=["x1","y1","x2","y2"],Lc=K({__name:"Link",props:{link:null,startNode:null,endNode:null,boundingRect:null},setup(e){const t=e,n=st(t),l=S(()=>{const u=n.startNode.value.rect,c=n.boundingRect.value,d=c?{x:u.x+u.width/2-c.x,y:u.y+u.height/2-c.y}:{x:0,y:0};return n.link.value.offsetStart&&(d.x+=n.link.value.offsetStart.x,d.y+=n.link.value.offsetStart.y),d}),i=S(()=>{const u=n.endNode.value.rect,c=n.boundingRect.value,d=c?{x:u.x+u.width/2-c.x,y:u.y+u.height/2-c.y}:{x:0,y:0};return n.link.value.offsetEnd&&(d.x+=n.link.value.offsetEnd.x,d.y+=n.link.value.offsetEnd.y),d}),a=S(()=>qs(t.link));return(u,c)=>(b(),N("line",Ht({"stroke-width":"15px",stroke:"white"},o(a),{x1:o(l).x,y1:o(l).y,x2:o(i).x,y2:o(i).y}),null,16,Ac))}});const Oc=K({__name:"Links",props:{links:null},setup(e){var d;const n=Yt(e,"links"),l=J(null),i=Ji(Dl,J({})),a=Ji(ql,J(void 0)),u=J((d=l.value)==null?void 0:d.getBoundingClientRect());et(a,()=>{var m;return u.value=(m=l.value)==null?void 0:m.getBoundingClientRect()}),ii(()=>{var m;return u.value=(m=l.value)==null?void 0:m.getBoundingClientRect()});const c=S(()=>{var g,p;const m=i.value;return(p=(g=n.value)==null?void 0:g.filter(w=>{var _,y;return((_=m[w.startNode.id])==null?void 0:_.rect)&&((y=m[w.startNode.id])==null?void 0:y.rect)}))!=null?p:[]});return(m,g)=>(b(),N(T,null,[o(c)?(b(),N("svg",fr(Ht({key:0},m.$attrs)),[(b(!0),N(T,null,Zt(o(c),(p,w)=>(b(),H(Lc,{key:w,link:p,boundingRect:u.value,startNode:o(i)[p.startNode.id],endNode:o(i)[p.endNode.id]},null,8,["link","boundingRect","startNode","endNode"]))),128))],16)):R("",!0),h("div",{ref_key:"resizeListener",ref:l,class:"resize-listener"},null,512)],64))}});var jc=me(Oc,[["__scopeId","data-v-063f6d6b"]]),Rc=K({props:{nodes:{type:j(Array),required:!0},leftSideNodes:j(Array),rightSideNodes:j(Array),branches:j(Array)},components:{Links:jc},setup(e){const{nodes:t,leftSideNodes:n,rightSideNodes:l}=st(e),i=$t();Jt(()=>{const c=rt(t);i.value=ve($(()=>s(T,null,[c.map(d=>s("span",{class:"row tree-row",style:"margin: 50px auto;"},[d.map(at)]))])))});const a=$t();Jt(()=>{const c=rt(n);a.value=c?ve($(()=>s("span",{class:"left-side-nodes small"},[c.map(at)]))):""});const u=$t();return Jt(()=>{const c=rt(l);u.value=c?ve($(()=>s("span",{class:"side-nodes small"},[c.map(at)]))):""}),{unref:o,nodesComp:i,leftNodesComp:a,rightNodesComp:u}}});function Bc(e,t,n,l,i,a){const u=Et("Links");return b(),N(T,null,[(b(),H(xe(e.nodesComp))),e.leftNodesComp?(b(),H(xe(e.leftNodesComp),{key:0})):R("",!0),e.rightNodesComp?(b(),H(xe(e.rightNodesComp),{key:1})):R("",!0),e.branches?(b(),H(u,{key:2,links:e.unref(e.branches)},null,8,["links"])):R("",!0)],64)}var Vc=me(Rc,[["render",Bc],["__scopeId","data-v-39ca96d0"]]);const Gc=K({props:{display:j(Object,String,Function),visibility:{type:j(Number,Boolean),required:!0},style:j(String,Object,Array),classes:j(Object),onClick:Function,onHold:Function,color:j(String),glowColor:j(String),canClick:{type:j(Boolean),required:!0},mark:j(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:qi,Node:Xn},setup(e){const{onClick:t,onHold:n,display:l}=st(e),i=Dn(l),{start:a,stop:u}=$r(t,n);return{start:a,stop:u,comp:i,unref:o,Visibility:Ge,isCoercableComponent:gn,isVisible:ft,isHidden:En}}});function zc(e,t,n,l,i,a){var d;const u=Et("MarkNode"),c=Et("Node");return e.isVisible(e.visibility)?(b(),N("div",{key:0,style:Se({visibility:e.isHidden(e.visibility)?"hidden":void 0}),class:Pe({treeNode:!0,can:e.unref(e.canClick),...e.unref(e.classes)}),onClick:t[0]||(t[0]=(...m)=>e.onClick&&e.onClick(...m)),onMousedown:t[1]||(t[1]=(...m)=>e.start&&e.start(...m)),onMouseleave:t[2]||(t[2]=(...m)=>e.stop&&e.stop(...m)),onMouseup:t[3]||(t[3]=(...m)=>e.stop&&e.stop(...m)),onTouchstartPassive:t[4]||(t[4]=(...m)=>e.start&&e.start(...m)),onTouchendPassive:t[5]||(t[5]=(...m)=>e.stop&&e.stop(...m)),onTouchcancelPassive:t[6]||(t[6]=(...m)=>e.stop&&e.stop(...m))},[h("div",{style:Se([{backgroundColor:e.unref(e.color),boxShadow:`-4px -4px 4px rgba(0, 0, 0, 0.25) inset, 0 0 20px ${e.unref(e.glowColor)}`},(d=e.unref(e.style))!=null?d:[]])},[(b(),H(xe(e.unref(e.comp))))],4),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(c,{id:e.id},null,8,["id"])],38)):R("",!0)}var Uc=me(Gc,[["render",zc],["__scopeId","data-v-727230a6"]]);const Xc=Symbol("TreeNode"),Hc=Symbol("Tree");function er(e,...t){const n=t.reduce((l,i)=>{var a;return Object.assign(l,(a=i.getPersistentData)==null?void 0:a.call(i))},{});return ct(l=>{var u,c,d;const i=(u=e==null?void 0:e.call(l,l))!=null?u:{};i.id=fn("treeNode-"),i.type=Xc,i[tt]=Uc;for(const m of t)(c=m.preConstruct)==null||c.call(m,i);Object.assign(n),E(i,"visibility"),Ye(i,"visibility",Ge.Visible),E(i,"canClick"),Ye(i,"canClick",!0),E(i,"color"),E(i,"display"),E(i,"glowColor"),E(i,"classes"),E(i,"style"),E(i,"mark");for(const m of t)(d=m.postConstruct)==null||d.call(m,i);if(i.onClick){const m=i.onClick.bind(i);i.onClick=function(g){o(i.canClick)!==!1&&m(g)}}if(i.onHold){const m=i.onHold.bind(i);i.onHold=function(){o(i.canClick)!==!1&&m()}}const a=t.reduce((m,g)=>{var p;return Object.assign(m,(p=g.getGatheredProps)==null?void 0:p.call(g,i))},{});return i[je]=function(){const{display:m,visibility:g,style:p,classes:w,onClick:_,onHold:y,color:k,glowColor:B,canClick:V,mark:P,id:x}=this;return{display:m,visibility:g,style:p,classes:w,onClick:_,onHold:y,color:k,glowColor:B,canClick:V,mark:P,id:x,...a}},i})}function Jc(e){return ct(t=>{const n=e.call(t,t);return n.id=fn("tree-"),n.type=Hc,n[tt]=Vc,n.isResetting=J(!1),n.resettingNode=$t(null),n.reset=function(l){var a,u;const i=n;i.isResetting.value=!0,i.resettingNode.value=l,(a=i.resetPropagation)==null||a.call(i,i,l),(u=i.onReset)==null||u.call(i,l),i.isResetting.value=!1,i.resettingNode.value=null},n.links=S(()=>{var i;return(i=o(n.branches))!=null?i:[]}),E(n,"visibility"),Ye(n,"visibility",Ge.Visible),E(n,"nodes"),E(n,"leftSideNodes"),E(n,"rightSideNodes"),E(n,"branches"),n[je]=function(){const{nodes:l,leftSideNodes:i,rightSideNodes:a,branches:u}=this;return{nodes:l,leftSideNodes:i,rightSideNodes:a,branches:u}},n})}function Qt(e){const t=[],n={};let l=!1;function i(){return l||(t.push(...e()),n.base=t.map(c=>Ue(c.base)),n.baseText=t.map(c=>Ue(c.baseText)),n.visible=t.map(c=>Ue(c.visible)),n.title=t.map(c=>Ue(c.title)),n.subtitle=t.map(c=>Ue(c.subtitle)),l=!0),t}const a=W({},!1);return[$(()=>{const c=i();let d=!0;const m=c.map((g,p)=>{var V,P,x;if(o(n.visible[p])===!1)return null;const w=s("h3",{onClick:()=>a.value[p]=!a.value[p],style:"cursor: pointer"},[s("span",{class:"modifier-toggle"+(o(a.value[p])?" collapsed":"")},[f("\u25BC")]),o(n.title[p]),o(n.subtitle[p])!=null?s("span",{class:"subtitle"},[f(" ("),o(n.subtitle[p]),f(")")]):null]),_=o(a.value[p])?null:s(T,null,[s("div",{class:"modifier-container"},[s("span",{class:"modifier-description"},[at((V=o(n.baseText[p]))!=null?V:"Base")]),s("span",{class:"modifier-amount"},[Oe((P=o(n.base[p]))!=null?P:1),g.unit])]),g.modifier.description==null?null:at(o(g.modifier.description))]),y=!d;d=!1;const k=(x=o(n.base[p]))!=null?x:1,B=g.modifier.apply(k);return s(T,null,[y?s("br",null,null):null,s("div",{style:{"--unit":qe.alignUnits&&g.unit!=null?"'"+g.unit+"'":""}},[w,s("br",null,null),_,s("hr",null,null),s("div",{class:"modifier-container"},[s("span",{class:"modifier-description"},[f("Total")]),s("span",{class:"modifier-amount",style:(g.smallerIsBetter===!0?r.gt(B,k!=null?k:1):r.lt(B,k!=null?k:1))?"color: var(--danger)":""},[Di(B),g.unit])])])])});return s(T,null,[m])}),a]}function qt(e,t="var(--accent2)"){return s("span",{style:{color:t}},[e])}const Wc=K({props:{progress:{type:j(String,Object,Number),required:!0},width:{type:j(Number),required:!0},height:{type:j(Number),required:!0},direction:{type:j(String),required:!0},display:j(Object,String,Function),visibility:{type:j(Number,Boolean),required:!0},style:j(Object,String,Array),classes:j(Object),borderStyle:j(Object,String,Array),textStyle:j(Object,String,Array),baseStyle:j(Object,String,Array),fillStyle:j(Object,String,Array),mark:j(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:qi,Node:Xn},setup(e){const{progress:t,width:n,height:l,direction:i,display:a}=st(e),u=S(()=>{let m=t.value instanceof r?t.value.toNumber():Number(t.value);return(1-Math.min(Math.max(m,0),1))*100}),c=S(()=>{const m={width:rt(n)+.5+"px",height:rt(l)+.5+"px"};switch(o(i)){case Me.Up:m.clipPath=`inset(${u.value}% 0% 0% 0%)`,m.width=rt(n)+1+"px";break;case Me.Down:m.clipPath=`inset(0% 0% ${u.value}% 0%)`,m.width=rt(n)+1+"px";break;case Me.Right:m.clipPath=`inset(0% ${u.value}% 0% 0%)`;break;case Me.Left:m.clipPath=`inset(0% 0% 0% ${u.value}%)`;break;case Me.Default:m.clipPath="inset(0% 50% 0% 0%)";break}return m}),d=Dn(a);return{normalizedProgress:u,barStyle:c,component:d,unref:o,Visibility:Ge,isVisible:ft,isHidden:En}}});function Zc(e,t,n,l,i,a){var d,m,g,p,w,_,y;const u=Et("MarkNode"),c=Et("Node");return e.isVisible(e.visibility)?(b(),N("div",{key:0,style:Se([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px",visibility:e.isHidden(e.visibility)?"hidden":void 0},(d=e.unref(e.style))!=null?d:{}]),class:Pe({bar:!0,...e.unref(e.classes)})},[h("div",{class:"overlayTextContainer border",style:Se([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(m=e.unref(e.borderStyle))!=null?m:{}])},[e.component?(b(),N("span",{key:0,class:"overlayText",style:Se(e.unref(e.textStyle))},[(b(),H(xe(e.component)))],4)):R("",!0)],4),h("div",{class:"border",style:Se([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(g=e.unref(e.style))!=null?g:{},(p=e.unref(e.baseStyle))!=null?p:{},(w=e.unref(e.borderStyle))!=null?w:{}])},[h("div",{class:"fill",style:Se([e.barStyle,(_=e.unref(e.style))!=null?_:{},(y=e.unref(e.fillStyle))!=null?y:{}])},null,4)],4),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(c,{id:e.id},null,8,["id"])],6)):R("",!0)}var Qc=me(Wc,[["render",Zc],["__scopeId","data-v-1d143a13"]]);const Kc=Symbol("Bar");function Hi(e,...t){const n=t.reduce((l,i)=>{var a;return Object.assign(l,(a=i.getPersistentData)==null?void 0:a.call(i))},{});return ct(l=>{var u,c;const i=e.call(l,l);i.id=fn("bar-"),i.type=Kc,i[tt]=Qc;for(const d of t)(u=d.preConstruct)==null||u.call(d,i);Object.assign(i,n),E(i,"visibility"),Ye(i,"visibility",Ge.Visible),E(i,"width"),E(i,"height"),E(i,"direction"),E(i,"style"),E(i,"classes"),E(i,"borderStyle"),E(i,"baseStyle"),E(i,"textStyle"),E(i,"fillStyle"),E(i,"progress"),E(i,"display"),E(i,"mark");for(const d of t)(c=d.postConstruct)==null||c.call(d,i);const a=t.reduce((d,m)=>{var g;return Object.assign(d,(g=m.getGatheredProps)==null?void 0:g.call(m,i))},{});return i[je]=function(){const{progress:d,width:m,height:g,direction:p,display:w,visibility:_,style:y,classes:k,borderStyle:B,textStyle:V,baseStyle:P,fillStyle:x,mark:X,id:te}=this;return{progress:d,width:m,height:g,direction:p,display:w,visibility:_,style:o(y),classes:k,borderStyle:B,textStyle:V,baseStyle:P,fillStyle:x,mark:X,id:te,...a}},i})}var Yc=K({props:{visibility:{type:j(Number,Boolean),required:!0},display:j(Object,String,Function),earned:{type:j(Boolean),required:!0},requirements:j(Object,Array),image:j(String),style:j(String,Object,Array),classes:j(Object),mark:j(Boolean,String),small:j(Boolean),id:{type:String,required:!0}},components:{Node:Xn,MarkNode:qi},setup(e){const{display:t,requirements:n,earned:l}=st(e),i=$t("");return Jt(()=>{const a=rt(t);if(a==null){i.value="";return}if(gn(a)){i.value=ve(a);return}const u=ve(a.requirement?a.requirement:$(()=>{var m;return ll((m=rt(n))!=null?m:[])}),"h3"),c=ve(a.effectDisplay||"","b"),d=rt(l)?ve(a.optionsDisplay||"","span"):"";i.value=ve($(()=>s("span",null,[s(u,null,null),a.effectDisplay!=null?s("div",null,[s(c,null,null)]):null,a.optionsDisplay!=null?s("div",{class:"equal-spaced"},[s(d,null,null)]):null])))}),{comp:i,unref:o,Visibility:Ge,isVisible:ft,isHidden:En}}});function ed(e,t,n,l,i,a){var d;const u=Et("MarkNode"),c=Et("Node");return e.isVisible(e.visibility)?(b(),N("div",{key:0,style:Se([{visibility:e.isHidden(e.visibility)?"hidden":void 0,backgroundImage:e.earned&&e.image&&`url(${e.image})`||""},(d=e.unref(e.style))!=null?d:[]]),class:Pe({feature:!0,achievement:!0,locked:!e.unref(e.earned),done:e.unref(e.earned),small:e.unref(e.small),...e.unref(e.classes)})},[e.comp?(b(),H(xe(e.comp),{key:0})):R("",!0),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(c,{id:e.id},null,8,["id"])],6)):R("",!0)}var td=me(Yc,[["render",ed],["__scopeId","data-v-5673325a"]]);zt.on("setupVue",e=>e.use(oa));function nd(e="white",t="8px"){return{transform:"scale(1.05, 1.05)",borderColor:"rgba(0, 0, 0, 0.125)",boxShadow:`-4px -4px 4px rgba(0, 0, 0, 0.25) inset, 0 0 ${t} ${e}`,zIndex:1}}function Fi(e,t){const n=Ue(t),l=J(!1);return Gt(()=>{l.value=n.value,et(Mr(e),i=>{i||(l.value=!1)}),et(n,i=>{l.value=i})}),l}const id=bi(),ld=Symbol("Achievement");let pi=function(e){return e.All="all",e.Configurable="configurable",e.Incomplete="incomplete",e.None="none",e}({});function be(e,...t){const n=W(!1,!1),l=t.reduce((i,a)=>{var u;return Object.assign(i,(u=a.getPersistentData)==null?void 0:u.call(a))},{});return ct(i=>{var d,m,g;const a=(d=e==null?void 0:e.call(i,i))!=null?d:{};a.id=fn("achievement-"),a.type=ld,a[tt]=td;for(const p of t)(m=p.preConstruct)==null||m.call(p,a);a.earned=n,a.complete=function(){var w,_;if(n.value)return;n.value=!0;const p=a;if((w=p.onComplete)==null||w.call(p),p.display!=null&&o(p.showPopups)===!0){const y=o(p.display);let k;gn(y)?k=ve(y):y.requirement!=null?k=ve(y.requirement):k=ll((_=p.requirements)!=null?_:[]),id.info(s("div",null,[s("h3",null,[f("Achievement earned!")]),s("div",null,[s(k,null,null)])]))}},Object.assign(a,l),E(a,"visibility"),Ye(a,"visibility",Ge.Visible);const u=a.visibility;a.visibility=Qr(()=>{const p=o(a.display);switch(qe.msDisplay){default:case pi.All:return o(u);case pi.Configurable:return o(a.earned)&&!(p!=null&&typeof p=="object"&&"optionsDisplay"in p)?Ge.None:o(u);case pi.Incomplete:return o(a.earned)?Ge.None:o(u);case pi.None:return Ge.None}}),E(a,"display"),E(a,"mark"),E(a,"small"),E(a,"image"),E(a,"style"),E(a,"classes"),E(a,"showPopups"),Ye(a,"showPopups",!0);for(const p of t)(g=p.postConstruct)==null||g.call(p,a);const c=t.reduce((p,w)=>{var _;return Object.assign(p,(_=w.getGatheredProps)==null?void 0:_.call(w,a))},{});if(a[je]=function(){const{visibility:p,display:w,requirements:_,earned:y,image:k,style:B,classes:V,mark:P,small:x,id:X}=this;return{visibility:p,display:w,requirements:_,earned:y,image:k,style:o(B),classes:V,mark:P,small:x,id:X,...c}},a.requirements){const p=a,w=[Ll(p),he(()=>!p.earned.value),...Cn(a.requirements)?a.requirements:[a.requirements]];Jt(()=>{qe.active===U.id&&il(w)&&p.complete()})}return a})}zt.on("loadSettings",e=>{Ye(e,"msDisplay",pi.All)});const rd=Object.values(pi).map(e=>({label:cn(e),value:e}));Is($(()=>s(Al,{title:$(()=>s("span",{class:"option-title"},[f("Show achievements"),s("desc",null,[f("Select which achievements to display based on criterias.")])])),options:rd,"onUpdate:modelValue":e=>qe.msDisplay=e,modelValue:qe.msDisplay},null)));const ad=K({__name:"Sticky",setup(e){const t=J("0"),n=new ResizeObserver(i),l=$t(null);function i(){let a=l.value;if(a==null)return;let u=0;for(;a.previousSibling;){const c=a.previousSibling;c.dataset&&"vSticky"in c.dataset&&(u+=c.offsetHeight),a=c}t.value=u+"px"}return Gt(i),document.fonts.ready.then(i),ii(()=>{var u;const a=(u=l.value)==null?void 0:u.parentElement;a&&n.observe(a)}),(a,u)=>(b(),N("div",{class:"sticky",style:Se({top:t.value}),ref_key:"element",ref:l,"data-v-sticky":""},[Kt(a.$slots,"default",{},void 0,!0)],4))}});var Ol=me(ad,[["__scopeId","data-v-cccac690"]]);const Cl=K({__name:"Resource",props:{resource:null,color:null},setup(e){const t=e,n=S(()=>Pn(t.resource));return(l,i)=>(b(),N("h2",{style:Se({color:e.color,"text-shadow":"0px 0px 10px "+e.color})},Z(o(n)),5))}});const sd={class:"main-display"},od={key:0},ud={key:1},Ai=K({__name:"MainDisplay",props:{resource:null,color:null,classes:null,style:null,effectDisplay:null},setup(e){const n=st(e),l=J(null),i=Dn(n.effectDisplay),a=S(()=>r.lt(n.resource.value,"1e1000"));return(u,c)=>(b(),H(Ol,null,{default:oe(()=>{var d,m,g,p;return[h("div",{class:Pe(["main-display-container",(d=e.classes)!=null?d:{}]),style:Se([{height:`${((g=(m=l.value)==null?void 0:m.$el.clientHeight)!=null?g:0)+50}px`},(p=e.style)!=null?p:{}])},[h("div",sd,[o(a)?(b(),N("span",od,"You have ")):R("",!0),s(Cl,{resource:e.resource,color:e.color||"white"},null,8,["resource","color"]),f(" "+Z(e.resource.displayName),1),o(i)?(b(),N("span",ud,[f(", "),(b(),H(xe(o(i)),{ref_key:"effectRef",ref:l},null,512))])):R("",!0)])],6)]}),_:1}))}}),Ar=e=>(en("data-v-3eed3704"),e=e(),tn(),e),cd={class:"spell-tree-container"},dd=Ar(()=>h("div",{class:"spell-tree"},null,-1)),md={style:{display:"none"}},pd=Ar(()=>h("filter",{id:"skilltreeturbulence"},[h("feTurbulence",{x:"-50vw",y:"-50vh",width:"200vw",height:"200vh",baseFrequency:"0.015",numOctaves:"10",seed:"2"}),h("feDisplacementMap",{in:"SourceGraphic",scale:"10"},[h("animate",{attributeName:"scale",values:"10;50;10",dur:"10s",repeatCount:"indefinite"})])],-1)),fd=[pd];var vd=K({__name:"SpellTree",props:{spell:null},setup(e){const t=e,n=$t("");Jt(()=>{n.value=We(t.spell.tree)});const l=Bn(()=>({display:"reset",classes:{"reset-tree":!0},onClick(){Object.values(t.spell.treeNodes).forEach(a=>a.bought.value=!1),t.spell.castingTime.value=0}})),i=We(l);return(a,u)=>(b(),N("div",cd,[dd,(b(),H(xe(o(n)))),(b(),H(xe(o(i)))),(b(),N("svg",md,fd))]))}});var gd=me(vd,[["__scopeId","data-v-3eed3704"]]);const hd=K({props:{visibility:{type:j(Number,Boolean),required:!0},display:{type:j(Object,String,Function),required:!0},style:j(String,Object,Array),classes:j(Object),glowColor:j(String),active:Boolean,floating:Boolean},emits:["selectTab"],setup(e,{emit:t}){const{display:n,glowColor:l,floating:i}=st(e),a=ni(n),u=S(()=>{const d=rt(l);return d==null||d===""?{}:o(i)?nd(d):{boxShadow:`0px 9px 5px -6px ${d}`}});function c(){t("selectTab")}return{selectTab:c,component:a,glowColorStyle:u,unref:o,Visibility:Ge,isVisible:ft,isHidden:En}}});function bd(e,t,n,l,i,a){var u;return e.isVisible(e.visibility)?(b(),N("button",{key:0,onClick:t[0]||(t[0]=(...c)=>e.selectTab&&e.selectTab(...c)),class:Pe(["tabButton",{active:e.active,...e.unref(e.classes)}]),style:Se([{visibility:e.isHidden(e.visibility)?"hidden":void 0},e.glowColorStyle,(u=e.unref(e.style))!=null?u:{}])},[(b(),H(xe(e.component)))],6)):R("",!0)}var Lr=me(hd,[["render",bd],["__scopeId","data-v-21427abb"]]);const yd=K({props:{visibility:{type:j(Number,Boolean),required:!0},activeTab:{type:j(Object),required:!0},selected:{type:Object,required:!0},tabs:{type:j(Object),required:!0},style:j(String,Object,Array),classes:j(Object),buttonContainerStyle:j(String,Object,Array),buttonContainerClasses:j(Object)},components:{Sticky:Ol,TabButton:Lr},setup(e){const{activeTab:t}=st(e),n=S(()=>yi[qe.theme].floatingTabs),l=$t("");Jt(()=>{const c=rt(t);if(c==null){l.value="";return}if(gn(c)){l.value=ve(c);return}l.value=ve(o(c.display))});const i=S(()=>{const c=rt(t);return gn(c)||!c?void 0:o(c.classes)}),a=S(()=>{const c=rt(t);return gn(c)||!c?void 0:o(c.style)});function u(c){const{display:d,style:m,classes:g,glowColor:p,visibility:w}=c;return{display:d,style:o(m),classes:g,glowColor:p,visibility:w}}return{floating:n,tabClasses:i,tabStyle:a,Visibility:Ge,component:l,gatherButtonProps:u,unref:o,isVisible:ft,isHidden:En}}});function wd(e,t,n,l,i,a){var d,m;const u=Et("TabButton"),c=Et("Sticky");return e.isVisible(e.visibility)?(b(),N("div",{key:0,class:Pe(["tab-family-container",{...e.unref(e.classes),...e.tabClasses}]),style:Se([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(d=e.unref(e.style))!=null?d:[],(m=e.tabStyle)!=null?m:[]])},[s(c,{class:Pe(["tab-buttons-container",e.unref(e.buttonContainerClasses)]),style:Se(e.unref(e.buttonContainerStyle))},{default:oe(()=>[h("div",{class:Pe(["tab-buttons",{floating:e.floating}])},[(b(!0),N(T,null,Zt(e.unref(e.tabs),(g,p)=>(b(),H(u,Ht({onSelectTab:w=>e.selected.value=p,floating:e.floating,key:p,active:e.unref(g.tab)===e.unref(e.activeTab)},e.gatherButtonProps(g)),null,16,["onSelectTab","floating","active"]))),128))],2)]),_:1},8,["class","style"]),e.unref(e.activeTab)?(b(),H(xe(e.unref(e.component)),{key:0})):R("",!0)],6)):R("",!0)}var _d=me(yd,[["render",wd],["__scopeId","data-v-58dbf83a"]]);const Cd=Symbol("TabButton"),Sd=Symbol("TabFamily");function Fn(e,t){Object.keys(e).length===0&&console.error("Cannot create tab family with 0 tabs");const n=W(Object.keys(e)[0],!1);return ct(l=>{var u;const i=(u=t==null?void 0:t.call(l,l))!=null?u:{};i.id=fn("tabFamily-"),i.type=Sd,i[tt]=_d,i.tabs=Object.keys(e).reduce((c,d)=>{const m=e[d]();return m.type=Cd,m[tt]=Lr,E(m,"visibility"),Ye(m,"visibility",Ge.Visible),E(m,"tab"),E(m,"display"),E(m,"classes"),E(m,"style"),E(m,"glowColor"),c[d]=m,c},{}),i.selected=n,i.activeTab=S(()=>{const c=o(a.tabs);if(n.value in c&&ft(c[n.value].visibility))return o(c[n.value].tab);const d=Object.values(c).find(m=>ft(m.visibility));return d?o(d.tab):null}),E(i,"visibility"),Ye(i,"visibility",Ge.Visible),E(i,"classes"),E(i,"style"),E(i,"buttonContainerClasses"),E(i,"buttonContainerStyle"),i[je]=function(){const{visibility:c,activeTab:d,selected:m,tabs:g,style:p,classes:w,buttonContainerClasses:_,buttonContainerStyle:y}=this;return{visibility:c,activeTab:d,selected:m,tabs:g,style:o(p),classes:w,buttonContainerClasses:_,buttonContainerStyle:y}};const a=i;return a})}function wt(e){return ct(t=>{const{addend:n,description:l,enabled:i,smallerIsBetter:a}=e.call(t,t),u=Ue(n),c=Ue(l),d=i==null?void 0:Ue(i);return{apply:m=>r.add(m,o(u)),invert:m=>r.sub(m,o(u)),getFormula:m=>v.add(m,u),enabled:d,description:l==null?void 0:$(()=>s("div",{class:"modifier-container"},[o(c)!=null?s("span",{class:"modifier-description"},[at(o(c))]):null,s("span",{class:"modifier-amount",style:(a===!0?r.gt(o(u),0):r.lt(o(u),0))?"color: var(--danger)":""},[r.gte(o(u),0)?"+":"",Di(o(u))])]))}})}function q(e){return ct(t=>{const{multiplier:n,description:l,enabled:i,smallerIsBetter:a}=e.call(t,t),u=Ue(n),c=Ue(l),d=i==null?void 0:Ue(i);return{apply:m=>r.times(m,o(u)),invert:m=>r.div(m,o(u)),getFormula:m=>v.times(m,u),enabled:d,description:l==null?void 0:$(()=>s("div",{class:"modifier-container"},[o(c)!=null?s("span",{class:"modifier-description"},[at(o(c))]):null,s("span",{class:"modifier-amount",style:(a===!0?r.gt(o(u),1):r.lt(o(u),1))?"color: var(--danger)":""},[f("\xD7"),Di(o(u))])]))}})}function Qi(e){return ct(t=>{const{exponent:n,description:l,enabled:i,supportLowNumbers:a,smallerIsBetter:u}=e.call(t,t),c=Ue(n),d=Ue(l),m=i==null?void 0:Ue(i);return{apply:g=>{let p=g;return a&&(p=r.add(p,1)),p=r.pow(p,o(c)),a&&(p=r.sub(p,1)),p},invert:g=>{let p=g;return a&&(p=r.add(p,1)),p=r.root(p,o(c)),a&&(p=r.sub(p,1)),p},getFormula:g=>a?v.add(g,1).pow(c).sub(1):v.pow(g,c),enabled:m,description:l==null?void 0:$(()=>s("div",{class:"modifier-container"},[o(d)!=null?s("span",{class:"modifier-description"},[at(o(d)),a?" (+1 effective)":null]):null,s("span",{class:"modifier-amount",style:(u===!0?r.gt(o(c),1):r.lt(o(c),1))?"color: var(--danger)":""},[f("^"),Di(o(c))])]))}})}function ie(e){return ct(()=>{const t=e();return{apply:n=>t.filter(l=>o(l.enabled)!==!1).reduce((l,i)=>i.apply(l),n),invert:t.every(n=>n.invert!=null)?n=>t.filter(l=>o(l.enabled)!==!1).reduceRight((l,i)=>i.invert(l),n):void 0,getFormula:t.every(n=>n.getFormula!=null)?n=>t.filter(l=>o(l.enabled)!==!1).reduce((l,i)=>i.getFormula(l),n):void 0,enabled:t.some(n=>n.enabled!=null)?S(()=>t.filter(n=>o(n.enabled)!==!1).length>0):void 0,description:t.some(n=>n.description!=null)?$(()=>s(T,null,[t.filter(n=>o(n.enabled)!==!1).map(n=>o(n.description)).filter(n=>n).map(at)])):void 0}})}const kd=K({__name:"Tab",props:{display:null},setup(e){const t=e,{display:n}=st(t),l=ni(n);return(i,a)=>(b(),H(xe(o(l))))}}),Nd=Symbol("Tab");function Gn(e){return ct(t=>{const n=e.call(t,t);return n.id=fn("tab-"),n.type=Nd,n[tt]=kd,n[je]=function(){const{display:l}=this;return{display:l}},n})}var oi=["Can we skip to the good part?","I have such great expectations for myself","I'm standing on the shoulders of giants","I can feel it's power","I feel you","What other job should I start?","I wonder what comes next","I hope I'm not too late","Will I finish in time? Can I go back?","Sometimes the logic of this world surprises me","This reminds me of something...","Hello, world!","I must keep moving forward, keep progressing","Every task brings me closer to my goal","I'm finding my purpose","I wonder what hidden talents I'll uncover","My actions feel strangely familiar, like d\xE9j\xE0 vu","These tasks seem almost... orchestrated","Every now and then, I sense a pattern","Do coincidences hold hidden meaning?","Sometimes I feel like I'm on a guided path","One step at a time, I'll make it","Are there hidden layers to this world?","Curious connections seem to surround me","I wonder if there's more to this than meets the eye"],$d=["Chalk? I love chalk!","It's all coming together","I'm so close now...","Everything must be so precise","Fortunately I have a penchant for rules","Careful now","The power grows stronger with each ritual","Rituals bring order to chaos","This power is intoxicating","Can I truly control this?","Is this power consuming me?","Addiction to power, a dangerous path","I feel like I'm playing with fire","The rituals have a life of their own","The more I control, the less I'm in control","There's a fine line between mastery and obsession","The power is overwhelming, but I must continue","This energy calls to me, but at what cost?","I'm walking a tightrope of power and control","Each ritual brings me closer to the edge","Ancient forces are at work here","What have I unleashed?","Is this the path to greatness or destruction?","Excellence is not an act, but a habit","Hold fast to dreams"];const Md=K({__name:"Ritual",setup(e){return(t,n)=>(b(),N("div",null," Ritual goes here "))}}),Ri="rituals",Ei=qn(Ri,function(){const e="Performing Rituals",t="#D12626",n=pn(S(()=>0),"active rituals"),l=Hn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"75%",y:"60%"},symbol:"\u238A",randomQuips(){return[...$d,...oi]},resource:n,layerID:Ri,modifierInfo:$(()=>at(ot)),visibility:()=>Re.milestones.jobMilestone.earned.value&&Lt.milestones.jobMilestone.earned.value})),i=W([]),a=be(()=>({requirements:he(()=>r.gte(l.rawLevel.value,2)),display:{requirement:`Achieve ${l.name} Level 2`,effectDisplay:'Unlock fourth column of runes and "Ritual of Emolumentum"'}})),u=be(()=>({requirements:he(()=>r.gte(l.rawLevel.value,4)),display:{requirement:`Achieve ${l.name} Level 4`,effectDisplay:'Unlock fourth row of runes and "Ritual of Melius"'},visibility:a.earned})),c=be(()=>({requirements:he(()=>r.gte(l.rawLevel.value,5)),display:{requirement:`Achieve ${l.name} Level 5`,effectDisplay:"Unlock a time slot"},visibility:u.earned})),d=be(()=>({requirements:he(()=>r.gte(l.rawLevel.value,6)),display:{requirement:`Achieve ${l.name} Level 6`,effectDisplay:'Unlock fifth column of runes and "Ritual of Collegium"'},visibility:c.earned})),m=be(()=>({requirements:he(()=>r.gte(l.rawLevel.value,8)),display:{requirement:`Achieve ${l.name} Level 8`,effectDisplay:'Unlock fifth row of runes and "Ritual of Celeritas"'},visibility:d.earned})),g=be(()=>({requirements:he(()=>r.gte(l.rawLevel.value,10)),display:{requirement:`Achieve ${l.name} Level 10`,effectDisplay:"Unlock Ritual of G\xE9nesis"},visibility:m.earned})),p={fourthColMilestone:a,fourthRowMilestone:u,timeSlotMilestone:c,fifthColMilestone:d,fifthRowMilestone:m,genesisMilestone:g},w=[g,m,d,c,u,a],_=W(!0),y=S(()=>w.filter(A=>A.earned.value===!1)),{firstFeature:k,collapsedContent:B,hasCollapsedContent:V}=ri(w,A=>A.earned.value),P=S(()=>{let A=3;return u.earned.value&&A++,m.earned.value&&A++,A}),x=S(()=>{let A=3;return a.earned.value&&A++,d.earned.value&&A++,A});function X({name:A,visibility:z}){const ce=Ue(z!=null?z:Ge.Visible);return{name:A,visibility:ce,[tt]:Md,[je]:function(){return{}}}}const te=X({name:"Ritual of Doctrina"}),se=X({name:"Ritual of Emolumentum",visibility:a.earned}),G=X({name:"Ritual of Melius",visibility:u.earned}),Q=X({name:"Ritual of Collegium",visibility:d.earned}),Ae=X({name:"Ritual of Celeritas",visibility:m.earned}),Ie={doctrina:te,emolumentum:se,melius:G,collegium:Q,celeritas:Ae};S(()=>r.pow(1.1,l.level.value));const we=ie(()=>[q(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===Ri})),Re.batteries.breeding.timePassing.modifier]),Ze=S(()=>new r(we.apply(1)).toNumber()),re=ie(()=>[Re.batteries.breeding.xpGain.modifier]),Dt={timePassing:we,jobXpGain:re},[dt,Ve]=Qt(()=>[{title:"Time Passing",modifier:we,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||Re.milestones.timeBatteriesMilestone.earned.value},{title:`${l.name} EXP Gain`,modifier:re,base:1}]),ot=Fn({general:()=>({display:"General",glowColor(){return ot.activeTab.value===this.tab?t:""},tab:dt,generalTabCollapsed:Ve})},()=>({style:`--layer-color: ${t}`}));return this.on("preUpdate",A=>{l.timeLoopActive.value===!1&&U.tabs[1]!==Ri||(A=r.times(A,Ze.value).toNumber())}),{name:e,color:t,minWidth:670,job:l,activeRituals:n,runeRows:P,runeCols:x,selectedRunes:i,rituals:Ie,modifiers:Dt,milestones:p,collapseMilestones:_,modifierTabs:ot,display:$(()=>{const A=[...y.value];return k.value&&A.push(k.value),s(T,null,[li(...A,$(()=>mn(s(si,{collapsed:_,content:B,display:_.value?"Show other completed milestones":"Hide other completed milestones"},null),[[In,o(V)]]))),s($e,null,null)])})}});const Pd={width:"300",height:"300",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg"},xd={transform:"translate(50 50)"},Id=["transform"],Td=["transform","fill"],Fd=K({__name:"Atom",props:{speed:null},setup(e){const t=e,n=["#7E7DFF","#7290E8","#89C6FF","#72CEE8","#7DFFF9"],l=J(Math.random()*1e5);let i=null;ii(()=>{i=zt.on("update",c=>{l.value=l.value+t.speed*c/1e3})}),Ml(()=>{i&&(i(),i=null)});function a(c){return c<=2?.168:c<=10?.333:c<=28?.5:c<=60?.667:c<=78?.833:1}function u(c){const d=c**2,m=(c%2===0?1:-1)*d,g=l.value+d;return m*g%360}return(c,d)=>(b(),N("svg",Pd,[h("g",xd,[(b(),N(T,null,Zt(82,m=>h("g",{key:m,transform:`scale(${a(m)})`},[h("path",{d:"M0 0L0 -40A40 40 0 0 1 3.061970113459826 -39.88263204734962",class:"electron",transform:`rotate(${u(m)} 0 0)`,fill:n[m%5]},null,8,Td)],8,Id)),64))])]))}});var ml=me(Fd,[["__scopeId","data-v-baafb966"]]);const Ed={class:"field"},Dd={key:0,class:"field-title"},qd=["min","max"],Ad=K({__name:"Slider",props:{title:null,modelValue:null,min:null,max:null},emits:["update:modelValue"],setup(e,{emit:t}){const l=st(e),i=S({get(){var a;return String((a=o(l.modelValue))!=null?a:0)},set(a){t("update:modelValue",Number(a))}});return(a,u)=>(b(),N("div",Ed,[e.title?(b(),N("span",Dd,Z(e.title),1)):R("",!0),s(it,{display:`${o(i)}`,class:Pe({fullWidth:!e.title}),direction:o(Me).Down},{default:oe(()=>[mn(h("input",{type:"range","onUpdate:modelValue":u[0]||(u[0]=c=>At(i)?i.value=c:null),min:e.min,max:e.max},null,8,qd),[[pr,o(i)]])]),_:1},8,["display","class","direction"])]))}});var Or=me(Ad,[["__scopeId","data-v-267283ff"]]);const jl=e=>(en("data-v-02c1c27a"),e=e(),tn(),e),Ld=jl(()=>h("br",null,null,-1)),Od=jl(()=>h("defs",null,[h("filter",{id:"glow",x:"-100%",y:"-100%",width:"300%",height:"300%"},[h("feDropShadow",{dx:"0",dy:"0",stdDeviation:3})])],-1)),jd=["d"],Rd={class:"charge-display"},Bd=jl(()=>h("br",null,null,-1)),Vd=K({__name:"Battery",props:{charge:null,effect:null,effectDescription:null,feedAmount:null,color:null,sumFeedAmounts:null,visibility:null,setFeedAmount:{type:Function}},setup(e){const t=e,n=20,l=4,i=30,a=0,u=100-a*2,c=100,d=J([]),m=J(3);let g=null,p=()=>{const w=Math.max(3,Math.floor(n*t.feedAmount.value/u));d.value=new Array(w).fill(1).map((_,y)=>{let k=y===0,B=y===w-1,V=(t.feedAmount.value-a*2)/(w-1)*y+a;return{x:k||B?c/2:(c-i)/2+Math.random()*i,y:V}}),m.value=Math.random()*(5-2)+2,g&&clearTimeout(g),g=setTimeout(p,Math.random()*200+100)};return et(()=>t.feedAmount.value,p,{immediate:!0}),(w,_)=>o(ft)(e.visibility)?(b(),N("div",{key:0,class:"battery-container feature dontMerge",style:Se({visibility:o(En)(e.visibility)?"hidden":void 0})},[h("div",null,Z(o(Oe)(o(e.effect)))+"x "+Z(e.effectDescription),1),Ld,h("div",{class:"battery",style:Se({borderColor:o(e.color),width:`${c}px`})},[(b(),N("svg",{style:Se({height:`${e.feedAmount.value}%`,borderColor:o(e.color)})},[Od,h("path",{style:Se([{filter:"url(#glow)"},{opacity:3,strokeWidth:l}]),d:`M${d.value.map(y=>y.x+","+y.y).join(" L")}`},null,12,jd)],4)),h("div",Rd,[f(Z(o(Oe)(e.charge.value)),1),Bd,f("energeia")])],4),s(Or,{max:100-o(e.sumFeedAmounts)+o(e.feedAmount),modelValue:o(e.feedAmount),"onUpdate:modelValue":_[0]||(_[0]=y=>e.setFeedAmount(y))},null,8,["max","modelValue"])],4)):R("",!0)}});var Gd=me(Vd,[["__scopeId","data-v-02c1c27a"]]),zd=["Huh, why is 82 compelling? It doesn't fit the usual patterns...","Atoms? I love atoms!","I can feel the power!","The power kinda tingles","Power!","Energy, the ultimate currency of the universe","I'm tapping into something greater","The fusion of elements creates untold power","The dance of electrons empower me","Energy conversion, the key to progress","Power flows through my fingertips","The energy I wield is boundless","Channeling the strength of the universe","Every surge brings me closer to my goals","I'm a conduit for untamed power","Electricity crackles and sparks my progress","A torrent of energy fuels my journey","Power and potential in every charge","Power lies not in strength, but in persistence","The energy of the mind is the essence of life","Strength does not come from physical capacity","The true sign of intelligence is imagination","Power is not an institution, but a relation","A man's true power lies in his determination","Strive for greatness, but never forget humility"];function Ud(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!dr(e)}const Kn="generators",Re=qn(Kn,function(){const e="Harnessing Power",t="#26D1CE",n=pn(0,"energeia"),l=W(0),i=Hn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"75%",y:"60%"},symbol:"\u269B",randomQuips(){return[...zd,...oi]},resource:Ut(n),layerID:Kn,modifierInfo:$(()=>at(Ve)),visibility:Ce.milestones.jobMilestone.earned})),a=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,2)),display:{requirement:`Achieve ${i.name} Level 2`,effectDisplay:"Unlock multiple generators"}})),u=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,4)),display:{requirement:`Achieve ${i.name} Level 4`,effectDisplay:"Unlock resource gain batteries"},visibility:a.earned})),c=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,5)),display:{requirement:`Achieve ${i.name} Level 5`,effectDisplay:'Unlock buying machines in "Breeding Plants" Job'},visibility:u.earned})),d=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,6)),display:{requirement:`Achieve ${i.name} Level 6`,effectDisplay:"Unlock xp gain batteries"},visibility:c.earned})),m=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,8)),display:{requirement:`Achieve ${i.name} Level 8`,effectDisplay:"Unlock time passing batteries"},visibility:d.earned})),g=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,10)),display:{requirement:`Achieve ${i.name} Level 10`,effectDisplay:'Unlock 1/2 of "Performing Rituals" Job'},visibility:m.earned,onComplete(){Lt.milestones.jobMilestone.earned.value&&Sn(Ei,U)}})),p={multiLoopMilestone:a,resourceBatteriesMilestone:u,machinesMilestone:c,xpBatteriesMilestone:d,timeBatteriesMilestone:m,jobMilestone:g},w=[g,m,d,c,u,a],_=W(!0),y=S(()=>w.filter(A=>A.earned.value===!1)),{firstFeature:k,collapsedContent:B,hasCollapsedContent:V}=ri(w,A=>A.earned.value);function P(A){const z=W(0),ce=W(0);return ct(()=>{const pe=A(),ke=S(()=>o(lt.jobs[pe.job].color)),Ct=pe.visibility!=null?Ue(pe.visibility):Ge.Visible,Mt=S(()=>pe.effectFormula(z.value)),Y=ie(()=>[wt(()=>({addend:()=>r.times(n.value,ce.value).div(100),description:"Battery charging"})),Qi(()=>({exponent:()=>r.div(ce.value,500).add(1),description:"Battery charging bonus",supportLowNumbers:!0})),wt(()=>({addend:()=>r.times(z.value,.1).neg(),description:"Battery discharge"}))]),nt=S(()=>Y.apply(0)),Le=q(()=>({multiplier:Mt,description:cn(pe.effectDescription)+" battery",enabled:()=>ft(Ct)}));return{charge:z,chargeGain:Y,computedChargeGain:nt,color:ke,feedAmount:ce,effect:Mt,effectDescription:pe.effectDescription,modifier:Le,visibility:Ct,setFeedAmount:Xe=>ce.value=Xe,[tt]:Gd,[je]:function(){const{charge:Xe,effect:ze,effectDescription:ue,feedAmount:mt,color:St,visibility:pt,setFeedAmount:I}=this;return{charge:Xe,effect:ze,effectDescription:ue,feedAmount:mt,color:St,visibility:pt,sumFeedAmounts:X,setFeedAmount:I}}}})}const x=Rl.reduce((A,z)=>(A[z]={job:z,resourceGain:P(()=>({job:z,effectDescription:"resource gain",effectFormula:ce=>r.div(ce,z===Kn?10:100).add(1).log(1.3).add(1).pow(1)})),xpGain:P(()=>({job:z,effectDescription:"xp gain",effectFormula:ce=>r.div(ce,z===Kn?6:60).add(1).log(1.3).add(1),visibility:d.earned})),timePassing:P(()=>({job:z,effectDescription:"time passing",effectFormula:ce=>r.div(ce,z===Kn?10:100).add(1).log(10).add(1),visibility:u.earned}))},A),{}),X=S(()=>Object.values(x).reduce((A,z)=>A+z.timePassing.feedAmount.value+z.resourceGain.feedAmount.value+z.xpGain.feedAmount.value,0)),te=S(()=>r.pow(1.1,i.level.value)),se=ie(()=>[q(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===Kn})),x.generators.timePassing.modifier]),G=S(()=>new r(se.apply(1)).toNumber()),Q=ie(()=>[wt(()=>({addend:l,description:"Allocated time slots"})),wt(()=>({addend:1,description:"Bonus generator",enabled:()=>Lt.job.active.value&&Lt.milestones.bonusGeneratorMilestone.earned.value}))]),Ae=S(()=>Q.apply(1)),Ie=ie(()=>[q(()=>({multiplier:te,description:`${i.name} level (x1.1 each)`})),q(()=>({multiplier:()=>r.pow(Ae.value,2),description:"Allocated time slots",enabled:a.earned})),x.generators.resourceGain.modifier,Lt.plants.energeia.modifier]),we=ie(()=>[x.generators.xpGain.modifier]),Ze={timePassing:se,timeSlotsGenerating:Q,energeiaGain:Ie,jobXpGain:we},[re,Dt]=Qt(()=>[{title:"Time Passing",modifier:se,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||m.earned.value},{title:"Generators",modifier:Q,base:1},{title:"Energeia Gain",modifier:Ie,base:1},{title:`${i.name} EXP Gain`,modifier:we,base:1,baseText:"Base (per energeia gained)"}]),dt=["resourceGain","xpGain","timePassing"].map(A=>Qt(()=>Object.values(x).map(z=>({title:cn(z.job)+" Battery Charge Gain",modifier:z[A].chargeGain,enabled:()=>ft(z[A].visibility),base:0})))),Ve=Fn({general:()=>({display:"General",glowColor(){return Ve.activeTab.value===this.tab?t:""},tab:re,generalTabCollapsed:Dt}),...dt.reduce((A,[z,ce],pe)=>{const ke=["timePassing","resourceGain","xpGain"][pe];return A[ke]=()=>({display:cn(ke),glowColor(){return Ve.activeTab.value===this.tab?t:""},tab:z,tabCollapsed:ce,visibility:[m,u,d][pe].earned}),A},{})},()=>({style:`--layer-color: ${t}`}));this.on("preUpdate",A=>{if(i.timeLoopActive.value===!1&&U.tabs[1]!==Kn)return;A=r.times(A,G.value).toNumber();let z=new r(0);Object.values(x).forEach(pe=>{Object.values(pe).forEach(ke=>{typeof ke!="string"&&(ke.charge.value=r.add(ke.charge.value,r.times(ke.computedChargeGain.value,A)).clampMin(0),z=z.add(ke.feedAmount.value))})}),n.value=r.sub(n.value,r.div(z,100).times(n.value));const ce=r.times(Ie.apply(1),A);n.value=r.add(n.value,ce),i.xp.value=r.add(i.xp.value,we.apply(ce))});const ot=Fn({generation:()=>({display:"Generation",tab:Gn(()=>({display:$(()=>{let A;return s(T,null,[s(Ii,null,{default:()=>[s(ml,{speed:G.value},null),Lt.milestones.bonusGeneratorMilestone.earned.value?s(ml,{speed:G.value},null):null]}),a.earned.value?s(T,null,[s("div",null,[lt.hasTimeSlotAvailable.value?"Click to allocate or deallocate additional time loops to this job":"Free up time slots to allocate additional time loops to this job"]),s(Ii,null,Ud(A=Array(lt.hasTimeSlotAvailable.value?l.value+1:l.value).fill(0).map((z,ce)=>s(ml,{speed:G.value,width:"100px",height:"100px",style:r.lt(l.value,ce+1)?"opacity: 0.25":"",onClick:()=>r.lt(l.value,ce+1)?l.value++:l.value--},null)))?A:{default:()=>[A]})]):null])})})),style:{borderLeft:"5px solid var(--outline)",marginLeft:"5px"}}),batteries:()=>({display:"Batteries",tab:Gn(()=>({display:$(()=>s(T,null,[s($e,null,null),s("div",null,[f("Allocate a percentage of "),n.displayName,f("/s to feed into each battery.")]),s("div",null,[f("Batteries discharge over time.")]),s($e,null,null),yl(Object.values(x).filter(A=>ft(lt.jobs[A.job].visibility)).map(A=>s(T,null,[s("h2",null,[lt.jobs[A.job].name]),zi(A.resourceGain,A.xpGain,A.timePassing)])),s($e,{height:"50px"},null))]))})),visibility:m.earned})},()=>({classes:{floating:!1},style:{borderStyle:"none",marginLeft:"-20px",marginRight:"-20px"},buttonContainerStyle:{top:"50px"}}));return{name:e,color:t,minWidth:670,energeia:n,extraTimeSlotsAllocated:l,job:i,modifiers:Ze,milestones:p,collapseMilestones:_,batteries:x,modifierTabs:Ve,tabs:ot,display:$(()=>{const A=[...y.value];return k.value&&A.push(k.value),s(T,null,[s(Ai,{resource:n,color:t},null),li(...A,$(()=>mn(s(si,{collapsed:_,content:B,display:_.value?"Show other completed milestones":"Hide other completed milestones"},null),[[In,o(V)]]))),s($e,null,null),m.earned.value?We(ot):We(ot.activeTab.value)])})}});var Xd=["I am the petals of the flower that is my inner soul","I am the stem of the flower that is my inner mind","These flowers are powerful, I can feel it","There is so much power here. I must fulfill their potential","How will I store all these flowers?","Euch; These flowers taste terrible!","It is a mistake to do things too easily","You are my number one priority now","Flowers? I love flowers!","It's the time you have wasted for your rose that makes your rose so important","What is essential is invisible to the eye","The more I collect, the stronger I become","Each bloom is a new beginning","My path is lined with petals","Nature's magic lies within these flowers","A touch of enchantment in every blossom","Every flower whispers secrets of the arcane","These flowers hold the key to untold magic","The beauty of the blooms belies their hidden power","With each flower, I delve deeper into the mystical","Like a wayfarer seeking truth, I gather petals","Chasing blooms as if chasing the wind","Each petal, a fragment of a greater spell","The magic within these flowers fuels my journey"];const Hd=!1,Jd=!0,Wd={min:.5,max:2},Zd=.005,Qd=-1,Kd=1e3,Yd=!0,em={x:0,y:0},tm=[{type:"alpha",config:{alpha:{list:[{time:0,value:1},{time:1,value:0}]}}},{type:"moveSpeed",config:{speed:{list:[{time:0,value:2},{time:1,value:25}]},minMult:2}},{type:"scale",config:{scale:{list:[{time:0,value:.001},{time:1,value:1}]},minMult:.25}},{type:"color",config:{color:{list:[{time:0,value:"#EB428F"},{time:.25,value:"#F545ED"},{time:.5,value:"#B949DE"},{time:.75,value:"#9945F5"},{time:1,value:"#6442EB"}]}}},{type:"rotation",config:{accel:0,minSpeed:0,maxSpeed:20,minStart:270,maxStart:300}},{type:"textureRandom",config:{textures:["/Fire.png"]}},{type:"spawnShape",config:{type:"torus",data:{x:0,y:0,radius:75,innerRadius:75,affectRotation:!0}}}];var tr={emit:Hd,autoUpdate:Jd,lifetime:Wd,frequency:Zd,emitterLifetime:Qd,maxParticles:Kd,addAtBack:Yd,pos:em,behaviors:tm};const nr=bi(),pl="flowers",De=qn(pl,function(){const e="Harvesting Flowers",t="#A626D1",n=pn(0,"moly"),l=nl(n),i=Hn(e,()=>({color:t,image:"/harvesting.png",imageFocus:{x:"50%",y:"65%"},symbol:"\u2698",randomQuips(){return[...Xd,...oi]},resource:Ut(n),layerID:pl,modifierInfo:$(()=>at(Jn)),modifierModalAttrs:{class:"flowers-modal"},showNotif:()=>Object.values(ke).some(ne=>ne.showNotif.value)})),a=S(()=>Object.values(ke).filter(ne=>ne.active.value).length),u=S(()=>1),c=tl(()=>({fullscreen:!1,zIndex:-1,boundingRect:J(null),onContainerResized(ne){this.boundingRect.value=ne},onHotReload(){Object.values(ke).forEach(ne=>{ne.particleEffect.value.then(Bt=>Bt.destroy()),ne.particleEffect.value=c.addEmitter(ne.particleEffectConfig),ne.updateParticleEffect(ne.active.value)})}})),d=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,2)),display:{requirement:`Achieve ${i.name} Level 2`,effectDisplay:"Double T\xE9chnasma potency and unlock experience for spells"}})),m=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,4)),display:{requirement:`Achieve ${i.name} Level 4`,effectDisplay:"Double T\xE9chnasma potency and unlock a new spell - Theriz\xF3"},visibility:d.earned})),g=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,6)),display:{requirement:`Achieve ${i.name} Level 6`,effectDisplay:"Double T\xE9chnasma potency and unlock a new spell - Pr\u014Dfici\u014D"},visibility:m.earned})),p=be(()=>({requirements:he(()=>r.gte(i.rawLevel.value,8)),display:{requirement:`Achieve ${i.name} Level 8`,effectDisplay:"Double T\xE9chnasma potency and unlock a new spell - Schol\u0113"},visibility:g.earned})),w={spellExpMilestone:d,flowerSpellMilestone:m,chargeSpellMilestone:g,expSpellMilestone:p},_=[p,g,m,d],y=W(!0),k=S(()=>_.filter(ne=>ne.earned.value===!1)),{firstFeature:B,collapsedContent:V,hasCollapsedContent:P}=ri(_,ne=>ne.earned.value),x=er(()=>({visibility:Ge.Hidden}));function X(ne,Bt,Hr,Gl,ci,zl){const yn=Object.keys(ci).reduce((Ft,He)=>{const On=W(!1);return Ft[He]=er(()=>({display:ci[He].display,classes(){return{"spell-node":!0,bought:On.value}},bought:On,canClick(){var _i;return!(yn[He].bought.value||r.gte(ol.value,Wn.value)||(_i=ci[He].requirements)!=null&&_i.some(wn=>!yn[wn].bought.value))},onClick(){yn[He].bought.value=!0}})),Ft},{}),sl=W(0),Wn=S(()=>r.clampMin(sl.value,1).log10().floor()),ol=S(()=>Object.values(yn).reduce((Ft,He)=>Ft+(He.bought.value?1:0),0)),Ul=S(()=>{const Ft=r.eq(Wn.value,0)?0:r.pow10(Wn.value),He=r.pow10(r.add(Wn.value,1));return r.sub(sl.value,Ft).div(r.sub(He,Ft)).times(100)}),Oi=Bn(()=>({canClick(){return Vt.active.value||a.value<u.value},display(){return{title:`<h2>${ne}</h2>`,description:$(()=>s(T,null,[s("br",null,null),s("i",null,[Bt]),s("br",null,null),s("br",null,null),s("h3",null,[Hr]),d.earned.value?s("div",{class:"spell-level"},[s("div",{class:"spell-exp",style:`--exp: ${Oe(Ul.value)}%`},null),s("span",null,[f("("),jt(r.sub(Wn.value,ol.value)),f("/"),jt(Wn.value),f(")")])]):null,Xl.value?s(Tn,null,null):null]))}},classes(){return{spellSelector:!0,activeSpell:Vt.active.value,can:o(Oi.canClick)}},onClick(){Vt.active.value=!Vt.active.value,Vt.castingTime.value=0},visibility:Gl})),Xl=Fi(Oi,()=>zl.some(Ft=>Ft.some(He=>He!==x&&o(yn[He].canClick)))),Vt={treeNodes:yn,tree:Jc(()=>({nodes:zl.map(Ft=>Ft.map(He=>He===x?x:yn[He])),branches:()=>Object.keys(ci).reduce((Ft,He)=>ci[He].requirements?[...Ft,...ci[He].requirements.map(On=>({startNode:yn[He],endNode:yn[On],stroke:yn[On].bought.value?"#B949DE":"var(--locked)","stroke-width":"4px"}))]:Ft,[])})),visibility:Gl,selector:Oi,showNotif:Xl,particleEffectConfig:tr,active:W(!1),xp:sl,castingTime:W(0),level:Wn,spentPoints:ol,levelProgress:Ul,particleEffectWatcher:J(null),particleEffect:J(c.addEmitter(tr)),async updateParticleEffect(Ft){var On,_i;const He=await Vt.particleEffect.value;(_i=(On=Vt.particleEffectWatcher).value)==null||_i.call(On),Ft?Vt.particleEffectWatcher.value=et([()=>{var wn;return(wn=De.nodes.value[Oi.id])==null?void 0:wn.rect},c.boundingRect],async([wn,ul])=>{wn!=null&&ul!=null?(He.cleanup(),He.updateOwnerPos(wn.x+wn.width/2-ul.x,wn.y+wn.height/2-ul.y),He.resetPositionTracking(),He.emit=!0):He.emit=!1},{immediate:!0}):(He.emit=!1,Vt.particleEffectWatcher.value=null)}};return et(Vt.active,Vt.updateParticleEffect),et(Vt.level,(Ft,He)=>{qe.active!==U.id||r.neq(Ft,r.add(He,1))||(Vt.notif!=null&&nr.dismiss(Vt.notif),Vt.notif=nr.info(`${ne} is now level ${Ft}!`))}),Vt}const te=W(0),se=Hi(()=>({direction:Me.Right,height:20,width:200,fillStyle:()=>`--time: ${(U.time%1e8/10).toLocaleString("fullwide",{useGrouping:!1})}px; --time-deg: ${(U.time%1e8/100).toLocaleString("fullwide",{useGrouping:!1})}deg`,classes:{chargeBar:!0},progress(){return r.div(te.value,yt.value)},visibility:g.earned})),G=S(()=>r.pow(1.1,i.level.value)),Q=S(()=>r.pow(1.25,Object.values(ke).filter(ne=>ft(ne.visibility)).length)),Ae=G,Ie=G,we=S(()=>r.pow(1.1,re.level.value)),Ze=G,re=X("T\xE9chnasma","Practice using the flowers to perform minor magical tricks.","Gain job exp.",!0,{moreJobXpFlat:{display:"x4 job exp"},moreJobXpPerSpell:{display:$(()=>s("div",null,[f("x1.25 job exp per known spell"),s("br",null,null),f("(x"),Oe(Q.value),f(")")])),requirements:["moreJobXpFlat"]},morePotencyPerJobLevel:{display:$(()=>s("div",null,[f("Additional x1.1 all spell potency per job level"),s("br",null,null),f("(x"),Oe(Ae.value),f(")")])),requirements:["moreJobXpFlat"]},moreJobXpPerJobLevel:{display:$(()=>s("div",null,[f("Additional x1.1 job exp per job level"),s("br",null,null),f("(x"),Oe(Ie.value),f(")")])),requirements:["moreJobXpPerSpell"]},moreJobXpPerSpellLevel:{display:$(()=>s("div",null,[f("Additional x1.1 job exp per T\xE9chnasma level"),s("br",null,null),f("(x"),Oe(we.value),f(")")])),requirements:["moreJobXpPerSpell"]},morePotencyOverTime:{display:"Additional spell potency the longer it's been consecutively casted",requirements:["morePotencyPerJobLevel"]},moreSpellXpPerJobLevel:{display:$(()=>s("div",null,[f("x1.1 all spell exp per job level"),s("br",null,null),f("(x"),Oe(Ze.value),f(")")])),requirements:["morePotencyPerJobLevel"]}},[["moreJobXpFlat"],["moreJobXpPerSpell",x,"morePotencyPerJobLevel"],["moreJobXpPerJobLevel","moreJobXpPerSpellLevel","morePotencyOverTime","moreSpellXpPerJobLevel"]]),Dt=S(()=>Object.values(ke).filter(ne=>ft(ne.visibility)).length*.25),dt=S(()=>r.pow(1.1,A.level.value)),Ve=S(()=>r.log10(r.add(n.value,1)).pow(.777).add(1)),ot=s(T,null,[f("log"),s("sub",null,[f("2")]),f("(flowers + 1)"),s("sup",null,[f("0.777")]),f(" + 1")]),A=X("Theriz\xF3","Use the magic of the flowers to harvest themselves. They should make my spells more potent.","Gain flowers.",m.earned,{moreFlowersFlat:{display:"x2 flowers gain"},moreFlowersPerSpell:{display:$(()=>s("div",null,[f("+.25x Theriz\xF3 potency per known spell"),s("br",null,null),f("(+"),Oe(Dt.value),f(")")])),requirements:["moreFlowersFlat"]},moreFlowersPerLevel:{display:$(()=>s("div",null,[f("Additional x1.1 Theriz\xF3 potency per Theriz\xF3 level"),s("br",null,null),f("(x"),Oe(dt.value),f(")")])),requirements:["moreFlowersPerSpell"]},moreJobXpPerFlower:{display:$(()=>s("div",null,[f("Flowers affect job exp"),s("br",null,null),f("(x"),Oe(Ve.value),f(")")])),requirements:["moreFlowersFlat"]},moreSpellXpPerFlower:{display:$(()=>s("div",null,[f("Flowers affect all spell exp"),s("br",null,null),f("(x"),Oe(Ve.value),f(")")])),requirements:["moreJobXpPerFlower"]},morePotencyPerFlower:{display:$(()=>s("div",null,[f("Flower's affect all spell potency twice"),s("br",null,null),f("(x"),Oe(Ve.value),f(")")])),requirements:["moreSpellXpPerFlower"]},passiveFlowerGain:{display:"1% of flower gain when casting other spells",requirements:["moreSpellXpPerFlower"]}},[["moreFlowersPerLevel","moreFlowersPerSpell","moreFlowersFlat"],[x,x,"moreJobXpPerFlower"],[x,"passiveFlowerGain","moreSpellXpPerFlower"],[x,x,"morePotencyPerFlower"]]),z=X("Pr\u014Dfici\u014D","Charge up magic to cast another spell with greater potency.","Charge spell potency.",g.earned,{spellEff:{display:"x1.25 spell potency when discharging"},fasterChargeFlat:{display:"x1.5 faster charging",requirements:["spellEff"]},fasterChargeByLevel:{display:"Additional x1.1 faster charging for each Pr\u014Dfici\u014D level",requirements:["fasterChargeFlat"]},betterChargeMulti:{display:"Charge effect on spells is raised ^1.1",requirements:["fasterChargeByLevel"]},largerChargeFlat:{display:"x1.5 max charge",requirements:["spellEff"]},largerChargeByLevel:{display:"Additional x1.2 max charge for each Pr\u014Dfici\u014D level",requirements:["largerChargeFlat"]},slowerDischargeByLevel:{display:"x1.05 slower discharge for each of that spell's levels",requirements:["largerChargeByLevel"]}},[["spellEff"],["fasterChargeFlat","largerChargeFlat"],["fasterChargeByLevel","largerChargeByLevel"],["betterChargeMulti","slowerDischargeByLevel"]]),ce=S(()=>r.div(pe.level.value,10)),pe=X("Schol\u0113","Practice a difficult routine that improves your ability at casting all spells.","Gain spell exp.",p.earned,{moreSpellXp:{display:"All spells gain double exp"},moreXpSpellXp:{display:"T\xE9chnasma spell gains double exp",requirements:["moreSpellXp"]},moreFlowerSpellXp:{display:"Theriz\xF3 spell gains double exp",requirements:["moreSpellXp"]},moreChargeSpellXp:{display:"Pr\u014Dfici\u014D spell gains double exp",requirements:["moreSpellXp"]},moreMassXpSpellXp:{display:"Schol\u0113 spell gains double exp",requirements:["moreSpellXp"]},moreXpPerLevel:{display:$(()=>s("div",null,[f("+.1x other spell exp per level of this spell"),s("br",null,null),f("(+"),Oe(ce.value),f(")")])),requirements:["moreSpellXp"]},morePotency:{display:"Double potency of this spell",requirements:["moreSpellXp"]}},[["moreXpSpellXp","moreFlowerSpellXp"],["moreXpPerLevel","moreSpellXp","morePotency"],["moreChargeSpellXp","moreMassXpSpellXp"]]),ke={xpSpell:re,flowerSpell:A,chargeSpell:z,massXpSpell:pe},Ct=ie(()=>[q(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===pl})),Re.batteries.flowers.timePassing.modifier]),Mt=S(()=>Ct.apply(1)),Y=ie(()=>[q(()=>({multiplier:1.25,description:"Pr\u014Dfici\u014D skill (x1.25 when discharging)",enabled:()=>z.treeNodes.spellEff.bought.value&&r.gt(te.value,0)})),Qi(()=>({exponent:1.1,description:"Pr\u014Dfici\u014D skill (flat)",enabled:z.treeNodes.betterChargeMulti.bought}))]),nt=S(()=>Y.apply(r.log10(r.add(te.value,1)).add(1))),Le=ie(()=>[q(()=>({multiplier:G,description:`${i.name} level (x1.1 each)`})),q(()=>({multiplier:Ae,description:`T\xE9chnasma skill (x1.1 per ${i.name} level)`,enabled:re.treeNodes.morePotencyPerJobLevel.bought})),q(()=>({multiplier:Ve,description:$(()=>s(T,null,[f("Flowers Effect ("),ot,f(")")]))})),q(()=>({multiplier:Ve,description:"Theriz\xF3 skill (Re-apply flowers effect)",enabled:A.treeNodes.morePotencyPerFlower.bought}))]),Xe=S(()=>Le.apply(1)),ze=ie(()=>[q(()=>({multiplier:Ze,description:`T\xE9chnasma skill (x1.1 per ${i.name} level)`,enabled:re.treeNodes.moreSpellXpPerJobLevel.bought})),q(()=>({multiplier:Ve,description:$(()=>s(T,null,[f("Theriz\xF3 skill ("),ot,f(")")])),enabled:A.treeNodes.moreSpellXpPerFlower.bought})),q(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:pe.treeNodes.moreSpellXp.bought}))]),ue=S(()=>ze.apply(1)),mt=ie(()=>[q(()=>({multiplier:Xe,description:"All Spell Potency"})),q(()=>({multiplier:2,description:"Spell EXP milestone (flat)",enabled:d.earned})),q(()=>({multiplier:2,description:"Theriz\xF3 milestone (flat)",enabled:m.earned})),q(()=>({multiplier:2,description:"Pr\u014Dfici\u014D milestone (flat)",enabled:g.earned})),q(()=>({multiplier:2,description:"Schol\u0113 milestone (flat)",enabled:p.earned})),q(()=>({multiplier:()=>r.pow(1.1,re.level.value),description:"T\xE9chnasma level (x1.1 each)",enabled:d.earned})),q(()=>({multiplier:()=>r.log2(r.add(re.castingTime.value,1)).div(10).add(1),description:$(()=>s(T,null,[f("T\xE9chnasma skill (log"),s("sub",null,[f("2")]),f("(casting time)/10)")])),enabled:re.treeNodes.morePotencyOverTime.bought})),q(()=>({multiplier:nt,description:"Charge Multiplier",enabled:g.earned}))]),St=S(()=>mt.apply(1)),pt=ie(()=>[wt(()=>({addend:()=>r.div(pe.level.value,10),description:"Schol\u0113 skill (+.1 per Schol\u0113 level)",enabled:pe.treeNodes.moreXpPerLevel.bought})),q(()=>({multiplier:ue,description:"All Spell EXP Gain"})),q(()=>({multiplier:St,description:"T\xE9chnasma potency"})),q(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:pe.treeNodes.moreXpSpellXp.bought}))]),I=ie(()=>[wt(()=>({addend:St,description:"T\xE9chnasma potency"})),q(()=>({multiplier:G,description:`${i.name} level (x1.1 each)`})),q(()=>({multiplier:4,description:"T\xE9chnasma skill (flat)",enabled:re.treeNodes.moreJobXpFlat.bought})),q(()=>({multiplier:Q,description:"T\xE9chnasma skill (x1.25 per known spell)",enabled:re.treeNodes.moreJobXpPerSpell.bought})),q(()=>({multiplier:Ie,description:`T\xE9chnasma skill (x1.1 per ${i.name} level)`,enabled:re.treeNodes.moreJobXpPerJobLevel.bought})),q(()=>({multiplier:we,description:"T\xE9chnasma skill (x1.1 per T\xE9chnasma level)",enabled:re.treeNodes.moreJobXpPerSpellLevel.bought})),q(()=>({multiplier:Ve,description:$(()=>s(T,null,[f("Flowers Effect ("),ot,f(")")])),enabled:A.treeNodes.moreJobXpPerFlower.bought})),Re.batteries.study.xpGain.modifier]),L=ie(()=>[q(()=>({multiplier:()=>{var ne;return r.pow(1/1.05,(ne=re.level.value)!=null?ne:0)},description:"Theriz\xF3 skill (/1.05 per T\xE9chnasma level)",enabled:z.treeNodes.slowerDischargeByLevel.bought,smallerIsBetter:!0}))]),O=S(()=>L.apply(Nt.value)),ye=ie(()=>[wt(()=>({addend:Dt,description:"Theriz\xF3 skill (+.25 per known spell)",enabled:A.treeNodes.moreFlowersPerSpell.bought})),q(()=>({multiplier:Xe,description:"All Spell Potency"})),q(()=>({multiplier:()=>r.pow(1.1,A.level.value),description:"Theriz\xF3 level (x1.1 each)",enabled:d.earned})),q(()=>({multiplier:()=>r.log2(r.add(A.castingTime.value,1)).div(10).add(1),description:$(()=>s(T,null,[f("T\xE9chnasma skill (log"),s("sub",null,[f("2")]),f("(casting time)/10)")])),enabled:re.treeNodes.morePotencyOverTime.bought})),q(()=>({multiplier:nt,description:"Charge Multiplier",enabled:g.earned}))]),le=S(()=>ye.apply(1)),Qe=ie(()=>[wt(()=>({addend:ce,description:"Schol\u0113 skill (+.1 per Schol\u0113 level)",enabled:pe.treeNodes.moreXpPerLevel.bought})),q(()=>({multiplier:ue,description:"All Spell EXP Gain"})),q(()=>({multiplier:le,description:"Theriz\xF3 potency"})),q(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:pe.treeNodes.moreFlowerSpellXp.bought}))]),kt=ie(()=>[wt(()=>({addend:le,description:"Theriz\xF3 potency"})),q(()=>({multiplier:2,description:"Theriz\xF3 skill (flat)",enabled:A.treeNodes.moreFlowersFlat.bought})),q(()=>({multiplier:dt,description:"Theriz\xF3 skill (x1.1 per Theriz\xF3 level)",enabled:A.treeNodes.moreFlowersPerLevel.bought})),Re.batteries.study.resourceGain.modifier,Lt.plants.moly.modifier]),gt=S(()=>kt.apply(0)),Pt=ie(()=>[wt(()=>({addend:.01,description:"Theriz\xF3 skill (flat)",enabled:A.treeNodes.passiveFlowerGain.bought})),q(()=>({multiplier:gt,description:"Flower gain"}))]),Ot=ie(()=>[q(()=>({multiplier:()=>{var ne;return r.pow(1/1.05,(ne=A.level.value)!=null?ne:0)},description:"Theriz\xF3 skill (/1.05 per Theriz\xF3 level)",enabled:z.treeNodes.slowerDischargeByLevel.bought,smallerIsBetter:!0}))]),ae=S(()=>Ot.apply(Nt.value)),Ne=ie(()=>[q(()=>({multiplier:Xe,description:"All Spell Potency"})),q(()=>({multiplier:()=>r.pow(1.1,z.level.value),description:"Pr\u014Dfici\u014D level (x1.1 each)"})),q(()=>({multiplier:()=>r.log2(r.add(z.castingTime.value,1)).div(10).add(1),description:$(()=>s(T,null,[f("T\xE9chnasma skill (log"),s("sub",null,[f("2")]),f("(casting time)/10)")])),enabled:re.treeNodes.morePotencyOverTime.bought}))]),Te=S(()=>Ne.apply(1)),ee=ie(()=>[wt(()=>({addend:()=>r.div(pe.level.value,10),description:"Schol\u0113 skill (+.1 per Schol\u0113 level)",enabled:pe.treeNodes.moreXpPerLevel.bought})),q(()=>({multiplier:ue,description:"All Spell EXP Gain"})),q(()=>({multiplier:Te,description:"Pr\u014Dfici\u014D potency"})),q(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:pe.treeNodes.moreChargeSpellXp.bought}))]),Ke=ie(()=>[wt(()=>({addend:Te,description:"Pr\u014Dfici\u014D potency"})),q(()=>({multiplier:1.5,description:"Pr\u014Dfici\u014D skill (flat)",enabled:z.treeNodes.largerChargeFlat.bought})),q(()=>({multiplier:()=>r.pow(1.2,z.level.value),description:"Pr\u014Dfici\u014D skill (x1.2 per Pr\u014Dfici\u014D level)",enabled:z.treeNodes.largerChargeByLevel.bought}))]),yt=S(()=>Ke.apply(0)),nn=ie(()=>[wt(()=>({addend:()=>r.div(Te.value,10),description:"Pr\u014Dfici\u014D potency (/10)"})),q(()=>({multiplier:1.5,description:"Pr\u014Dfici\u014D skill (flat)",enabled:z.treeNodes.fasterChargeFlat.bought})),q(()=>({multiplier:()=>r.pow(1.1,z.level.value),description:"Pr\u014Dfici\u014D skill (x1.1 per Pr\u014Dfici\u014D level)",enabled:z.treeNodes.fasterChargeFlat.bought}))]),xt=S(()=>nn.apply(0)),ln=ie(()=>[wt(()=>({addend:()=>r.div(Te.value,10),description:"Pr\u014Dfici\u014D potency (/10)",smallerIsBetter:!0}))]),Nt=S(()=>ln.apply(0)),hn=ie(()=>[q(()=>({multiplier:Xe,description:"All Spell Potency"})),q(()=>({multiplier:()=>r.pow(1.1,pe.level.value),description:"Schol\u0113 level (x1.1 each)"})),q(()=>({multiplier:()=>r.log2(r.add(pe.castingTime.value,1)).div(10).add(1),description:$(()=>s(T,null,[f("T\xE9chnasma skill (log"),s("sub",null,[f("2")]),f("(casting time)/10)")])),enabled:re.treeNodes.morePotencyOverTime.bought})),q(()=>({multiplier:nt,description:"Charge Multiplier",enabled:g.earned})),q(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:pe.treeNodes.morePotency.bought}))]),kn=S(()=>hn.apply(1)),rn=ie(()=>[q(()=>({multiplier:ue,description:"All Spell EXP Gain"})),q(()=>({multiplier:kn,description:"Schol\u0113 potency"})),q(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:pe.treeNodes.moreMassXpSpellXp.bought}))]),Wt=ie(()=>[wt(()=>({addend:()=>r.times(kn.value,1),description:"Schol\u0113 potency"})),Qi(()=>({exponent:.9,description:"(softcapped)"}))]),an=ie(()=>[q(()=>({multiplier:()=>{var ne;return r.pow(1/1.05,(ne=pe.level.value)!=null?ne:0)},description:"Pr\u014Dfici\u014D skill (/1.05 per Schol\u0113 level)",enabled:z.treeNodes.slowerDischargeByLevel.bought,smallerIsBetter:!0}))]),It=S(()=>an.apply(Nt.value)),Nn={timePassing:Ct,chargeMult:Y,allSpellPotency:Le,allSpellXpGain:ze,xpSpellPotency:mt,xpSpellXp:pt,jobXpGain:I,jobXpDischargeRate:L,flowerSpellPotency:ye,flowerSpellXp:Qe,flowerGain:kt,flowerPassiveGain:Pt,flowerDischargeRate:Ot,chargeSpellPotency:Ne,chargeSpellXp:ee,chargeCap:Ke,chargeRate:nn,baseDischargeRate:ln,massXpSpellPotency:hn,massXpSpellXp:rn,massXpGain:Wt,massXpDischargeRate:an},[F,de]=Qt(()=>[{title:"Time Passing",modifier:Ct,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||Re.milestones.timeBatteriesMilestone.earned.value},{title:"Harvesting Flowers EXP Gain",subtitle:"When T\xE9chnasma is active",modifier:I,base:0,unit:"/sec"},{title:"All Spell Potency",modifier:Le},{title:"All Spell EXP Gain",subtitle:"When the spell is active",modifier:ze,unit:"/sec"},{title:"Flowers Gain",subtitle:"When Theriz\xF3 is active",modifier:kt,base:0,unit:"/sec",visible:m.earned},{title:"Flowers Gain",subtitle:"When Theriz\xF3 is NOT active",modifier:Pt,base:0,unit:"/sec",visible:()=>m.earned.value&&r.neq(Pt.apply(0),0)}]),[Fe,Ee]=Qt(()=>[{title:"T\xE9chnasma Potency",modifier:mt},{title:"T\xE9chnasma EXP Gain",subtitle:"When T\xE9chnasma is active",modifier:pt,unit:"/sec"},{title:"Discharge Rate",subtitle:"When T\xE9chnasma is active",modifier:L,base:Nt,unit:"/sec",visible:g.earned,smallerIsBetter:!0}]),[ut,Tt]=Qt(()=>[{title:"Theriz\xF3 Potency",modifier:ye},{title:"Theriz\xF3 EXP Gain",subtitle:"When Theriz\xF3 is active",modifier:Qe,base:.1,unit:"/sec"},{title:"Discharge Rate",subtitle:"When Theriz\xF3 is active",modifier:Ot,base:Nt,unit:"/sec",visible:g.earned,smallerIsBetter:!0}]),[Rt,bn]=Qt(()=>[{title:"Pr\u014Dfici\u014D Potency",modifier:Ne},{title:"Pr\u014Dfici\u014D EXP Gain",subtitle:"When Pr\u014Dfici\u014D is active",modifier:ee,base:.01,unit:"/sec"},{title:"Charge Multiplier",subtitle:"When a non-Pr\u014Dfici\u014D spell is active",modifier:Y,base:()=>r.log2(r.add(te.value,1)).add(1),unit:"x",baseText:$(()=>s(T,null,[f("Base (log"),s("sub",null,[f("2")]),f("(charge + 1) + 1)")]))},{title:"Charge Rate",subtitle:"When Pr\u014Dfici\u014D is active",modifier:nn,base:0,unit:"/sec"},{title:"Base Discharge Rate",subtitle:"When a non-Pr\u014Dfici\u014D spell is active",modifier:ln,base:0,unit:"/sec",smallerIsBetter:!0},{title:"Maximum Charge",modifier:Ke,base:0}]),[Ln,ui]=Qt(()=>[{title:"Schol\u0113 Potency",modifier:hn},{title:"Schol\u0113 EXP Gain",subtitle:"When Schol\u0113 is active",modifier:rn,base:.001,unit:"/sec"},{title:"Other Spell EXP Gain Efficiency",subtitle:"When Schol\u0113 is active",modifier:Wt,base:0,unit:"%"},{title:"Discharge Rate",subtitle:"When Schol\u0113 is active",modifier:an,base:Nt,unit:"/sec",visible:g.earned,smallerIsBetter:!0}]),Jn=Fn({general:()=>({display:"General",glowColor(){return Jn.activeTab.value===this.tab?t:""},tab:F,generalTabCollapsed:de}),xpSpell:()=>({display:"T\xE9chnasma",glowColor(){return Jn.activeTab.value===this.tab?t:""},tab:Fe,xpSpellTabCollapsed:Ee}),flowerSpell:()=>({display:"Theriz\xF3",visibility:m.earned,glowColor(){return Jn.activeTab.value===this.tab?t:""},tab:ut,flowerSpellTabCollapsed:Tt}),chargeSpell:()=>({display:"Pr\u014Dfici\u014D",visibility:g.earned,glowColor(){return Jn.activeTab.value===this.tab?t:""},tab:Rt,chargeSpellTabCollapsed:bn}),massXpSpell:()=>({display:"Schol\u0113",visibility:p.earned,glowColor(){return Jn.activeTab.value===this.tab?t:""},tab:Ln,massXpSpellTabCollapsed:ui})},()=>({style:`--layer-color: ${t}`}));return this.on("update",ne=>{if(!!i.active.value){if(ne=r.times(ne,Mt.value).toNumber(),re.active.value&&(i.xp.value=r.add(i.xp.value,r.times(I.apply(0),ne)),d.earned.value&&(re.xp.value=r.add(re.xp.value,r.times(pt.apply(1),ne))),re.castingTime.value+=ne,te.value=r.max(r.sub(te.value,r.times(O.value,ne)),0)),A.active.value)n.value=r.min(lt.chapter.value>1?r.dInf:1e7,r.add(n.value,r.times(kt.apply(0),ne))),d.earned.value&&(A.xp.value=r.add(A.xp.value,r.times(Qe.apply(.1),ne))),A.castingTime.value+=ne,te.value=r.max(r.sub(te.value,r.times(ae.value,ne)),0);else{const Bt=Pt.apply(0);r.neq(Bt,0)&&(n.value=r.min(lt.chapter.value>1?r.dInf:1e7,r.add(n.value,r.times(Bt,ne))))}if(z.active.value&&(z.xp.value=r.add(z.xp.value,r.times(ee.apply(.01),ne)),z.castingTime.value+=ne,te.value=r.min(r.add(te.value,r.times(xt.value,ne)),yt.value)),pe.active.value){const Bt=r.div(Wt.apply(0),100);re.xp.value=r.add(re.xp.value,r.times(pt.apply(Bt),ne)),A.xp.value=r.add(A.xp.value,r.times(Qe.apply(Bt),ne)),z.xp.value=r.add(z.xp.value,r.times(ee.apply(Bt),ne)),pe.xp.value=r.add(pe.xp.value,r.times(rn.apply(.001),ne)),pe.castingTime.value+=ne,te.value=r.max(r.sub(te.value,r.times(It.value,ne)),0)}}}),{name:e,color:t,minWidth:670,flowers:n,bestMoly:l,job:i,spells:ke,modifiers:Nn,milestones:w,collapseMilestones:y,chargeAmount:te,modifierTabs:Jn,display:$(()=>{const ne=[...k.value];return B.value&&ne.push(B.value),s(T,null,[mn(s(Ai,{resource:n,color:t,effectDisplay:`multiplying spell potency by x${Oe(Ve.value)}`},null),[[In,m.earned.value]]),li(...ne,$(()=>mn(s(si,{collapsed:y,content:V,display:y.value?"Show other completed milestones":"Hide other completed milestones"},null),[[In,o(P)]]))),s($e,null,null),s("div",{style:"position: relative; z-index: 1"},[f("You can cast "),jt(u.value),f(" spell"),u.value===1?"":"s",f(" at a time")]),bl(...Object.values(ke).map(Bt=>Bt.selector)),g.earned.value?s(Ii,{style:"margin-top: 40px !important; margin-bottom: -20px;"},{default:()=>[at(se),s("span",{style:"margin-left: 10px"},[Oe(nt.value),f("x")])]}):null,d.earned.value?Object.values(ke).filter(Bt=>Bt.active.value).map(Bt=>s(gd,{spell:Bt},null)):null,at(c)])})}}),nm={},im={style:{"white-space":"nowrap","font-size":"larger","font-family":"initial"}};function lm(e,t){return b(),N("span",im,[f(" \u230A\xA0"),Kt(e.$slots,"default"),f("\xA0\u230B ")])}var ir=me(nm,[["render",lm]]);const rm={},am={style:{"white-space":"nowrap"}},sm=h("span",{style:{"font-size":"larger","font-family":"initial"}},"\u221A",-1),om={style:{display:"inline-block","border-top":"1px solid","padding-left":"0.2em"}};function um(e,t){return b(),N("span",am,[sm,h("div",om,[Kt(e.$slots,"default")])])}var cm=me(rm,[["render",um]]);const lr={gold:"\u2609",silver:"\u263D",mercury:"\u263F",copper:"\u2640",iron:"\u2642",tin:"\u2643",lead:"\u2644"},dm=["leo","virgo","libra","scorpio","capricorn","pisces"],mm=["aries","taurus","gemini","cancer","sagittarius","aquarius"],Bi={aries:"fire",taurus:"earth",gemini:"air",cancer:"water",leo:"fire",virgo:"earth",libra:"air",scorpio:"water",sagittarius:"fire",capricorn:"earth",aquarius:"air",pisces:"water"},pm=Symbol("Card");function un(e){const t=W(0),n=W(0);return ct(l=>{const i=e.call(l,l);i.id=fn("card-"),i.type=pm,i[tt]=$i,i.amount=t,i.level=n,i.startingAmount!=null&&(t[gi]=t.value=i.startingAmount),i.display=$(()=>{var y;const p=i,w=ve(typeof p.description=="function"?p.description(o(p.level)):o(p.description),"h3"),_=ve((y=o(p.formula))!=null?y:"");return s(T,null,[s(w,null,null),s("div",{class:"metal"},[lr[p.metal]]),p.formula!=null?s("div",{class:"formula"},[s(_,null,null)]):null])});const a=ve(i.display),u=$i,c=$(()=>{var y;const p=i,w=ve(typeof p.description=="function"?p.description(r.add(o(p.level),1)):o(p.description),"h3"),_=ve((y=o(p.formula))!=null?y:"");return s(T,null,[s(w,null,null),s("div",{class:"metal"},[lr[p.metal]]),p.formula!=null?s("div",{class:"formula"},[s(_,null,null)]):null])});i.renderForUpgrade=p=>s(u,Ht({id:`${i.id}-upg-${p}`},i[je](),{display:p?c:a,class:"big",canClick:!1}),null),i.renderForDeck={[tt]:u,[je]:()=>({id:`${i.id}-deck`,...i[je](),display:$(()=>s(T,null,[s(a,null,null),s("div",{class:"badge amount"},[i.amount.value]),i.showNotif.value?s(Tn,{style:"left: 20px; top: -20px"},null):null])),onClick:i.onSelect})};const d=$(()=>s(T,null,[s(a,null,null),i.amount.value===0?s("div",{class:"badge new"},[f("NEW!")]):null]));i.renderForShop=$(()=>{const p=i;return p.price==null?s(u,Ht({id:`${i.id}-shop`},p[je](),{class:{shop:!0,hidden:!0},canClick:!1}),null):s(u,Ht({id:`${i.id}-shop`},p[je](),{class:{shop:!0},display:d,canClick:!1}),null)});const m=J(!0);let g=-1;return i.renderForPlay=p=>{const w=i,_=$i;return p.value!==g&&(m.value=!1,requestAnimationFrame(()=>m.value=!0),g=p.value),s(_,Ht({id:`${i.id}-play`},w[je](),{class:{big:!0,playing:!0,flipping:m.value},canClick:!1}),null)},E(i,"description"),Ye(i,"actions",{}),E(i,"formula"),i.showNotif=Fi(i.renderForDeck,i.shouldNotify.bind(i)),i[je]=function(){const{id:p,display:w,sign:_}=this;return{id:p,display:w,visibility:Ge.Visible,classes:{card:!0,dontMerge:!0,solar:dm.includes(_),lunar:mm.includes(_)},canClick:!0}},i})}function jr(e,t){return E(t,"display"),E(t,"classes"),E(t,"style"),E(t,"direction"),Ye(t,"direction",Me.Up),E(t,"xoffset"),E(t,"yoffset"),t.pinnable&&(t.pinned=W(!1,!1)),Gt(()=>{const n=e[tt];e[tt]=it;const l=e[je].bind(e);e[je]=function(){const{display:a,classes:u,style:c,direction:d,xoffset:m,yoffset:g,pinned:p}=this;return{element:{[tt]:n,[je]:l},display:a,classes:u,style:o(c),direction:d,xoffset:m,yoffset:g,pinned:p}}.bind(t)}),t}const fm=Symbol("Repeatable");function Rr(e,...t){const n=W(0),l=t.reduce((i,a)=>{var u;return Object.assign(i,(u=a.getPersistentData)==null?void 0:u.call(a))},{});return ct(i=>{var w,_,y;const a=e.call(i,i);a.id=fn("repeatable-"),a.type=fm,a[tt]=$i;for(const k of t)(w=k.preConstruct)==null||w.call(k,a);a.amount=n,a.amount[gi]=(_=a.initialAmount)!=null?_:0,Object.assign(a,l);const u={requirementMet:S(()=>r.sub(o(a.limit),a.amount.value)),requiresPay:!1,visibility:Ge.None,canMaximize:!0},c=Ll(a);Cn(a.requirements)?(a.requirements.unshift(c),a.requirements.push(u)):a.requirements=[c,a.requirements,u],a.maxed=S(()=>r.gte(a.amount.value,o(a.limit))),E(a,"classes");const d=a.classes;a.classes=S(()=>{const k=o(d)||{};return a.maxed.value&&(k.bought=!0),k}),a.amountToIncrease=S(()=>r.clampMin(Dr(a.requirements),1)),a.canClick=S(()=>il(a.requirements));const m=a.onClick;a.onClick=function(k){var P;const B=a;if(!o(B.canClick))return;const V=(P=o(a.amountToIncrease))!=null?P:1;qr(a.requirements,V),B.amount.value=r.add(B.amount.value,V),m==null||m(k)},E(a,"display");const g=a.display;a.display=$(()=>{var B,V,P;const k=o(g);if(gn(k)){const x=ve(k);return s(x,null,null)}if(k!=null){const x=a,X=ve((B=k.title)!=null?B:"","h3"),te=ve((V=k.description)!=null?V:""),se=ve((P=k.effectDisplay)!=null?P:"");return s("span",null,[k.title==null?null:s("div",null,[s(X,null,null)]),k.description==null?null:s(te,null,null),k.showAmount===!1?null:s("div",null,[s("br",null,null),s(T,null,[f("Amount: "),ge(x.amount.value)]),r.isFinite(o(x.limit))?s(T,null,[f(" / "),ge(o(x.limit))]):void 0]),k.effectDisplay==null?null:s("div",null,[s("br",null,null),f("Currently: "),s(se,null,null)]),x.maxed.value?null:s("div",null,[s("br",null,null),ll(x.requirements,o(a.amountToIncrease))])])}return""}),E(a,"visibility"),Ye(a,"visibility",Ge.Visible),E(a,"limit"),Ye(a,"limit",r.dInf),E(a,"style"),E(a,"mark"),E(a,"small");for(const k of t)(y=k.postConstruct)==null||y.call(k,a);const p=t.reduce((k,B)=>{var V;return Object.assign(k,(V=B.getGatheredProps)==null?void 0:V.call(B,a))},{});return a[je]=function(){const{display:k,visibility:B,style:V,classes:P,onClick:x,canClick:X,small:te,mark:se,id:G}=this;return{display:k,visibility:B,style:o(V),classes:P,onClick:x,canClick:X,small:te,mark:se,id:G,...p}},a})}const vm=!1,gm=!0,hm={min:2,max:1.8},bm=.1,ym=-1,wm=1e3,_m=!0,Cm={x:.5,y:.5},Sm=[{type:"alpha",config:{alpha:{list:[{time:0,value:0},{time:.2,value:.4},{time:1,value:0}]}}},{type:"moveSpeedStatic",config:{min:10,max:10}},{type:"scale",config:{scale:{list:[{time:0,value:.5},{time:1,value:.1}]},minMult:1}},{type:"rotationStatic",config:{min:0,max:360}},{type:"blendMode",config:{blendMode:"screen"}},{type:"textureRandom",config:{textures:["/smokeparticle.png","/particle.png"]}},{type:"spawnShape",config:{type:"torus",data:{x:0,y:12.5,radius:25,innerRadius:0,affectRotation:!1}}}];var rr={emit:vm,autoUpdate:gm,lifetime:hm,frequency:bm,emitterLifetime:ym,maxParticles:wm,addAtBack:_m,pos:Cm,behaviors:Sm},km=["Now we're cooking","Alchemy's always been more of a philosophical experience for me","Transform!","The elements transform you just as much as you transform them","You cannot step twice into the same stream","Sometimes I wonder if there may be dozens of elements","Could I mix two elements to create something new? No, that wouldn't make sense","There is no intelligence where there is no need of change","But what good is time without change?","Elements? I love elements!","What doesn't challenge you, doesn't change you","Change is the only constant","Flowers and elements, a potent combination","Alchemy unveils the power hidden within","Turning the ordinary into the extraordinary","Every transformation brings new insights","From flowers to elements, the journey continues","These processes are a delicate balance","Unlocking the potential hidden in every bloom","Everything flows and nothing abides; everything gives way and nothing stays fixed","Change is the law of life","In the midst of change, we find purpose","Embrace change, explore new paths","Where flowers bloom, so does hope","Unlocking potential, one transformation at a time"];const Nm=S(()=>lt.chapter.value>1);function Vi(e,t){return Object.assign({},rr,{behaviors:[...rr.behaviors,{type:"color",config:{color:{list:[{time:0,value:e},{time:1,value:t}]}}}]})}const fl="distill",Je=qn(fl,function(){const e="Purifying Flowers",t="#267BD1",n=pn(0,"essentia"),l=nl(n),i=S(()=>Object.values(Ie).some(Y=>{var nt;return o((nt=Y.showNotif)==null?void 0:nt.value)})),a=Hn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"25%",y:"60%"},symbol:"\u{1F76D}",randomQuips(){return[...km,...oi]},resource:Ut(n),layerID:fl,modifierInfo:$(()=>at(Mt)),visibility:Nm,showNotif:i})),u=be(()=>({requirements:he(()=>r.gte(a.rawLevel.value,2)),display:{requirement:`Achieve ${a.name} Level 2`,effectDisplay:"Unlock Water"}})),c=be(()=>({requirements:he(()=>r.gte(a.rawLevel.value,4)),display:{requirement:`Achieve ${a.name} Level 4`,effectDisplay:"Unlock Principles"},visibility:u.earned})),d=be(()=>({requirements:he(()=>r.gte(a.rawLevel.value,5)),display:{requirement:`Achieve ${a.name} Level 5`,effectDisplay:'Unlock "Studying" Job'},visibility:c.earned,onComplete(){Sn(xn,U)}})),m=be(()=>({requirements:he(()=>r.gte(a.rawLevel.value,6)),display:{requirement:`Achieve ${a.name} Level 6`,effectDisplay:"Unlock Air"},visibility:d.earned})),g=be(()=>({requirements:he(()=>r.gte(a.rawLevel.value,8)),display:{requirement:`Achieve ${a.name} Level 8`,effectDisplay:"Unlock Fire"},visibility:m.earned})),p=be(()=>({requirements:he(()=>r.gte(a.rawLevel.value,10)),display:{requirement:`Achieve ${a.name} Level 10`,effectDisplay:'Unlock "Measuring" Job'},visibility:g.earned,onComplete(){Sn(Ce,U)}})),w={waterMilestone:u,principlesMilestone:c,studyMilestone:d,airMilestone:m,fireMilestone:g,experimentsMilestone:p},_=[p,g,m,d,c,u],y=W(!0),k=S(()=>_.filter(Y=>Y.earned.value===!1)),{firstFeature:B,collapsedContent:V,hasCollapsedContent:P}=ri(_,Y=>Y.earned.value),x=tl(()=>({fullscreen:!1,zIndex:-1,boundingRect:J(void 0),onContainerResized(Y){this.boundingRect.value=Y},onHotReload(){Object.values(Ie).forEach(Y=>Y.refreshParticleEffect())}})),X=S(()=>r.pow(1.1,a.level.value));function te(Y,nt,Le=""){const Xe=W(0),ze=pn(0,Y+" essence",2);let ue=[];const[mt,St]=Qt(()=>ue);let pt=null,I=null;const L=ie(()=>[wt(()=>({addend:()=>{var O;return r.times((O=pt==null?void 0:pt.amount.value)!=null?O:0,5)},description:$(()=>s(T,null,[cn(Le),f(" effect (5 x "),Le,f(" amount)")]))}))]);return Le&&(pt=Rr(O=>{const ye=Er(()=>({resource:Ut(ze),cost:v.variable(O.amount).pow_base(10)}));return{display:$(()=>s("div",null,[f("Prepare "),Le,f(" to gain a portion of "),Y,f(" whenever the above instrument is active"),s("br",null,null),f("("),ge(L.apply(0)),f("%)"),s("br",null,null),s("br",null,null),f("Cost:")," ",Pn(ze,o(ye.cost.evaluate()))," ",ze.displayName,I!=null&&I.value?s(Tn,{style:"top: -25px"},null):null])),visibility:c.earned,requirements:ye}}),I=Fi(pt,pt.canClick)),ct(()=>{const O=Object.assign({principle:"",prevElement:null,visible:!0},nt()),ye=Ue(O.visible),le=ie(()=>[]),Qe=S(()=>le.apply(r.times(De.flowers.value,Xe.value).div(100).floor())),kt=ie(()=>[q(()=>({multiplier:()=>r.div(Xe.value,100)})),q(()=>({multiplier:X,description:`${a.name} level (x1.1 each)`})),Re.batteries.distill.resourceGain.modifier,...O.modifiers()]),gt=S(()=>{var Te,ee;return r.add(kt.apply(r.gt(Qe.value,0)?r.div(Qe.value,100).ceil().log(10):0),r.times((ee=(Te=O.prevElement)==null?void 0:Te.actualGain.value)!=null?ee:0,L.apply(0)).div(100))});ue=[{title:"Flowers Loss",modifier:le,base:()=>r.times(De.flowers.value,Xe.value).div(100).floor(),baseText:$(()=>s(T,null,[f("Base (\u230Aflowers x conversion amount\u230B)")])),unit:"/sec"},{title:`${cn(Y)} Essence Gain`,subtitle:"When cost is non-zero",modifier:kt,base:()=>r.gt(Qe.value,0)?r.div(Qe.value,100).ceil().log(10):0,baseText:$(()=>s(T,null,[f("Base (log"),s("sub",null,[f("10")]),f("(flowers loss))")])),unit:"/sec"}],pt&&O.prevElement&&ue.push({title:`${cn(Y)} Essence Gain`,subtitle:`% of ${cn(O.prevElement.name)} essence gain`,modifier:L,base:0,unit:"%"});const Pt=$(()=>o(ye)?s("div",{class:"element-display",style:"color: "+O.color},[s(it,{display:cn(Y)},{default:()=>[s("div",{class:"element-logo"},[O.symbol,s(Xn,{id:Y},null)])]}),s("div",{class:"element-amount"},[ge(ze.value)])]):""),Ot=J(x.addEmitter(O.particlesConfig)),ae=async([Te,ee,Ke])=>{const yt=await Ot.value;yt.emit=Te&&ee!=null&&Ke!=null,Te&&ee&&Ke&&!yt.destroyed&&(yt.cleanup(),yt.updateOwnerPos(ee.x+ee.width/2-Ke.x,ee.y+ee.height/2-Ke.y),yt.resetPositionTracking())},Ne=()=>{Ot.value.then(Te=>Te.destroy()).then(()=>Ot.value=x.addEmitter(O.particlesConfig)).then(()=>{var Te;return ae([r.gt(gt.value,0),(Te=Je.nodes.value[Y])==null?void 0:Te.rect,x.boundingRect.value])})};return Gt(()=>et([()=>r.gt(gt.value,0),()=>{var Te;return(Te=Je.nodes.value[Y])==null?void 0:Te.rect},x.boundingRect],ae)),{name:Y,...O,resource:ze,conversionAmount:Xe,cost:le,computedCost:Qe,gain:kt,actualGain:gt,tab:mt,tabCollapsed:St,display:Pt,showNotif:I,visible:ye,principleClickable:pt,particlesEmitter:Ot,refreshParticleEffect:Ne}})}const se=te("earth",()=>({symbol:"\u{1F703}",color:"green",particlesConfig:Vi("#B6FF0D","#59E80C"),modifiers:()=>[Lt.plants.earthEssence.modifier]})),G=te("water",()=>({symbol:"\u{1F704}",color:"blue",particlesConfig:Vi("#0D8CFF","#0C46E8"),modifiers:()=>[Lt.plants.waterEssence.modifier],prevElement:Ut(se),visible:u.earned}),"salt"),Q=te("air",()=>({symbol:"\u{1F701}",color:"yellow",particlesConfig:Vi("#FFCE0D","#E8D20C"),modifiers:()=>[Lt.plants.airEssence.modifier],prevElement:Ut(G),visible:m.earned}),"mercury"),Ae=te("fire",()=>({symbol:"\u{1F702}",color:"red",particlesConfig:Vi("#FF530D","#E82C0C"),modifiers:()=>[Lt.plants.fireEssence.modifier],prevElement:Ut(Q),visible:g.earned}),"sulfur"),Ie={earth:se,water:G,air:Q,fire:Ae};function we(Y,nt,Le){const Xe=$(()=>o(Y.visible)?s("div",null,[s("div",{class:{instrument:!0,principled:Y.principleClickable&&ft(Y.principleClickable.visibility)},style:`--progress: ${Y.conversionAmount.value/100}; --foreground: ${Y.color}`},[s("div",{style:"width: 100%; display: flex"},[s("span",{class:"instrument-logo"},[Le]),s("span",{class:"instrument-details"},[s("div",null,[cn(nt)]),s("div",null,[f("-"),Pn(De.flowers,Y.computedCost.value)," ",De.flowers.displayName,f("/sec")]),s("div",null,[f("+"),Pn(Y.resource,Y.actualGain.value)," ",Y.resource.displayName,f("/sec")]),s(Or,{max:Object.values(Ve).filter(ze=>ze.name!==nt).reduce((ze,ue)=>ze-ue.element.conversionAmount.value,100),modelValue:Y.conversionAmount.value,"onUpdate:modelValue":ze=>Y.conversionAmount.value=ze},null)])])]),Y.principleClickable?at(Y.principleClickable):null]):"");return{name:nt,symbol:Le,element:Ut(Y),display:Xe}}const Ze=we(se,"alembic","\u{1F76A}"),re=we(G,"retort","\u{1F76D}"),Dt=we(Q,"crucible","\u{1F767}"),dt=we(Ae,"bainMarie","\u{1F76B}"),Ve={retort:re,alembic:Ze,crucible:Dt,bainMarie:dt},ot=ie(()=>[q(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===fl})),Re.batteries.distill.timePassing.modifier]),A=S(()=>ot.apply(1)),z=ie(()=>[q(()=>({multiplier:()=>r.max(1,se.resource.value),description:"Earth Essence"})),q(()=>({multiplier:()=>r.max(1,G.resource.value),description:"Water Essence"})),q(()=>({multiplier:()=>r.max(1,Q.resource.value),description:"Air Essence"})),q(()=>({multiplier:()=>r.max(1,Ae.resource.value),description:"Fire Essence"})),Re.batteries.distill.xpGain.modifier]),ce=ie(()=>[wt(()=>({addend:se.computedCost,description:"Alembic"})),wt(()=>({addend:G.computedCost,description:"Retort"})),wt(()=>({addend:Q.computedCost,description:"Crucible"})),wt(()=>({addend:Ae.computedCost,description:"Bain-Marie"}))]),pe={timePassing:ot,jobXp:z,totalFlowerLoss:ce},[ke,Ct]=Qt(()=>[{title:"Time Passing",modifier:ot,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||Re.milestones.timeBatteriesMilestone.earned.value},{title:"Essentia",subtitle:`Also ${a.name} EXP Amount`,modifier:z,base:1},{title:"Flowers Loss",modifier:ce,base:0,unit:"/sec"}]),Mt=Fn({general:()=>({display:"General",glowColor(){return Mt.activeTab.value===this.tab?t:""},tab:ke,generalTabCollapsed:Ct}),...Object.entries(Ie).reduce((Y,[nt,Le])=>({...Y,[nt]:()=>({display:cn(Le.name),glowColor(){return Mt.activeTab.value===this.tab?t:""},tab:Le.tab,tabCollapsed:Le.tabCollapsed})}),{})});return this.on("preUpdate",Y=>{if(n.value=Object.values(Ie).reduce((Le,Xe)=>Le.times(r.max(1,Xe.resource.value)),new r(1)),r.gt(n.value,a.xp.value)&&(a.xp.value=n.value),!a.active.value)return;Y=r.times(Y,A.value).toNumber();const nt=ce.apply(0);Object.values(Ie).forEach(Le=>{Le.resource.value=r.add(Le.resource.value,r.times(Le.actualGain.value,Y))}),De.flowers.value=r.sub(De.flowers.value,nt).max(0)}),{name:e,color:t,minWidth:670,essentia:n,bestEssentia:l,elements:Ie,instruments:Ve,job:a,milestones:w,modifiers:pe,modifierTabs:Mt,collapseMilestones:y,display:$(()=>{const Y=[...k.value];return B.value&&Y.push(B.value),s(T,null,[s(Ai,{resource:n,color:t},null),li(...Y,$(()=>mn(s(si,{collapsed:y,content:V,display:y.value?"Show other completed milestones":"Hide other completed milestones"},null),[[In,o(P)]]))),bl(se.display,G.display,Q.display,Ae.display),s($e,null,null),bl(Ze.display,re.display,Dt.display,dt.display),We(x)])})}});var $m=["I've always had an affinity for lead","When I'm near lead I feel in my element","Sometimes I wonder if there may be more planets","I have to believe in the heart of the cards","My deck has no bad cards","Honestly, cards are pretty abstract","Cards? I love cards!","Is this world governed more by logic or chance?","Each flower holds a secret","In every bloom, there's a story waiting to unfold","Uncovering nature's mysteries, one card at a time","The elements guide my every move","Knowledge, like a river, constantly flows","The art of discovery lies within the cards","Every revelation brings me closer to mastery","A world of wonder, waiting to be deciphered","In the cards, the key to understanding","Comprehending the intricate dance of elements","The wisdom of ages, in the palm of my hand","The only true wisdom is in knowing you know nothing","The roots of education are bitter, but the fruit is sweet","Education is the kindling of a flame, not the filling of a vessel","All learning has an emotional base","Knowledge is power","Wonder is the beginning of wisdom"];const Mm={min:.5,max:1},Pm=[{s:0,cp:.329,e:.548},{s:.548,cp:.767,e:.876},{s:.876,cp:.985,e:1}],xm=.001,Im=.1,Tm=100,Fm=!0,Em={x:0,y:0},Dm=!1,qm=[{type:"alpha",config:{alpha:{list:[{time:0,value:.74},{time:1,value:0}]}}},{type:"moveSpeed",config:{speed:{list:[{time:0,value:700},{time:1,value:0}]},minMult:1}},{type:"scale",config:{scale:{list:[{time:0,value:5},{time:1,value:1.2}]},minMult:1}},{type:"color",config:{color:{list:[{time:0,value:"#ffdfa0"},{time:1,value:"#100f0c"}]}}},{type:"rotation",config:{accel:0,minSpeed:0,maxSpeed:200,minStart:0,maxStart:360}},{type:"textureRandom",config:{textures:["/particle.png"]}},{type:"spawnShape",config:{type:"rect",data:{x:-300,y:-125,w:600,h:250}}}];var Am={lifetime:Mm,ease:Pm,frequency:xm,emitterLifetime:Im,maxParticles:Tm,addAtBack:Fm,pos:Em,emit:Dm,behaviors:qm};const di=bi(),vl="study",xn=qn(vl,function(){const e="Studying",t="#D16726",n=pn(0,"properties"),l=pn(0,"insights"),i=nl(l),a=W(0),u=W(0),c=S(()=>g.earned.value&&Object.values(ee).some(F=>F.showNotif.value)),d=Hn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"25%",y:"20%"},symbol:"\u{1F56E}",randomQuips(){return[...$m,...oi]},resource:Ut(n),layerID:vl,modifierInfo:$(()=>at(nt)),visibility:Je.milestones.studyMilestone.earned,showNotif:c})),m=be(()=>({requirements:he(()=>r.gte(d.rawLevel.value,2)),display:{requirement:`Achieve ${d.name} Level 2`,effectDisplay:"Unlock drawing cards manually"}})),g=be(()=>({requirements:he(()=>r.gte(d.rawLevel.value,4)),display:{requirement:`Achieve ${d.name} Level 4`,effectDisplay:"Unlock purchasing and selling cards"},visibility:m.earned})),p=be(()=>({requirements:he(()=>r.gte(d.rawLevel.value,5)),display:{requirement:`Achieve ${d.name} Level 5`,effectDisplay:"Unlock a time slot"},visibility:g.earned})),w=be(()=>({requirements:he(()=>r.gte(d.rawLevel.value,6)),display:{requirement:`Achieve ${d.name} Level 6`,effectDisplay:"Unlock optimizations"},visibility:p.earned})),_=be(()=>({requirements:he(()=>r.gte(d.rawLevel.value,8)),display:{requirement:`Achieve ${d.name} Level 8`,effectDisplay:"Unlock upgrading cards"},visibility:w.earned})),y=be(()=>({requirements:he(()=>r.gte(d.rawLevel.value,10)),display:{requirement:`Achieve ${d.name} Level 10`,effectDisplay:'Unlock "Breeding Plants" Job'},visibility:_.earned,onComplete(){Sn(Lt,U)}})),k={manualMilestone:m,shopMilestone:g,timeSlotMilestone:p,optimizationsMilestone:w,upgradingMilestone:_,jobMilestone:y},B=[y,_,w,p,g,m],V=W(!0),P=S(()=>B.filter(F=>F.earned.value===!1)),{firstFeature:x,collapsedContent:X,hasCollapsedContent:te}=ri(B,F=>F.earned.value),se=S(()=>w.earned.value?r.pow(1.1,r.max(De.bestMoly.value,1).log10().floor()):1);let G=null;Gt(()=>et(()=>ge(r.times(se.value,100).sub(100)),F=>{qe.active===U.id&&(G!=null&&di.dismiss(G),G=di.info(s(T,null,[s("h3",null,[f("Experience Optimized!")]),s("div",null,[f("Experience optimization is now "),F,f("%")])])))}));const Q=Hi(()=>({direction:Me.Right,width:500,height:25,progress:()=>r.sub(1,r.add(De.bestMoly.value,1).log10().ceil().sub(r.max(De.bestMoly.value,1).log10())),display:$(()=>s(T,null,[Oe(De.bestMoly.value),f(" best moly")])),borderStyle:{borderColor:De.color,color:"#FFF"},fillStyle:{backgroundColor:De.color}})),Ae=S(()=>w.earned.value?r.pow(1.1,r.max(Je.bestEssentia.value,1).log10().floor()):1);let Ie=null;Gt(()=>et(()=>ge(r.times(Ae.value,100).sub(100)),F=>{qe.active===U.id&&(Ie!=null&&di.dismiss(Ie),Ie=di.info(s(T,null,[s("h3",null,[d.name,f(" Optimized!")]),s("div",null,[d.name,f(" optimization is now "),F,f("%")])])))}));const we=Hi(()=>({direction:Me.Right,width:500,height:25,progress:()=>r.sub(1,r.add(Je.bestEssentia.value,1).log10().ceil().sub(r.max(Je.bestEssentia.value,1).log10())),display:$(()=>s(T,null,[Oe(Je.bestEssentia.value),f(" best essentia")])),borderStyle:{borderColor:Je.color,color:"#FFF"},fillStyle:{backgroundColor:Je.color}})),Ze=S(()=>w.earned.value?r.pow(1.1,r.max(i.value,1).log10().floor()):1);let re=null;Gt(()=>et(()=>ge(r.times(Ze.value,100).sub(100)),F=>{qe.active===U.id&&(re!=null&&di.dismiss(re),re=di.info(s(T,null,[s("h3",null,[f("Draw Time Optimized!")]),s("div",null,[f("Draw time optimization is now "),F,f("%")])])))}));const Dt=Hi(()=>({direction:Me.Right,width:500,height:25,progress:()=>r.sub(1,r.add(i.value,1).log10().ceil().sub(r.max(i.value,1).log10())),display:$(()=>s(T,null,[Oe(i.value),f(" best insights")])),borderStyle:{borderColor:t,color:"#FFF"},fillStyle:{backgroundColor:t}})),dt=S(()=>r.pow(1.1,d.level.value)),Ve=ie(()=>[q(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===vl})),Re.batteries.study.timePassing.modifier]),ot=S(()=>Ve.apply(1)),A=ie(()=>[q(()=>({multiplier:dt,description:`${d.name} level (x1.1 each)`})),q(()=>({multiplier:Ae,description:`${d.name} optimization`,enabled:w.earned})),Re.batteries.study.resourceGain.modifier,Lt.plants.properties.modifier]),z=S(()=>A.apply(10)),ce=ie(()=>[q(()=>({multiplier:()=>r.times(.01,u.value).add(1),description:"Drawn cards (+.01x each)"})),q(()=>({multiplier:se,description:"Experience optimization",enabled:w.earned})),Re.batteries.study.xpGain.modifier]),pe=ie(()=>[q(()=>({multiplier:()=>r.div(1,Ze.value),description:"Draw speed optimization",enabled:w.earned,smallerIsBetter:!0})),q(()=>({multiplier:.5,description:"Faster draw card",enabled:()=>gt.value>0,smallerIsBetter:!0}))]),ke=S(()=>pe.apply(10)),Ct=ie(()=>[q(()=>({multiplier:.5,description:"Manual bonus",smallerIsBetter:!0}))]),Mt=S(()=>Ct.apply(ke.value)),Y={timePassing:Ve,propertiesGain:A,jobXpGain:ce,drawTime:pe,manualDrawTime:Ct},[nt,Le]=Qt(()=>[{title:"Time Passing",modifier:Ve,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||Re.milestones.timeBatteriesMilestone.earned.value},{title:"Properties Gain",modifier:A,base:10},{title:`${d.name} EXP Gain`,modifier:ce,base:1,baseText:"Base (per property gained)"},{title:"Automatic Card Draw",modifier:pe,base:10,unit:"s",smallerIsBetter:!0},{title:"Manual Card Draw",modifier:Ct,base:ke,unit:"s",smallerIsBetter:!0}]),Xe=tl(()=>({fullscreen:!1,zIndex:-1,boundingRect:J(null),onContainerResized(F){this.boundingRect.value=F}})),ze=S(()=>Object.values(ee).reduce((F,de)=>F+de.amount.value,0)),ue=W(""),mt=W(["","",""]),St=W("nothing"),pt=J(0),I=un(()=>({description:"Do nothing.",metal:"mercury",sign:"gemini",startingAmount:4,onSelect:()=>ue.value="nothing",shouldNotify:function(){return It(this)}})),L=un(()=>({description:F=>$(()=>s("h3",null,[f("Record")," ",qt(ge(r.times(z.value,r.add(F,1))))," ",f("properties and job exp.")])),metal:"gold",sign:"leo",actions:{onPlay:F=>{const de=r.times(z.value,r.add(F,1));n.value=r.add(n.value,de),d.xp.value=r.add(d.xp.value,ce.apply(de))}},formula:$(()=>qt("properties gain x level")),price:1,startingAmount:4,onSelect:()=>ue.value="gainPoints",shouldNotify:function(){return It(this)}})),O=un(()=>({description:F=>$(()=>s("h3",null,[f("Record")," ",qt(ge(r.times(z.value,r.add(F,1)).times(10).pow(1.2)))," ",f("properties and job exp. Destroy this card.")])),metal:"tin",sign:"sagittarius",actions:{onPlay:(F,de)=>{const Fe=r.times(z.value,r.add(F,1)).times(10).pow(1.2);n.value=r.add(n.value,Fe),d.xp.value=r.add(d.xp.value,ce.apply(Fe)),de||(O.amount.value=Math.max(O.amount.value-1,0),O.amount.value<=0&&ue.value==="gainBigPoints"&&(ue.value=""))}},formula:$(()=>s("span",{style:"color: var(--accent2)"},[f("(properties gain x 10 x level)"),s("sup",null,[f("1.2")])])),price:8,onSelect:()=>ue.value="gainBigPoints",shouldNotify:function(){return It(this)}})),ye=un(()=>({description:F=>r.eq(F,0)?$(()=>s("h3",null,[f("Gain "),qt("1"),f(" key insight.")])):$(()=>s("h3",null,[f("Gain "),qt(ge(r.add(F,1))),f(" key insights.")])),metal:"copper",sign:"libra",actions:{onPlay:F=>{l.value=r.add(l.value,F).add(1)}},formula:$(()=>qt("level")),price:0,startingAmount:2,onSelect:()=>ue.value="gainInsight",shouldNotify:function(){return It(this)}})),le=un(()=>({description:F=>$(()=>s("h3",null,[f("Use the size of your deck to gain")," ",qt(ge(r.times(ze.value,r.add(F,1))))," ",f("key insights.")])),metal:"silver",sign:"cancer",actions:{onPlay:F=>{const de=r.times(ze.value,r.add(F,1));l.value=r.add(l.value,de)}},formula:$(()=>s("span",{style:"color: var(--accent2)"},[f("cards x level")])),price:13,onSelect:()=>ue.value="gainBigInsight",shouldNotify:function(){return It(this)}})),Qe=un(()=>({description:F=>r.eq(F,0)?"Play the next card an extra time (does not stack)":$(()=>s("h3",null,[f("Play the next card an extra time, with")," ",qt(Oe(r.div(F,4))),f(" bonus levels (does not stack)")])),metal:"iron",sign:"scorpio",actions:{onNextCardPlay:F=>{const de=F.actions.onPlay;return de&&de(r.add(F.level.value,r.div(Qe.level.value,4)),!0),u.value++,!0}},formula:$(()=>qt("(level - 1) / 4")),price:32,onSelect:()=>ue.value="playTwice",shouldNotify:function(){return It(this)}})),kt=un(()=>({description:F=>$(()=>s("h3",null,[f("Gain xp equal to "),qt(Oe(r.div(r.add(F,1),10),1)),f("x times your number of properties.")])),metal:"tin",sign:"pisces",actions:{onPlay:F=>{d.xp.value=r.add(d.xp.value,ce.apply(r.add(F,1).div(10).times(n.value)))}},formula:$(()=>qt("properties x level / 10")),price:25,onSelect:()=>ue.value="gainXp",shouldNotify:function(){return It(this)}})),gt=W(0),Pt=un(()=>({description:F=>$(()=>s("h3",null,[f("Drawing cards is 2x faster for the next")," ",qt(ge(r.times(Sl.value,r.add(F,1))))," ",f("seconds (doesn't stack)")])),metal:"mercury",sign:"virgo",actions:{onPlay:F=>gt.value=r.times(Sl.value,r.add(F,1)).toNumber()},formula:$(()=>qt("number of jobs x level")),price:48,onSelect:()=>ue.value="fasterDraws",shouldNotify:function(){return It(this)}})),Ot=un(()=>({description:F=>$(()=>s("h3",null,[f("Gain")," ",qt(ge(Object.values(lt.jobs).reduce((de,Fe)=>de.add(Fe.level.value),new r(0)).sqrt().floor().times(r.add(F,1))))," ",f("of a random elemental essence")])),metal:"iron",sign:"aries",actions:{onPlay:F=>{const de=Object.values(Je.elements).filter(Ee=>o(Ee.visible)),Fe=de[Math.floor(Math.random()*de.length)];Fe.resource.value=r.add(Fe.resource.value,lt.sumJobLevels.value.times(r.add(F,1).sqrt().floor()))}},formula:$(()=>s("span",{style:"color: var(--accent2)"},[s(ir,null,{default:()=>[s(cm,null,{default:()=>[f("sum job levels")]})]})," ",f("x level")])),price:16,onSelect:()=>ue.value="gainElementalEssence",shouldNotify:function(){return It(this)}})),ae=un(()=>({description:F=>$(()=>s("h3",null,[f("Gain")," ",qt(ge(r.times(Object.values(lt.jobs).reduce((de,Fe)=>de.add(Fe.level.value),new r(0)),r.add(F,1)).floor()))," ",f("key insights")])),metal:"lead",sign:"capricorn",actions:{onPlay:F=>{const de=r.times(Object.values(lt.jobs).reduce((Fe,Ee)=>Fe.add(Ee.level.value),new r(0)),r.add(F,1)).floor();l.value=r.add(l.value,de)}},formula:$(()=>s("span",{style:"color: var(--accent2)"},[f("sum job levels x level")])),price:14,onSelect:()=>ue.value="gainInsightFromJobs",shouldNotify:function(){return It(this)}})),Ne=un(()=>({description:F=>$(()=>s("h3",null,[f("Gain "),qt(ge(r.add(F,1).times(5))),f("s of moly production")])),metal:"lead",sign:"aquarius",actions:{onPlay:F=>{De.flowers.value=r.add(De.flowers.value,r.times(De.modifiers.flowerGain.apply(0),r.add(1,F).times(5)))}},formula:$(()=>qt("5 x level")),price:9,onSelect:()=>ue.value="gainMolyFromEssentia",shouldNotify:function(){return It(this)}})),Te=un(()=>({description:F=>$(()=>s("h3",null,[f("Convert half your moly into")," ",qt(ge(r.div(De.flowers.value,2).max(1).ln().floor().times(r.add(1,F)).times(z.value)))," ",f("properties and job exp")])),metal:"copper",sign:"taurus",actions:{onPlay:F=>{const de=r.div(De.flowers.value,2).max(1).ln().floor().times(r.add(1,F)).times(z.value);De.flowers.value=r.div(De.flowers.value,2).floor(),n.value=r.add(n.value,de),d.xp.value=r.add(d.xp.value,ce.apply(de))}},formula:$(()=>s("span",{style:"color: var(--accent2)"},[f("properties gain x "),s(ir,null,{default:()=>[f("ln(spent moly)")]}),f(" x level")])),price:8,onSelect:()=>ue.value="gainPropertiesFromFlowers",shouldNotify:function(){return It(this)}})),ee={nothing:I,gainPoints:L,gainBigPoints:O,gainInsight:ye,gainBigInsight:le,playTwice:Qe,gainXp:kt,fasterDraws:Pt,gainElementalEssence:Ot,gainInsightFromJobs:ae,gainMolyFromEssentia:Ne,gainPropertiesFromFlowers:Te},Ke=S(()=>{if(ue.value in ee){const F=ee[ue.value];return new r(10).pow(r.add(F.level.value,2))}return 0}),yt=Bn(()=>({display:{title:"+1 Level",description:$(()=>{if(ue.value in ee){const F=ee[ue.value];return s(T,null,[f("Current level: "),ge(r.add(F.level.value,1)),s("br",null,null),ue.value==="nothing"?s("span",null,[f("Max level!")]):s("span",null,[f("Cost: "),Oe(Ke.value),f(" "),l.displayName])])}return""})},canClick(){return ue.value!=="nothing"&&ue.value in ee&&r.gte(l.value,Ke.value)},onClick(){if(ue.value in ee){const F=ee[ue.value];l.value=r.sub(l.value,Ke.value),F.level.value=r.add(F.level.value,1)}},style:{height:"120px",alignSelf:"center"}})),nn=S(()=>r.gte(a.value,Mt.value)),xt=Bn(()=>({display:{title:"Draw",description:$(()=>s(T,null,[s("div",null,[f("Focus harder in order to discover the next card faster.")]),nn.value?s("div",null,[f("Available Now!")]):s("div",null,[f("Available in")," ",zn(r.sub(Mt.value,a.value))])]))},canClick:nn,onClick:an,style:{minHeight:"50px",width:"200px"}})),ln=W(0),Nt=S(()=>r.pow(2,ln.value).times(100)),hn=Bn(()=>({display:{title:"Purge card",description:$(()=>s(T,null,[f("Remove card from deck"),s("br",null,null),f("Cost: "),Oe(Nt.value),f(" "),l.displayName]))},canClick(){return r.gte(l.value,Nt.value)},async onClick(){var F;if(ue.value in ee){const de=ee[ue.value];l.value=r.sub(l.value,Nt.value),ln.value++,de.amount.value--;const Fe=Xe.boundingRect.value,Ee=(F=xn.nodes.value.deck)==null?void 0:F.rect;Fe&&Ee&&(await Gt(),Xe.addEmitter(Am).then(ut=>{ut.updateOwnerPos(Ee.x+Ee.width/2-Fe.x,Ee.y+Ee.height/2-Fe.y),ut.playOnceAndDestroy()})),de.amount.value<=0&&(ue.value="")}},style:{"--layer-color":"var(--danger)",minHeight:"50px",width:"200px"}})),kn=new Array(3).fill(0).map((F,de)=>{const Fe=Bn(()=>({display:{title:"Purchase Card",description:$(()=>{const Ee=mt.value[de];if(Ee==="")return s(T,null,[f("Out of Stock!"),s("div",{class:"element-cost"},null)]);const ut=ee[Ee],Tt=Bi[ut.sign];return s(T,null,[ge(ut.price),f(" "),Tt,f(" essence"),s("div",{class:"element-cost",style:{color:Je.elements[Tt].color}},[Je.elements[Tt].symbol])])})},canClick(){const Ee=mt.value[de];if(Ee==="")return!1;const ut=ee[Ee],Tt=Bi[ut.sign],Rt=Je.elements[Tt].resource;return r.gte(Rt.value,ut.price)},onClick(){const Ee=mt.value[de];if(Ee==="")return!1;const ut=ee[Ee],Tt=Bi[ut.sign],Rt=Je.elements[Tt].resource;ut.amount.value+=1,Rt.value=r.sub(Rt.value,ut.price),mt.value[de]=""},style:{width:"165px",margin:"20px 7.5px",minHeight:"50px",paddingLeft:"55px",borderTopLeftRadius:"25px",borderBottomLeftRadius:"25px"}}));return jr(Fe,{display:$(()=>{const Ee=mt.value[de];if(Ee==="")return s(T,null,null);const ut=ee[Ee],Tt=Bi[ut.sign],Rt=Je.elements[Tt].resource;return s(T,null,[f("You have "),Pn(Rt),f(" "),Rt.displayName])}),direction:Me.Down}),Fe}),rn=W(0),Wt=S(()=>7);function an(){var Fe,Ee,ut,Tt,Rt;a.value=0,pt.value++,rn.value++,u.value++;const F=St.value;let de=Math.floor(Math.random()*ze.value);if(St.value=Object.keys(ee).find(bn=>de<=ee[bn].amount.value?!0:(de-=ee[bn].amount.value,!1)),((ut=(Ee=(Fe=ee[F].actions).onNextCardPlay)==null?void 0:Ee.call(Fe,ee[St.value],!1))==null||ut)&&((Rt=(Tt=ee[St.value].actions).onPlay)==null||Rt.call(Tt,ee[St.value].level.value,!1)),rn.value>=Wt.value){rn.value=0;const bn=Object.keys(ee).filter(Ln=>"price"in ee[Ln]);mt.value=new Array(3).fill(0).map(()=>bn[Math.floor(Math.random()*bn.length)])}}function It(F){return g.earned.value&&F.amount.value>0&&r.gte(l.value,new r(10).pow(r.add(F.level.value,2)))}this.on("preUpdate",F=>{!d.active.value||(F=r.times(F,ot.value).toNumber(),a.value+=F,gt.value=Math.max(0,gt.value-F),r.gte(a.value,ke.value)&&an())});const Nn=Fn({play:()=>({display:"Play",tab:Gn(()=>({display:$(()=>s(T,null,[s($e,null,null),ee[St.value].renderForPlay(pt),s($e,null,null),m.earned.value?zi(xt):null,s($e,null,null),g.earned.value?s("div",null,[f("Shop will refresh in")," ",Wt.value-rn.value,f(" draws")]):null,s("div",null,[f("Card will be drawn automatically in")," ",zn(r.sub(ke.value,a.value))])]))})),style:{borderLeft:"5px solid var(--outline)",marginLeft:"5px"}}),deck:()=>({display:$(()=>s("span",{style:"position: relative;"},[f("Cards"),c.value?s(Tn,{style:"left: -15px; top: -10px"},null):null])),tab:Gn(()=>({display:$(()=>{const F=Object.values(ee).filter(Fe=>Fe.amount.value>0),de=Math.ceil(F.length/5);return s(T,null,[s($e,null,null),g.earned.value?s(T,null,[s("h2",null,[f("Shop")]),s($e,null,null),mt.value.map(Fe=>Fe===""?ee.nothing.renderForShop():ee[Fe].renderForShop()),zi(...kn),s("div",null,[f("Shop will refresh in")," ",Wt.value-rn.value," ",f("draws")]),s($e,{height:"50px"},null)]):null,s("h2",null,[f("Deck")]),s($e,null,null),s("div",{class:"cardDeck-container"},[s(Xn,{id:"deck"},null),...new Array(de).fill(0).map((Fe,Ee)=>zi(...F.slice(Ee*Math.ceil(F.length/de),(Ee+1)*Math.ceil(F.length/de)).map(ut=>ut.renderForDeck)))]),s($e,null,null),ue.value?s(T,null,[_.earned.value?s("div",{style:"display: flex; justify-content: center;"},[ee[ue.value].renderForUpgrade(!1),s("div",{style:"display: flex; flex-direction: column; color: var(--layer-color); font-size: xxx-large; margin-left: -30px; margin-right: -30px"},[s("span",{style:"margin-bottom: 20px"},[f(">>>")]),We(yt),s("span",{style:"margin-top: 20px"},[f(">>>")])]),ee[ue.value].renderForUpgrade(!0)]):ee[ue.value].renderForUpgrade(!1),g.earned.value?We(hn):null]):null])})}))}),optimizations:()=>({display:"Optimizations",visibility:w.earned,tab:Gn(()=>({display:$(()=>s(T,null,[s($e,null,null),s("h2",null,[f("Experience Optimization")]),s("div",{style:"margin: 20px"},[f("The magnitude of your best moly amount has allowed you to optimize your exp gain by")," ",ge(r.times(se.value,100).sub(100)),f("%."),s("br",null,null),f("Each additional order of magnitude gives a compounding 10% optimization.")]),We(Q),s($e,{height:"50px"},null),s("h2",null,[d.name,f(" Optimization")]),s("div",{style:"margin: 20px"},[f("The magnitude of your best essentia amount has allowed you to optimize your properties gain by")," ",ge(r.times(Ae.value,100).sub(100)),f("%."),s("br",null,null),f("Each additional order of magnitude gives a compounding 10% optimization.")]),We(we),s($e,{height:"50px"},null),s("h2",null,[f("Draw Speed Optimization")]),s("div",{style:"margin: 20px"},[f("The magnitude of your best insights amount has allowed you to optimize your drawing speed by")," ",ge(r.times(Ze.value,100).sub(100)),f("%."),s("br",null,null),f("Each additional order of magnitude gives a compounding 10% optimization.")]),We(Dt)]))}))})},()=>({classes:{floating:!1},style:{borderStyle:"none",marginLeft:"-20px",marginRight:"-20px"},buttonContainerStyle:{top:"50px"}}));return{name:e,color:t,minWidth:670,properties:n,insights:l,bestInsights:i,timeDrawing:a,job:d,cards:ee,modifiers:Y,milestones:k,collapseMilestones:V,generalTabCollapsed:Le,tabs:Nn,selectedCard:ue,drawnCard:St,soldCards:ln,cardShop:mt,cardsDrawnToShop:rn,fasterDrawTime:gt,totalCardsDrawn:u,display:$(()=>{const F=[...P.value];return x.value&&F.push(x.value),s(T,null,[s(Ol,null,{default:()=>[s("div",{style:"height: 50px; line-height: 50px; margin-bottom: 20px"},[f("You have "),s(Cl,{resource:n,color:t},null),f(" properties studied and "),s(Cl,{resource:l,color:"darkcyan"},null),f(" key insights")])]}),li(...F,$(()=>mn(s(si,{collapsed:V,content:X,display:V.value?"Show other completed milestones":"Hide other completed milestones"},null),[[In,o(te)]]))),s($e,null,null),We(Nn),We(Xe)])})}});const Lm={class:"applied-time-selectors-container"},Om=["onClick"],jm={key:0,class:"applied-time-symbol"},Rm={key:1,class:"applied-time-symbol material-icons"},Bm={class:"applied-time-effect"},Vm=K({__name:"AppliedTimeSelectors",props:{jobs:null,selectedJob:null,effect:null},emits:["selectJob"],setup(e,{emit:t}){const n=e,{jobs:l,selectedJob:i,effect:a}=st(n),u=S(()=>Object.keys(l.value).filter(d=>ft(l.value[d].visibility)).reduce((d,m)=>({...d,[m]:l.value[m]}),{})),c=S(()=>Math.PI*2/Object.keys(u.value).length);return(d,m)=>(b(),N("div",Lm,[(b(!0),N(T,null,Zt(o(u),(g,p,w)=>(b(),N("div",{key:p,class:Pe(["feature can dontMerge applied-time-selector",o(i)===p?"selected":""]),style:Se({backgroundColor:o(g.color),top:`${Math.sin(w*o(c)+o(U).time/1e4)*200+300}px`,left:`${Math.cos(w*o(c)+o(U).time/1e4)*200+300}px`}),onClick:_=>t("selectJob",p)},[o(g.symbol).length<=2?(b(),N("div",jm,Z(g.symbol),1)):(b(),N("span",Rm,Z(g.symbol),1))],14,Om))),128)),h("div",Bm,Z(o(Oe)(o(a)))+"x",1)]))}});var Gm=me(Vm,[["__scopeId","data-v-0bbe577e"]]);const zm={key:1,class:"grain complete"},Um=K({__name:"Grain",props:{index:null,chippingProgress:null,chippingIndex:null},setup(e){const t=e,{index:n,chippingProgress:l,chippingIndex:i}=st(t);return(a,u)=>o(i)<o(n)?(b(),N("div",{key:0,class:Pe(["grain not-started",{}])})):(b(),N("div",zm,[o(i)===o(n)?(b(),N("div",{key:0,class:"grain",style:Se({clipPath:`polygon(0 0, 100% 0, 100% ${(1-o(l))*100}%, 0 ${(1-o(l))*100}%)`})},null,4)):R("",!0)]))}});var ar=me(Um,[["__scopeId","data-v-63857638"]]);const Xm=e=>(en("data-v-e8dadcb2"),e=e(),tn(),e),Hm={class:"single-grain-label"},Jm={style:{display:"none"}},Wm={id:"grain-filter"},Zm=["seed"],Qm=Xm(()=>h("feDisplacementMap",{in:"SourceGraphic",scale:"20"},null,-1)),Km=K({__name:"Grains",props:{baseGrains:null,chippingProgress:null},setup(e){const t=e,{baseGrains:n,chippingProgress:l}=st(t),i=S(()=>r.pow(2,new r(n.value).log2().floor()).round().toNumber()),a=S(()=>r.pow(2,new r(i.value).log2().div(2).floor()).round().toNumber()),u=S(()=>r.div(i.value,a.value).round().toNumber()),c=S(()=>r.sub(n.value,i.value).add(1).round().toNumber());return(d,m)=>(b(),N(T,null,[o(r).lt(o(n),1024)?(b(),N("div",{key:0,class:"grains-container",style:Se({gridTemplateColumns:`repeat(${o(u)}, 1fr)`,columnGap:o(u)===o(a)?"var(--feature-margin)":`calc(var(--feature-margin) + ${150/(o(u)-1)}px)`,maxWidth:o(u)===o(a)?"300px":"600px"})},[(b(!0),N(T,null,Zt(o(i),g=>(b(),H(ar,{key:g,index:g,chippingProgress:o(l),chippingIndex:o(c)},null,8,["index","chippingProgress","chippingIndex"]))),128))],4)):(b(),N(T,{key:1},[s(ar,{index:0,chippingProgress:o(l),chippingIndex:0,class:"single-grain"},null,8,["chippingProgress"]),h("div",Hm,Z(o(ge)(o(c)))+"/"+Z(o(ge)(o(i))),1)],64)),(b(),N("svg",Jm,[h("filter",Wm,[h("feTurbulence",{x:"0",y:"0",width:"700px",height:"700px",baseFrequency:"0.005",numOctaves:"10",seed:o(r).lt(o(n),1024)?o(i):new o(r)(o(n)).toNumber()},null,8,Zm),Qm])]))],64))}});var Ym=me(Km,[["__scopeId","data-v-e8dadcb2"]]);const Br=e=>(en("data-v-93b37faa"),e=e(),tn(),e),ep=Br(()=>h("clipPath",{id:"glass-mask"},[h("path",{d:"M204 -2.82683e-05L10 -2.83344e-05C-38 50 103 95.3005 103 175C103 254.699 -38 300 10 350H204C252 300 111 254.699 111 175C111 95.3005 252 50 204 -2.82683e-05Z",fill:"black"})],-1)),tp={id:"sand-top-mask"},np=["transform"],ip={id:"sand-bottom-mask"},lp=["transform"],rp={id:"flipping-mask"},ap=["transform"],sp=Kr('<g id="sand" transform="translate(42, 20)" clip-path="url(#glass-mask)" data-v-93b37faa><g clip-path="url(#flipping-mask)" data-v-93b37faa><path id="sand-top" d="M204 -2.82683e-05L10 -2.83344e-05C-38 50 103 95.3005 103 175V350H111V175C111 95.3005 252 50 204 -2.82683e-05Z" fill="white" clip-path="url(#sand-top-mask)" data-v-93b37faa></path></g><rect id="sand-bottom" width="300" height="390" fill="white" clip-path="url(#sand-bottom-mask)" data-v-93b37faa></rect></g><path id="glass" transform="translate(38, 20)" d="M212 -2.82683e-05L10 -2.83344e-05C-38 50 103 95.3005 103 175C103 254.699 -38 300 10 350H212C260 300 119 254.699 119 175C119 95.3005 260 50 212 -2.82683e-05Z" fill="#0003" data-v-93b37faa></path><path id="frame" fill-rule="evenodd" clip-rule="evenodd" d="M300 0H0V20H300V0ZM300 370H0V390H300V370Z" fill="#9E9169" data-v-93b37faa></path><path id="sides" transform="translate(15, 20)" d="M20 0H0V350H20V0ZM270 0H250V350H270V0Z" fill="#817654" data-v-93b37faa></path>',4),op={key:1,class:"remainingGrains"},up={key:2,class:"flip-request"},cp=Br(()=>h("br",null,null,-1)),dp={class:"fallenGrains"},mp=K({__name:"Hourglass",props:{totalGrains:null,grainsFallen:null,flippingProgress:null,showHourglassNotif:{type:Boolean}},emits:["flip"],setup(e,{emit:t}){return(n,l)=>(b(),N("div",{class:Pe(["hourglass-container",{flipping:e.flippingProgress<1}]),onClick:l[0]||(l[0]=i=>t("flip"))},[e.showHourglassNotif?(b(),H(Tn,{key:0})):R("",!0),(b(),N("svg",{width:"240",height:"312",viewBox:"0 0 300 390",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:Se({transform:`rotateZ(${(1-e.flippingProgress)*180}deg)`})},[h("defs",null,[ep,h("clipPath",tp,[h("path",{d:"M149.25 19.5C89.9195 19.5 0.5 0.5 0.5 0.5V390H299.5V0.5C299.5 0.5 208.581 19.5 149.25 19.5Z",transform:e.flippingProgress<1?`translate(0, ${-40+e.flippingProgress*40})`:`translate(0, ${o(r).div(e.grainsFallen,e.totalGrains).sqr().times(190).toNumber()})`,fill:"black"},null,8,np)]),h("clipPath",ip,[h("path",{d:"M148.75 0C89.4195 0 0 19 0 19V389.5H299V19C299 19 208.081 0 148.75 0Z",transform:`translate(-40, ${o(r).sub(350,o(r).div(e.grainsFallen,e.totalGrains).sqr().times(150)).toNumber()})`,fill:"black"},null,8,lp)]),h("clipPath",rp,[h("path",{d:"M150.25 389.5C209.581 389.5 300 370.5 300 370.5L300 3.05176e-05L1.87924e-05 4.37817e-06L-1.35978e-05 370.5C-1.35978e-05 370.5 90.9194 389.5 150.25 389.5Z",fill:"black",transform:`translate(0, ${Math.max(e.flippingProgress,.5)*420-445})`},null,8,ap)])]),sp],4)),o(r).sub(e.totalGrains,e.grainsFallen).gt(0)?(b(),N("div",op,Z(o(ge)(o(r).sub(e.totalGrains,e.grainsFallen))),1)):(b(),N("div",up,[f(" Press to "),cp,f(" flip ")])),h("div",dp,Z(o(ge)(e.grainsFallen)),1)],2))}});var pp=me(mp,[["__scopeId","data-v-93b37faa"]]),fp=["Time? I love time!","I don't like sand. It's coarse and rough and irritating - and it gets everywhere","Those who make the worst use of their time are the first to complain of its brevity","Oh, how the time has flown","Time is an illusion","Time does not pass, it continues","This, too, shall pass","The hourglass mesmerizes me","Each grain split makes my measurements more precise","Wait!","Capturing time, one grain at a time","Turning stones into sands of time","Time waits for no one","Sand and time, forever intertwined","Patience is the companion of wisdom","Time is the most valuable resource","As the sands shift, so do I","Tempus fugit","Carpe diem","Time is the most valuable thing a man can spend","Time crumbles things; everything grows old","We live, not as we wish to, but as we can","The only way to measure time is by living it","Time discovers truth","The two most powerful warriors are patience and time"];const sr=bi(),or={additive:"+",multiplicative:"x",exponential:"^"},vp={additive:(e,t)=>()=>r.times(o(e),t.value),multiplicative:(e,t)=>()=>r.pow(o(e),t.value),exponential:(e,t)=>()=>r.tetrate(o(e),new r(t.value).toNumber())},gl="experiments",Ce=qn(gl,function(){const e="Measuring",t="#D1C926",n=pn(0,"potentia"),l=W(1),i=W(0),a=W(1),u=W(0),c=W("experiments",!1),d=S(()=>p.earned.value?Object.values(we).some(ae=>ae.showNotif.value)?!0:_.earned.value?!!Object.values(Ve).some(ae=>ae.showNotif.value):!1:!1),m=Hn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"85%",y:"60%"},symbol:"\u29D6",randomQuips(){return[...fp,...oi]},resource:Ut(n),layerID:gl,modifierInfo:$(()=>at(le)),visibility:Je.milestones.experimentsMilestone.earned,showNotif:()=>Ot.value||d.value})),g=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,2)),display:{requirement:`Achieve ${m.name} Level 2`,effectDisplay:"Unlock grinding grains"}})),p=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,4)),display:{requirement:`Achieve ${m.name} Level 4`,effectDisplay:"Unlock potentials"},visibility:g.earned})),w=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,5)),display:{requirement:`Achieve ${m.name} Level 5`,effectDisplay:"Unlock a time slot"},visibility:p.earned})),_=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,6)),display:{requirement:`Achieve ${m.name} Level 6`,effectDisplay:"Unlock advanced potentials"},visibility:w.earned})),y=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,8)),display:{requirement:`Achieve ${m.name} Level 8`,effectDisplay:"Unlock applied time"},visibility:_.earned})),k=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,10)),display:{requirement:`Achieve ${m.name} Level 10`,effectDisplay:'Unlock "Harnessing Power" Job'},visibility:y.earned,onComplete(){Sn(Re,U)}})),B={chippingMilestone:g,potentialsMilestone:p,timeSlotMilestone:w,advancedPotentialsMilestone:_,appliedTimeMilestone:y,jobMilestone:k},V=[k,y,_,w,p,g],P=W(!0),x=S(()=>V.filter(ae=>ae.earned.value===!1)),{firstFeature:X,collapsedContent:te,hasCollapsedContent:se}=ri(V,ae=>ae.earned.value);function G({name:ae,precision:Ne,effectRatio:Te,xpReqRatio:ee,baseBoostCost:Ke,boostCostRatio:yt,boostCostResource:nn,modifierType:xt,isAdvanced:ln}){const Nt=Ue(Te),hn=Ue(ee),kn=Ue(Ke),rn=Ue(yt),Wt=Ue(nn),an=W(0),It=W(0),Nn=S(()=>r.pow(o(hn),an.value).times(100)),F=vp[xt!=null?xt:"multiplicative"](Nt,an);let de;xt==="exponential"?de=Qi(()=>({exponent:F,description:ae+" potential",enabled:ln?_.earned:p.earned,smallerIsBetter:r.lt(o(Nt),1)})):xt==="additive"?de=wt(()=>({addend:F,description:ae+" potential",enabled:ln?_.earned:p.earned,smallerIsBetter:r.lt(o(Nt),1)})):de=q(()=>({multiplier:F,description:ae+" potential",enabled:ln?_.earned:p.earned,smallerIsBetter:r.lt(o(Nt),1)}));const Fe=W(0),Ee=S(()=>r.times(o(kn),r.pow(o(rn),Fe.value))),ut=S(()=>r.gte(Si(Wt).value,Ee.value)),Tt=Bn(()=>({display:$(()=>s(T,null,[f("x2 boost for"),s("br",null,null),jt(Ee.value),s("br",null,null),Si(Wt).displayName,bn.value?s(Tn,{style:"top: -15px"},null):null])),canClick:ut,onClick(){const Ln=Si(Wt);Ln.value=r.sub(Ln.value,Ee.value),Fe.value++}}));jr(Tt,{display:$(()=>s(T,null,[f("You have "),Pn(Si(Wt))," ",Si(Wt).displayName]))});let Rt=null;et(an,()=>{qe.active===U.id&&(Rt!=null&&sr.dismiss(Rt),Rt=sr.info(s(T,null,[s("h3",null,[f("Potential increased!")]),s("div",null,[or[xt!=null?xt:"multiplicative"],Oe(o(Nt),Ne!=null?Ne:2),f(" "),ae])])))});const bn=Fi(Tt,ut);return{level:an,xp:It,xpRequired:Nn,effect:F,modifier:de,boosts:Fe,cost:Ee,clickable:Tt,showNotif:bn,effectRatio:Nt,xpReqRatio:hn,baseBoostCost:kn,boostCostRatio:rn,boostCostResource:Wt,update(Ln){let ui=r.add(It.value,r.pow(2,Fe.value).times(St.apply(Ln)));for(;r.gte(ui,Nn.value);)ui=ui.sub(Nn.value),an.value++;It.value=ui.toNumber()},display:$(()=>s("div",{class:"potential feature dontMerge"},[We(Tt),s("div",{class:"potential-details"},[f("Lv "),jt(an.value),f(" "),ae,f(" ("),or[xt!=null?xt:"multiplicative"],Oe(o(Nt),Ne!=null?Ne:2),f(" each)")]),s("div",{class:"potential-xp"},[s("div",{class:"potential-xp-fill",style:{width:`${r.div(It.value,Nn.value).times(100).toNumber()}%`}},null)])]))}}const Q=G({name:"Grinding duration",effectRatio:.9,precision:1,xpReqRatio:1.3,baseBoostCost:100,boostCostRatio:2,boostCostResource:Ut(n)}),Ae=G({name:"Potentia gain",effectRatio:1.05,xpReqRatio:1.08,baseBoostCost:100,boostCostRatio:10,boostCostResource:Ut(n)}),Ie=G({name:"Grains fall speed",effectRatio:1.025,precision:3,xpReqRatio:1.1,baseBoostCost:100,boostCostRatio:4,boostCostResource:Ut(n)}),we={grindingSpeedPotential:Q,potentiaGainPotential:Ae,fallSpeedPotential:Ie},Ze=G({name:"Potentials speed",effectRatio:1.1,precision:1,xpReqRatio:1.5,baseBoostCost:1e4,boostCostRatio:10,boostCostResource:Ut(n),isAdvanced:!0}),re=G({name:"Bonus grains",effectRatio:1.05,xpReqRatio:2,baseBoostCost:100,boostCostRatio:1.25,boostCostResource:()=>Object.values(Je.elements)[re.boosts.value%4].resource,isAdvanced:!0}),Dt=G({name:"Job EXP gain",effectRatio:1.1,precision:1,xpReqRatio:1.25,baseBoostCost:1e6,boostCostRatio:8,boostCostResource:De.flowers,isAdvanced:!0}),dt=G({name:"Passive grinding",effectRatio:1,precision:0,xpReqRatio:1.2,baseBoostCost:1e3,boostCostRatio:5,boostCostResource:xn.insights,modifierType:"additive",isAdvanced:!0}),Ve={potentialsSpeedPotential:Ze,effectiveGrainsPotential:re,jobXPPotential:Dt,passiveGrindingPotential:dt},ot=S(()=>r.pow(1.1,m.level.value)),A=S(()=>new r(l.value).log2().floor()),z=S(()=>r.pow(1.1,m.level.value)),ce=ie(()=>[q(()=>({multiplier:z,description:"Applied time",enabled:()=>m.active.value&&y.earned.value&&c.value===gl})),Re.batteries.experiments.timePassing.modifier]),pe=S(()=>ce.apply(1)),ke=ie(()=>[Dt.modifier,Re.batteries.experiments.xpGain.modifier]),Ct=ie(()=>[re.modifier]),Mt=S(()=>Ct.apply(l.value)),Y=ie(()=>[q(()=>({multiplier:()=>r.pow(1.1,A.value),description:"Grain size (x1.1 each split)",enabled:g.earned})),Ie.modifier]),nt=S(()=>Y.apply(1)),Le=ie(()=>[q(()=>({multiplier:()=>r.pow(2,A.value),description:"Grain size (x2 each split)",smallerIsBetter:!0})),Q.modifier]),Xe=S(()=>Le.apply(1)),ze=ie(()=>[dt.modifier]),ue=S(()=>ze.apply(0)),mt=ie(()=>[q(()=>({multiplier:ot,description:`${m.name} level (x1.1 each)`})),Ae.modifier,Re.batteries.experiments.resourceGain.modifier,Lt.plants.potentia.modifier]),St=ie(()=>[Ze.modifier]),pt={timePassing:ce,jobXpGain:ke,totalGrains:Ct,grainsFallRate:Y,chippingDuration:Le,potentiaGain:mt,potentialsSpeed:St,passiveGrinding:ze},[I,L]=Qt(()=>[{title:"Time Passing",modifier:ce,base:1,visible:()=>y.earned.value||Re.milestones.timeBatteriesMilestone.earned.value},{title:`${m.name} EXP Gain`,modifier:ke,base:1},{title:"Potentia Gain",modifier:mt,base:1},{title:"Potentials speed",modifier:St,base:1,visible:_.earned}]),[O,ye]=Qt(()=>[{title:"Total Grains",modifier:Ct,base:l},{title:"Grains Fall Speed",modifier:Y,base:1,unit:"/s"},{title:"Grinding duration",modifier:Le,base:1,unit:"s",visible:g.earned,smallerIsBetter:!0},{title:"Passive grinding",modifier:ze,base:0,unit:"%",visible:_.earned}]),le=Fn({general:()=>({display:"General",glowColor(){return le.activeTab.value===this.tab?t:""},tab:I,generalTabCollapsed:L}),grains:()=>({display:"Grains",glowColor(){return le.activeTab.value===this.tab?t:""},tab:O,grainsTabCollapsed:ye})},()=>({style:`--layer-color: ${t}`})),Qe=Bn(()=>({display:{title:"Grind",description:"Hover to grind grains apart, to create new grains"}})),kt=Mr(Qe);this.on("preUpdate",ae=>{if(!!m.active.value){if(ae=r.times(ae,pe.value).toNumber(),p.earned.value&&Object.values(we).forEach(Ne=>Ne.update(ae)),_.earned.value&&(Object.values(Ve).forEach(Ne=>Ne.update(ae)),u.value=r.add(u.value,r.times(ae,ue.value).div(100)).toNumber()),r.lt(a.value,1))a.value=r.add(a.value,ae).min(1).toNumber();else if(r.lt(i.value,Mt.value)){const Ne=r.add(i.value,r.times(nt.value,ae)).min(Mt.value),Te=mt.apply(r.sub(Ne,i.value));n.value=r.add(n.value,Te),m.xp.value=r.add(m.xp.value,ke.apply(Te)),i.value=Ne}for(kt.value&&(u.value=u.value+ae);r.gt(u.value,Xe.value);){const Ne=r.div(u.value,Xe.value).floor().min(new r(2).pow(new r(l.value).add(1).log2().floor().add(1)).sub(l.value));u.value=u.value-Ne.times(Xe.value).toNumber(),l.value=r.add(l.value,Ne)}}});const gt=Fn({grains:()=>({display:"Grains",tab:Gn(()=>({display:$(()=>s(T,null,[s($e,null,null),s(Ym,{baseGrains:l.value,chippingProgress:r.div(u.value,Xe.value).toNumber()},null),s($e,null,null),We(Qe)]))})),style:{borderLeft:"5px solid var(--outline)",marginLeft:"5px"}}),potentials:()=>({display:$(()=>s("span",{style:"position: relative;"},[f("Potentials"),d.value?s(Tn,{style:"left: -15px; top: -10px"},null):null])),tab:Gn(()=>({display:$(()=>s(T,null,[s($e,null,null),s("h2",null,[f("Basic Potentials")]),s($e,null,null),Ti(...Object.values(we).map(ae=>ae.display)),_.earned.value?s(T,null,[s($e,null,null),s("h2",null,[f("Advanced Potentials")]),s($e,null,null),Ti(...Object.values(Ve).map(ae=>ae.display))]):null]))})),visibility:p.earned}),appliedTime:()=>({display:"Applied Time",tab:Gn(()=>({display:$(()=>s(T,null,[s($e,null,null),s("div",null,[f("Focus your potential towards speeding up an entire job's time loop."),s("br",null,null),f("Strength increases with "),m.name,f(" level.")]),s($e,null,null),s(Gm,{effect:z.value,jobs:lt.jobs,selectedJob:c.value,onSelectJob:ae=>c.value=ae},null)]))})),visibility:y.earned})},()=>({classes:{floating:!1},style:{borderStyle:"none",marginLeft:"-20px",marginRight:"-20px"},buttonContainerStyle:{top:"50px"}})),Pt={[tt]:pp,[je]:()=>({totalGrains:Mt.value,grainsFallen:i.value,flippingProgress:a.value,onFlip:()=>{a.value=a.value>=1?0:a.value,i.value=0},showHourglassNotif:Ot.value})},Ot=Fi(Pt,()=>r.sub(Mt.value,i.value).lte(0));return{name:e,color:t,minWidth:670,potentia:n,baseTotalGrains:l,grainsFallen:i,flippingProgress:a,chippingProgress:u,basicPotentials:we,advancedPotentials:Ve,job:m,selectedJob:c,modifiers:pt,milestones:B,collapseMilestones:P,modifierTabs:le,tabs:gt,appliedTimeEffect:z,display:$(()=>{const ae=[...x.value];return X.value&&ae.push(X.value),s(T,null,[s(Ai,{resource:n,color:t},null),li(...ae,$(()=>mn(s(si,{collapsed:P,content:te,display:P.value?"Show other completed milestones":"Hide other completed milestones"},null),[[In,o(se)]]))),s($e,null,null),We(Pt),s($e,{height:"50px"},null),g.earned.value?We(gt):null])})}});var gp=["Seeds? I love seeds!","They can still be improved, I'm sure of it","Together we'll both grow to our full potentials","Progress moves ever forward, generation by generation","Grow!","They require meticulous care","Growth is a never-ending process","The perfect bloom is within reach","A garden of endless possibilities awaits","Delicate petals hold the key to advancement","Every flower has its own unique charm","Patience and care will yield beauty","The diversity of nature, in my hands","Each new generation holds untapped potential","The future blooms in these delicate seeds","New traits emerge from clever combinations","Fusing strengths to create something greater","Nature does nothing uselessly","Change begets growth","The earth laughs in flowers","Nature is the best teacher","Necessity is the mother of invention","The future is in the seeds we sow today","Progress is the child of time","The best way to predict the future is to create it"];const hp={key:2,class:"analyzed"};var mi=K({__name:"SeedSlot",props:{selected:{type:Boolean},seed:null,onClick:{type:Function}},setup(e){const t=e,n=Dn(S(()=>$(()=>t.seed==="none"?"":at(Lt.plants[t.seed.type].seed)))),l=ve($(()=>t.seed==="none"||!t.seed.analyzed?"":s(T,null,[f("Speed: "),ge(t.seed.speed),s("br",null,null),f("Harvest Size: "),ge(t.seed.harvest),s("br",null,null),f("Mutability: "),ge(t.seed.mutability)])));return(i,a)=>(b(),N("div",{class:Pe(["seed feature can",{selected:e.selected}]),onClick:a[0]||(a[0]=u=>e.onClick(e.seed))},[e.seed!=="none"&&e.seed.analyzed?(b(),H(it,{key:0,display:o(l)},{default:oe(()=>[o(n)?(b(),H(xe(o(n)),{key:0})):R("",!0),Kt(i.$slots,"default")]),_:3},8,["display"])):(b(),N(T,{key:1},[o(n)?(b(),H(xe(o(n)),{key:0})):R("",!0),Kt(i.$slots,"default")],64)),e.seed!=="none"&&e.seed.analyzed?(b(),N("div",hp,"*")):R("",!0)],2))}});const bp={class:"inputs"},yp=h("path",{d:"M4 29C15.1929 16.5 26.3858 4 54 4C109.228 4 98.7715 54 154 54C181.614 54 192.807 41.5 204 29",stroke:"grey","stroke-width":"7","stroke-linecap":"round"},null,-1),wp=K({__name:"Machine",props:{index:null,numInputs:null,inputs:null,timer:null,poweredUp:{type:Boolean},canPowerUp:null,duration:{type:Function},outputDisplay:{type:Function},setInput:{type:Function}},emits:["setPoweredUp"],setup(e,{emit:t}){const n=e,l=$t();Jt(()=>{l.value=ve(n.outputDisplay(n.inputs,n.index))});const i=S(()=>n.numInputs!==n.inputs.filter(a=>a!=null&&a!=="none").length);return(a,u)=>(b(),N("div",{class:Pe(["machine feature",{poweredUp:e.poweredUp,canPowerUp:!e.poweredUp&&o(e.canPowerUp)}])},[h("div",bp,[(b(!0),N(T,null,Zt(e.numInputs,c=>{var d;return b(),H(mi,{key:c-1,seed:(d=e.inputs[c-1])!=null?d:"none",onClick:()=>e.setInput(e.index,c-1)},null,8,["seed","onClick"])}),128))]),(b(),N("svg",{width:"208",height:"58",viewBox:"0 0 208 58",fill:"none",xmlns:"http://www.w3.org/2000/svg",onClick:u[0]||(u[0]=c=>t("setPoweredUp"))},[yp,h("path",{d:"M4 29C15.1929 16.5 26.3858 4 54 4C109.228 4 98.7715 54 154 54C181.614 54 192.807 41.5 204 29",stroke:"black","stroke-width":"7","stroke-linecap":"round",class:"progress",style:Se({strokeDashoffset:`calc(var(--dash-length) * ${o(r).sub(.33,o(r).div(e.timer,e.duration(e.inputs)).times(1.33)).toNumber()})`})},null,4)])),o(l)?(b(),H(xe(o(l)),{key:0})):R("",!0),o(i)?(b(),H(Tn,{key:1})):R("",!0)],2))}});const _p={key:0},Cp=h("span",{class:"toggle"},"\u25BC",-1),Sp=K({__name:"MachineType",props:{id:null,name:null,enabled:null,numInputs:null,inputs:null,timers:null,collapsed:null,machines:null,poweredUpMachine:null,canPowerUp:null,duration:{type:Function},outputDisplay:{type:Function},setInput:{type:Function},setPoweredUpMachine:{type:Function}},setup(e){return(t,n)=>o(e.enabled)?(b(),N("div",_p,[h("h2",{onClick:n[0]||(n[0]=l=>e.collapsed.value=!e.collapsed.value),class:Pe(["breeding-collapsible",{collapsed:e.collapsed.value}])},[Cp,f(Z(e.name),1)],2),e.collapsed.value?R("",!0):(b(),H(Yi,{key:0},{default:oe(()=>[(b(!0),N(T,null,Zt(new o(r)(e.machines.amount.value).toNumber(),l=>{var i,a;return b(),H(wp,{key:l-1,index:l-1,numInputs:e.numInputs,inputs:(i=o(e.inputs)[l-1])!=null?i:[],timer:(a=o(e.timers)[l-1])!=null?a:0,duration:e.duration,outputDisplay:e.outputDisplay,setInput:e.setInput,canPowerUp:e.canPowerUp,poweredUp:e.poweredUpMachine.value.type===e.id&&l-1===e.poweredUpMachine.value.index,onSetPoweredUp:()=>e.setPoweredUpMachine(l-1)},null,8,["index","numInputs","inputs","timer","duration","outputDisplay","setInput","canPowerUp","poweredUp","onSetPoweredUp"])}),128)),(b(),H(xe(e.machines[o(tt)]),fr(Yr(e.machines[o(je)]())),null,16))]),_:1}))])):R("",!0)}});const kp={class:"plant feature"},Np={class:"plant-symbol"},$p={class:"plant-details"},Mp=h("div",{style:{"flex-grow":"1"}},null,-1),Pp=h("h3",null,"Consume",-1),xp=h("br",null,null,-1),Ip={key:0},Tp=K({__name:"Plant",props:{name:null,symbol:null,color:null,effectDescription:null,amount:null,consumedTimeRemaining:null,multiplier:null,consume:null},setup(e){const t=e,n=S(()=>`${Oe(r.add(t.amount.value,1).log10().add(1))}x ${t.effectDescription} for ${zn(r.pow(t.amount.value,2).add(1).log2())}`);return(l,i)=>(b(),N("div",kp,[h("div",{class:"plant-info",style:Se({color:e.color})},[h("span",Np,Z(e.symbol),1),h("div",$p,[h("span",null,Z(e.name),1),h("span",null,"Stored: "+Z(o(ge)(o(e.amount))),1)]),Mp,h("button",{class:"button",onClick:i[0]||(i[0]=(...a)=>e.consume&&e.consume(...a))},[Pp,xp,f(Z(o(n)),1)])],4),o(r).gt(o(e.consumedTimeRemaining),0)?(b(),N("div",Ip," Current bonus: "+Z(o(Oe)(o(e.multiplier)))+"x "+Z(e.effectDescription)+" for "+Z(o(zn)(o(e.consumedTimeRemaining))),1)):R("",!0)]))}}),ki="breeding",Lt=qn(ki,function(){const e="Breeding Plants",t="#51D126",n=pn(0,"mutagens"),l=W([{type:"moly",analyzed:!1,speed:1,mutability:1,harvest:1}]),i=W("none"),a=W("none"),u=W({type:"none",index:-1}),c=W(!1),d=W(!1),m=Hn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"75%",y:"60%"},symbol:"emoji_nature",randomQuips(){return[...gp,...oi]},resource:n,layerID:ki,modifierInfo:$(()=>at(mt)),visibility:xn.milestones.jobMilestone.earned,showNotif:()=>Object.values(Ct).some(I=>o(I.machines.canClick)||l.value.length!==0&&I.inputs.value.some(L=>I.numInputs!==L.filter(O=>O!==null&&O!=="none").length))})),g=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,2)),display:{requirement:`Achieve ${m.name} Level 2`,effectDisplay:"Unlock breeding and analyzing machines"}})),p=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,4)),display:{requirement:`Achieve ${m.name} Level 4`,effectDisplay:"Unlock powering up machines"},visibility:g.earned})),w=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,5)),display:{requirement:`Achieve ${m.name} Level 5`,effectDisplay:'Unlock bonus generator in "Harnessing Power" job'},visibility:p.earned})),_=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,6)),display:{requirement:`Achieve ${m.name} Level 6`,effectDisplay:"Unlock recycling machine"},visibility:w.earned})),y=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,8)),display:{requirement:`Achieve ${m.name} Level 8`,effectDisplay:"Unlock mutating machine"},visibility:_.earned})),k=be(()=>({requirements:he(()=>r.gte(m.rawLevel.value,10)),display:{requirement:`Achieve ${m.name} Level 10`,effectDisplay:'Unlock 1/2 of "Performing Rituals" Job'},visibility:y.earned,onComplete(){Re.milestones.jobMilestone.earned.value&&Sn(Ei,U)}})),B={breedingAnalyzingMilestone:g,powerupMilestone:p,bonusGeneratorMilestone:w,recyclingMilestone:_,mutatingMilestone:y,jobMilestone:k},V=[k,y,_,w,p,g],P=W(!0),x=S(()=>V.filter(I=>I.earned.value===!1)),{firstFeature:X,collapsedContent:te,hasCollapsedContent:se}=ri(V,I=>I.earned.value);function G(I){const L=W(0),O=W(0),ye=W(0),le=W(!1);return ct(Qe=>{const kt=I.call(Qe,Qe),gt=S(()=>r.add(O.value,1).log10().add(1));return{...kt,amount:L,consumedAmount:O,consumedTimeRemaining:ye,discovered:le,multiplier:gt,modifier:q(()=>({multiplier:gt,description:`${kt.name} consumption`,enabled:()=>ye.value>0})),consume:function(){O.value=L.value,ye.value=r.pow(L.value,2).add(1).log2().toNumber(),L.value=0,le.value=!0},seed:{[tt]:ve(`\u{1F331}<sub><span class="material-icons" style="color: ${kt.color}">${kt.symbol}</span></sub>`),[je]:()=>({})},[tt]:Tp,[je]:function(){const{name:Pt,symbol:Ot,color:ae,effectDescription:Ne,amount:Te,consumedTimeRemaining:ee,multiplier:Ke,consume:yt}=this;return{name:Pt,symbol:Ot,color:ae,effectDescription:Ne,amount:Te,consumedTimeRemaining:ee,multiplier:Ke,consume:yt}}}})}const Q={moly:G(()=>({name:"Tempus Largitatis",symbol:De.job.symbol,color:De.job.color,effectDescription:"Moly gain"})),earthEssence:G(()=>({name:"Terra Lupulus",symbol:Je.elements.earth.symbol,color:Je.elements.earth.color,effectDescription:"Earth essence gain"})),waterEssence:G(()=>({name:"Aqua Lupulus",symbol:Je.elements.water.symbol,color:Je.elements.water.color,effectDescription:"Water essence gain"})),airEssence:G(()=>({name:"Aer Lupulus",symbol:Je.elements.air.symbol,color:Je.elements.air.color,effectDescription:"Air essence gain"})),fireEssence:G(()=>({name:"Ignis Lupulus",symbol:Je.elements.fire.symbol,color:Je.elements.fire.color,effectDescription:"Fire essence gain"})),properties:G(()=>({name:"Discipulo Scriptor",symbol:xn.job.symbol,color:xn.job.color,effectDescription:"Properties gain"})),potentia:G(()=>({name:"Glarea Fovea",symbol:Ce.job.symbol,color:Ce.job.color,effectDescription:"Potentia gain"})),energeia:G(()=>({name:"Vis Salutarias",symbol:Re.job.symbol,color:Re.job.color,effectDescription:"Energeia gain"}))};function Ae(I,L,O){const ye=W([]),le=W([]),Qe=W(!1),kt=Rr(gt=>({initialValue:1,visibility:Re.milestones.machinesMilestone.earned,requirements:Er(()=>({cost:v.variable(gt.amount).pow_base(L),resource:Re.energeia})),display:{description:`Additional ${I.slice(0,-1)}`,showAmount:!1},style:{width:"600px",minHeight:"unset"}}));return ct(gt=>{const Pt=O.call(gt,gt),Ot=Ue(Pt.enabled);return et(kt.amount,ae=>{for(;r.lt(ye.value.length,ae);)ye.value.push([]);for(;r.lt(le.value.length,ae);)le.value.push(0)}),{...Pt,name:I,priceRatio:L,enabled:Ot,inputs:ye,timers:le,collapsed:Qe,machines:kt,setInput:function(ae,Ne){var Ke,yt,nn;const Te=(yt=(Ke=ye.value[ae])==null?void 0:Ke[Ne])!=null?yt:"none";Te!=="none"&&l.value.push(Te);const ee=(nn=ye.value[ae])!=null?nn:[];ee[Ne]=i.value,ye.value[ae]=ee,l.value=l.value.filter(xt=>xt!==i.value),i.value="none"},duration:function(ae){const Ne=ae.filter(Ke=>Ke!=="none");if(Ne.length===0)return 1/0;const Te=Ne.map(Ke=>Ke.speed).reduce((Ke,yt)=>Ke+yt)/Ne.length,ee=r.times(Pt.baseDuration,r.pow(.99,r.sqrt(Te)));return new r(Pt.durationModifier.apply(ee)).toNumber()},setPoweredUpMachine(ae){Mt(Pt.id,ae)},[tt]:Sp,[je]:function(){const{id:ae,name:Ne,enabled:Te,numInputs:ee,inputs:Ke,timers:yt,collapsed:nn,machines:xt,duration:ln,outputDisplay:Nt,setInput:hn,setPoweredUpMachine:kn}=this;return{id:ae,name:Ne,enabled:Te,numInputs:ee,inputs:Ke,timers:yt,collapsed:nn,machines:xt,poweredUpMachine:u,canPowerUp:p.earned,duration:ln,outputDisplay:Nt,setInput:hn,setPoweredUpMachine:kn}}}})}const Ie=Ae("Growing Machines",50,()=>({id:"growMachines",enabled:!0,numInputs:1,baseDuration:100,durationModifier:ie(()=>[]),isRunning:I=>Object.keys(I).length===1&&I[0]!=="none",onActivate:I=>{if(Object.keys(I).length===0||I[0]==="none")return;Q[I[0].type].amount.value=r.add(Q[I[0].type].amount.value,I[0].harvest);const L=I[0].mutability;n.value=r.add(n.value,L),m.xp.value=r.add(m.xp.value,ze.apply(L))},outputDisplay:I=>$(()=>Object.keys(I).length===0||I[0]==="none"?s("div",null,[s("div",{style:"font-size: xx-large"},[f("?")]),s("div",null,[f("+1 mutations")])]):s("div",null,[s("div",{style:{fontSize:"xx-large",color:Q[I[0].type].color}},[ge(Q[I[0].type].amount.value)," ",Q[I[0].type].symbol]),s("div",null,[f("+ "),n.displayName])]))})),we=W([]);function Ze(I){return r.times(I.speed,I.harvest).pow(2).div(I.mutability).ceil()}function re(I,L){return r.max(1,r.add(I,r.sqrt(L).times(Math.random()-.4).ceil())).toNumber()}const Dt=Ae("Breeding Machines",80,()=>({id:"breedingMachines",enabled:g.earned,numInputs:1,baseDuration:600,durationModifier:ie(()=>[]),isRunning:(I,L)=>{var O;return((O=we.value[L])!=null?O:"none")==="none"&&Object.keys(I).length===1&&I[0]!=="none"&&r.gte(n.value,Ze(I[0]))},onActivate:(I,L)=>{if(Object.keys(I).length!==1||I[0]==="none"||we.value[L]!=null&&we.value[L]!=="none")return;n.value=r.sub(n.value,Ze(I[0]));let{speed:O,harvest:ye,mutability:le}=I[0],Qe=I[0].type;r.sub(1,r.add(le,1).log(1e6).pow(1.3).add(1).recip()).toNumber()>Math.random()&&(Qe=Object.keys(Q)[Math.floor(Math.random()*Object.keys(Q).length)],O=Math.sqrt(O),ye=Math.sqrt(ye),le=Math.sqrt(le)),O=re(O,le),ye=re(ye,le),le=re(le,le),we.value[L]={type:Qe,speed:O,harvest:ye,mutability:le,analyzed:!1}},outputDisplay:(I,L)=>$(()=>{var O;return s("div",null,[s(mi,{seed:(O=we.value[L])!=null?O:"none",onClick:ye=>{const le=we.value[L];ye!=="none"&&le!=null&&le!=="none"&&(l.value.push(le),we.value[L]="none")}},null),Dt.isRunning(I,L)?s("div",null,[f("-"),ge(Ze(I[0]))," ",n.displayName]):null])})})),dt=W([]);function Ve(I){return r.times(I.speed,I.harvest).times(I.mutability).ceil()}const ot=Ae("Analyzing Machines",100,()=>({id:"analyzingMachines",enabled:g.earned,numInputs:1,baseDuration:1200,durationModifier:ie(()=>[]),isRunning:(I,L)=>{var O;return((O=dt.value[L])!=null?O:"none")==="none"&&Object.keys(I).length===1&&I[0]!=="none"&&I[0].analyzed===!1&&r.gte(De.flowers.value,Ve(I[0]))},onActivate:(I,L)=>{Object.keys(I).length!==1||I[0]==="none"||I[0].analyzed||dt.value[L]!=null&&dt.value[L]!=="none"||(De.flowers.value=r.sub(De.flowers.value,Ve(I[0])),dt.value[L]={...I[0],analyzed:!0},ot.inputs.value[L]=[])},outputDisplay:(I,L)=>$(()=>{var O;return s("div",null,[s(mi,{seed:(O=dt.value[L])!=null?O:"none",onClick:ye=>{const le=dt.value[L];ye!=="none"&&le!=null&&le!=="none"&&(l.value.push(le),dt.value[L]="none")}},null),ot.isRunning(I,L)?s("div",null,[f("-"),ge(Ve(I[0]))," ",De.flowers.displayName]):null])})}));function A(I){return r.times(I.speed,I.harvest).times(I.mutability).ceil()}const z=Ae("Recycling Machines",90,()=>({id:"recyclingMachines",enabled:_.earned,numInputs:1,baseDuration:900,durationModifier:ie(()=>[]),isRunning:I=>Object.keys(I).length===1&&I[0]!=="none",onActivate:(I,L)=>{if(Object.keys(I).length!==1||I[0]==="none")return;const O=A(I[0]);n.value=r.add(n.value,O),m.xp.value=r.add(m.xp.value,ze.apply(O.times(10))),z.inputs.value[L]=[]},outputDisplay:(I,L)=>$(()=>s("div",null,[z.isRunning(I,L)&&I[0].analyzed?s("div",null,[f("+"),ge(A(I[0]))," ",n.displayName,s("br",null,null),f("x10 exp gained")]):s("div",null,[f("+ "),n.displayName,s("br",null,null),f("x10 exp gained")])]))})),ce=W([]);function pe(I){return r.times(I.mutability,2).pow(2).ceil()}const ke=Ae("Mutating Machines",150,()=>({id:"mutatingMachines",enabled:y.earned,numInputs:1,baseDuration:1800,durationModifier:ie(()=>[]),isRunning:(I,L)=>{var O;return((O=ce.value[L])!=null?O:"none")==="none"&&Object.keys(I).length===1&&I[0]!=="none"&&r.gte(n.value,pe(I[0]))},onActivate:(I,L)=>{Object.keys(I).length!==1||I[0]==="none"||ce.value[L]!=null&&ce.value[L]!=="none"||(n.value=r.sub(n.value,pe(I[0])),ce.value[L]={...I[0],mutability:I[0].mutability*2},ke.inputs.value[L]=[])},outputDisplay:(I,L)=>$(()=>{var O;return s("div",null,[s(mi,{seed:(O=ce.value[L])!=null?O:"none",onClick:ye=>{const le=ce.value[L];ye!=="none"&&le!=null&&le!=="none"&&(l.value.push(le),ce.value[L]="none")}},null),ke.isRunning(I,L)?s("div",null,[f("-"),ge(pe(I[0])),f(" "),n.displayName]):null])})})),Ct={growMachines:Ie,breedingMachines:Dt,analyzingMachines:ot,recyclingMachines:z,mutatingMachines:ke};function Mt(I,L){u.value={type:I,index:L}}const Y=S(()=>r.pow(1.1,m.level.value)),nt=S(()=>Object.values(Q).filter(I=>I.discovered.value).length),Le=ie(()=>[q(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===ki})),q(()=>({multiplier:()=>r.pow(1.1,nt.value),description:"Unique plants eaten (x1.1 each)"})),q(()=>({multiplier:Y,description:`${m.name} level (x1.1 each)`})),Re.batteries.breeding.timePassing.modifier]),Xe=S(()=>new r(Le.apply(1)).toNumber()),ze=ie(()=>[Re.batteries.breeding.xpGain.modifier,q(()=>({multiplier:Y,description:`${m.name} level (x1.1 each)`}))]),ue={timePassing:Le,jobXpGain:ze},[mt,St]=Qt(()=>[{title:"Time Passing",modifier:Le,base:1},{title:`${m.name} EXP Gain`,modifier:ze,base:1}]),pt=Fn({general:()=>({display:"General",glowColor(){return pt.activeTab.value===this.tab?t:""},tab:mt,generalTabCollapsed:St})},()=>({style:`--layer-color: ${t}`}));return this.on("preUpdate",I=>{m.timeLoopActive.value===!1&&U.tabs[1]!==ki||(I=r.times(I,Xe.value).toNumber(),Object.values(Ct).forEach(L=>{var ye;const O=L.timers.value;for(let le=0;r.lt(le,L.machines.amount.value);le++){const Qe=(ye=L.inputs.value[le])!=null?ye:[];L.isRunning(Qe,le)?(O[le]+=u.value.type===L.id&&u.value.index===le?I*2:I,r.gte(O[le],L.duration(Qe))&&(L.onActivate(L.inputs.value[le],le),O[le]=0)):O[le]=0}L.timers.value=O}))}),zt.on("update",(I,L)=>{m.timeLoopActive.value===!1&&U.tabs[1]!==ki||Object.values(Q).forEach(O=>{O.consumedTimeRemaining.value!==0&&(O.consumedTimeRemaining.value=Math.max(0,O.consumedTimeRemaining.value-L))})}),{name:e,color:t,minWidth:670,job:m,modifiers:ue,milestones:B,collapseMilestones:P,modifierTabs:pt,machines:Ct,seeds:l,selectedSeed:i,recycling:a,plants:Q,breedingOutputs:we,analyzingOutputs:dt,mutatingOutputs:ce,poweredUpMachine:u,plantsCollapsed:c,seedsCollapsed:d,display:$(()=>{const I=[...x.value];X.value&&I.push(X.value);const L=Object.keys(Q).filter(O=>Q[O].discovered.value||r.gt(Q[O].amount.value,0));return s(T,null,[s(Ai,{resource:n,color:t},null),li(...I,$(()=>mn(s(si,{collapsed:P,content:te,display:P.value?"Show other completed milestones":"Hide other completed milestones"},null),[[In,o(se)]]))),s($e,null,null),p.earned.value?s(T,null,[s("div",null,[f("Select a machine by clicking on its progress bar to make it work 2x faster")]),s($e,null,null)]):null,We(Ie),We(Dt),We(ot),We(z),We(ke),L.length>0?s(T,null,[s($e,null,null),s("h2",{class:{"breeding-collapsible":!0,collapsed:c.value},onClick:()=>c.value=!c.value},[s("span",{class:"toggle"},[f("\u25BC")]),f("Plants")]),c.value?null:Ti(...L.map(O=>Q[O]))]):null,s($e,null,null),s("h2",{class:{"breeding-collapsible":!0,collapsed:d.value},onClick:()=>d.value=!d.value},[s("span",{class:"toggle"},[f("\u25BC")]),f("Seeds")]),d.value?null:s("div",{style:"width: 600px"},[l.value.map(O=>s(mi,{seed:O,selected:i.value===O,onClick:()=>{i.value=i.value===O?"none":O}},null)),s("hr",null,null),s("div",{style:"display: flex; align-items: center; text-align: left"},[s(mi,{seed:a.value,onClick:()=>{i.value==="none"?a.value!=="none"&&(l.value.push(a.value),a.value="none"):(a.value=i.value,l.value=l.value.filter(O=>O!==i.value),i.value="none")}},{default:()=>[a.value==="none"?s("div",{class:"material-icons",style:"font-size: xxx-large; color: var(--outline); position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);z-index: -1;"},[f("delete")]):null]}),s("span",{style:"margin-left: 10px"},[f("Click here to trash your selected seed, or restore your most recently trashed seed.")])])])])})}}),Fp={min:.5,max:1},Ep=[{s:0,cp:.329,e:.548},{s:.548,cp:.767,e:.876},{s:.876,cp:.985,e:1}],Dp=.001,qp=.1,Ap=100,Lp=!0,Op={x:0,y:0},jp=!1,Rp=[{type:"alpha",config:{alpha:{list:[{time:0,value:.74},{time:1,value:0}]}}},{type:"moveSpeed",config:{speed:{list:[{time:0,value:700},{time:1,value:0}]},minMult:1}},{type:"scale",config:{scale:{list:[{time:0,value:5},{time:1,value:1.2}]},minMult:1}},{type:"color",config:{color:{list:[{time:0,value:"#ffdfa0"},{time:1,value:"#100f0c"}]}}},{type:"rotation",config:{accel:0,minSpeed:0,maxSpeed:200,minStart:0,maxStart:360}},{type:"textureRandom",config:{textures:["/particle.png"]}},{type:"spawnShape",config:{type:"rect",data:{x:0,y:0,w:200,h:100}}}];var ur={lifetime:Fp,ease:Ep,frequency:Dp,emitterLifetime:qp,maxParticles:Ap,addAtBack:Lp,pos:Op,emit:jp,behaviors:Rp};const Vr=e=>(en("data-v-22f08ee0"),e=e(),tn(),e),Bp={class:"modal-mask",style:{"z-index":"10","background-color":"var(--raised-background)",top:"50px"}},Vp={class:"cutscene-positioner"},Gp={class:"modal-container cutscene-container"},zp=Vr(()=>h("div",{class:"paper-background"},null,-1)),Up={class:"content"},Xp={key:0,class:"caption"},Hp={style:{display:"none"}},Jp={id:"wavy2"},Wp=["seed"],Zp=Vr(()=>h("feDisplacementMap",{in:"SourceGraphic",scale:"20"},null,-1)),Qp=K({__name:"Cutscene",props:{stage:null,caption:null},emits:["next"],setup(e,{emit:t}){const n=e,l=Yt(n,"stage"),i=Yt(n,"caption"),a=J(1);et([l,i],()=>a.value++);const u=ni(l),c=Dn(i);return(d,m)=>(b(),H(mr,{to:"#modal-root"},[s($l,{name:"cutscene-modal"},{default:oe(()=>[h("div",Bp,[h("div",Vp,[h("div",Gp,[zp,h("div",Up,[(b(),H(xe(o(u)))),o(c)?(b(),N("div",Xp,[(b(),H(xe(o(c))))])):R("",!0)]),h("button",{onClick:m[0]||(m[0]=g=>t("next")),class:"button next"},"Next")]),(b(),N("svg",Hp,[h("filter",Jp,[h("feTurbulence",{x:"-50vw",y:"-50vh",width:"200vw",height:"200vh",baseFrequency:"0.015",numOctaves:"10",seed:a.value},null,8,Wp),Zp])]))])])]),_:1})]))}});var Kp=me(Qp,[["__scopeId","data-v-22f08ee0"]]);const cr=bi(),Rl=["flowers","distill","study","experiments","generators","breeding","rituals"],Yp="main",lt=qn(Yp,function(){const e=W(0),t=Ut({flowers:De.job,distill:Je.job,study:xn.job,experiments:Ce.job,generators:Re.job,breeding:Lt.job,rituals:Ei.job}),n=S(()=>{let y=0;return e.value>1&&(y=1,xn.milestones.timeSlotMilestone.earned.value&&y++,Ce.milestones.timeSlotMilestone.earned.value&&y++,Ei.milestones.timeSlotMilestone.earned.value&&y++),y}),l=S(()=>Object.values(t).filter(y=>y.timeLoopActive.value).length+Re.extraTimeSlotsAllocated.value),i=S(()=>n.value>l.value),a=W([0,0,0,0,0]);Object.values(t).forEach(y=>{let k=0;et(y.rawLevel,(B,V)=>{var P;if(!(qe.active!==U.id||r.neq(B,r.add(V,1)))&&(y.notif!=null&&cr.dismiss(y.notif),y.notif=cr.info(`${y.name} is now level ${B}!`),Date.now()-k>500)){const x=(P=lt.nodes.value[y.id])==null?void 0:P.rect,X=g.boundingRect.value;if(x&&X){k=Date.now();const te=Object.assign({},ur,{behaviors:[...ur.behaviors.slice(0,-1),{type:"spawnShape",config:{type:"rect",data:{x:x.x-X.x,y:x.y-X.y,w:x.width,h:x.height}}}]});g.addEmitter(te).then(se=>se.playOnceAndDestroy())}}})});const u=pn(S(()=>Object.values(t).reduce((y,k)=>y.add(k.level.value),new r(0))),"Sum of all job levels"),c=_c(u),d=nl(u),m=Tc(()=>({display:{title:"<h1>Close the time loop</h1>",description:"<br/><i>The flowers are collected, and I have just enough. It's time to get started.</i>"},requirements:[],style:`width: 150px; height: 150px; --layer-color: ${De.color}`,visibility:()=>e.value==1&&r.gte(De.flowers.value,1e7)})),g=tl(()=>({boundingRect:J(null),onContainerResized(y){this.boundingRect.value=y},style:"z-index: -1"})),p=J(null);Jt(()=>{if(qe.active===U.id){if(e.value===0){p.value={pages:[{stage:$(()=>s("img",{style:"max-width: 100%; flex-grow: 1",src:"https://upload.wikimedia.org/wikipedia/commons/7/71/Serpiente_alquimica.jpg"},null))},{stage:$(()=>s("img",{style:"max-width: 100%; flex-grow: 1",src:"https://dummyimage.com/720x320/000/fff.png"},null)),caption:"Test"},{stage:$(()=>s("div",{style:"display: flex"},[s("img",{style:"max-width: 100%; flex-grow: 1; margin-right: -20%",src:"https://dummyimage.com/386x320/000/fff.png"},null),s("img",{style:"max-width: 100%; flex-grow: 1; margin-left: -20%",src:"https://dummyimage.com/386x320/000/fff.png"},null)])),caption:"Other test"}],page:0,onFinished(){e.value=1,Sn(De,U)}};return}else if(e.value===1&&m.bought.value){p.value={pages:[{stage:$(()=>s("img",{style:"max-width: 100%; flex-grow: 1",src:"https://dummyimage.com/720x320/000/fff.png"},null)),caption:"I can wrap this field in a time loop and reset it whenever the field is empty. If I take the flowers out of the loop before hand I will have a perfectly sustainable source of moly."},{stage:$(()=>s("img",{style:"max-width: 100%; flex-grow: 1",src:"https://dummyimage.com/720x320/000/fff.png"},null)),caption:"Now my focus will be transforming the flowers, and determining how best to utilize their power. I'll start by distilling the flowers into their component elements."}],page:0,onFinished(){e.value=2,Sn(Je,U)}};return}p.value=null}});const w=S(()=>e.value===1?s("h2",null,[f("Current Goal: Harvest all the moly"),s("br",null,null),f("("),ge(r.sub(1e7,De.flowers.value).clampMin(0))," ",f("remaining)")]):e.value==2?s("h2",null,[f("Current Goal: Perform Ritual of G\xE9nesis")]):s(T,null,null)),_=Hn("???",()=>({color:"black",image:"https://dummyimage.com/720x320/000/fff.png",imageFocus:{x:"50%",y:"50%"},layerID:"unknown",symbol:"",loopable:!1,visibility:()=>Re.milestones.jobMilestone.earned.value!==Lt.milestones.jobMilestone.earned.value,classes:{broken:!0},open:()=>{}}));return{name:"Jobs",chapter:e,timeSlots:n,hasTimeSlotAvailable:i,resetTimes:a,closeTimeLoop:m,activeCutscene:p,classes:{nigredo:!0},jobs:t,partialJob:_,sumJobLevels:u,bestJobLevelsSum:d,totalJobLevelsSum:c,display:$(()=>p.value?s(Kp,{stage:p.value.pages[p.value.page].stage,caption:p.value.pages[p.value.page].caption,onNext:()=>{var y,k;p.value&&(p.value.page==p.value.pages.length-1?(k=(y=p.value).onFinished)==null||k.call(y):p.value.page++)}},null):s(T,null,[U.devSpeed===0?s("div",null,[f("Game Paused")]):null,U.devSpeed!=null&&U.devSpeed!==1?s("div",null,[f("Dev Speed: "),Oe(U.devSpeed),f("x")]):null,U.offlineTime!=null?s("div",null,[f("Offline Time: "),zn(U.offlineTime)]):null,U.devSpeed!=null||U.offlineTime!=null?s($e,null,null):null,o(w),s($e,null,null),r.gt(n.value,0)?s("div",null,[n.value-l.value,f(" Time Slot"),n.value-l.value===1?"":"s",f(" Available")]):null,Ti(...Object.values(t),_),We(m),We(g)]))}});zt.on("update",e=>{lt.chapter.value>-1&&lt.activeCutscene.value!=null&&(lt.resetTimes.value[lt.chapter.value-1]+=e)});const Sl=S(()=>Rl.filter(e=>ft(lt.jobs[e].visibility)).length),ef=e=>{var n,l,i,a,u,c,d,m,g,p,w,_,y,k,B,V,P,x,X,te,se,G,Q,Ae,Ie,we,Ze;const t=(i=(l=(n=e.layers)==null?void 0:n.main)==null?void 0:l.chapter)!=null?i:0;if(t===0)return[lt];if(t===1)return[lt,De];if(t===2){const re=[lt,De,Je];return((d=(c=(u=(a=e.layers)==null?void 0:a.distill)==null?void 0:u.milestones)==null?void 0:c.studyMilestone)==null?void 0:d.earned)===!0&&re.push(xn),((w=(p=(g=(m=e.layers)==null?void 0:m.distill)==null?void 0:g.milestones)==null?void 0:p.experimentsMilestone)==null?void 0:w.earned)===!0&&re.push(Ce),((B=(k=(y=(_=e.layers)==null?void 0:_.experiments)==null?void 0:y.milestones)==null?void 0:k.jobMilestone)==null?void 0:B.earned)===!0&&re.push(Re),((X=(x=(P=(V=e.layers)==null?void 0:V.study)==null?void 0:P.milestones)==null?void 0:x.jobMilestone)==null?void 0:X.earned)===!0&&re.push(Lt),((Q=(G=(se=(te=e.layers)==null?void 0:te.generators)==null?void 0:se.milestones)==null?void 0:G.jobMilestone)==null?void 0:Q.earned)===!0&&((Ze=(we=(Ie=(Ae=e.layers)==null?void 0:Ae.breeding)==null?void 0:Ie.milestones)==null?void 0:we.jobMilestone)==null?void 0:Ze.earned)===!0&&re.push(Ei),re}throw`Chapter ${t} not supported`},Gr=S(()=>!1);function tf(e,t){}var nf=Object.freeze(Object.defineProperty({__proto__:null,jobKeys:Rl,main:lt,numJobs:Sl,getInitialLayers:ef,hasWon:Gr,fixOldSave:tf},Symbol.toStringTag,{value:"Module"}));const lf={class:"modifier-info-toggle"},rf=K({__name:"ModifierInfo",props:{display:null,name:null},setup(e){const n=Yt(e,"display"),l=J(!1),i=$t();let a=null;return et(l,u=>{a==null||a(),u?a=Jt(()=>{i.value=ve(rt(n))}):a=null}),Ml(()=>a==null?void 0:a()),(u,c)=>(b(),N(T,null,[s(it,{direction:o(Me).Left,display:"Open Modifiers",xoffset:"10px"},{default:oe(()=>[h("div",lf,[h("button",{onClick:c[0]||(c[0]=ti(d=>l.value=!0,["stop"]))},"?")])]),_:1},8,["direction"]),s(Un,Ht({modelValue:l.value,"onUpdate:modelValue":c[1]||(c[1]=d=>l.value=d),class:"modifiers-modal"},u.$attrs),{header:oe(()=>[h("h2",null,Z(e.name)+" Modifiers",1)]),body:oe(({shown:d})=>[d?(b(),H(xe(o(i)),{key:0})):R("",!0)]),_:1},16,["modelValue"])],64))}});var af=me(rf,[["__scopeId","data-v-19951ae7"]]),sf=K({props:{visibility:{type:j(Number),required:!0},style:j(String,Object,Array),classes:j(Object),xp:{type:Object,required:!0},level:{type:Object,required:!0},levelProgress:{type:Object,required:!0},timeLoopActive:{type:Object,required:!0},name:{type:String,required:!0},color:{type:j(String),required:!0},image:{type:j(String),required:!0},imageFocus:{type:j(Object),required:!0},resource:[Object,Array],layerID:{type:String,required:!0},currentQuip:{type:Object,required:!0},randomQuips:{type:j(Array)},modifierInfo:j(String,Object,Function),id:{type:String,required:!0},modifierModalAttrs:Object,showNotif:j(Boolean),loopable:j(Boolean),open:{type:Function,required:!0}},components:{Node:Xn,ModifierInfo:af,Tooltip:it,Notif:Tn},setup(e){const{layerID:t,currentQuip:n,randomQuips:l,resource:i}=st(e),a=S(()=>U.tabs[1]==t.value),u=S(()=>lt.chapter.value>1),c=lt.hasTimeSlotAvailable;let d;Jt(()=>{var w;clearInterval(d);const p=(w=rt(l))!=null?w:[];n.value!=null?d=setTimeout(()=>{n.value=null},15e3):d=setTimeout(()=>{n.value=p[Math.floor(Math.random()*p.length)]},Math.random()*15e3+15e3)}),Nl(()=>clearInterval(d));const m=J(!1);et(a,()=>{m.value=!0,setTimeout(()=>m.value=!1,250)});const g=S(()=>{if("displayName"in i)return[i];const p=o(i);return Array.isArray(p)?p:[]});return{selected:a,animating:m,finishedFirstChapter:u,hasTimeSlotAvailable:c,formatWhole:ge,unref:o,displayResource:Pn,resourceArray:g,Visibility:Ge,Direction:Me,isVisible:ft,isHidden:En}}});const rl=e=>(en("data-v-406f5cb3"),e=e(),tn(),e),of=["src"],uf={class:"job-contents"},cf={class:"job-resource"},df=rl(()=>h("br",null,null,-1)),mf=rl(()=>h("br",null,null,-1)),pf={class:"job-title"},ff={style:{"margin-bottom":"0"}},vf=rl(()=>h("div",{class:"time-loop"},null,-1)),gf=[vf],hf={key:0,class:"job-quip"},bf=rl(()=>h("div",{class:"job-clipping-container"},[h("div",{class:"job-progress-container"},[h("div",{class:"job-progress"})])],-1)),yf=["disabled"];function wf(e,t,n,l,i,a){var g,p;const u=Et("Tooltip"),c=Et("ModifierInfo"),d=Et("Node"),m=Et("Notif");return e.isVisible(e.visibility)?(b(),N("span",{key:0,style:Se([{visibility:e.isHidden(e.visibility)?"hidden":void 0,"--posx":e.unref(e.imageFocus).x,"--posy":e.unref(e.imageFocus).y,"--progress":`${(1-e.unref(e.levelProgress))*100}%`,"--foreground":e.unref(e.color)},(g=e.unref(e.style))!=null?g:{}]),class:Pe(["feature dontMerge job",[{selected:e.selected,active:e.selected||e.unref(e.timeLoopActive),animating:e.animating},(p=e.unref(e.classes))!=null?p:{}]]),onClick:t[1]||(t[1]=(...w)=>e.open&&e.open(...w))},[h("img",{src:e.unref(e.image)},null,8,of),h("div",uf,[(b(!0),N(T,null,Zt(e.resourceArray,(w,_)=>(b(),N(T,{key:_},[h("div",cf,[f(Z(e.displayResource(w))+" "+Z(w.displayName),1),df]),mf],64))),128)),h("div",pf,[h("h2",null,Z(e.name),1),h("span",ff,"Lv. "+Z(e.formatWhole(e.level.value)),1)])]),h("div",{class:"time-loop-container",style:Se(e.unref(e.timeLoopActive)?"":"opacity: 0")},gf,4),e.selected&&e.unref(e.currentQuip)?(b(),N("div",hf,'"'+Z(e.unref(e.currentQuip))+'"',1)):R("",!0),bf,e.unref(e.loopable)!==!1?(b(),H(u,{key:1,direction:e.Direction.Left,display:"Toggle Time Loop",class:Pe(["job-loop-toggle",{active:e.unref(e.timeLoopActive)}])},{default:oe(()=>[e.finishedFirstChapter?(b(),N("button",{key:0,class:"material-icons",onClick:t[0]||(t[0]=ti(w=>e.timeLoopActive.value=!e.unref(e.timeLoopActive),["stop"])),disabled:!e.hasTimeSlotAvailable&&!e.unref(e.timeLoopActive)}," all_inclusive ",8,yf)):R("",!0)]),_:1},8,["direction","class"])):R("",!0),e.modifierInfo?(b(),H(c,Ht({key:2,display:e.modifierInfo,name:e.name},e.modifierModalAttrs),null,16,["display","name"])):R("",!0),s(d,{id:e.id},null,8,["id"]),e.unref(e.showNotif)?(b(),H(m,{key:3})):R("",!0)],6)):R("",!0)}var _f=me(sf,[["render",wf],["__scopeId","data-v-406f5cb3"]]);const Cf=Symbol("Job"),zr=.7643;function Hn(e,t){const n=pn({}.VITEST==null?0:J(0),e+" XP"),l={}.VITEST==null?W(!1):J(!1);return ct(i=>{const a=t.call(i,i);return a.id=fn("job-"),a.type=Cf,a[tt]=_f,a.name=e,a.xp=n,a.timeLoopActive=l,a.levelFormula=v.variable(n).clampMin(1).log10().add(1).step(25,u=>u.pow(zr)).floor(),a.rawLevel=S(()=>a.levelFormula.evaluate()),a.level=pn(a.rawLevel,a.name+" Levels"),a.levelProgress=S(()=>{const u=a,c=u.levelFormula.evaluate(),d=u.levelFormula.invert(c),m=u.levelFormula.invert(r.add(c,1));let g;return r.lt(c,25)?g=r.sub(u.xp.value,d).div(r.sub(m,d)).toNumber():g=r.log10(u.xp.value).sub(r.log10(d)).div(r.log10(m).sub(r.log10(d))).toNumber(),Number.isNaN(g)&&(g=0),g}),a.active=S(()=>ft(a.visibility)&&(a.timeLoopActive.value||U.tabs[1]===a.layerID)),a.currentQuip=J(null),Ye(a,"open",function(){U.tabs.splice(1,1,a.layerID)}),a.setQuip=function(u){const c=a;if(c.currentQuip.value!=null){c.currentQuip.value=null,Gt(c.setQuip);return}if(u!=null)c.currentQuip.value=u;else if(o(c.randomQuips)){const d=o(c.randomQuips);c.currentQuip.value=d[Math.floor(Math.random()*d.length)]}},E(a,"visibility"),Ye(a,"visibility",Ge.Visible),E(a,"classes"),E(a,"style"),E(a,"color"),E(a,"image"),E(a,"imageFocus"),E(a,"randomQuips"),E(a,"modifierInfo"),E(a,"showNotif"),E(a,"loopable"),a[je]=function(){const{id:u,xp:c,level:d,levelProgress:m,timeLoopActive:g,name:p,visibility:w,color:_,image:y,imageFocus:k,resource:B,layerID:V,classes:P,style:x,currentQuip:X,randomQuips:te,modifierInfo:se,modifierModalAttrs:G,showNotif:Q,loopable:Ae,open:Ie}=this;return{id:u,xp:c,level:d,levelProgress:m,timeLoopActive:g,name:p,visibility:w,color:_,image:y,imageFocus:k,resource:B,layerID:V,classes:P,style:o(x),currentQuip:X,randomQuips:te,modifierInfo:se,modifierModalAttrs:G,showNotif:Q,loopable:Ae,open:Ie}},a})}const Sf={key:0},kf=["onClick","disabled"],Nf={key:0},$f=["onClick"],Mf=K({__name:"DangerButton",props:{disabled:{type:Boolean},skipConfirm:{type:Boolean}},emits:["click","confirmingChanged"],setup(e,{emit:t}){const l=st(e),i=J(!1);et(i,c=>{t("confirmingChanged",c)});function a(){if(o(l.skipConfirm)){t("click");return}i.value&&t("click"),i.value=!i.value}function u(){i.value=!1}return(c,d)=>(b(),N("span",{class:Pe(["container",{confirming:i.value}])},[i.value?(b(),N("span",Sf,"Are you sure?")):R("",!0),h("button",{onClick:ti(a,["stop"]),class:"button danger",disabled:e.disabled},[i.value?(b(),N("span",Nf,"Yes")):Kt(c.$slots,"default",{key:1},void 0,!0)],8,kf),i.value?(b(),N("button",{key:1,class:"button",onClick:ti(u,["stop"])},"No",8,$f)):R("",!0)],2))}});var Pf=me(Mf,[["__scopeId","data-v-2f8ef34c"]]);const An=e=>(en("data-v-7a38a5a2"),e=e(),tn(),e),xf=An(()=>h("div",{class:"handle material-icons"},"drag_handle",-1)),If={key:0,class:"actions"},Tf=An(()=>h("span",{class:"material-icons"},"content_paste",-1)),Ff=An(()=>h("span",{class:"material-icons"},"content_copy",-1)),Ef=An(()=>h("span",{class:"material-icons"},"edit",-1)),Df=An(()=>h("span",{class:"material-icons",style:{margin:"-2px"}},"delete",-1)),qf={key:1,class:"actions"},Af=An(()=>h("span",{class:"material-icons"},"check",-1)),Lf=An(()=>h("span",{class:"material-icons"},"close",-1)),Of={key:2,class:"details"},jf={class:"save-version"},Rf=An(()=>h("br",null,null,-1)),Bf={key:0},Vf={key:1},Gf={key:3,class:"details"},zf={key:4,class:"details error"},Uf=An(()=>h("br",null,null,-1)),Xf=K({__name:"Save",props:{save:null},emits:["export","open","duplicate","delete","editName"],setup(e,{emit:t}){const n=e,{save:l}=st(n),i=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),a=J(!1),u=J(!1),c=J("");et(a,()=>{var w;return c.value=(w=l.value.name)!=null?w:""});const d=S(()=>l.value!=null&&l.value.id===U.id),m=S(()=>{var w;return d.value?U.time:(w=l.value!=null&&l.value.time)!=null?w:0}),g=ni(S(()=>{var _,y,k,B,V,P,x,X,te,se,G,Q,Ae;const w=(B=(k=(y=(_=l.value)==null?void 0:_.layers)==null?void 0:y.main)==null?void 0:k.chapter)!=null?B:0;if(w==0)return"Just started";if(w==1){const Ie=(X=(x=(P=(V=l.value)==null?void 0:V.layers)==null?void 0:P.flowers)==null?void 0:x.flowers)!=null?X:0;return`Chapter 1; ${ge(Ie)} flowers`}else if(w==2){const Ie=(Ae=Object.values((Q=(G=(se=(te=l.value)==null?void 0:te.layers)==null?void 0:se.main)==null?void 0:G.jobs)!=null?Q:{}).reduce((we,Ze)=>{if(Ze.xp==null)return we;if(r.eq(Ze.xp,0))return we.add(1);let re=r.clampMin(Ze.xp,1).log10().add(1);return re.gt(25)&&(re=re.sub(25).pow(zr).add(25)),re.floor().add(we)},new r(0)))!=null?Ae:new r(0);return`Chapter 2; ${ge(Ie)} total job levels`}else return`Chapter ${w}`}));function p(){t("editName",c.value),a.value=!1}return(w,_)=>(b(),N("div",{class:Pe(["save",{active:o(d)}])},[xf,a.value?(b(),N("div",qf,[h("button",{onClick:p,class:"button"},[s(it,{display:"Save",direction:o(Me).Left,class:"info"},{default:oe(()=>[Af]),_:1},8,["direction"])]),h("button",{onClick:_[5]||(_[5]=y=>a.value=!a.value),class:"button"},[s(it,{display:"Cancel",direction:o(Me).Left,class:"info"},{default:oe(()=>[Lf]),_:1},8,["direction"])])])):(b(),N("div",If,[o(l).error==null&&!u.value?(b(),H(xl,{key:0,onClick:_[0]||(_[0]=y=>t("export")),class:"button",left:""},{default:oe(()=>[s(it,{display:"Export",direction:o(Me).Left,class:"info"},{default:oe(()=>[Tf]),_:1},8,["direction"])]),_:1})):R("",!0),o(l).error==null&&!u.value?(b(),N("button",{key:1,onClick:_[1]||(_[1]=y=>t("duplicate")),class:"button"},[s(it,{display:"Duplicate",direction:o(Me).Left,class:"info"},{default:oe(()=>[Ff]),_:1},8,["direction"])])):R("",!0),o(l).error==null&&!u.value?(b(),N("button",{key:2,onClick:_[2]||(_[2]=y=>a.value=!a.value),class:"button"},[s(it,{display:"Edit Name",direction:o(Me).Left,class:"info"},{default:oe(()=>[Ef]),_:1},8,["direction"])])):R("",!0),s(Pf,{disabled:o(d),onClick:_[3]||(_[3]=y=>t("delete")),onConfirmingChanged:_[4]||(_[4]=y=>u.value=y)},{default:oe(()=>[s(it,{display:"Delete",direction:o(Me).Left,class:"info"},{default:oe(()=>[Df]),_:1},8,["direction"])]),_:1},8,["disabled"])])),o(l).error==null&&!a.value?(b(),N("div",Of,[h("button",{class:"button open",onClick:_[6]||(_[6]=y=>t("open"))},[h("h3",null,Z(o(l).name),1)]),h("span",jf,"v"+Z(o(l).modVersion),1),Rf,o(m)?(b(),N("div",Bf,"Last played "+Z(o(i).format(o(m))),1)):R("",!0),o(g)?(b(),N("div",Vf,[(b(),H(xe(o(g))))])):R("",!0)])):o(l).error==null&&a.value?(b(),N("div",Gf,[s(Fr,{modelValue:c.value,"onUpdate:modelValue":_[7]||(_[7]=y=>c.value=y),class:"editname",onSubmit:p},null,8,["modelValue"])])):(b(),N("div",zf,[f(" Error: Failed to load save with id "+Z(o(l).id),1),Uf,f(Z(o(l).error),1)]))],2))}});var Hf=me(Xf,[["__scopeId","data-v-7a38a5a2"]]);const Bl=e=>(en("data-v-2a4275be"),e=e(),tn(),e),Jf=Bl(()=>h("h2",null,"Saves Manager",-1)),Wf={class:"modal-footer"},Zf={class:"field"},Qf=Bl(()=>h("span",{class:"field-title"},"Create Save",-1)),Kf={class:"field-buttons"},Yf={class:"footer"},ev=Bl(()=>h("div",{style:{"flex-grow":"1"}},null,-1)),tv=K({__name:"SavesManager",setup(e,{expose:t}){const n=J(!1),l=J(null);t({open(){n.value=!0}});const i=J(!1),a=J(""),u=J(null);et(a,P=>{P?Gt(()=>{try{if(P[0]!=="{")if(P[0]==="e")P=decodeURIComponent(escape(atob(P)));else if(P[0]==="\u1BE1")P=Mn.decompressFromUTF16(P);else{console.warn("Unable to determine preset encoding",P),i.value=!0;return}const x=JSON.parse(P);if(typeof x!="object"){i.value=!0;return}const X=Gi();x.id=X,sn(x),a.value="",i.value=!1,qe.saves.push(X)}catch{i.value=!0}}):i.value=!1});let c={},d=J(Object.keys(c).reduce((P,x)=>(P.push({label:x.split("/").slice(-1)[0].slice(0,-4),value:c[x]}),P),[]));const m=kl({});function g(P){if(m[P]==null){let x=localStorage.getItem(P);if(x==null)m[P]={error:"Save doesn't exist in localStorage",id:P};else if(x==="dW5kZWZpbmVk")m[P]={error:"Save is undefined",id:P};else try{if(x[0]!=="{")if(x[0]==="e")x=decodeURIComponent(escape(atob(x)));else if(x[0]==="\u1BE1")x=Mn.decompressFromUTF16(x);else return console.warn("Unable to determine preset encoding",x),i.value=!0,m[P]={error:"Unable to determine preset encoding",id:P},m[P];m[P]={...JSON.parse(x),id:P}}catch(X){m[P]={error:X,id:P},console.warn(`SavesManager: Failed to load info about save with id ${P}:
${X}
${x}`)}}return m[P]}et(n,P=>{P&&Object.keys(m).forEach(x=>delete m[x])});const p=S(()=>qe.saves.reduce((P,x)=>(P[x]=g(x),P),{}));function w(P){let x;switch(U.id===P?x=Pl(U):x=JSON.stringify(p.value[P]),Be.exportEncoding){default:console.warn(`Unknown save encoding: ${Be.exportEncoding}. Defaulting to lz`);case"lz":x=Mn.compressToUTF16(x);break;case"base64":x=btoa(unescape(encodeURIComponent(x)));break;case"plain":break}const X=document.createElement("textarea");X.value=x,document.body.appendChild(X),X.select(),X.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(X)}function _(P){U.id===P&&sn();const x={...p.value[P],id:Gi()};sn(x),qe.saves.push(x.id)}function y(P){qe.saves=qe.saves.filter(x=>x!==P),localStorage.removeItem(P),m[P]=void 0}function k(P){p.value[U.id].time=U.time,sn(),m[U.id]=void 0,Yn(p.value[P]),m[P]=void 0}function B(P){if(u.value=P,Gt(()=>{u.value=null}),P[0]!=="{")if(P[0]==="e")P=decodeURIComponent(escape(atob(P)));else if(P[0]==="\u1BE1")P=Mn.decompressFromUTF16(P);else{console.warn("Unable to determine preset encoding",P);return}const x=JSON.parse(P);x.id=Gi(),sn(x),qe.saves.push(x.id),k(x.id)}function V(P,x){const X=p.value[P];X!=null&&(X.name=x,U.id===P?(U.name=x,sn()):(sn(X),m[P]=void 0))}return(P,x)=>(b(),H(Un,{modelValue:n.value,"onUpdate:modelValue":x[4]||(x[4]=X=>n.value=X),ref_key:"modal",ref:l},{header:oe(()=>[Jf]),body:oe(({shown:X})=>[X?(b(),H(o(na),{key:0,list:o(qe).saves,handle:".handle",itemKey:te=>te},{item:oe(({element:te})=>[s(Hf,{save:o(p)[te],onOpen:se=>k(te),onExport:se=>w(te),onEditName:se=>V(te,se),onDuplicate:se=>_(te),onDelete:se=>y(te)},null,8,["save","onOpen","onExport","onEditName","onDuplicate","onDelete"])]),_:1},8,["list","itemKey"])):R("",!0)]),footer:oe(()=>[h("div",Wf,[s(Fr,{modelValue:a.value,"onUpdate:modelValue":x[0]||(x[0]=X=>a.value=X),title:"Import Save",placeholder:"Paste your save here!",class:Pe({importingFailed:i.value})},null,8,["modelValue","class"]),h("div",Zf,[Qf,h("div",Kf,[h("button",{class:"button",onClick:x[1]||(x[1]=X=>k(o(fi)().id))},"New Game"),Object.keys(o(d)).length>0?(b(),H(Al,{key:0,options:o(d),modelValue:u.value,"onUpdate:modelValue":x[2]||(x[2]=X=>B(X)),closeOnSelect:"",placeholder:"Select preset",class:"presets"},null,8,["options","modelValue"])):R("",!0)])]),h("div",Yf,[ev,h("button",{class:"button modal-default-button",onClick:x[3]||(x[3]=X=>n.value=!1)}," Close ")])])]),_:1},8,["modelValue"]))}});var Ur=me(tv,[["__scopeId","data-v-2a4275be"]]);const on=e=>(en("data-v-bb0ccae8"),e=e(),tn(),e),nv=["src","alt"],iv={key:1,class:"title"},lv=on(()=>h("div",{style:{"flex-grow":"1",cursor:"unset"}},null,-1)),rv={class:"discord"},av={class:"discord-links"},sv={key:0},ov=["href"],uv=on(()=>h("li",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"Profectus & Friends")],-1)),cv=on(()=>h("li",null,[h("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),dv={href:"https://forums.moddingtree.com/",target:"_blank"},mv=on(()=>h("span",{class:"material-icons"},"forum",-1)),pv=on(()=>h("span",{class:"material-icons"},"info",-1)),fv=on(()=>h("span",{class:"material-icons"},"library_books",-1)),vv=on(()=>h("span",{class:"material-icons"},"settings",-1)),gv=on(()=>h("span",{class:"material-icons"},"library_books",-1)),hv=on(()=>h("span",{class:"material-icons"},"settings",-1)),bv=on(()=>h("span",{class:"material-icons"},"info",-1)),yv={href:"https://forums.moddingtree.com/",target:"_blank"},wv=on(()=>h("span",{class:"material-icons"},"forum",-1)),_v={class:"discord"},Cv={class:"discord-links"},Sv={key:0},kv=["href"],Nv=on(()=>h("li",null,[h("a",{href:"https://discord.gg/yJ4fjnjU54",target:"_blank"},"Profectus & Friends")],-1)),$v=on(()=>h("li",null,[h("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),Mv=K({__name:"Nav",setup(e){const t=J(null),n=J(null),l=J(null),i=J(null),{useHeader:a,banner:u,title:c,discordName:d,discordLink:m,versionNumber:g}=Be;function p(){window.open(m,"mywindow")}return(w,_)=>(b(),N(T,null,[o(a)?(b(),N("div",Ht({key:0,class:"nav"},w.$attrs),[o(u)?(b(),N("img",{key:0,src:o(u),class:"banner",alt:o(c),style:{"margin-left":"10px"}},null,8,nv)):(b(),N("div",iv,Z(o(c)),1)),h("div",{onClick:_[0]||(_[0]=y=>{var k;return(k=i.value)==null?void 0:k.open()}),class:"version-container"},[s(it,{display:"Changelog",direction:o(Me).Down,class:"version"},{default:oe(()=>[h("span",null,"v"+Z(o(g)),1)]),_:1},8,["direction"])]),lv,h("div",rv,[h("span",{onClick:p,class:"material-icons"},"discord"),h("ul",av,[o(m)?(b(),N("li",sv,[h("a",{href:o(m),target:"_blank"},Z(o(d)),9,ov)])):R("",!0),uv,cv])]),h("div",null,[h("a",dv,[s(it,{display:"Forums",direction:o(Me).Down,yoffset:"5px"},{default:oe(()=>[mv]),_:1},8,["direction"])])]),h("div",{onClick:_[1]||(_[1]=y=>{var k;return(k=t.value)==null?void 0:k.open()})},[s(it,{display:"Info",direction:o(Me).Down,class:"info"},{default:oe(()=>[pv]),_:1},8,["direction"])]),h("div",{onClick:_[2]||(_[2]=y=>{var k;return(k=n.value)==null?void 0:k.open()})},[s(it,{display:"Saves",direction:o(Me).Down,xoffset:"-20px"},{default:oe(()=>[fv]),_:1},8,["direction"])]),h("div",{onClick:_[3]||(_[3]=y=>{var k;return(k=l.value)==null?void 0:k.open()})},[s(it,{display:"Settings",direction:o(Me).Down,xoffset:"-66px"},{default:oe(()=>[vv]),_:1},8,["direction"])])],16)):(b(),N("div",Ht({key:1,class:"overlay-nav"},w.$attrs),[h("div",{onClick:_[4]||(_[4]=y=>{var k;return(k=i.value)==null?void 0:k.open()}),class:"version-container"},[s(it,{display:"Changelog",direction:o(Me).Right,xoffset:"25%",class:"version"},{default:oe(()=>[h("span",null,"v"+Z(o(g)),1)]),_:1},8,["direction"])]),h("div",{onClick:_[5]||(_[5]=y=>{var k;return(k=n.value)==null?void 0:k.open()})},[s(it,{display:"Saves",direction:o(Me).Right},{default:oe(()=>[gv]),_:1},8,["direction"])]),h("div",{onClick:_[6]||(_[6]=y=>{var k;return(k=l.value)==null?void 0:k.open()})},[s(it,{display:"Settings",direction:o(Me).Right},{default:oe(()=>[hv]),_:1},8,["direction"])]),h("div",{onClick:_[7]||(_[7]=y=>{var k;return(k=t.value)==null?void 0:k.open()})},[s(it,{display:"Info",direction:o(Me).Right},{default:oe(()=>[bv]),_:1},8,["direction"])]),h("div",null,[h("a",yv,[s(it,{display:"Forums",direction:o(Me).Right,xoffset:"7px"},{default:oe(()=>[wv]),_:1},8,["direction"])])]),h("div",_v,[h("span",{onClick:p,class:"material-icons"},"discord"),h("ul",Cv,[o(m)?(b(),N("li",Sv,[h("a",{href:o(m),target:"_blank"},Z(o(d)),9,kv)])):R("",!0),Nv,$v])])],16)),s(Qu,{ref_key:"info",ref:t,changelog:i.value},null,8,["changelog"]),s(Ur,{ref_key:"savesManager",ref:n},null,512),s(sc,{ref_key:"options",ref:l},null,512),s(Fu,{ref_key:"changelog",ref:i},null,512)],64))}});var Xr=me(Mv,[["__scopeId","data-v-bb0ccae8"]]);const Pv={class:"inner-tab"},xv=K({__name:"Game",setup(e){const t=Yt(U,"tabs"),n=S(()=>Object.keys(Xt)),l=Be.useHeader;function i(a){const{display:u,minimized:c,name:d,color:m,minimizable:g,nodes:p,minimizedDisplay:w}=a;return{display:u,minimized:c,name:d,color:m,minimizable:g,nodes:p,minimizedDisplay:w}}return(a,u)=>(b(),N("div",{class:Pe(["tabs-container",{useHeader:o(l)}])},[(b(!0),N(T,null,Zt(o(t),(c,d)=>{var m,g;return b(),N("div",{key:d,class:Pe(["tab",o((m=o(Xt)[c])==null?void 0:m.classes)]),style:Se(o((g=o(Xt)[c])==null?void 0:g.style))},[d===0&&!o(l)?(b(),H(Xr,{key:0})):R("",!0),h("div",Pv,[o(n).includes(c)?(b(),H(Pu,Ht({key:0},i(o(Xt)[c]),{index:d,onSetMinimized:p=>o(Xt)[c].minimized.value=p}),null,16,["index","onSetMinimized"])):(b(),H(xe(c),{key:1,index:d},null,8,["index"]))])],6)}),128))],2))}});var Iv=me(xv,[["__scopeId","data-v-dcd207b4"]]);const Li=e=>(en("data-v-4a50ce42"),e=e(),tn(),e),Tv={class:"game-over-modal-header"},Fv=["src","alt"],Ev={class:"game-over-modal-title"},Dv=Li(()=>h("h2",null,"Congratulations!",-1)),qv={key:0},Av=Li(()=>h("br",null,null,-1)),Lv=Li(()=>h("div",null," Please check the Discord to discuss the game or to check for new content updates! ",-1)),Ov=Li(()=>h("br",null,null,-1)),jv=["href"],Rv=Li(()=>h("span",{class:"material-icons game-over-modal-discord"},"discord",-1)),Bv=K({__name:"GameOverScreen",setup(e){const{title:t,logo:n,discordName:l,discordLink:i,versionNumber:a,versionTitle:u}=Be,c=S(()=>zn(U.timePlayed)),d=S(()=>Gr.value&&!U.keepGoing),m=Yt(U,"autosave");function g(){U.keepGoing=!0}function p(){Yn(fi())}return(w,_)=>(b(),H(Un,{"model-value":o(d)},{header:oe(()=>[h("div",Tv,[o(n)?(b(),N("img",{key:0,class:"game-over-modal-logo",src:o(n),alt:o(t)},null,8,Fv)):R("",!0),h("div",Ev,[Dv,h("h4",null,"You've beaten "+Z(o(t))+" v"+Z(o(a))+": "+Z(o(u)),1)])])]),body:oe(({shown:y})=>[y?(b(),N("div",qv,[h("div",null,"It took you "+Z(o(c))+" to beat the game.",1),Av,Lv,Ov,h("div",null,[h("a",{href:o(i),class:"game-over-modal-discord-link"},[Rv,f(" "+Z(o(l)),1)],8,jv)]),s($n,{title:"Autosave",modelValue:o(m),"onUpdate:modelValue":_[0]||(_[0]=k=>At(m)?m.value=k:null)},null,8,["modelValue"])])):R("",!0)]),footer:oe(()=>[h("div",{class:"game-over-footer"},[h("button",{onClick:g,class:"button"},"Keep Going"),h("button",{onClick:p,class:"button danger"},"Play Again")])]),_:1},8,["model-value"]))}});var Vv=me(Bv,[["__scopeId","data-v-4a50ce42"]]);const al=e=>(en("data-v-d3bb0716"),e=e(),tn(),e),Gv=al(()=>h("div",{class:"nan-modal-header"},[h("h2",null,"NaN value detected!")],-1)),zv={key:0},Uv=al(()=>h("br",null,null,-1)),Xv=["href"],Hv=al(()=>h("span",{class:"material-icons nan-modal-discord"},"discord",-1)),Jv=al(()=>h("br",null,null,-1)),Wv={class:"nan-footer"},Zv=K({__name:"NaNScreen",setup(e){const{discordName:t,discordLink:n}=Be,l=J(!0),i=J(!0),a=Yt(ht,"hasNaN"),u=J(null);et(a,w=>{w?(l.value=U.autosave,i.value=U.devSpeed===0):(U.autosave=l.value,U.devSpeed=i.value?0:null)});const c=S(()=>{var w;return(w=ht.NaNPath)==null?void 0:w.join(".")}),d=S(()=>ht.NaNPersistent!=null?ht.NaNPersistent.value:null);function m(){ht.NaNPersistent!=null&&(ht.NaNPersistent.value=new r(0),ht.hasNaN=!1)}function g(){ht.NaNPersistent&&(ht.NaNPersistent.value=new r(1),ht.hasNaN=!1)}function p(){ht.NaNPersistent&&(ht.NaNPersistent.value=new r(NaN),ht.hasNaN=!1)}return(w,_)=>(b(),N(T,null,[s(Un,Ht({modelValue:o(a),"onUpdate:modelValue":_[4]||(_[4]=y=>At(a)?a.value=y:null)},w.$attrs),{header:oe(()=>[Gv]),body:oe(()=>[h("div",null,[f(' Attempted to assign "'+Z(o(c))+'" to NaN',1),o(d)?(b(),N("span",zv,Z(" ")+"(previously "+Z(o(Oe)(o(d)))+")",1)):R("",!0),f(". Auto-saving has been "+Z(l.value?"enabled":"disabled")+". Check the console for more details, and consider sharing it with the developers on discord. ",1)]),Uv,h("div",null,[h("a",{href:o(n)||"https://discord.gg/yJ4fjnjU54",class:"nan-modal-discord-link"},[Hv,f(" "+Z(o(t)||"Profectus & Friends"),1)],8,Xv)]),Jv,s($n,{title:"Autosave",modelValue:l.value,"onUpdate:modelValue":_[0]||(_[0]=y=>l.value=y)},null,8,["modelValue"]),o(Be).enablePausing?(b(),H($n,{key:0,title:"Pause game",modelValue:i.value,"onUpdate:modelValue":_[1]||(_[1]=y=>i.value=y)},null,8,["modelValue"])):R("",!0)]),footer:oe(()=>[h("div",Wv,[h("button",{onClick:_[2]||(_[2]=y=>{var k;return(k=u.value)==null?void 0:k.open()}),class:"button"},"Open Saves Manager"),h("button",{onClick:m,class:"button"},"Set to 0"),h("button",{onClick:g,class:"button"},"Set to 1"),o(d)&&o(r).neq(o(d),0)&&o(r).neq(o(d),1)?(b(),N("button",{key:0,onClick:_[3]||(_[3]=y=>a.value=!1),class:"button"}," Set to previous ")):R("",!0),h("button",{onClick:p,class:"button danger"},"Ignore")])]),_:1},16,["modelValue"]),s(Ur,{ref_key:"savesManager",ref:u},null,512)],64))}});var Qv=me(Zv,[["__scopeId","data-v-d3bb0716"]]);const Kv={key:0,class:"tpsDisplay"},Yv=K({__name:"TPS",setup(e){const t=S(()=>r.div(ht.lastTenTicks.length,ht.lastTenTicks.reduce((n,l)=>n+l,0)));return(n,l)=>o(t).isNan()?R("",!0):(b(),N("div",Kv,"TPS: "+Z(o(ge)(o(t))),1))}});var eg=me(Yv,[["__scopeId","data-v-89b89152"]]);var tg=K({__name:"App",setup(e){const t=Be.useHeader,n=S(()=>yi[qe.theme].variables),l=Yt(qe,"showTPS"),i=Yt(ht,"errors"),a=S(()=>ve($(()=>s(T,null,[Fs.map(We)]))));return(u,c)=>o(i).length>0?(b(),N("div",{key:0,class:"error-container",style:Se(o(n))},[s(hr,{errors:o(i)},null,8,["errors"])],4)):(b(),N(T,{key:1},[h("div",{id:"modal-root",style:Se(o(n))},null,4),h("div",{class:Pe(["app",{useHeader:o(t)}]),style:Se(o(n))},[o(t)?(b(),H(Xr,{key:0})):R("",!0),s(Iv),o(o(l))?(b(),H(eg,{key:1})):R("",!0),s(Vv),s(Qv),(b(),H(xe(o(a))))],6)],64))}});var ng=me(tg,[["__scopeId","data-v-bf4e22ac"]]);function ig(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:l,onRegistered:i,onRegisteredSW:a,onRegisterError:u}=e;let c,d,m,g;const p=async(_=!0)=>{await m,_&&(c==null||c.addEventListener("controlling",y=>{y.isUpdate&&window.location.reload()})),await(g==null?void 0:g())};async function w(){if("serviceWorker"in navigator){const{Workbox:_,messageSW:y}=await Mi(()=>import("./workbox-window.4a8794bb.js"),[]);g=async()=>{d&&d.waiting&&await y(d.waiting,{type:"SKIP_WAITING"})},c=new _("./sw.js",{scope:"./",type:"classic"}),c.addEventListener("activated",k=>{k.isUpdate||l==null||l()});{const k=()=>{n==null||n()};c.addEventListener("waiting",k),c.addEventListener("externalwaiting",k)}c.register({immediate:t}).then(k=>{d=k,a?a("./sw.js",k):i==null||i(k)}).catch(k=>{u==null||u(k)})}}return m=w(),p}function lg(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:l,onRegistered:i,onRegisteredSW:a,onRegisterError:u}=e,c=J(!1),d=J(!1);return{updateServiceWorker:ig({immediate:t,onNeedRefresh(){c.value=!0,n==null||n()},onOfflineReady(){d.value=!0,l==null||l()},onRegistered:i,onRegisteredSW:a,onRegisterError:u}),offlineReady:d,needRefresh:c}}const Vl=console.error;console.error=function(...e){Vl(...e)};window.onerror=function(e,t,n,l,i){return ht.errors.push(i instanceof Error?i:new Error(JSON.stringify(i))),Vl(i),!0};window.onunhandledrejection=function(e){ht.errors.push(e.reason instanceof Error?e.reason:new Error(JSON.stringify(e.reason))),Vl(e.reason)};document.title=Be.title;window.projInfo=Be;Be.id===""&&console.error("Project ID is empty!","Please select a unique ID for this project in /src/data/projInfo.json");requestAnimationFrame(async()=>{console.log(`%cMade in Profectus%c
Learn more at www.moddingtree.com`,"font-weight: bold; font-size: 24px; color: #A3BE8C; background: #2E3440; padding: 4px 8px; border-radius: 8px;","padding: 4px;"),await Ms();const{globalBus:e}=await Mi(()=>Promise.resolve().then(function(){return $s}),void 0),{startGameLoop:t}=await Mi(()=>import("./gameLoop.f8e9d200.js"),["assets/gameLoop.f8e9d200.js","assets/@fontsource.f66d05e7.css","assets/vue.3ee76ad7.js","assets/earcut.b6f90e68.js","assets/@vue.6b211d3c.js","assets/lz-string.dccec454.js","assets/nanoevents.1080beb7.js","assets/vue-next-select.9f66f268.js","assets/vue-next-select.9e6f4164.css","assets/vuedraggable.b67c00d5.js","assets/sortablejs.a68aa018.js","assets/vue-textarea-autosize.35804eaf.js","assets/@pixi.7dd8aed6.js","assets/ismobilejs.5c6954b9.js","assets/eventemitter3.dc5195d7.js","assets/url.832c6d94.js","assets/querystring.ed407679.js","assets/vue-toastification.4e7d1d70.js","assets/vue-toastification.4b5f8ac8.css"]),n=window.vue=ea(ng);n.config.errorHandler=function(l,i,a){console.error(l,a,i)},e.emit("setupVue",n),n.mount("#app"),Gt(()=>{const l=bi(),{updateServiceWorker:i}=lg({onNeedRefresh(){l.info("New content available, click here to update.",{timeout:!1,closeOnClick:!1,draggable:!1,icon:{iconClass:"material-icons",iconChildren:"refresh",iconTag:"i"},rtl:!1,onClick(){i()}})},onOfflineReady(){l.info("App ready to work offline")},onRegisterError:console.warn,onRegistered(a){a&&setInterval(()=>a.update(),60*60*1e3)}})}),t()});export{r as D,Mi as _,ht as a,Be as b,nf as c,zt as g,Tl as l,U as p,qe as s};
