/* empty css                    */import"./vue.0b1ef07e.js";import{Z as w,C as o,q as Pi,t as X,b1 as tt,aa as K,aE as g,a0 as $,a1 as v,aK as Wt,G as Me,aC as wl,w as St,b2 as Vt,a8 as s,O as F,ao as aa,ay as fi,ar as en,aG as Di,A as ct,_ as U,b6 as se,b8 as cn,bs as kn,aq as Jt,bu as Yn,bb as Qi,T as sa,a7 as m,u as _l,j as Va,l as Et,bv as yn,aL as Ft,$ as j,aN as Pe,J as ee,I as Oe,aH as nn,aF as ln,z as tn,bn as za,br as ra,al as zi,au as Cl,H as oa,aJ as xn,bw as Ga,a6 as Ua,ah as Xa,be as Ha}from"./@vue.a5783f16.js";import{c as ua}from"./nanoevents.1080beb7.js";import{L as Dn}from"./lz-string.f2f3b7cf.js";import{Y as Ja}from"./vue-next-select.348eb514.js";import{D as Wa}from"./vuedraggable.3773156d.js";import{p as Qa}from"./vue-textarea-autosize.35804eaf.js";import{A as ca,T as Za,R as Ka,B as Ya,u as es,E as jl}from"./@pixi.d7e055ca.js";import{s as ts,u as vi}from"./vue-toastification.e4040407.js";import{v as ns,n as is}from"./workbox-window.8d14e8b7.js";import"./earcut.b6f90e68.js";import"./sortablejs.a68aa018.js";import"./ismobilejs.5c6954b9.js";import"./eventemitter3.dc5195d7.js";import"./url.832c6d94.js";import"./querystring.ed407679.js";const ls=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const r of a)if(r.type==="childList")for(const u of r.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const r={};return a.integrity&&(r.integrity=a.integrity),a.referrerpolicy&&(r.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?r.credentials="include":a.crossorigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(a){if(a.ep)return;a.ep=!0;const r=n(a);fetch(a.href,r)}};ls();const as="modulepreload",Bl={},ss="./",Gi=function(t,n){return!n||n.length===0?t():Promise.all(n.map(i=>{if(i=`${ss}${i}`,i in Bl)return;Bl[i]=!0;const a=i.endsWith(".css"),r=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${i}"]${r}`))return;const u=document.createElement("link");if(u.rel=a?"stylesheet":as,a||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),a)return new Promise((d,c)=>{u.addEventListener("load",d),u.addEventListener("error",()=>c(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>t())},rs="./projInfo-schema.json",os="Kronos",us="A game about flowers, time, and focus",cs="kronos",ds="thepaperpilot",ps="",ms="",fs="0.3",vs="",gs=!1,hs=!1,bs=2,ys=!0,ws="banner.png",_s="pwa-192x192.png",Cs=["main"],Ss=3600,ks=1,Ns=!0,$s="base64";var He={$schema:rs,title:os,description:us,id:cs,author:ds,discordName:ps,discordLink:ms,versionNumber:fs,versionTitle:vs,allowGoBack:gs,defaultShowSmall:hs,defaultDecimalsShown:bs,useHeader:ys,banner:ws,logo:_s,initialTabs:Cs,maxTickLength:Ss,offlineLimit:ks,enablePausing:Ns,exportEncoding:$s};class xs{constructor(t){this.map=new Map,this.first=void 0,this.last=void 0,this.maxSize=t}get size(){return this.map.size}get(t){const n=this.map.get(t);if(n!==void 0)return n!==this.first&&(n===this.last?(this.last=n.prev,this.last.next=void 0):(n.prev.next=n.next,n.next.prev=n.prev),n.next=this.first,this.first.prev=n,this.first=n),n.value}set(t,n){if(this.maxSize<1)return;if(this.map.has(t))throw new Error("Cannot update existing keys in the cache");const i=new Ms(t,n);for(this.first===void 0?(this.first=i,this.last=i):(i.next=this.first,this.first.prev=i,this.first=i),this.map.set(t,i);this.map.size>this.maxSize;){const a=this.last;this.map.delete(a.key),this.last=a.prev,this.last.next=void 0}}}class Ms{constructor(t,n){this.next=void 0,this.prev=void 0,this.key=t,this.value=n}}const ol=17,Ps=9e15,Ts=Math.log10(9e15),Is=1/9e15,Es=308,Fs=-324,Vl=5,qs=(1<<10)-1,Ds=function(){const e=[];for(let n=Fs+1;n<=Es;n++)e.push(Number("1e"+n));const t=323;return function(n){return e[n+t]}}(),Xn=[2,Math.E,3,4,5,6,7,8,9,10],Ls=[[1,1.0891180521811203,1.1789767925673957,1.2701455431742086,1.3632090180450092,1.4587818160364217,1.5575237916251419,1.6601571006859253,1.767485818836978,1.8804192098842727,2],[1,1.1121114330934079,1.231038924931609,1.3583836963111375,1.4960519303993531,1.6463542337511945,1.8121385357018724,1.996971324618307,2.2053895545527546,2.4432574483385254,Math.E],[1,1.1187738849693603,1.2464963939368214,1.38527004705667,1.5376664685821402,1.7068895236551784,1.897001227148399,2.1132403089001035,2.362480153784171,2.6539010333870774,3],[1,1.1367350847096405,1.2889510672956703,1.4606478703324786,1.6570295196661111,1.8850062585672889,2.1539465047453485,2.476829779693097,2.872061932789197,3.3664204535587183,4],[1,1.1494592900767588,1.319708228183931,1.5166291280087583,1.748171114438024,2.0253263297298045,2.3636668498288547,2.7858359149579424,3.3257226212448145,4.035730287722532,5],[1,1.159225940787673,1.343712473580932,1.5611293155111927,1.8221199554561318,2.14183924486326,2.542468319282638,3.0574682501653316,3.7390572020926873,4.6719550537360774,6],[1,1.1670905356972596,1.3632807444991446,1.5979222279405536,1.8842640123816674,2.2416069644878687,2.69893426559423,3.3012632110403577,4.121250340630164,5.281493033448316,7],[1,1.1736630594087796,1.379783782386201,1.6292821855668218,1.9378971836180754,2.3289975651071977,2.8384347394720835,3.5232708454565906,4.478242031114584,5.868592169644505,8],[1,1.1793017514670474,1.394054150657457,1.65664127441059,1.985170999970283,2.4069682290577457,2.9647310119960752,3.7278665320924946,4.814462547283592,6.436522247411611,9],[1,1.1840100246247336,1.4061375836156955,1.6802272208863964,2.026757028388619,2.4770056063449646,3.080525271755482,3.9191964192627284,5.135152840833187,6.989961179534715,10]],As=[[-1,-.9194161097107025,-.8335625019330468,-.7425599821143978,-.6466611521029437,-.5462617907227869,-.4419033816638769,-.3342645487554494,-.224140440909962,-.11241087890006762,0],[-1,-.90603157029014,-.80786507256596,-.7064666939634,-.60294836853664,-.49849837513117,-.39430303318768,-.29147201034755,-.19097820800866,-.09361896280296,0],[-1,-.9021579584316141,-.8005762598234203,-.6964780623319391,-.5911906810998454,-.486050182576545,-.3823089430815083,-.28106046722897615,-.1831906535795894,-.08935809204418144,0],[-1,-.8917227442365535,-.781258746326964,-.6705130326902455,-.5612813129406509,-.4551067709033134,-.35319256652135966,-.2563741554088552,-.1651412821106526,-.0796919581982668,0],[-1,-.8843387974366064,-.7678744063886243,-.6529563724510552,-.5415870994657841,-.4352842206588936,-.33504449124791424,-.24138853420685147,-.15445285440944467,-.07409659641336663,0],[-1,-.8786709358426346,-.7577735191184886,-.6399546189952064,-.527284921869926,-.4211627631006314,-.3223479611761232,-.23107655627789858,-.1472057700818259,-.07035171210706326,0],[-1,-.8740862815291583,-.7497032990976209,-.6297119746181752,-.5161838335958787,-.41036238255751956,-.31277212146489963,-.2233976621705518,-.1418697367979619,-.06762117662323441,0],[-1,-.8702632331800649,-.7430366914122081,-.6213373075161548,-.5072025698095242,-.40171437727184167,-.30517930701410456,-.21736343968190863,-.137710238299109,-.06550774483471955,0],[-1,-.8670016295947213,-.7373984232432306,-.6143173985094293,-.49973884395492807,-.394584953527678,-.2989649949848695,-.21245647317021688,-.13434688362382652,-.0638072667348083,0],[-1,-.8641642839543857,-.732534623168535,-.6083127477059322,-.4934049257184696,-.3885773075899922,-.29376029055315767,-.2083678561173622,-.13155653399373268,-.062401588652553186,0]];let N=function(t){return l.fromValue_noAlloc(t)},ve=function(e,t,n){return l.fromComponents(e,t,n)},_e=function(t,n,i){return l.fromComponents_noNormalize(t,n,i)};const qn=function(t,n){const i=n+1,a=Math.ceil(Math.log10(Math.abs(t))),r=Math.round(t*Math.pow(10,i-a))*Math.pow(10,a-i);return parseFloat(r.toFixed(Math.max(i-a,0)))},ul=function(e){return Math.sign(e)*Math.log10(Math.abs(e))},Os=function(e){if(!isFinite(e))return e;if(e<-50)return e===Math.trunc(e)?Number.NEGATIVE_INFINITY:0;let t=1;for(;e<10;)t=t*e,++e;e-=1;let n=.9189385332046727;n=n+(e+.5)*Math.log(e),n=n-e;const i=e*e;let a=e;return n=n+1/(12*a),a=a*i,n=n+1/(360*a),a=a*i,n=n+1/(1260*a),a=a*i,n=n+1/(1680*a),a=a*i,n=n+1/(1188*a),a=a*i,n=n+691/(360360*a),a=a*i,n=n+7/(1092*a),a=a*i,n=n+3617/(122400*a),Math.exp(n)/t},da=.5671432904097838,zl=function(e,t=1e-10){let n,i;if(!Number.isFinite(e)||e===0)return e;if(e===1)return da;e<10?n=0:n=Math.log(e)-Math.log(Math.log(e));for(let a=0;a<100;++a){if(i=(e*Math.exp(-n)+n*n)/(n+1),Math.abs(i-n)<t*Math.abs(i))return i;n=i}throw Error(`Iteration failed to converge: ${e.toString()}`)};function Gl(e,t=1e-10){let n,i,a,r;if(!Number.isFinite(e.mag)||e.eq(l.dZero))return e;if(e.eq(l.dOne))return l.fromNumber(da);n=l.ln(e);for(let u=0;u<100;++u){if(i=n.neg().exp(),a=n.sub(e.mul(i)),r=n.sub(a.div(n.add(1).sub(n.add(2).mul(a).div(l.mul(2,n).add(2))))),l.abs(r.sub(n)).lt(l.abs(r).mul(t)))return r;n=r}throw Error(`Iteration failed to converge: ${e.toString()}`)}const b=class{constructor(e){this.sign=0,this.mag=0,this.layer=0,e instanceof b?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"&&this.fromString(e)}get m(){if(this.sign===0)return 0;if(this.layer===0){const e=Math.floor(Math.log10(this.mag));let t;return this.mag===5e-324?t=5:t=this.mag/Ds(e),this.sign*t}else if(this.layer===1){const e=this.mag-Math.floor(this.mag);return this.sign*Math.pow(10,e)}else return this.sign}set m(e){this.layer<=2?this.fromMantissaExponent(e,this.e):(this.sign=Math.sign(e),this.sign===0&&(this.layer=0,this.exponent=0))}get e(){return this.sign===0?0:this.layer===0?Math.floor(Math.log10(this.mag)):this.layer===1?Math.floor(this.mag):this.layer===2?Math.floor(Math.sign(this.mag)*Math.pow(10,Math.abs(this.mag))):this.mag*Number.POSITIVE_INFINITY}set e(e){this.fromMantissaExponent(this.m,e)}get s(){return this.sign}set s(e){e===0?(this.sign=0,this.layer=0,this.mag=0):this.sign=e}get mantissa(){return this.m}set mantissa(e){this.m=e}get exponent(){return this.e}set exponent(e){this.e=e}static fromComponents(e,t,n){return new b().fromComponents(e,t,n)}static fromComponents_noNormalize(e,t,n){return new b().fromComponents_noNormalize(e,t,n)}static fromMantissaExponent(e,t){return new b().fromMantissaExponent(e,t)}static fromMantissaExponent_noNormalize(e,t){return new b().fromMantissaExponent_noNormalize(e,t)}static fromDecimal(e){return new b().fromDecimal(e)}static fromNumber(e){return new b().fromNumber(e)}static fromString(e){return new b().fromString(e)}static fromValue(e){return new b().fromValue(e)}static fromValue_noAlloc(e){if(e instanceof b)return e;if(typeof e=="string"){const t=b.fromStringCache.get(e);return t!==void 0?t:b.fromString(e)}else return typeof e=="number"?b.fromNumber(e):b.dZero}static abs(e){return N(e).abs()}static neg(e){return N(e).neg()}static negate(e){return N(e).neg()}static negated(e){return N(e).neg()}static sign(e){return N(e).sign}static sgn(e){return N(e).sign}static round(e){return N(e).round()}static floor(e){return N(e).floor()}static ceil(e){return N(e).ceil()}static trunc(e){return N(e).trunc()}static add(e,t){return N(e).add(t)}static plus(e,t){return N(e).add(t)}static sub(e,t){return N(e).sub(t)}static subtract(e,t){return N(e).sub(t)}static minus(e,t){return N(e).sub(t)}static mul(e,t){return N(e).mul(t)}static multiply(e,t){return N(e).mul(t)}static times(e,t){return N(e).mul(t)}static div(e,t){return N(e).div(t)}static divide(e,t){return N(e).div(t)}static recip(e){return N(e).recip()}static reciprocal(e){return N(e).recip()}static reciprocate(e){return N(e).reciprocate()}static cmp(e,t){return N(e).cmp(t)}static cmpabs(e,t){return N(e).cmpabs(t)}static compare(e,t){return N(e).cmp(t)}static isNaN(e){return e=N(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag)}static isFinite(e){return e=N(e),isFinite(e.sign)&&isFinite(e.layer)&&isFinite(e.mag)}static eq(e,t){return N(e).eq(t)}static equals(e,t){return N(e).eq(t)}static neq(e,t){return N(e).neq(t)}static notEquals(e,t){return N(e).notEquals(t)}static lt(e,t){return N(e).lt(t)}static lte(e,t){return N(e).lte(t)}static gt(e,t){return N(e).gt(t)}static gte(e,t){return N(e).gte(t)}static max(e,t){return N(e).max(t)}static min(e,t){return N(e).min(t)}static minabs(e,t){return N(e).minabs(t)}static maxabs(e,t){return N(e).maxabs(t)}static clamp(e,t,n){return N(e).clamp(t,n)}static clampMin(e,t){return N(e).clampMin(t)}static clampMax(e,t){return N(e).clampMax(t)}static cmp_tolerance(e,t,n){return N(e).cmp_tolerance(t,n)}static compare_tolerance(e,t,n){return N(e).cmp_tolerance(t,n)}static eq_tolerance(e,t,n){return N(e).eq_tolerance(t,n)}static equals_tolerance(e,t,n){return N(e).eq_tolerance(t,n)}static neq_tolerance(e,t,n){return N(e).neq_tolerance(t,n)}static notEquals_tolerance(e,t,n){return N(e).notEquals_tolerance(t,n)}static lt_tolerance(e,t,n){return N(e).lt_tolerance(t,n)}static lte_tolerance(e,t,n){return N(e).lte_tolerance(t,n)}static gt_tolerance(e,t,n){return N(e).gt_tolerance(t,n)}static gte_tolerance(e,t,n){return N(e).gte_tolerance(t,n)}static pLog10(e){return N(e).pLog10()}static absLog10(e){return N(e).absLog10()}static log10(e){return N(e).log10()}static log(e,t){return N(e).log(t)}static log2(e){return N(e).log2()}static ln(e){return N(e).ln()}static logarithm(e,t){return N(e).logarithm(t)}static pow(e,t){return N(e).pow(t)}static pow10(e){return N(e).pow10()}static pow_base(e,t){return N(e).pow_base(t)}static root(e,t){return N(e).root(t)}static factorial(e,t){return N(e).factorial()}static gamma(e,t){return N(e).gamma()}static lngamma(e,t){return N(e).lngamma()}static exp(e){return N(e).exp()}static sqr(e){return N(e).sqr()}static sqrt(e){return N(e).sqrt()}static cube(e){return N(e).cube()}static cbrt(e){return N(e).cbrt()}static tetrate(e,t=2,n=_e(1,0,1)){return N(e).tetrate(t,n)}static iteratedexp(e,t=2,n=_e(1,0,1)){return N(e).iteratedexp(t,n)}static iteratedlog(e,t=10,n=1){return N(e).iteratedlog(t,n)}static layeradd10(e,t){return N(e).layeradd10(t)}static layeradd(e,t,n=10){return N(e).layeradd(t,n)}static slog(e,t=10){return N(e).slog(t)}static lambertw(e){return N(e).lambertw()}static ssqrt(e){return N(e).ssqrt()}static pentate(e,t=2,n=_e(1,0,1)){return N(e).pentate(t,n)}static sin(e){return N(e).sin()}static cos(e){return N(e).cos()}static tan(e){return N(e).tan()}static asin(e){return N(e).asin()}static acos(e){return N(e).acos()}static atan(e){return N(e).atan()}static sinh(e){return N(e).sinh()}static cosh(e){return N(e).cosh()}static tanh(e){return N(e).tanh()}static asinh(e){return N(e).asinh()}static acosh(e){return N(e).acosh()}static atanh(e){return N(e).atanh()}static affordGeometricSeries(e,t,n,i){return this.affordGeometricSeries_core(N(e),N(t),N(n),i)}static sumGeometricSeries(e,t,n,i){return this.sumGeometricSeries_core(e,N(t),N(n),i)}static affordArithmeticSeries(e,t,n,i){return this.affordArithmeticSeries_core(N(e),N(t),N(n),N(i))}static sumArithmeticSeries(e,t,n,i){return this.sumArithmeticSeries_core(N(e),N(t),N(n),N(i))}static efficiencyOfPurchase(e,t,n){return this.efficiencyOfPurchase_core(N(e),N(t),N(n))}static randomDecimalForTesting(e){if(Math.random()*20<1)return _e(0,0,0);const t=Math.random()>.5?1:-1;if(Math.random()*20<1)return _e(t,0,1);const n=Math.floor(Math.random()*(e+1));let i=n===0?Math.random()*616-308:Math.random()*16;Math.random()>.9&&(i=Math.trunc(i));let a=Math.pow(10,i);return Math.random()>.9&&(a=Math.trunc(a)),ve(t,n,a)}static affordGeometricSeries_core(e,t,n,i){const a=t.mul(n.pow(i));return b.floor(e.div(a).mul(n.sub(1)).add(1).log10().div(n.log10()))}static sumGeometricSeries_core(e,t,n,i){return t.mul(n.pow(i)).mul(b.sub(1,n.pow(e))).div(b.sub(1,n))}static affordArithmeticSeries_core(e,t,n,i){const r=t.add(i.mul(n)).sub(n.div(2)),u=r.pow(2);return r.neg().add(u.add(n.mul(e).mul(2)).sqrt()).div(n).floor()}static sumArithmeticSeries_core(e,t,n,i){const a=t.add(i.mul(n));return e.div(2).mul(a.mul(2).plus(e.sub(1).mul(n)))}static efficiencyOfPurchase_core(e,t,n){return e.div(t).add(e.div(n))}normalize(){if(this.sign===0||this.mag===0&&this.layer===0)return this.sign=0,this.mag=0,this.layer=0,this;if(this.layer===0&&this.mag<0&&(this.mag=-this.mag,this.sign=-this.sign),this.layer===0&&this.mag<Is)return this.layer+=1,this.mag=Math.log10(this.mag),this;let e=Math.abs(this.mag),t=Math.sign(this.mag);if(e>=Ps)return this.layer+=1,this.mag=t*Math.log10(e),this;for(;e<Ts&&this.layer>0;)this.layer-=1,this.layer===0?this.mag=Math.pow(10,this.mag):(this.mag=t*Math.pow(10,e),e=Math.abs(this.mag),t=Math.sign(this.mag));return this.layer===0&&(this.mag<0?(this.mag=-this.mag,this.sign=-this.sign):this.mag===0&&(this.sign=0)),this}fromComponents(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this.normalize(),this}fromComponents_noNormalize(e,t,n){return this.sign=e,this.layer=t,this.mag=n,this}fromMantissaExponent(e,t){return this.layer=1,this.sign=Math.sign(e),e=Math.abs(e),this.mag=t+Math.log10(e),this.normalize(),this}fromMantissaExponent_noNormalize(e,t){return this.fromMantissaExponent(e,t),this}fromDecimal(e){return this.sign=e.sign,this.layer=e.layer,this.mag=e.mag,this}fromNumber(e){return this.mag=Math.abs(e),this.sign=Math.sign(e),this.layer=0,this.normalize(),this}fromString(e){const t=e,n=b.fromStringCache.get(t);if(n!==void 0)return this.fromDecimal(n);e=e.replace(",","");const i=e.split("^^^");if(i.length===2){const C=parseFloat(i[0]),T=parseFloat(i[1]),W=i[1].split(";");let le=1;if(W.length===2&&(le=parseFloat(W[1]),isFinite(le)||(le=1)),isFinite(C)&&isFinite(T)){const P=b.pentate(C,T,le);return this.sign=P.sign,this.layer=P.layer,this.mag=P.mag,b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}}const a=e.split("^^");if(a.length===2){const C=parseFloat(a[0]),T=parseFloat(a[1]),W=a[1].split(";");let le=1;if(W.length===2&&(le=parseFloat(W[1]),isFinite(le)||(le=1)),isFinite(C)&&isFinite(T)){const P=b.tetrate(C,T,le);return this.sign=P.sign,this.layer=P.layer,this.mag=P.mag,b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}}const r=e.split("^");if(r.length===2){const C=parseFloat(r[0]),T=parseFloat(r[1]);if(isFinite(C)&&isFinite(T)){const W=b.pow(C,T);return this.sign=W.sign,this.layer=W.layer,this.mag=W.mag,b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}}e=e.trim().toLowerCase();let u,d,c=e.split("pt");if(c.length===2){u=10,d=parseFloat(c[0]),c[1]=c[1].replace("(",""),c[1]=c[1].replace(")","");let C=parseFloat(c[1]);if(isFinite(C)||(C=1),isFinite(u)&&isFinite(d)){const T=b.tetrate(u,d,C);return this.sign=T.sign,this.layer=T.layer,this.mag=T.mag,b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}}if(c=e.split("p"),c.length===2){u=10,d=parseFloat(c[0]),c[1]=c[1].replace("(",""),c[1]=c[1].replace(")","");let C=parseFloat(c[1]);if(isFinite(C)||(C=1),isFinite(u)&&isFinite(d)){const T=b.tetrate(u,d,C);return this.sign=T.sign,this.layer=T.layer,this.mag=T.mag,b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}}const p=e.split("e"),f=p.length-1;if(f===0){const C=parseFloat(e);if(isFinite(C))return this.fromNumber(C),b.fromStringCache.size>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}else if(f===1){const C=parseFloat(e);if(isFinite(C)&&C!==0)return this.fromNumber(C),b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}const h=e.split("e^");if(h.length===2){this.sign=1,h[0].charAt(0)=="-"&&(this.sign=-1);let C="";for(let T=0;T<h[1].length;++T){const W=h[1].charCodeAt(T);if(W>=43&&W<=57||W===101)C+=h[1].charAt(T);else return this.layer=parseFloat(C),this.mag=parseFloat(h[1].substr(T+1)),this.normalize(),b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}}if(f<1)return this.sign=0,this.layer=0,this.mag=0,b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this;const y=parseFloat(p[0]);if(y===0)return this.sign=0,this.layer=0,this.mag=0,b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this;let _=parseFloat(p[p.length-1]);if(f>=2){const C=parseFloat(p[p.length-2]);isFinite(C)&&(_*=Math.sign(C),_+=ul(C))}if(!isFinite(y))this.sign=p[0]==="-"?-1:1,this.layer=f,this.mag=_;else if(f===1)this.sign=Math.sign(y),this.layer=1,this.mag=_+Math.log10(Math.abs(y));else if(this.sign=Math.sign(y),this.layer=f,f===2){const C=b.mul(ve(1,2,_),N(y));return this.sign=C.sign,this.layer=C.layer,this.mag=C.mag,b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}else this.mag=_;return this.normalize(),b.fromStringCache.maxSize>=1&&b.fromStringCache.set(t,b.fromDecimal(this)),this}fromValue(e){return e instanceof b?this.fromDecimal(e):typeof e=="number"?this.fromNumber(e):typeof e=="string"?this.fromString(e):(this.sign=0,this.layer=0,this.mag=0,this)}toNumber(){return Number.isFinite(this.layer)?this.layer===0?this.sign*this.mag:this.layer===1?this.sign*Math.pow(10,this.mag):this.mag>0?this.sign>0?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:0:Number.NaN}mantissaWithDecimalPlaces(e){return isNaN(this.m)?Number.NaN:this.m===0?0:qn(this.m,e)}magnitudeWithDecimalPlaces(e){return isNaN(this.mag)?Number.NaN:this.mag===0?0:qn(this.mag,e)}toString(){return isNaN(this.layer)||isNaN(this.sign)||isNaN(this.mag)?"NaN":this.mag===Number.POSITIVE_INFINITY||this.layer===Number.POSITIVE_INFINITY?this.sign===1?"Infinity":"-Infinity":this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toString():this.m+"e"+this.e:this.layer===1?this.m+"e"+this.e:this.layer<=Vl?(this.sign===-1?"-":"")+"e".repeat(this.layer)+this.mag:(this.sign===-1?"-":"")+"(e^"+this.layer+")"+this.mag}toExponential(e){return this.layer===0?(this.sign*this.mag).toExponential(e):this.toStringWithDecimalPlaces(e)}toFixed(e){return this.layer===0?(this.sign*this.mag).toFixed(e):this.toStringWithDecimalPlaces(e)}toPrecision(e){return this.e<=-7?this.toExponential(e-1):e>this.e?this.toFixed(e-this.exponent-1):this.toExponential(e-1)}valueOf(){return this.toString()}toJSON(){return this.toString()}toStringWithDecimalPlaces(e){return this.layer===0?this.mag<1e21&&this.mag>1e-7||this.mag===0?(this.sign*this.mag).toFixed(e):qn(this.m,e)+"e"+qn(this.e,e):this.layer===1?qn(this.m,e)+"e"+qn(this.e,e):this.layer<=Vl?(this.sign===-1?"-":"")+"e".repeat(this.layer)+qn(this.mag,e):(this.sign===-1?"-":"")+"(e^"+this.layer+")"+qn(this.mag,e)}abs(){return _e(this.sign===0?0:1,this.layer,this.mag)}neg(){return _e(-this.sign,this.layer,this.mag)}negate(){return this.neg()}negated(){return this.neg()}sgn(){return this.sign}round(){return this.mag<0?b.dZero:this.layer===0?ve(this.sign,0,Math.round(this.mag)):this}floor(){return this.mag<0?b.dZero:this.layer===0?ve(this.sign,0,Math.floor(this.mag)):this}ceil(){return this.mag<0?b.dZero:this.layer===0?ve(this.sign,0,Math.ceil(this.mag)):this}trunc(){return this.mag<0?b.dZero:this.layer===0?ve(this.sign,0,Math.trunc(this.mag)):this}add(e){const t=N(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer)||this.sign===0)return t;if(t.sign===0)return this;if(this.sign===-t.sign&&this.layer===t.layer&&this.mag===t.mag)return _e(0,0,0);let n,i;if(this.layer>=2||t.layer>=2)return this.maxabs(t);if(b.cmpabs(this,t)>0?(n=this,i=t):(n=t,i=this),n.layer===0&&i.layer===0)return b.fromNumber(n.sign*n.mag+i.sign*i.mag);const a=n.layer*Math.sign(n.mag),r=i.layer*Math.sign(i.mag);if(a-r>=2)return n;if(a===0&&r===-1){if(Math.abs(i.mag-Math.log10(n.mag))>ol)return n;{const u=Math.pow(10,Math.log10(n.mag)-i.mag),d=i.sign+n.sign*u;return ve(Math.sign(d),1,i.mag+Math.log10(Math.abs(d)))}}if(a===1&&r===0){if(Math.abs(n.mag-Math.log10(i.mag))>ol)return n;{const u=Math.pow(10,n.mag-Math.log10(i.mag)),d=i.sign+n.sign*u;return ve(Math.sign(d),1,Math.log10(i.mag)+Math.log10(Math.abs(d)))}}if(Math.abs(n.mag-i.mag)>ol)return n;{const u=Math.pow(10,n.mag-i.mag),d=i.sign+n.sign*u;return ve(Math.sign(d),1,i.mag+Math.log10(Math.abs(d)))}}plus(e){return this.add(e)}sub(e){return this.add(N(e).neg())}subtract(e){return this.sub(e)}minus(e){return this.sub(e)}mul(e){const t=N(e);if(!Number.isFinite(this.layer))return this;if(!Number.isFinite(t.layer))return t;if(this.sign===0||t.sign===0)return _e(0,0,0);if(this.layer===t.layer&&this.mag===-t.mag)return _e(this.sign*t.sign,0,1);let n,i;if(this.layer>t.layer||this.layer==t.layer&&Math.abs(this.mag)>Math.abs(t.mag)?(n=this,i=t):(n=t,i=this),n.layer===0&&i.layer===0)return b.fromNumber(n.sign*i.sign*n.mag*i.mag);if(n.layer>=3||n.layer-i.layer>=2)return ve(n.sign*i.sign,n.layer,n.mag);if(n.layer===1&&i.layer===0)return ve(n.sign*i.sign,1,n.mag+Math.log10(i.mag));if(n.layer===1&&i.layer===1)return ve(n.sign*i.sign,1,n.mag+i.mag);if(n.layer===2&&i.layer===1){const a=ve(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(ve(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)));return ve(n.sign*i.sign,a.layer+1,a.sign*a.mag)}if(n.layer===2&&i.layer===2){const a=ve(Math.sign(n.mag),n.layer-1,Math.abs(n.mag)).add(ve(Math.sign(i.mag),i.layer-1,Math.abs(i.mag)));return ve(n.sign*i.sign,a.layer+1,a.sign*a.mag)}throw Error("Bad arguments to mul: "+this+", "+e)}multiply(e){return this.mul(e)}times(e){return this.mul(e)}div(e){const t=N(e);return this.mul(t.recip())}divide(e){return this.div(e)}divideBy(e){return this.div(e)}dividedBy(e){return this.div(e)}recip(){return this.mag===0?b.dNaN:this.layer===0?ve(this.sign,0,1/this.mag):ve(this.sign,this.layer,-this.mag)}reciprocal(){return this.recip()}reciprocate(){return this.recip()}cmp(e){const t=N(e);return this.sign>t.sign?1:this.sign<t.sign?-1:this.sign*this.cmpabs(e)}cmpabs(e){const t=N(e),n=this.mag>0?this.layer:-this.layer,i=t.mag>0?t.layer:-t.layer;return n>i?1:n<i?-1:this.mag>t.mag?1:this.mag<t.mag?-1:0}compare(e){return this.cmp(e)}isNan(){return isNaN(this.sign)||isNaN(this.layer)||isNaN(this.mag)}isFinite(){return isFinite(this.sign)&&isFinite(this.layer)&&isFinite(this.mag)}eq(e){const t=N(e);return this.sign===t.sign&&this.layer===t.layer&&this.mag===t.mag}equals(e){return this.eq(e)}neq(e){return!this.eq(e)}notEquals(e){return this.neq(e)}lt(e){return this.cmp(e)===-1}lte(e){return!this.gt(e)}gt(e){return this.cmp(e)===1}gte(e){return!this.lt(e)}max(e){const t=N(e);return this.lt(t)?t:this}min(e){const t=N(e);return this.gt(t)?t:this}maxabs(e){const t=N(e);return this.cmpabs(t)<0?t:this}minabs(e){const t=N(e);return this.cmpabs(t)>0?t:this}clamp(e,t){return this.max(e).min(t)}clampMin(e){return this.max(e)}clampMax(e){return this.min(e)}cmp_tolerance(e,t){const n=N(e);return this.eq_tolerance(n,t)?0:this.cmp(n)}compare_tolerance(e,t){return this.cmp_tolerance(e,t)}eq_tolerance(e,t){const n=N(e);if(t==null&&(t=1e-7),this.sign!==n.sign||Math.abs(this.layer-n.layer)>1)return!1;let i=this.mag,a=n.mag;return this.layer>n.layer&&(a=ul(a)),this.layer<n.layer&&(i=ul(i)),Math.abs(i-a)<=t*Math.max(Math.abs(i),Math.abs(a))}equals_tolerance(e,t){return this.eq_tolerance(e,t)}neq_tolerance(e,t){return!this.eq_tolerance(e,t)}notEquals_tolerance(e,t){return this.neq_tolerance(e,t)}lt_tolerance(e,t){const n=N(e);return!this.eq_tolerance(n,t)&&this.lt(n)}lte_tolerance(e,t){const n=N(e);return this.eq_tolerance(n,t)||this.lt(n)}gt_tolerance(e,t){const n=N(e);return!this.eq_tolerance(n,t)&&this.gt(n)}gte_tolerance(e,t){const n=N(e);return this.eq_tolerance(n,t)||this.gt(n)}pLog10(){return this.lt(b.dZero)?b.dZero:this.log10()}absLog10(){return this.sign===0?b.dNaN:this.layer>0?ve(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):ve(1,0,Math.log10(this.mag))}log10(){return this.sign<=0?b.dNaN:this.layer>0?ve(Math.sign(this.mag),this.layer-1,Math.abs(this.mag)):ve(this.sign,0,Math.log10(this.mag))}log(e){return e=N(e),this.sign<=0||e.sign<=0||e.sign===1&&e.layer===0&&e.mag===1?b.dNaN:this.layer===0&&e.layer===0?ve(this.sign,0,Math.log(this.mag)/Math.log(e.mag)):b.div(this.log10(),e.log10())}log2(){return this.sign<=0?b.dNaN:this.layer===0?ve(this.sign,0,Math.log2(this.mag)):this.layer===1?ve(Math.sign(this.mag),0,Math.abs(this.mag)*3.321928094887362):this.layer===2?ve(Math.sign(this.mag),1,Math.abs(this.mag)+.5213902276543247):ve(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}ln(){return this.sign<=0?b.dNaN:this.layer===0?ve(this.sign,0,Math.log(this.mag)):this.layer===1?ve(Math.sign(this.mag),0,Math.abs(this.mag)*2.302585092994046):this.layer===2?ve(Math.sign(this.mag),1,Math.abs(this.mag)+.36221568869946325):ve(Math.sign(this.mag),this.layer-1,Math.abs(this.mag))}logarithm(e){return this.log(e)}pow(e){const t=N(e),n=this,i=t;if(n.sign===0)return i.eq(0)?_e(1,0,1):n;if(n.sign===1&&n.layer===0&&n.mag===1)return n;if(i.sign===0)return _e(1,0,1);if(i.sign===1&&i.layer===0&&i.mag===1)return n;const a=n.absLog10().mul(i).pow10();return this.sign===-1?Math.abs(i.toNumber()%2)%2===1?a.neg():Math.abs(i.toNumber()%2)%2===0?a:b.dNaN:a}pow10(){if(!Number.isFinite(this.layer)||!Number.isFinite(this.mag))return b.dNaN;let e=this;if(e.layer===0){const t=Math.pow(10,e.sign*e.mag);if(Number.isFinite(t)&&Math.abs(t)>=.1)return ve(1,0,t);if(e.sign===0)return b.dOne;e=_e(e.sign,e.layer+1,Math.log10(e.mag))}return e.sign>0&&e.mag>=0?ve(e.sign,e.layer+1,e.mag):e.sign<0&&e.mag>=0?ve(-e.sign,e.layer+1,-e.mag):b.dOne}pow_base(e){return N(e).pow(this)}root(e){const t=N(e);return this.pow(t.recip())}factorial(){return this.mag<0?this.add(1).gamma():this.layer===0?this.add(1).gamma():this.layer===1?b.exp(b.mul(this,b.ln(this).sub(1))):b.exp(this)}gamma(){if(this.mag<0)return this.recip();if(this.layer===0){if(this.lt(_e(1,0,24)))return b.fromNumber(Os(this.sign*this.mag));const e=this.mag-1;let t=.9189385332046727;t=t+(e+.5)*Math.log(e),t=t-e;const n=e*e;let i=e,a=12*i,r=1/a,u=t+r;if(u===t||(t=u,i=i*n,a=360*i,r=1/a,u=t-r,u===t))return b.exp(t);t=u,i=i*n,a=1260*i;let d=1/a;return t=t+d,i=i*n,a=1680*i,d=1/a,t=t-d,b.exp(t)}else return this.layer===1?b.exp(b.mul(this,b.ln(this).sub(1))):b.exp(this)}lngamma(){return this.gamma().ln()}exp(){return this.mag<0?b.dOne:this.layer===0&&this.mag<=709.7?b.fromNumber(Math.exp(this.sign*this.mag)):this.layer===0?ve(1,1,this.sign*Math.log10(Math.E)*this.mag):this.layer===1?ve(1,2,this.sign*(Math.log10(.4342944819032518)+this.mag)):ve(1,this.layer+1,this.sign*this.mag)}sqr(){return this.pow(2)}sqrt(){if(this.layer===0)return b.fromNumber(Math.sqrt(this.sign*this.mag));if(this.layer===1)return ve(1,2,Math.log10(this.mag)-.3010299956639812);{const e=b.div(_e(this.sign,this.layer-1,this.mag),_e(1,0,2));return e.layer+=1,e.normalize(),e}}cube(){return this.pow(3)}cbrt(){return this.pow(1/3)}tetrate(e=2,t=_e(1,0,1)){if(e===1)return b.pow(this,t);if(e===0)return new b(t);if(this.eq(b.dOne))return b.dOne;if(this.eq(-1))return b.pow(this,t);if(e===Number.POSITIVE_INFINITY){const a=this.toNumber();if(a<=1.444667861009766&&a>=.06598803584531254){if(a>1.444667861009099)return b.fromNumber(Math.E);const r=b.ln(this).neg();return r.lambertw().div(r)}else return a>1.444667861009766?b.fromNumber(Number.POSITIVE_INFINITY):b.dNaN}if(this.eq(b.dZero)){let a=Math.abs((e+1)%2);return a>1&&(a=2-a),b.fromNumber(a)}if(e<0)return b.iteratedlog(t,this,-e);t=N(t);const n=e;e=Math.trunc(e);const i=n-e;if(this.gt(b.dZero)&&this.lte(1.444667861009766)){e=Math.min(1e4,e);for(let a=0;a<e;++a){const r=t;if(t=this.pow(t),r.eq(t))return t}if(i!=0){const a=this.pow(t);return t.mul(1-i).add(a.mul(i))}return t}i!==0&&(t.eq(b.dOne)?this.gt(10)?t=this.pow(i):(t=b.fromNumber(b.tetrate_critical(this.toNumber(),i)),this.lt(2)&&(t=t.sub(1).mul(this.minus(1)).plus(1))):this.eq(10)?t=t.layeradd10(i):t=t.layeradd(i,this));for(let a=0;a<e;++a){if(t=this.pow(t),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(t.layer-this.layer>3)return _e(t.sign,t.layer+(e-a-1),t.mag);if(a>1e4)return t}return t}iteratedexp(e=2,t=_e(1,0,1)){return this.tetrate(e,t)}iteratedlog(e=10,t=1){if(t<0)return b.tetrate(e,-t,this);e=N(e);let n=b.fromDecimal(this);const i=t;t=Math.trunc(t);const a=i-t;if(n.layer-e.layer>3){const r=Math.min(t,n.layer-e.layer-3);t-=r,n.layer-=r}for(let r=0;r<t;++r){if(n=n.log(e),!isFinite(n.layer)||!isFinite(n.mag))return n.normalize();if(r>1e4)return n}return a>0&&a<1&&(e.eq(10)?n=n.layeradd10(-a):n=n.layeradd(-a,e)),n}slog(e=10,t=100){let n=.001,i=!1,a=!1,r=this.slog_internal(e).toNumber();for(let u=1;u<t;++u){const c=new b(e).tetrate(r).gt(this);if(u>1&&a!=c&&(i=!0),a=c,i?n/=2:n*=2,n=Math.abs(n)*(c?-1:1),r+=n,n===0)break}return b.fromNumber(r)}slog_internal(e=10){if(e=N(e),e.lte(b.dZero)||e.eq(b.dOne))return b.dNaN;if(e.lt(b.dOne))return this.eq(b.dOne)?b.dZero:this.eq(b.dZero)?b.dNegOne:b.dNaN;if(this.mag<0||this.eq(b.dZero))return b.dNegOne;let t=0,n=b.fromDecimal(this);if(n.layer-e.layer>3){const i=n.layer-e.layer-3;t+=i,n.layer-=i}for(let i=0;i<100;++i)if(n.lt(b.dZero))n=b.pow(e,n),t-=1;else{if(n.lte(b.dOne))return b.fromNumber(t+b.slog_critical(e.toNumber(),n.toNumber()));t+=1,n=b.log(n,e)}return b.fromNumber(t)}static slog_critical(e,t){return e>10?t-1:b.critical_section(e,t,As)}static tetrate_critical(e,t){return b.critical_section(e,t,Ls)}static critical_section(e,t,n){t*=10,t<0&&(t=0),t>10&&(t=10),e<2&&(e=2),e>10&&(e=10);let i=0,a=0;for(let u=0;u<Xn.length;++u)if(Xn[u]==e){i=n[u][Math.floor(t)],a=n[u][Math.ceil(t)];break}else if(Xn[u]<e&&Xn[u+1]>e){const d=(e-Xn[u])/(Xn[u+1]-Xn[u]);i=n[u][Math.floor(t)]*(1-d)+n[u+1][Math.floor(t)]*d,a=n[u][Math.ceil(t)]*(1-d)+n[u+1][Math.ceil(t)]*d;break}const r=t-Math.floor(t);return i<=0||a<=0?i*(1-r)+a*r:Math.pow(e,Math.log(i)/Math.log(e)*(1-r)+Math.log(a)/Math.log(e)*r)}layeradd10(e){e=b.fromValue_noAlloc(e).toNumber();const t=b.fromDecimal(this);if(e>=1){t.mag<0&&t.layer>0?(t.sign=0,t.mag=0,t.layer=0):t.sign===-1&&t.layer==0&&(t.sign=1,t.mag=-t.mag);const n=Math.trunc(e);e-=n,t.layer+=n}if(e<=-1){const n=Math.trunc(e);if(e-=n,t.layer+=n,t.layer<0)for(let i=0;i<100;++i){if(t.layer++,t.mag=Math.log10(t.mag),!isFinite(t.mag))return t.sign===0&&(t.sign=1),t.layer<0&&(t.layer=0),t.normalize();if(t.layer>=0)break}}for(;t.layer<0;)t.layer++,t.mag=Math.log10(t.mag);return t.sign===0&&(t.sign=1,t.mag===0&&t.layer>=1&&(t.layer-=1,t.mag=1)),t.normalize(),e!==0?t.layeradd(e,10):t}layeradd(e,t){const i=this.slog(t).toNumber()+e;return i>=0?b.tetrate(t,i):Number.isFinite(i)?i>=-1?b.log(b.tetrate(t,i+1),t):b.log(b.log(b.tetrate(t,i+2),t),t):b.dNaN}lambertw(){if(this.lt(-.3678794411710499))throw Error("lambertw is unimplemented for results less than -1, sorry!");if(this.mag<0)return b.fromNumber(zl(this.toNumber()));if(this.layer===0)return b.fromNumber(zl(this.sign*this.mag));if(this.layer===1)return Gl(this);if(this.layer===2)return Gl(this);if(this.layer>=3)return _e(this.sign,this.layer-1,this.mag);throw new Error("Unhandled behavior in lambertw()")}ssqrt(){if(this.sign==1&&this.layer>=3)return _e(this.sign,this.layer-1,this.mag);const e=this.ln();return e.div(e.lambertw())}pentate(e=2,t=_e(1,0,1)){t=N(t);const n=e;e=Math.trunc(e);const i=n-e;i!==0&&(t.eq(b.dOne)?(++e,t=b.fromNumber(i)):this.eq(10)?t=t.layeradd10(i):t=t.layeradd(i,this));for(let a=0;a<e;++a){if(t=this.tetrate(t.toNumber()),!isFinite(t.layer)||!isFinite(t.mag))return t.normalize();if(a>10)return t}return t}sin(){return this.mag<0?this:this.layer===0?b.fromNumber(Math.sin(this.sign*this.mag)):_e(0,0,0)}cos(){return this.mag<0?b.dOne:this.layer===0?b.fromNumber(Math.cos(this.sign*this.mag)):_e(0,0,0)}tan(){return this.mag<0?this:this.layer===0?b.fromNumber(Math.tan(this.sign*this.mag)):_e(0,0,0)}asin(){return this.mag<0?this:this.layer===0?b.fromNumber(Math.asin(this.sign*this.mag)):_e(Number.NaN,Number.NaN,Number.NaN)}acos(){return this.mag<0?b.fromNumber(Math.acos(this.toNumber())):this.layer===0?b.fromNumber(Math.acos(this.sign*this.mag)):_e(Number.NaN,Number.NaN,Number.NaN)}atan(){return this.mag<0?this:this.layer===0?b.fromNumber(Math.atan(this.sign*this.mag)):b.fromNumber(Math.atan(this.sign*(1/0)))}sinh(){return this.exp().sub(this.negate().exp()).div(2)}cosh(){return this.exp().add(this.negate().exp()).div(2)}tanh(){return this.sinh().div(this.cosh())}asinh(){return b.ln(this.add(this.sqr().add(1).sqrt()))}acosh(){return b.ln(this.add(this.sqr().sub(1).sqrt()))}atanh(){return this.abs().gte(1)?_e(Number.NaN,Number.NaN,Number.NaN):b.ln(this.add(1).div(b.fromNumber(1).sub(this))).div(2)}ascensionPenalty(e){return e===0?this:this.root(b.pow(10,e))}egg(){return this.add(9)}lessThanOrEqualTo(e){return this.cmp(e)<1}lessThan(e){return this.cmp(e)<0}greaterThanOrEqualTo(e){return this.cmp(e)>-1}greaterThan(e){return this.cmp(e)>0}};let l=b;l.fromStringCache=new xs(qs);l.dZero=_e(0,0,0);l.dOne=_e(1,0,1);l.dNegOne=_e(-1,0,1);l.dTwo=_e(1,0,2);l.dTen=_e(1,0,10);l.dNaN=_e(Number.NaN,Number.NaN,Number.NaN);l.dInf=_e(1,Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY);l.dNegInf=_e(-1,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);l.dNumberMax=ve(1,0,Number.MAX_VALUE);l.dNumberMin=ve(1,0,Number.MIN_VALUE);N=l.fromValue_noAlloc;ve=l.fromComponents;_e=l.fromComponents_noNormalize;l.fromMantissaExponent;l.fromMantissaExponent_noNormalize;const Rs=new l(1);function _i(e,t,n=!0){let i=l.log10(e).floor(),a=l.div(e,l.pow(10,i));a.toStringWithDecimalPlaces(t)==="10"&&(a=Rs,i=i.add(1));const r=i.gte(1e9)?un(i,Math.max(Math.max(t,3),He.defaultDecimalsShown)):i.gte(1e4)?Ui(i,0):i.toStringWithDecimalPlaces(0);return n?a.toStringWithDecimalPlaces(t)+"e"+r:"e"+r}function Ui(e,t){if(e==null)return"NaN";if(e=new l(e),e.mag<.001)return 0 .toFixed(t);const i=e.toStringWithDecimalPlaces(t).split(".");return i[0]=i[0].replace(/(\d)(?=(\d\d\d)+(?!\d))/g,"$1,"),i.length==1?i[0]:i[0]+"."+i[1]}function pa(e,t){return e==null?"NaN":(e=new l(e),e.mag<1e-4?0 .toFixed(t):(e.mag<.1&&t!==0&&(t=Math.max(Math.max(t,e.log10().negate().ceil().toNumber()),He.defaultDecimalsShown)),e.toStringWithDecimalPlaces(t)))}const js=new l("eeee1000"),Bs=new l("e100000"),Ul=new l("e1000"),ma=new l(1e9),Vs=new l(1e6),zs=new l(1e3),Gs=new l(.98),Us=new l(.001),fa=new l(0);function un(e,t,n){if(t==null&&(t=He.defaultDecimalsShown),n=n!=null?n:He.defaultShowSmall,e=new l(e),isNaN(e.sign)||isNaN(e.layer)||isNaN(e.mag))return"NaN";if(e.sign<0)return"-"+un(e.neg(),t);if(e.mag===Number.POSITIVE_INFINITY)return"Infinity";if(e.gte(js)){const i=e.slog();return i.gte(Vs)?"F"+un(i.floor()):l.pow(10,i.sub(i.floor())).toStringWithDecimalPlaces(3)+"F"+Ui(i.floor(),0)}else{if(e.gte(Bs))return _i(e,0,!1);if(e.gte(Ul))return _i(e,0);if(e.gte(ma))return _i(e,t);if(e.gte(zs))return Ui(e,0);if(e.gte(Us)||!n)return pa(e,t);if(e.eq(fa))return 0 .toFixed(t)}return e=ga(e),e.lt(Ul)?_i(e,t).replace(/([^(?:e|F)]*)$/,"-$1"):un(e,t)+"\u207B\xB9"}function At(e){return e=new l(e),e.sign<0?"-"+At(e.neg()):e.gte(ma)||e.lte(Gs)&&!e.eq(fa)?un(e):un(e,0)}function va(e){return l.lt(e,0)?"-"+va(l.neg(e)):l.gt(e,2**51)?un(l.div(e,31536e3))+"y":(e=new l(e).toNumber(),e<60?un(e)+"s":e<3600?At(Math.floor(e/60))+"m "+un(e%60)+"s":e<86400?At(Math.floor(e/3600))+"h "+At(Math.floor(e/60)%60)+"m "+At(e%60)+"s":e<31536e3?At(Math.floor(e/84600)%365)+"d "+At(Math.floor(e/3600)%24)+"h "+At(Math.floor(e/60)%60)+"m":At(Math.floor(e/31536e3))+"y "+At(Math.floor(e/84600)%365)+"d "+At(Math.floor(e/3600)%24)+"h")}function Xs(e,t,n){e=new l(e);let i=e.toStringWithDecimalPlaces(t);return new l(i).gte(n)&&(i=l.sub(n,Math.pow(.1,t)).toStringWithDecimalPlaces(t)),i}function Hs(e,t){return un(e,t,!0)}function ga(e){let t=l.log10(e).ceil();const n=l.div(e,l.pow(10,t));return t=t.neg(),e=new l(10).pow(t).times(n),e}var Js=Object.freeze(Object.defineProperty({__proto__:null,default:l,exponentialFormat:_i,commaFormat:Ui,regularFormat:pa,format:un,formatWhole:At,formatTime:va,toPlaces:Xs,formatSmall:Hs,invertOOM:ga},Symbol.toStringTag,{value:"Module"}));const{exponentialFormat:Ws,commaFormat:Qs,regularFormat:Zs,format:ze,formatWhole:ge,formatTime:Rn,toPlaces:Ks,formatSmall:Ti,invertOOM:Ys}=Js;window.Decimal=l;window.exponentialFormat=Ws;window.commaFormat=Qs;window.regularFormat=Zs;window.format=ze;window.formatWhole=ge;window.formatTime=Rn;window.toPlaces=Ks;window.formatSmall=Ti;window.invertOOM=Ys;function on(e){let t=e.replace(/([A-Z])/g," $1");return t=t.charAt(0).toUpperCase()+t.slice(1),t}function vl(e){return typeof e=="function"}var xe=(e=>(e.Up="Up",e.Down="Down",e.Left="Left",e.Right="Right",e.Default="Up",e))(xe||{});const ki=Symbol("DoNotCache");function q(e,t){const n=e[t];vl(n)&&n.length===0&&!n[ki]?e[t]=w(n.bind(e)):vl(n)&&(e[t]=n.bind(e),e[t][ki]=!0)}function et(e){return vl(e)&&!e[ki]&&(e=w(e)),e}const it=Symbol("Component"),Ge=Symbol("GatherProps");let er=0;function pn(e="feature-"){return e+er++}var Re=(e=>(e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden",e[e.None=2]="None",e))(Re||{});function ht(e){const t=o(e);return t!==2&&t!==!1}function Mn(e){return o(e)===1}function k(e){return e[ki]=!0,e}function nt(e,t,n){e[t]===void 0&&n!=null&&(e[t]=n)}const Hn={variables:{"--foreground":"#dfdfdf","--background":"#0f0f0f","--feature-foreground":"#0f0f0f","--tooltip-background":"rgba(0, 0, 0, 0.75)","--raised-background":"#0f0f0f","--points":"#ffffff","--locked":"#bf8f8f","--highlighted":"#333","--bought":"#77bf5f","--danger":"rgb(220, 53, 69)","--link":"#02f2f2","--outline":"#dfdfdf","--accent1":"#627a82","--accent2":"#658262","--accent3":"#7c6282","--border-radius":"15px","--modal-border":"solid 2px var(--color)","--feature-margin":"0px"},floatingTabs:!0,mergeAdjacent:!0,showPin:!0};var Sl=(e=>(e.Classic="classic",e.Paper="paper",e.Nordic="nordic",e.Aqua="aqua",e))(Sl||{}),gi={classic:Hn,paper:{...Hn,variables:{...Hn.variables,"--background":"#2a323d","--feature-foreground":"#000","--raised-background":"#333c4a","--locked":"#3a3e45","--bought":"#5C8A58","--outline":"#333c4a","--border-radius":"4px","--modal-border":"","--feature-margin":"5px"},floatingTabs:!1},nordic:{...Hn,variables:{...Hn.variables,"--foreground":"#D8DEE9","--background":"#2E3440","--feature-foreground":"#000","--raised-background":"#3B4252","--points":"#E5E9F0","--locked":"#4c566a","--highlighted":"#434c5e","--bought":"#8FBCBB","--danger":"#D08770","--link":"#88C0D0","--outline":"#3B4252","--accent1":"#B48EAD","--accent2":"#A3BE8C","--accent3":"#EBCB8B","--border-radius":"4px","--modal-border":"solid 2px #3B4252","--feature-margin":"5px"},floatingTabs:!1},aqua:{...Hn,variables:{...Hn.variables,"--foreground":"#bfdfff","--background":"#001f3f","--tooltip-background":"rgba(0, 15, 31, 0.75)","--raised-background":"#001f3f","--points":"#dfefff","--locked":"#c4a7b3","--outline":"#bfdfff"}}};const Ot=ua();"fonts"in document&&(document.fonts.onloadingdone=()=>Ot.emit("fontsLoaded"));document.fonts.onloadingdone=()=>Ot.emit("fontsLoaded");var tr=Object.freeze(Object.defineProperty({__proto__:null,globalBus:Ot},Symbol.toStringTag,{value:"Module"}));const nr=Pi({id:"",devSpeed:null,name:"",tabs:[],time:-1,autosave:!0,offlineProd:!0,offlineTime:null,timePlayed:0,keepGoing:!1,modID:"",modVersion:"",layers:{}});var G=window.player=nr;function ha(e){return JSON.stringify(e,(t,n)=>o(n))}function ba(e={}){return Object.assign({id:`${He.id}-0`,name:"Default Save",tabs:He.initialTabs.slice(),time:Date.now(),autosave:!0,offlineProd:!0,offlineTime:0,timePlayed:0,keepGoing:!1,modID:He.id,modVersion:He.versionNumber,layers:{}},e)}function Yt(e){const t=Dn.compressToUTF16(ha(e!=null?e:G));return localStorage.setItem((e!=null?e:G).id,t),t}async function ir(){ar();try{let e=localStorage.getItem(Ae.active);if(e==null){await Qn(di());return}if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=Dn.decompressFromUTF16(e);else throw"Unable to determine save encoding";const t=JSON.parse(e);if(t.modID!==He.id){await Qn(di());return}t.id=Ae.active,await Qn(t)}catch(e){console.error(`Failed to load save. Falling back to new save.
`,e),await Qn(di())}}function di(){const e=Ri(),t=ba({id:e});return Yt(t),Ae.saves.push(e),t}function Ri(){let e,t=0;do e=`${He.id}-${t++}`;while(localStorage.getItem(e)!=null);return e}const kl=X(!1);async function Qn(e){console.info("Loading save",e),kl.value=!0;const{layers:t,removeLayer:n,addLayer:i}=await Gi(()=>Promise.resolve().then(function(){return xr}),void 0),{fixOldSave:a,getInitialLayers:r}=await Gi(()=>Promise.resolve().then(function(){return Gm}),void 0);for(const u in t){const d=t[u];d&&n(d)}r(e).forEach(u=>i(u,e)),e=ba(e),e.offlineProd&&e.time!=null&&e.time&&e.devSpeed!==0&&(e.offlineTime==null&&(e.offlineTime=0),e.offlineTime+=Math.min(e.offlineTime+(Date.now()-e.time)/1e3,He.offlineLimit*3600)),e.time=Date.now(),e.modVersion!==He.versionNumber&&(a(e.modVersion,e),e.modVersion=He.versionNumber),Object.assign(G,e),Ae.active=G.id,Ot.emit("onLoad")}setInterval(()=>{G.autosave&&Yt()},1e3);window.onbeforeunload=()=>{G.autosave&&Yt()};window.save=Yt;const lr=window.hardReset=async()=>{await Qn(di())};window.deleteLowerSaves=()=>{const e=Object.values(Ae.saves).indexOf(G.id)+1;Object.values(Ae.saves).slice(e).forEach(t=>localStorage.removeItem(t)),Ae.saves=Ae.saves.slice(0,e)};const Ni=Pi({active:"",saves:[],showTPS:!0,theme:Sl.Nordic,unthrottled:!1,alignUnits:!1});tt(Ni,e=>{const t=Dn.compressToUTF16(JSON.stringify(e));localStorage.setItem(He.id,t)},{deep:!0});var Ae=window.settings=Ni;window.hardResetSettings=()=>{const e={active:"",saves:[],showTPS:!0,theme:Sl.Nordic,alignUnits:!1};Ot.emit("loadSettings",e),Object.assign(Ni,e),lr()};function ar(){try{let e=localStorage.getItem(He.id);if(e!=null&&e!==""){if(e[0]!=="{")if(e[0]==="e")e=decodeURIComponent(escape(atob(e)));else if(e[0]==="\u1BE1")e=Dn.decompressFromUTF16(e);else{console.warn("Unable to determine settings encoding",e);return}const t=JSON.parse(e);typeof t=="object"&&Object.assign(Ni,t)}Ot.emit("loadSettings",Ni)}catch{}}const ya=Pi([]);function sr(e){ya.push(e)}const rr=Pi([]),or=Pi([]),ur={class:"table"},Zi=K({__name:"Column",setup(e){const t=w(()=>gi[Ae.theme].mergeAdjacent);return(n,i)=>(g(),$("div",ur,[v("div",{class:Me(["col",{mergeAdjacent:o(t)}])},[Wt(n.$slots,"default")],2)]))}}),cr={class:"table"},$i=K({__name:"Row",setup(e){const t=w(()=>gi[Ae.theme].mergeAdjacent);return(n,i)=>(g(),$("div",cr,[v("div",{class:Me(["row",{mergeAdjacent:o(t)}])},[Wt(n.$slots,"default")],2)]))}});function Ki(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!aa(e)}function he(e,t="span"){return typeof e=="function"?K({render:e}):typeof e=="string"?e.length>0?(e=e.trim(),e.charAt(0)!=="<"&&(e=`<${t}>${e}</${t}>`),K({template:e})):K({render:()=>({})}):e}function Ye(e){if(mn(e))return typeof e=="function"?e():he(e);const t=e[it];return s(t,e[Ge](),null)}function ji(...e){let t;return s($i,null,Ki(t=e.map(Ye))?t:{default:()=>[t]})}function xi(...e){let t;return s(Zi,null,Ki(t=e.map(Ye))?t:{default:()=>[t]})}function ut(e){if(mn(e))return typeof e=="function"?e():typeof e=="string"?s(F,null,[e]):s(e,null,null);const t=e[it];return s(t,e[Ge](),null)}function gl(...e){let t;return s($i,null,Ki(t=e.map(ut))?t:{default:()=>[t]})}function ni(...e){let t;return s(Zi,null,Ki(t=e.map(ut))?t:{default:()=>[t]})}function hl(e,t){return e.reduce((n,i)=>s(F,null,[n,t,i]))}function mn(e){return typeof e=="string"?!0:typeof e=="object"?e==null?!1:"render"in e||"component"in e:typeof e=="function"&&e[ki]===!0}function wa(e,t){const n=X(null),i=X(void 0);function a(d){n.value||(n.value=setInterval(u,250)),i.value=d}function r(){n.value&&(clearInterval(n.value),n.value=null)}function u(){t&&t.value?t.value():e&&e.value&&e.value(i.value)}return wl(r),{start:a,stop:r,handleHolding:u}}function ii(e,t){const n=w(()=>e.filter(i=>ht(i.visibility)&&t(i)));return{firstFeature:w(()=>n.value[0]),collapsedContent:k(()=>xi(...n.value.slice(1))),hasCollapsedContent:w(()=>n.value.length>1)}}function ei(e,t="div"){const n=St();return Vt(()=>{n.value=he(ot(e),t)}),n}function Pn(e,t="div"){const n=St(null);return Vt(()=>{const i=ot(e);n.value=i==""||i==null?null:he(i,t)}),n}function ot(e){return o(o(e))}function R(...e){return e.includes(Object)||e.push(Object),e}function _a(e){const t=X(!1),n=e[Ge].bind(e);return e[Ge]=()=>({...n(),onPointerenter:()=>t.value=!0,onPointerleave:()=>t.value=!1}),t}var me=(e,t)=>{const n=e.__vccOpts||e;for(const[i,a]of t)n[i]=a;return n};const dr=K({__name:"Context",emits:["updateNodes"],setup(e,{emit:t}){var f;const n=X({}),i=new ResizeObserver(d),a=X(null);fi(()=>{const h=a.value;h!=null&&i.observe(h)});let r=!0,u=X((f=a.value)==null?void 0:f.getBoundingClientRect());function d(){r&&(r=!1,en(()=>{var h;u.value=(h=a.value)==null?void 0:h.getBoundingClientRect(),Object.values(n.value).filter(y=>y).forEach(y=>y.rect=y.element.getBoundingClientRect()),t("updateNodes",n.value),r=!0}))}Ot.on("fontsLoaded",d);const c={attributes:!1,childList:!0,subtree:!1};Di(Nl,(h,y)=>{const _=new MutationObserver(()=>p(h));_.observe(y,c),n.value[h]={element:y,observer:_,rect:y.getBoundingClientRect()},d()}),Di($l,h=>{var y;(y=n.value[h])==null||y.observer.disconnect(),n.value[h]=void 0,d()}),Di(xl,n),Di(Ml,u);function p(h){const y=n.value[h];y!=null&&(y.rect=y.element.getBoundingClientRect(),t("updateNodes",n.value))}return(h,y)=>(g(),$(F,null,[Wt(h.$slots,"default",{},void 0,!0),v("div",{ref_key:"resizeListener",ref:a,class:"resize-listener"},null,512)],64))}});var Ca=me(dr,[["__scopeId","data-v-2b1dc1bc"]]);const pr=["onPointerdown"],mr={class:"modal-wrapper"},fr={class:"modal-container"},vr={class:"modal-header"},gr=m(" default header "),hr={class:"modal-body"},br=m(" default body "),yr={class:"modal-footer"},wr=v("div",{class:"modal-default-flex-grow"},null,-1),jn=K({__name:"Modal",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{expose:t,emit:n}){const a=ct(e),r=w(()=>o(a.modelValue)||d.value);function u(){n("update:modelValue",!1)}const d=X(!1),c=X(null),p=w(()=>{var f,h;return(h=(f=c.value)==null?void 0:f.nodes)!=null?h:null});return t({isOpen:r,nodes:p}),(f,h)=>(g(),U(sa,{to:"#modal-root"},[s(Qi,{name:"modal",onBeforeEnter:h[0]||(h[0]=y=>d.value=!0),onAfterLeave:h[1]||(h[1]=y=>d.value=!1)},{default:se(()=>[cn(v("div",Jt({class:"modal-mask",onPointerdown:Yn(u,["self"])},f.$attrs),[v("div",mr,[v("div",fr,[v("div",vr,[Wt(f.$slots,"header",{shown:o(r)},()=>[gr])]),v("div",hr,[s(Ca,{ref_key:"contextRef",ref:c},{default:se(()=>[Wt(f.$slots,"body",{shown:o(r)},()=>[br])]),_:3},512)]),v("div",yr,[Wt(f.$slots,"footer",{shown:o(r)},()=>[v("div",{class:"modal-default-footer"},[wr,v("button",{class:"button modal-default-button",onClick:u}," Close ")])])])])])],16,pr),[[kn,e.modelValue]])]),_:3})]))}}),Wn=Symbol("ProxyState");function pt(e,t={}){const n=t;let i=!1;function a(){return i||(Object.assign(n,e(n)),i=!0),n}return new Proxy(n,{get(r,u){if(u===Wn)return a();const d=a()[u];return d!=null&&typeof d=="object"&&Ji in d?d[Ji]:d},set(r,u,d){return a()[u]=d,!0},has(r,u){return u===Wn?!0:Reflect.has(a(),u)},ownKeys(){return Reflect.ownKeys(a())},getOwnPropertyDescriptor(r,u){return i||(Object.assign(n,e(n)),i=!0),Object.getOwnPropertyDescriptor(r,u)}})}var Pt=window.state=_l({lastTenTicks:[],hasNaN:!1,NaNPath:[]});const pi=Symbol("PersistentState"),mi=Symbol("DefaultValue"),Xi=Symbol("StackTrace"),Hi=Symbol("Deleted"),Ji=Symbol("NonPersistent"),Zn=Symbol("SaveDataPath");function _r(){var e,t;return(t=(e=new Error().stack)==null?void 0:e.split(`
`).slice(3,5).map(n=>n.trim()).join(`
`))!=null?t:""}function Xl(e,t){var n;if(l.isNaN(t))throw Pt.hasNaN||(G.autosave=!1,Pt.hasNaN=!0,Pt.NaNPath=e[Zn],Pt.NaNPersistent=e),console.error("Attempted to save NaN value to",(n=e[Zn])==null?void 0:n.join("."),e),new Error("Attempted to set NaN value. See above for details");e[pi].value=t}function H(e,t=!0){const n=Et(e)?e:X(e);Et(e)&&(e=e.value);const i=w({get(){return n.value},set(r){t?Xl(a,r):a[pi].value=r}});i[mi]=e;const a={get value(){return n.value},set value(r){t?Xl(a,r):a[pi].value=r},__v_isRef:!0,[pi]:n,[mi]:e,[Xi]:_r(),[Hi]:!1,[Ji]:i,[Zn]:void 0};return Xt.length===0?console.warn("Creating a persistent ref outside of a layer. This is not officially supported",a,`
Created at:
`+a[Xi]):Kn[Xt[Xt.length-1]].add(a),a}function Cr(e){return e!=null&&typeof e=="object"&&pi in e}function Sr(e){Xt.length===0?console.warn("Deleting a persistent ref outside of a layer. Ignoring...",e):Kn[Xt[Xt.length-1]].delete(e),e[Hi]=!0}Ot.on("addLayer",(e,t)=>{const n=[],i=(a,r=[])=>{let u=!1;return Object.keys(a).forEach(d=>{let c=a[d];if(c!=null&&typeof c=="object")if(Wn in c&&(c=c[Wn]),Cr(c)){if(u=!0,c[Hi]){console.warn("Deleted persistent ref present in returned object. Ignoring...",c,`
Created at:
`+c[Xi]);return}Kn[e.id].delete(c);const p=[e.id,...r,d];c[Zn]!=null&&JSON.stringify(p)!==JSON.stringify(c[Zn])&&console.error(`Persistent ref is being saved to \`${p.join(".")}\` when it's already present at \`${c[Zn].join(".")}\`. This can cause unexpected behavior when loading saves between updates.`,c),c[Zn]=p;const f=r.reduce((y,_)=>(_ in y||(y[_]={}),y[_]),t),h=f[d];f[d]=c[pi],Va(f)?h!=null?f[d]=h:f[d]=c[mi]:h!=null?f[d].value=h:f[d].value=c[mi]}else!(c instanceof l)&&!Et(c)&&!n.includes(c)&&(typeof c.type=="symbol"&&n.push(c),i(c,[...r,d])&&(yn(c)&&!yn(a)?console.warn("Found array that contains persistent values when adding layer. Keep in mind changing the order of elements in the array will mess with existing player saves.",Wn in a?a[Wn]:a,d):u=!0))}),u};i(e[Wn]),Kn[e.id].forEach(a=>{a[Hi]||console.error(`Created persistent ref in ${e.id} without registering it to the layer! Make sure to include everything persistent in the returned object`,a,`
Created at:
`+a[Xi])}),Kn[e.id].clear()});const Nl=Symbol("RegisterNode"),$l=Symbol("UnregisterNode"),xl=Symbol("Nodes"),Ml=Symbol("Bounds"),Gt=_l({});window.layers=Gt;const Kn={},Xt=[];function Tn(e,t){return pt(()=>{const n={},i=n.emitter=ua();if(n.on=i.on.bind(i),n.emit=i.emit.bind(i),n.nodes=X({}),n.id=e,Xt.push(e),Kn[e]=new Set,n.minimized=H(!1,!1),Object.assign(n,t.call(n)),Xt[Xt.length-1]==null||Xt[Xt.length-1]!==e)throw`Adding layers stack in invalid state. This should not happen
Stack: ${Xt}
Trying to pop ${n.id}`;Xt.pop(),q(n,"color"),q(n,"display"),q(n,"classes"),q(n,"style"),q(n,"name"),nt(n,"name",n.id),q(n,"minWidth"),nt(n,"minWidth",600),q(n,"minimizable"),nt(n,"minimizable",!0),q(n,"minimizedDisplay");const a=n.style;return n.style=w(()=>{var u,d;let r=o(n.minWidth);return(typeof r=="number"||!Number.isNaN(parseInt(r)))&&(r=r+"px"),[(u=o(a))!=null?u:"",(d=n.minimized)!=null&&d.value?{flexGrow:"0",flexShrink:"0",width:"60px",minWidth:"",flexBasis:"",margin:"0"}:{flexGrow:"",flexShrink:"",width:"",minWidth:r,flexBasis:r,margin:""}]}),n})}function wn(e,t){if(console.info("Adding layer",e.id),Gt[e.id]){console.error("Attempted to add layer with same ID as existing layer",e.id,Gt[e.id]);return}nt(t,"layers",{}),t.layers[e.id]==null&&(t.layers[e.id]={}),Gt[e.id]=e,Ot.emit("addLayer",e,t.layers[e.id])}function kr(e){return Gt[e]}function Sa(e){console.info("Removing layer",e.id),Ot.emit("removeLayer",e),Gt[e.id]=void 0}function Nr(e){Sa(e),wn(e,G)}function $r(e){const t=X(!1);return{openModal:()=>t.value=!0,modal:k(()=>s(jn,{modelValue:t.value,"onUpdate:modelValue":n=>t.value=n},{header:()=>s("h2",null,[o(e.name)]),body:o(e.display)}))}}Ot.on("update",function(t){Object.values(Gt).forEach(n=>{n==null||n.emit("preUpdate",t)}),Object.values(Gt).forEach(n=>{n==null||n.emit("update",t)}),Object.values(Gt).forEach(n=>{n==null||n.emit("postUpdate",t)})});var xr=Object.freeze(Object.defineProperty({__proto__:null,RegisterNodeInjectionKey:Nl,UnregisterNodeInjectionKey:$l,NodesInjectionKey:xl,BoundsInjectionKey:Ml,layers:Gt,persistentRefs:Kn,addingLayers:Xt,createLayer:Tn,addLayer:wn,getLayer:kr,removeLayer:Sa,reloadLayer:Nr,setupLayerModal:$r},Symbol.toStringTag,{value:"Module"}));const Mr=K({components:{Context:Ca},props:{index:{type:Number,required:!0},display:{type:R(Object,String,Function),required:!0},minimizedDisplay:R(Object,String,Function),minimized:{type:Object,required:!0},name:{type:R(String),required:!0},color:R(String),minimizable:R(Boolean),nodes:{type:Object,required:!0}},emits:["setMinimized"],setup(e){const{display:t,index:n,minimized:i,minimizedDisplay:a}=ct(e),r=ei(t),u=Pn(a),d=w(()=>He.allowGoBack&&n.value>0&&!ot(i));function c(){G.tabs.splice(o(e.index),1/0)}function p(f){e.nodes.value=f}return{component:r,minimizedComponent:u,showGoBack:d,updateNodes:p,unref:o,goBack:c}}}),Pr={key:1};function Tr(e,t,n,i,a,r){const u=Ft("Context");return g(),$("div",{class:"layer-container",style:Oe({"--layer-color":e.unref(e.color)})},[e.showGoBack?(g(),$("button",{key:0,class:"goBack",onClick:t[0]||(t[0]=(...d)=>e.goBack&&e.goBack(...d))},"\u274C")):j("",!0),e.unref(e.minimized)?(g(),$("button",{key:1,class:"layer-tab minimized",onClick:t[1]||(t[1]=d=>e.$emit("setMinimized",!1))},[e.minimizedComponent?(g(),U(Pe(e.minimizedComponent),{key:0})):(g(),$("div",Pr,ee(e.unref(e.name)),1))])):(g(),$("div",{key:2,class:Me(["layer-tab",{showGoBack:e.showGoBack}])},[s(u,{onUpdateNodes:e.updateNodes},{default:se(()=>[(g(),U(Pe(e.component)))]),_:1},8,["onUpdateNodes"])],2)),e.unref(e.minimizable)?(g(),$("button",{key:3,class:"minimize",onClick:t[2]||(t[2]=d=>e.$emit("setMinimized",!0))}," \u25BC ")):j("",!0)],4)}var Ir=me(Mr,[["render",Tr],["__scopeId","data-v-a592996e"]]);const ka=e=>(nn("data-v-4b4bda40"),e=e(),ln(),e),Er=ka(()=>v("h2",null,"Changelog",-1)),Fr=ka(()=>v("details",{open:""},[v("summary",null,[m("v0.0 Initial Commit - "),v("time",null,"2021-09-04")]),m(" This is the first release :D "),v("ul",null,[v("li",{class:"feature"},"Did everything"),v("li",{class:"fix"},"Had some fun"),v("li",{class:"breaking"},"Removed everything"),v("li",{class:"balancing"},"Created some bugs to fix later")])],-1)),qr=K({__name:"Changelog",setup(e,{expose:t}){const n=X(!1);return t({open(){n.value=!0}}),(i,a)=>(g(),U(jn,{modelValue:n.value,"onUpdate:modelValue":a[0]||(a[0]=r=>n.value=r)},{header:se(()=>[Er]),body:se(()=>[Fr]),_:1},8,["modelValue"]))}});var Dr=me(qr,[["__scopeId","data-v-4b4bda40"]]),Lr=K({props:{element:Object,display:{type:R(Object,String,Function),required:!0},style:R(Object,String,Array),classes:R(Object),direction:R(String),xoffset:R(String),yoffset:R(String),pinned:Object},setup(e){const{element:t,display:n,pinned:i}=ct(e),a=X(!1),r=w(()=>(ot(i)||a.value)&&u.value),u=Pn(n),d=St(he(k(()=>{const f=ot(t);return f==null?"":ut(f)})));function c(f){const h=i;f.shiftKey&&h&&(h.value=!h.value,f.stopPropagation(),f.preventDefault())}const p=w(()=>ot(i)&&gi[Ae.theme].showPin);return{Direction:xe,isHovered:a,isShown:r,comp:u,elementComp:d,unref:o,togglePinned:c,showPin:p}}});const Ar={key:0,class:"material-icons pinned"};function Or(e,t,n,i,a,r){return g(),$("div",{class:Me(["tooltip-container",{shown:e.isShown,...e.unref(e.classes)}]),onMouseenter:t[0]||(t[0]=u=>e.isHovered=!0),onMouseleave:t[1]||(t[1]=u=>e.isHovered=!1),onClickCapture:t[2]||(t[2]=(...u)=>e.togglePinned&&e.togglePinned(...u))},[Wt(e.$slots,"default",{},void 0,!0),e.elementComp?(g(),U(Pe(e.elementComp),{key:0})):j("",!0),s(Qi,{name:"fade"},{default:se(()=>{var u;return[e.isShown?(g(),$("div",{key:0,class:Me(["tooltip",{top:e.unref(e.direction)===e.Direction.Up,left:e.unref(e.direction)===e.Direction.Left,right:e.unref(e.direction)===e.Direction.Right,bottom:e.unref(e.direction)===e.Direction.Down,...e.unref(e.classes)}]),style:Oe([{"--xoffset":e.unref(e.xoffset)||"0px","--yoffset":e.unref(e.yoffset)||"0px"},(u=e.unref(e.style))!=null?u:{}])},[e.showPin?(g(),$("span",Ar,"push_pin")):j("",!0),e.comp?(g(),U(Pe(e.comp),{key:1})):j("",!0)],6)):j("",!0)]}),_:1})],34)}var st=me(Lr,[["render",Or],["__scopeId","data-v-be7a60de"]]);const li=e=>(nn("data-v-5d3cb6f4"),e=e(),ln(),e),Rr={class:"info-modal-header"},jr=["src","alt"],Br={class:"info-modal-title"},Vr={key:0},zr={key:0},Gr={key:0},Ur=li(()=>v("div",null," Made in Profectus, by thepaperpilot with inspiration from Acameada and Jacorb ",-1)),Xr=li(()=>v("br",null,null,-1)),Hr=li(()=>v("br",null,null,-1)),Jr=["href"],Wr=li(()=>v("span",{class:"material-icons info-modal-discord"},"discord",-1)),Qr=li(()=>v("div",null,[v("a",{href:"https://discord.gg/WzejVAx",class:"info-modal-discord-link",target:"_blank"},[v("span",{class:"material-icons info-modal-discord"},"discord"),m(" The Paper Pilot Community ")])],-1)),Zr=li(()=>v("div",null,[v("a",{href:"https://discord.gg/F3xveHV",class:"info-modal-discord-link",target:"_blank"},[v("span",{class:"material-icons info-modal-discord"},"discord"),m(" The Modding Tree ")])],-1)),Kr=li(()=>v("br",null,null,-1));var Yr=K({__name:"Info",props:{changelog:null},setup(e,{expose:t}){const n=e,{title:i,logo:a,author:r,discordName:u,discordLink:d,versionNumber:c,versionTitle:p}=He,f=ct(n),h=X(!1),y=w(()=>Rn(G.timePlayed)),_=w(()=>he(k(()=>s(F,null,[rr.map(Ye)]))));t({open(){h.value=!0}});function C(){var T;(T=o(f.changelog))==null||T.open()}return(T,W)=>(g(),U(jn,{modelValue:h.value,"onUpdate:modelValue":W[0]||(W[0]=le=>h.value=le)},{header:se(()=>[v("div",Rr,[o(a)?(g(),$("img",{key:0,class:"info-modal-logo",src:o(a),alt:o(i)},null,8,jr)):j("",!0),v("div",Br,[v("h2",null,ee(o(i)),1),v("h4",null,[m(" v"+ee(o(c)),1),o(p)?(g(),$("span",Vr,": "+ee(o(p)),1)):j("",!0)])])])]),body:se(({shown:le})=>[le?(g(),$("div",zr,[o(r)?(g(),$("div",Gr,"By "+ee(o(r)),1)):j("",!0),Ur,Xr,v("div",{class:"link",onClick:C},"Changelog"),Hr,v("div",null,[o(d)?(g(),$("a",{key:0,href:o(d),class:"info-modal-discord-link",target:"_blank"},[Wr,m(" "+ee(o(u)),1)],8,Jr)):j("",!0)]),Qr,Zr,Kr,v("div",null,"Time Played: "+ee(o(y)),1),(g(),U(Pe(o(_))))])):j("",!0)]),_:1},8,["modelValue"]))}});var eo=me(Yr,[["__scopeId","data-v-5d3cb6f4"]]);const to={class:"field"},no={key:0,class:"field-title"},Pl=K({__name:"Select",props:{title:null,modelValue:null,options:null,placeholder:null,closeOnSelect:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){var u;const n=e,i=Pn(tn(n,"title"),"span"),a=X((u=n.options.find(d=>d.value===n.modelValue))!=null?u:null);tt(tn(n,"modelValue"),d=>{var c;ot(a)!==d&&(a.value=(c=n.options.find(p=>p.value===d))!=null?c:null)});function r(d){t("update:modelValue",d.value)}return(d,c)=>(g(),$("div",to,[o(i)?(g(),$("span",no,[(g(),U(Pe(o(i))))])):j("",!0),s(o(Ja),{options:e.options,modelValue:a.value,"onUpdate:modelValue":[c[0]||(c[0]=p=>a.value=p),r],min:1,"label-by":"label",placeholder:e.placeholder,"close-on-select":e.closeOnSelect},null,8,["options","modelValue","placeholder","close-on-select"])]))}});const io={class:"field"},lo=K({__name:"Toggle",props:{title:null,modelValue:{type:Boolean}},emits:["update:modelValue"],setup(e,{emit:t}){const n=e,i=w(()=>{var r;return he((r=o(n.title))!=null?r:"<span></span>","span")}),a=w({get(){return!!n.modelValue},set(r){t("update:modelValue",r)}});return(r,u)=>(g(),$("label",io,[cn(v("input",{type:"checkbox",class:"toggle","onUpdate:modelValue":u[0]||(u[0]=d=>Et(a)?a.value=d:null)},null,512),[[za,o(a)]]),(g(),U(Pe(o(i))))]))}});var Cn=me(lo,[["__scopeId","data-v-11046116"]]);const ao=["onClick"],so=K({__name:"FeedbackButton",props:{left:{type:Boolean}},emits:["click"],setup(e,{emit:t}){const n=X(!1),i=X(null);function a(){t("click"),i.value&&clearTimeout(i.value),n.value=!1,en(()=>{n.value=!0,i.value=setTimeout(()=>n.value=!1,500)})}return(r,u)=>(g(),$("button",{onClick:Yn(a,["stop"]),class:Me(["feedback",{activated:n.value,left:e.left}])},[Wt(r.$slots,"default",{},void 0,!0)],10,ao))}});var Na=me(so,[["__scopeId","data-v-01a1b95c"]]);const ro={class:"header"},oo=v("h2",null,"Settings",-1),uo={class:"option-tabs"},co={key:0},po=m("Manually save"),mo={key:1};var fo=K({__name:"Options",setup(e,{expose:t}){const n=X(!1),i=X("behaviour");function a(oe){return oe==i.value}function r(oe){i.value=oe}t({isTab:a,setTab:r,save:Yt,open(){n.value=!0}});const u=Object.keys(gi).map(oe=>({label:on(oe),value:oe})),d=w(()=>he(k(()=>s(F,null,[ya.map(Ye)])))),{showTPS:c,theme:p,unthrottled:f,alignUnits:h}=ct(Ae),{autosave:y,offlineProd:_}=ct(G),C=w({get(){return G.devSpeed===0},set(oe){G.devSpeed=oe?0:null}}),T=k(()=>s("span",{class:"option-title"},[m("Unthrottled"),s("desc",null,[m("Allow the game to run as fast as possible. Not battery friendly.")])])),W=k(()=>s("span",{class:"option-title"},[m("Offline Production"),s(st,{display:"Save-specific",direction:xe.Right},{default:()=>[m("*")]}),s("desc",null,[m("Simulate production that occurs while the game is closed.")])])),le=k(()=>s("span",{class:"option-title"},[m("Autosave"),s(st,{display:"Save-specific",direction:xe.Right},{default:()=>[m("*")]}),s("desc",null,[m("Automatically save the game every second or when the game is closed.")])])),P=k(()=>s("span",{class:"option-title"},[m("Pause game"),s(st,{display:"Save-specific",direction:xe.Right},{default:()=>[m("*")]}),s("desc",null,[m("Stop everything from moving.")])])),M=k(()=>s("span",{class:"option-title"},[m("Theme"),s("desc",null,[m("How the game looks.")])])),Z=k(()=>s("span",{class:"option-title"},[m("Show TPS"),s("desc",null,[m("Show TPS meter at the bottom-left corner of the page.")])])),re=k(()=>s("span",{class:"option-title"},[m("Align modifier units"),s("desc",null,[m("Align numbers to the beginning of the unit in modifier view.")])]));return(oe,B)=>(g(),U(jn,{modelValue:n.value,"onUpdate:modelValue":B[10]||(B[10]=J=>n.value=J)},{header:se(()=>[v("div",ro,[oo,v("div",uo,[v("button",{class:Me({selected:a("behaviour")}),onClick:B[0]||(B[0]=J=>r("behaviour"))},"Behaviour",2),v("button",{class:Me({selected:a("appearance")}),onClick:B[1]||(B[1]=J=>r("appearance"))},"Appearance",2)])])]),body:se(()=>[a("behaviour")?(g(),$("div",co,[s(Cn,{title:o(T),modelValue:o(f),"onUpdate:modelValue":B[2]||(B[2]=J=>Et(f)?f.value=J:null)},null,8,["title","modelValue"]),o(He).enablePausing?(g(),U(Cn,{key:0,title:o(P),modelValue:o(C),"onUpdate:modelValue":B[3]||(B[3]=J=>Et(C)?C.value=J:null)},null,8,["title","modelValue"])):j("",!0),s(Cn,{title:o(W),modelValue:o(_),"onUpdate:modelValue":B[4]||(B[4]=J=>Et(_)?_.value=J:null)},null,8,["title","modelValue"]),s(Cn,{title:o(le),modelValue:o(y),"onUpdate:modelValue":B[5]||(B[5]=J=>Et(y)?y.value=J:null)},null,8,["title","modelValue"]),o(y)?j("",!0):(g(),U(Na,{key:1,class:"button save-button",onClick:B[6]||(B[6]=J=>o(Yt)())},{default:se(()=>[po]),_:1}))])):j("",!0),a("appearance")?(g(),$("div",mo,[s(Pl,{title:o(M),options:o(u),modelValue:o(p),"onUpdate:modelValue":B[7]||(B[7]=J=>Et(p)?p.value=J:null)},null,8,["title","options","modelValue"]),(g(),U(Pe(o(d)))),s(Cn,{title:o(Z),modelValue:o(c),"onUpdate:modelValue":B[8]||(B[8]=J=>Et(c)?c.value=J:null)},null,8,["title","modelValue"]),s(Cn,{title:o(re),modelValue:o(h),"onUpdate:modelValue":B[9]||(B[9]=J=>Et(h)?h.value=J:null)},null,8,["title","modelValue"])])):j("",!0)]),_:1},8,["modelValue"]))}});const vo=["onSubmit"],go={class:"field"},ho={key:0,class:"field-title"},bo=["placeholder"],yo=K({__name:"Text",props:{title:null,modelValue:null,textArea:{type:Boolean},placeholder:null,maxHeight:null,submitOnBlur:{type:Boolean}},emits:["update:modelValue","submit","cancel"],setup(e,{emit:t}){const n=e,i=Pn(tn(n,"title"),"span"),a=St(null);fi(()=>{var c;(c=a.value)==null||c.focus()});const r=w({get(){var c;return(c=o(n.modelValue))!=null?c:""},set(c){t("update:modelValue",c)}});function u(){t("submit")}function d(){n.submitOnBlur!==!1?t("submit"):t("cancel")}return(c,p)=>(g(),$("form",{onSubmit:Yn(u,["prevent"])},[v("div",go,[o(i)?(g(),$("span",ho,[(g(),U(Pe(o(i))))])):j("",!0),e.textArea?(g(),U(o(Qa),{key:1,modelValue:o(r),"onUpdate:modelValue":p[0]||(p[0]=f=>Et(r)?r.value=f:null),placeholder:e.placeholder,maxHeight:e.maxHeight,onBlur:d,ref_key:"field",ref:a},null,8,["modelValue","placeholder","maxHeight"])):cn((g(),$("input",{key:2,type:"text","onUpdate:modelValue":p[1]||(p[1]=f=>Et(r)?r.value=f:null),placeholder:e.placeholder,class:Me({fullWidth:!e.title}),onBlur:d,ref_key:"field",ref:a},null,42,bo)),[[ra,o(r)]])])],40,vo))}});var $a=me(yo,[["__scopeId","data-v-90bd4994"]]);const wo=K({__name:"Node",props:{id:null},setup(e){const n=ct(e),i=zi(Nl,()=>{}),a=zi($l,()=>{}),r=St(null),u=w(()=>r.value&&r.value.parentElement);return tt([u,n.id],([d,c],[p,f])=>{p&&a(o(f)),d&&i(c,d)}),wl(()=>a(o(n.id))),(d,c)=>(g(),$("div",{class:"node",ref_key:"node",ref:r},null,512))}});var Bn=me(wo,[["__scopeId","data-v-a48cb382"]]);const _o={},Co={class:"notif"};function So(e,t){return g(),$("div",Co,"!")}var Nn=me(_o,[["render",So],["__scopeId","data-v-66323fd4"]]);const $e=K({__name:"Spacer",props:{width:{default:"8px"},height:{default:"17px"}},setup(e){return(t,n)=>(g(),$("div",{style:Oe({width:e.width,height:e.height})},null,4))}});ca.registerPlugin(Za);Ka.registerPlugin("batch",Ya);var ko=K({props:{style:R(String,Object,Array),classes:R(Object),onInit:{type:Function,required:!0},id:{type:String,required:!0},onContainerResized:Function,onHotReload:Function},setup(e){const t=St(null),n=new ResizeObserver(r),i=St(null);fi(()=>{var d,c;const u=i.value;u!=null&&(n.observe(u),t.value=new ca({resizeTo:u,backgroundAlpha:0}),(d=i.value)==null||d.appendChild(t.value.view),(c=e.onInit)==null||c.call(e,t.value)),r(),e.onHotReload&&en(e.onHotReload)}),Cl(()=>{var u;(u=t.value)==null||u.destroy()});let a=!0;function r(){a&&(a=!1,en(()=>{var u;i.value!=null&&((u=e.onContainerResized)==null||u.call(e,i.value.getBoundingClientRect())),a=!0}))}return Ot.on("fontsLoaded",r),{unref:o,resizeListener:i}}});function No(e,t,n,i,a,r){return g(),$("div",{ref:"resizeListener",class:Me(["resize-listener",e.unref(e.classes)]),style:Oe(e.unref(e.style))},null,6)}var $o=me(ko,[["render",No],["__scopeId","data-v-48dd302a"]]);const xo=Symbol("Particles");function Yi(e){return pt(()=>{var a,r;const t=(a=e==null?void 0:e())!=null?a:{};t.id=pn("particles-"),t.type=xo,t[it]=$o,t.app=St(null),t.addEmitter=u=>{const d=t;return d.app.value?Promise.resolve(new jl(d.app.value.stage,u)):new Promise(c=>{n.push({resolve:c,config:u})})};let n=[];function i(u){const d=t;d.app.value=u,n.forEach(({resolve:c,config:p})=>c(new jl(u.stage,p))),n=[]}return t.onContainerResized=(r=t.onContainerResized)==null?void 0:r.bind(t),t[Ge]=function(){const{id:u,style:d,classes:c,onContainerResized:p,onHotReload:f}=this;return{id:u,style:o(d),classes:c,onContainerResized:p,onHotReload:f,onInit:i}},t})}window.upgradeConfig=es;function dn(e,t="points",n=0,i=void 0){const a=Et(e)?e:H(e);if(a.displayName=t,a.precision=n,a.small=i,!Et(e)){const r=a[Ji];r.displayName=t,r.precision=n,r.small=i}return a}function el(e){const t=H(e.value);return tt(e,n=>{kl.value||l.gt(n,t.value)&&(t.value=n)}),t}function Mo(e){const t=H(e.value);return tt(e,(n,i)=>{kl.value||l.gt(n,i)&&(t.value=l.add(t.value,l.sub(n,i)))}),t}new l("10^^8");new l("1e100");function Sn(e,t){const n=t!=null?t:e.value;return l.eq(e.precision,0)?ge(e.small?n:l.floor(n)):ze(n,e.precision,e.small)}function yi(e){return"displayName"in e?e:o(e)}const Po={key:0},To={key:0,class:"mark star"},Io=["src"],Eo=K({__name:"MarkNode",props:{mark:{type:[Boolean,String]}},setup(e){return(t,n)=>e.mark?(g(),$("div",Po,[e.mark===!0?(g(),$("div",To)):(g(),$("img",{key:1,class:"mark",src:e.mark},null,8,Io))])):j("",!0)}});var Ii=me(Eo,[["__scopeId","data-v-2207999f"]]);const xa=l.ln(10);function Ci(e){return e}function Fo(e,t){if(D(t))return t.invert(l.neg(e));throw new Error("Could not invert due to no input being a variable")}function qo(e,t){if(D(t))return E.neg(t.getIntegralFormula(e));throw new Error("Could not integrate due to no input being a variable")}function Do(e){return E.neg(e)}function Lo(e,t,n){if(D(t))return t.invert(l.sub(e,bt(n)));if(D(n))return n.invert(l.sub(e,bt(t)));throw new Error("Could not invert due to no input being a variable")}function Ao(e,t,n){var i,a;if(D(t)){const r=t.getIntegralFormula(e);return E.times(n,(i=t.innermostVariable)!=null?i:0).add(r)}else if(D(n)){const r=n.getIntegralFormula(e);return E.times(t,(a=n.innermostVariable)!=null?a:0).add(r)}throw new Error("Could not integrate due to no input being a variable")}function Oo(e,t,n){if(D(t)){const i=t.getIntegralFormula(e);return E.add(i,n)}else if(D(n)){const i=n.getIntegralFormula(e);return E.add(i,t)}throw new Error("Could not integrate due to no input being a variable")}function Ro(e,t,n){if(D(t))return t.invert(l.add(e,bt(n)));if(D(n))return n.invert(l.sub(bt(t),e));throw new Error("Could not invert due to no input being a variable")}function jo(e,t,n){var i,a;if(D(t)){const r=t.getIntegralFormula(e);return E.sub(r,E.times(n,(i=t.innermostVariable)!=null?i:0))}else if(D(n)){const r=n.getIntegralFormula(e);return E.times(t,(a=n.innermostVariable)!=null?a:0).sub(r)}throw new Error("Could not integrate due to no input being a variable")}function Bo(e,t,n){if(D(t)){const i=t.getIntegralFormula(e);return E.sub(i,n)}else if(D(n)){const i=n.getIntegralFormula(e);return E.sub(i,t)}throw new Error("Could not integrate due to no input being a variable")}function Vo(e,t,n){if(D(t))return t.invert(l.div(e,bt(n)));if(D(n))return n.invert(l.div(e,bt(t)));throw new Error("Could not invert due to no input being a variable")}function zo(e,t,n){if(D(t)){const i=t.getIntegralFormula(e);return E.times(i,n)}else if(D(n)){const i=n.getIntegralFormula(e);return E.times(i,t)}throw new Error("Could not integrate due to no input being a variable")}function Go(e,t,n){if(D(t))return E.div(e,n);if(D(n))return E.div(e,t);throw new Error("Could not apply substitution due to no input being a variable")}function Uo(e,t,n){if(D(t))return t.invert(l.mul(e,bt(n)));if(D(n))return n.invert(l.div(bt(t),e));throw new Error("Could not invert due to no input being a variable")}function Xo(e,t,n){if(D(t)){const i=t.getIntegralFormula(e);return E.div(i,n)}else if(D(n)){const i=n.getIntegralFormula(e);return E.div(t,i)}throw new Error("Could not integrate due to no input being a variable")}function Ho(e,t,n){if(D(t))return E.mul(e,n);if(D(n))return E.mul(e,t);throw new Error("Could not apply substitution due to no input being a variable")}function Jo(e,t){if(D(t))return t.invert(l.recip(e));throw new Error("Could not invert due to no input being a variable")}function Wo(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.ln(n)}throw new Error("Could not integrate due to no input being a variable")}function Qo(e,t){if(D(t))return t.invert(l.pow10(e));throw new Error("Could not invert due to no input being a variable")}function Zo(e){return l.ln(e).sub(1).times(e).div(xa)}function Ko(e,t){if(D(t)){const n=xa.times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}throw new Error("Could not invert due to no input being a variable")}function Yo(e,t){if(D(t))return new E({inputs:[t.getIntegralFormula(e)],evaluate:Zo,invert:Ko});throw new Error("Could not integrate due to no input being a variable")}function eu(e,t,n){if(D(t))return t.invert(l.pow(bt(n),e));if(D(n))return n.invert(l.root(bt(t),e));throw new Error("Could not invert due to no input being a variable")}function tu(e,t){return l.ln(e).sub(1).times(e).div(l.ln(t))}function nu(e,t,n){if(D(t)){const i=l.ln(bt(n)).times(e);return t.invert(i.div(i.div(Math.E).lambertw()))}throw new Error("Could not invert due to no input being a variable")}function iu(e,t,n){if(D(t))return new E({inputs:[t.getIntegralFormula(e),n],evaluate:tu,invert:nu});throw new Error("Could not integrate due to no input being a variable")}function lu(e,t){if(D(t))return t.invert(l.pow(2,e));throw new Error("Could not invert due to no input being a variable")}function au(e){return l.ln(e).sub(1).times(e).div(l.ln(2))}function su(e,t){if(D(t)){const n=l.ln(2).times(e);return t.invert(n.div(n.div(Math.E).lambertw()))}throw new Error("Could not invert due to no input being a variable")}function ru(e,t){if(D(t))return new E({inputs:[t.getIntegralFormula(e)],evaluate:au,invert:su});throw new Error("Could not integrate due to no input being a variable")}function ou(e,t){if(D(t))return t.invert(l.exp(e));throw new Error("Could not invert due to no input being a variable")}function uu(e){return l.ln(e).sub(1).times(e)}function cu(e,t){if(D(t))return t.invert(l.div(e,l.div(e,Math.E).lambertw()));throw new Error("Could not invert due to no input being a variable")}function du(e,t){if(D(t))return new E({inputs:[t.getIntegralFormula(e)],evaluate:uu,invert:cu});throw new Error("Could not integrate due to no input being a variable")}function pu(e,t,n){if(D(t))return t.invert(l.root(e,bt(n)));if(D(n))return n.invert(l.ln(e).div(l.ln(bt(t))));throw new Error("Could not invert due to no input being a variable")}function mu(e,t,n){if(D(t)){const i=t.getIntegralFormula(e),a=E.add(n,1);return E.pow(i,a).div(a)}else if(D(n)){const i=n.getIntegralFormula(e);return E.pow(t,i).div(E.ln(t))}throw new Error("Could not integrate due to no input being a variable")}function fu(e,t){if(D(t))return t.invert(l.root(e,10));throw new Error("Could not invert due to no input being a variable")}function vu(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.pow10(n).div(E.ln(10))}throw new Error("Could not integrate due to no input being a variable")}function gu(e,t,n){if(D(t))return t.invert(l.ln(e).div(bt(n)));if(D(n))return n.invert(l.root(bt(t),e));throw new Error("Could not invert due to no input being a variable")}function hu(e,t,n){if(D(t)){const i=t.getIntegralFormula(e);return E.pow(n,i).div(E.ln(n))}else if(D(n)){const i=n.getIntegralFormula(e),a=E.add(t,1);return E.pow(i,a).div(a)}throw new Error("Could not integrate due to no input being a variable")}function bu(e,t,n){if(D(t))return t.invert(l.root(e,l.recip(bt(n))));if(D(n))return n.invert(l.ln(bt(t)).div(l.ln(e)));throw new Error("Could not invert due to no input being a variable")}function yu(e,t,n){if(D(t)){const i=t.getIntegralFormula(e);return E.pow(i,E.recip(n).add(1)).times(n).div(E.add(n,1))}throw new Error("Could not integrate due to no input being a variable")}function wu(e,t){if(D(t))return t.invert(l.ln(e));throw new Error("Could not invert due to no input being a variable")}function _u(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.exp(n)}throw new Error("Could not integrate due to no input being a variable")}function Cu(e,t=2,n=l.fromComponents_noNormalize(1,0,1)){const i=l.minabs(t,1e308).toNumber();return l.tetrate(e,i,n)}function Su(e,t,n,i){if(D(t))return t.invert(l.ssqrt(e));throw new Error("Could not invert due to no input being a variable")}function ku(e,t=2,n=l.fromComponents_noNormalize(1,0,1)){const i=l.minabs(t,1e308).toNumber();return l.iteratedexp(e,i,new l(n))}function Nu(e,t,n,i){if(D(t))return t.invert(l.iteratedlog(e,Math.E,l.minabs(1e308,bt(n)).toNumber()));throw new Error("Could not invert due to no input being a variable")}function $u(e,t=10,n=2){const i=l.minabs(n,1e308).toNumber();return l.iteratedlog(e,t,i)}function xu(e,t=10){const n=l.minabs(t,1e308).toNumber();return l.slog(e,n)}function Mu(e,t,n){if(D(t))return t.invert(l.tetrate(e,l.minabs(1e308,bt(n)).toNumber()));throw new Error("Could not invert due to no input being a variable")}function Pu(e,t,n){const i=l.minabs(t,1e308).toNumber();return l.layeradd(e,i,n)}function Tu(e,t,n,i){if(D(t))return t.invert(l.layeradd(e,l.minabs(1e308,bt(n)).negate().toNumber()));throw new Error("Could not invert due to no input being a variable")}function Iu(e,t){if(D(t))return t.invert(l.pow(Math.E,e).times(e));throw new Error("Could not invert due to no input being a variable")}function Eu(e,t){if(D(t))return t.invert(l.tetrate(e,2));throw new Error("Could not invert due to no input being a variable")}function Fu(e,t,n){const i=l.minabs(t,1e308).toNumber();return l.pentate(e,i,n)}function qu(e,t){if(D(t))return t.invert(l.asin(e));throw new Error("Could not invert due to no input being a variable")}function Du(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.cos(n).neg()}throw new Error("Could not integrate due to no input being a variable")}function Lu(e,t){if(D(t))return t.invert(l.acos(e));throw new Error("Could not invert due to no input being a variable")}function Au(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.sin(n)}throw new Error("Could not integrate due to no input being a variable")}function Ou(e,t){if(D(t))return t.invert(l.atan(e));throw new Error("Could not invert due to no input being a variable")}function Ru(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.cos(n).ln().neg()}throw new Error("Could not integrate due to no input being a variable")}function ju(e,t){if(D(t))return t.invert(l.sin(e));throw new Error("Could not invert due to no input being a variable")}function Bu(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.asin(n).times(n).add(E.sqrt(E.sub(1,E.pow(n,2))))}throw new Error("Could not integrate due to no input being a variable")}function Vu(e,t){if(D(t))return t.invert(l.cos(e));throw new Error("Could not invert due to no input being a variable")}function zu(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.acos(n).times(n).sub(E.sqrt(E.sub(1,E.pow(n,2))))}throw new Error("Could not integrate due to no input being a variable")}function Gu(e,t){if(D(t))return t.invert(l.tan(e));throw new Error("Could not invert due to no input being a variable")}function Uu(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.atan(n).times(n).sub(E.ln(E.pow(n,2).add(1)).div(2))}throw new Error("Could not integrate due to no input being a variable")}function Xu(e,t){if(D(t))return t.invert(l.asinh(e));throw new Error("Could not invert due to no input being a variable")}function Hu(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.cosh(n)}throw new Error("Could not integrate due to no input being a variable")}function Ju(e,t){if(D(t))return t.invert(l.acosh(e));throw new Error("Could not invert due to no input being a variable")}function Wu(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.sinh(n)}throw new Error("Could not integrate due to no input being a variable")}function Qu(e,t){if(D(t))return t.invert(l.atanh(e));throw new Error("Could not invert due to no input being a variable")}function Zu(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.cosh(n).ln()}throw new Error("Could not integrate due to no input being a variable")}function Ku(e,t){if(D(t))return t.invert(l.sinh(e));throw new Error("Could not invert due to no input being a variable")}function Yu(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.asinh(n).times(n).sub(E.pow(n,2).add(1).sqrt())}throw new Error("Could not integrate due to no input being a variable")}function ec(e,t){if(D(t))return t.invert(l.cosh(e));throw new Error("Could not invert due to no input being a variable")}function tc(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.acosh(n).times(n).sub(E.add(n,1).sqrt().times(E.sub(n,1).sqrt()))}throw new Error("Could not integrate due to no input being a variable")}function nc(e,t){if(D(t))return t.invert(l.tanh(e));throw new Error("Could not invert due to no input being a variable")}function ic(e,t){if(D(t)){const n=t.getIntegralFormula(e);return E.atanh(n).times(n).add(E.sub(1,E.pow(n,2)).ln().div(2))}throw new Error("Could not integrate due to no input being a variable")}function hi(e){return(t,n)=>new E({inputs:[t,n],evaluate:e,invert:Ci})}function D(e){return e instanceof E&&e.hasVariable()}function bt(e,t){return e instanceof E?e.evaluate(t):o(e)}function lc(){return E.pow(this,2).div(2)}function ac(){return this}const S=class{constructor(e){this.negate=this.neg,this.negated=this.neg,this.sgn=this.sign,this.plus=this.add,this.subtract=this.sub,this.minus=this.sub,this.multiply=this.mul,this.times=this.mul,this.divide=this.div,this.divideBy=this.div,this.dividedBy=this.div,this.reciprocal=this.recip,this.reciprocate=this.recip,this.logarithm=this.log;let t;"variable"in e?t=this.setupVariable(e):"evaluate"in e?t=this.setupFormula(e):t=this.setupConstant(e),this.inputs=t.inputs,this.internalVariables=t.internalVariables,this.innermostVariable=t.innermostVariable,this.internalEvaluate=t.internalEvaluate,this.internalInvert=t.internalInvert,this.internalIntegrate=t.internalIntegrate,this.internalIntegrateInner=t.internalIntegrateInner,this.applySubstitution=t.applySubstitution}setupVariable({variable:e}){return{inputs:[e],internalVariables:1,innermostVariable:e,internalIntegrate:lc,internalIntegrateInner:ac,applySubstitution:Ci}}setupConstant({inputs:e}){if(e.length!==1)throw new Error("Evaluate function is required if inputs is not length 1");return{inputs:e,internalVariables:0}}setupFormula(e){const{inputs:t,evaluate:n,invert:i,integrate:a,integrateInner:r,applySubstitution:u}=e,d=t.reduce((f,h)=>f+(h instanceof S?h.internalVariables:0),0),c=t.find(f=>f instanceof S&&f.hasVariable()),p=d===1?c==null?void 0:c.innermostVariable:void 0;return{inputs:t,internalEvaluate:n,internalInvert:i,internalIntegrate:a,internalIntegrateInner:r,applySubstitution:u,innermostVariable:p,internalVariables:d}}calculateConstantOfIntegration(){const e=this.getIntegralFormula().evaluate(1),t=l.add(this.evaluate(0),this.evaluate(1)).div(2);return l.sub(t,e)}isInvertible(){return this.hasVariable()&&(this.internalInvert!=null||this.internalEvaluate==null)}isIntegrable(){return this.hasVariable()&&this.internalIntegrate!=null}isIntegralInvertible(){return this.isIntegrable()?this.getIntegralFormula().isInvertible():!1}hasVariable(){return this.internalVariables===1}evaluate(e){var t,n,i;return(i=(n=(t=this.internalEvaluate)==null?void 0:t.call(this,...this.inputs.map(a=>bt(a,e))))!=null?n:this.hasVariable()?e:null)!=null?i:bt(this.inputs[0])}invert(e){if(this.internalInvert&&this.hasVariable())return this.internalInvert.call(this,e,...this.inputs);if(this.inputs.length===1&&this.hasVariable())return e;throw new Error("Cannot invert non-invertible formula")}evaluateIntegral(e){if(!this.isIntegrable())throw new Error("Cannot evaluate integral of formula without integral");return this.getIntegralFormula().evaluate(e)}invertIntegral(e){if(!this.isIntegrable()||!this.getIntegralFormula().isInvertible())throw new Error("Cannot invert integral of formula without invertible integral");return this.getIntegralFormula().invert(e)}getIntegralFormula(e){if(this.integralFormula!=null&&e==null)return this.integralFormula;if(e==null){if(this.applySubstitution==null){if(e=[],this.internalIntegrate==null)throw new Error("Cannot integrate formula with non-integrable operation");let t=this.internalIntegrate.call(this,e,...this.inputs);e.forEach(n=>t=n(t)),this.integralFormula=t}else if(this.internalIntegrate)this.integralFormula=this.internalIntegrate.call(this,void 0,...this.inputs);else if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())this.integralFormula=this;else throw new Error("Cannot integrate formula without variable");return this.integralFormula}else{if(this.applySubstitution==null)throw new Error("Cannot have two complex operations in an integrable formula");if(e.push(t=>this.applySubstitution.call(this,t,...this.inputs)),this.internalIntegrateInner)return this.internalIntegrateInner.call(this,e,...this.inputs);if(this.internalIntegrate)return this.internalIntegrate.call(this,e,...this.inputs);if(this.inputs.length===1&&this.internalEvaluate==null&&this.hasVariable())return this;throw new Error("Cannot integrate formula without variable")}}equals(e){return this.inputs.length===e.inputs.length&&this.inputs.every((t,n)=>t instanceof S&&e.inputs[n]instanceof S?t.equals(e.inputs[n]):!(t instanceof S)&&!(e.inputs[n]instanceof S)&&l.eq(o(t),o(e.inputs[n])))&&this.internalEvaluate===e.internalEvaluate&&this.internalInvert===e.internalInvert&&this.internalIntegrate===e.internalIntegrate&&this.internalVariables===e.internalVariables}static constant(e){return new S({inputs:[e]})}static variable(e){return new S({variable:e})}static step(e,t,n){const i=X(0),a=n(S.variable(i)),r=et(t);function u(c){return l.lt(c,o(r))?c:(i.value=l.sub(c,o(r)),l.add(a.evaluate(),o(r)))}function d(c,p){if(D(p))return l.gt(c,o(r))&&(c=l.add(a.invert(l.sub(c,o(r))),o(r))),p.invert(c);throw new Error("Could not invert due to no input being a variable")}return new S({inputs:[e],evaluate:u,invert:a.isInvertible()&&a.hasVariable()?d:void 0})}static if(e,t,n){const i=X(0),a=n(S.variable(i)),r=et(t);function u(c){return o(r)?(i.value=c,a.evaluate()):c}function d(c,p){if(!D(p))throw new Error("Could not invert due to no input being a variable");return o(r)?p.invert(a.invert(c)):p.invert(c)}return new S({inputs:[e],evaluate:u,invert:a.isInvertible()&&a.hasVariable()?d:void 0})}static conditional(e,t,n){return S.if(e,t,n)}static abs(e){return new S({inputs:[e],evaluate:l.abs})}static neg(e){return new S({inputs:[e],evaluate:l.neg,invert:Fo,applySubstitution:Do,integrate:qo})}static sign(e){return new S({inputs:[e],evaluate:l.sign})}static round(e){return new S({inputs:[e],evaluate:l.round})}static floor(e){return new S({inputs:[e],evaluate:l.floor})}static ceil(e){return new S({inputs:[e],evaluate:l.ceil})}static trunc(e){return new S({inputs:[e],evaluate:l.trunc})}static add(e,t){return new S({inputs:[e,t],evaluate:l.add,invert:Lo,integrate:Ao,integrateInner:Oo,applySubstitution:Ci})}static sub(e,t){return new S({inputs:[e,t],evaluate:l.sub,invert:Ro,integrate:jo,integrateInner:Bo,applySubstitution:Ci})}static mul(e,t){return new S({inputs:[e,t],evaluate:l.mul,invert:Vo,integrate:zo,applySubstitution:Go})}static div(e,t){return new S({inputs:[e,t],evaluate:l.div,invert:Uo,integrate:Xo,applySubstitution:Ho})}static recip(e){return new S({inputs:[e],evaluate:l.recip,invert:Jo,integrate:Wo})}static clamp(e,t,n){return new S({inputs:[e,t,n],evaluate:l.clamp,invert:Ci})}static pLog10(e){return new S({inputs:[e],evaluate:l.pLog10})}static absLog10(e){return new S({inputs:[e],evaluate:l.absLog10})}static log10(e){return new S({inputs:[e],evaluate:l.log10,invert:Qo,integrate:Yo})}static log(e,t){return new S({inputs:[e,t],evaluate:l.log,invert:eu,integrate:iu})}static log2(e){return new S({inputs:[e],evaluate:l.log2,invert:lu,integrate:ru})}static ln(e){return new S({inputs:[e],evaluate:l.ln,invert:ou,integrate:du})}static pow(e,t){return new S({inputs:[e,t],evaluate:l.pow,invert:pu,integrate:mu})}static pow10(e){return new S({inputs:[e],evaluate:l.pow10,invert:fu,integrate:vu})}static pow_base(e,t){return new S({inputs:[e,t],evaluate:l.pow_base,invert:gu,integrate:hu})}static root(e,t){return new S({inputs:[e,t],evaluate:l.root,invert:bu,integrate:yu})}static factorial(e){return new S({inputs:[e],evaluate:l.factorial})}static gamma(e){return new S({inputs:[e],evaluate:l.gamma})}static lngamma(e){return new S({inputs:[e],evaluate:l.lngamma})}static exp(e){return new S({inputs:[e],evaluate:l.exp,invert:wu,integrate:_u})}static sqr(e){return S.pow(e,2)}static sqrt(e){return S.root(e,2)}static cube(e){return S.pow(e,3)}static cbrt(e){return S.root(e,3)}static tetrate(e,t=2,n=l.fromComponents_noNormalize(1,0,1)){return new S({inputs:[e,t,n],evaluate:Cu,invert:Su})}static iteratedexp(e,t=2,n=l.fromComponents_noNormalize(1,0,1)){return new S({inputs:[e,t,n],evaluate:ku,invert:Nu})}static iteratedlog(e,t=10,n=1){return new S({inputs:[e,t,n],evaluate:$u})}static slog(e,t=10){return new S({inputs:[e,t],evaluate:xu,invert:Mu})}static layeradd10(e,t){return new S({inputs:[e,t],evaluate:l.layeradd10})}static layeradd(e,t,n=10){return new S({inputs:[e,t,n],evaluate:Pu,invert:Tu})}static lambertw(e){return new S({inputs:[e],evaluate:l.lambertw,invert:Iu})}static ssqrt(e){return new S({inputs:[e],evaluate:l.ssqrt,invert:Eu})}static pentate(e,t=2,n=l.fromComponents_noNormalize(1,0,1)){return new S({inputs:[e,t,n],evaluate:Fu})}static sin(e){return new S({inputs:[e],evaluate:l.sin,invert:ju,integrate:Du})}static cos(e){return new S({inputs:[e],evaluate:l.cos,invert:Vu,integrate:Au})}static tan(e){return new S({inputs:[e],evaluate:l.tan,invert:Gu,integrate:Ru})}static asin(e){return new S({inputs:[e],evaluate:l.asin,invert:qu,integrate:Bu})}static acos(e){return new S({inputs:[e],evaluate:l.acos,invert:Lu,integrate:zu})}static atan(e){return new S({inputs:[e],evaluate:l.atan,invert:Ou,integrate:Uu})}static sinh(e){return new S({inputs:[e],evaluate:l.sinh,invert:Ku,integrate:Hu})}static cosh(e){return new S({inputs:[e],evaluate:l.cosh,invert:ec,integrate:Wu})}static tanh(e){return new S({inputs:[e],evaluate:l.tanh,invert:nc,integrate:Zu})}static asinh(e){return new S({inputs:[e],evaluate:l.asinh,invert:Xu,integrate:Yu})}static acosh(e){return new S({inputs:[e],evaluate:l.acosh,invert:Ju,integrate:tc})}static atanh(e){return new S({inputs:[e],evaluate:l.atanh,invert:Qu,integrate:ic})}step(e,t){return S.step(this,e,t)}if(e,t){return S.if(this,e,t)}conditional(e,t){return S.if(this,e,t)}abs(){return S.abs(this)}neg(){return S.neg(this)}sign(){return S.sign(this)}round(){return S.round(this)}floor(){return S.floor(this)}ceil(){return S.ceil(this)}trunc(){return S.trunc(this)}add(e){return S.add(this,e)}sub(e){return S.sub(this,e)}mul(e){return S.mul(this,e)}div(e){return S.div(this,e)}recip(){return S.recip(this)}max(e){return S.max(this,e)}min(e){return S.min(this,e)}maxabs(e){return S.maxabs(this,e)}minabs(e){return S.minabs(this,e)}clamp(e,t){return S.clamp(this,e,t)}clampMin(e){return S.clampMin(this,e)}clampMax(e){return S.clampMax(this,e)}pLog10(){return S.pLog10(this)}absLog10(){return S.absLog10(this)}log10(){return S.log10(this)}log(e){return S.log(this,e)}log2(){return S.log2(this)}ln(){return S.ln(this)}pow(e){return S.pow(this,e)}pow10(){return S.pow10(this)}pow_base(e){return S.pow_base(this,e)}root(e){return S.root(this,e)}factorial(){return S.factorial(this)}gamma(){return S.gamma(this)}lngamma(){return S.lngamma(this)}exp(){return S.exp(this)}sqr(){return S.pow(this,2)}sqrt(){return S.root(this,2)}cube(){return S.pow(this,3)}cbrt(){return S.root(this,3)}tetrate(e=2,t=l.fromComponents_noNormalize(1,0,1)){return S.tetrate(this,e,t)}iteratedexp(e=2,t=l.fromComponents_noNormalize(1,0,1)){return S.iteratedexp(this,e,t)}iteratedlog(e=10,t=1){return S.iteratedlog(this,e,t)}slog(e=10){return S.slog(this,e)}layeradd10(e){return S.layeradd10(this,e)}layeradd(e,t){return S.layeradd(this,e,t)}lambertw(){return S.lambertw(this)}ssqrt(){return S.ssqrt(this)}pentate(e=2,t=l.fromComponents_noNormalize(1,0,1)){return S.pentate(this,e,t)}sin(){return S.sin(this)}cos(){return S.cos(this)}tan(){return S.tan(this)}asin(){return S.asin(this)}acos(){return S.acos(this)}atan(){return S.atan(this)}sinh(){return S.sinh(this)}cosh(){return S.cosh(this)}tanh(){return S.tanh(this)}asinh(){return S.asinh(this)}acosh(){return S.acosh(this)}atanh(){return S.atanh(this)}};let E=S;E.negate=S.neg;E.negated=S.neg;E.sgn=S.sign;E.plus=S.add;E.subtract=S.sub;E.minus=S.sub;E.multiply=S.mul;E.times=S.mul;E.divide=S.div;E.divideBy=S.div;E.dividedBy=S.div;E.reciprocal=S.recip;E.reciprocate=S.recip;E.max=hi(l.max);E.min=hi(l.min);E.minabs=hi(l.minabs);E.maxabs=hi(l.maxabs);E.clampMin=hi(l.clampMin);E.clampMax=hi(l.clampMax);E.logarithm=S.log;function sc(e,t,n=!0,i){const a=et(n);return w(()=>{var u,d;let r;if(o(a)){if(!e.isIntegrable()||!e.isIntegralInvertible())throw new Error("Cannot calculate max affordable of formula with non-invertible integral");r=l.floor(e.invertIntegral(l.add(t.value,e.evaluateIntegral()))).sub((u=o(e.innermostVariable))!=null?u:0),i==null&&(i=10)}else{if(!e.isInvertible())throw new Error("Cannot calculate max affordable of non-invertible formula");r=l.floor(e.invert(t.value)),i==null&&(i=0)}if(i>0){r=r.sub(i).clampMin(0);let c=Bi(e,r,!0,0);for(;;){const p=e.evaluate(r.add((d=o(e.innermostVariable))!=null?d:0));if(l.add(c,p).lt(t.value))r=r.add(1),c=l.add(c,p);else break}}return r})}function Bi(e,t,n=!0,i){var r,u,d;let a=l.add(t,(r=o(e.innermostVariable))!=null?r:0);if(n){const c=a;a=a.sub(i!=null?i:10).clampMin((u=o(e.innermostVariable))!=null?u:0);let p=l.sub(e.evaluateIntegral(a),e.evaluateIntegral());if(c.gt(1e308))return p.add(l.sub(c,a).times(e.evaluate(a)));for(let f=a.toNumber();f<c.toNumber();f++)p=p.add(e.evaluate(f));return p}else{const c=a;a=a.sub(i!=null?i:0).clampMin((d=o(e.innermostVariable))!=null?d:0);let p=e.evaluate(a);if(c.gt(1e308))return l.sub(c,a).add(1).times(p);for(let f=a.toNumber();f<c.toNumber();f++)p=l.add(p,e.evaluate(f));return p}}function Ma(e){return pt(()=>{const t=e();return t.partialDisplay=n=>s("span",{style:o(t.requirementMet)?"":"color: var(--danger)"},[Sn(t.resource,t.cost instanceof E?Bi(t.cost,n!=null?n:1,o(t.spendResources)):o(t.cost))," ",t.resource.displayName]),t.display=n=>s("div",null,[o(t.requiresPay)?"Costs: ":"Requires: ",Sn(t.resource,t.cost instanceof E?Bi(t.cost,n!=null?n:1,o(t.spendResources)):o(t.cost))," ",t.resource.displayName]),q(t,"visibility"),nt(t,"visibility",Re.Visible),q(t,"cost"),q(t,"requiresPay"),nt(t,"requiresPay",!0),q(t,"spendResources"),nt(t,"spendResources",!0),nt(t,"pay",function(n){const i=t.cost instanceof E?Bi(t.cost,n!=null?n:1,o(t.spendResources)):o(t.cost);t.resource.value=l.sub(t.resource.value,i).max(0)}),t.canMaximize=t.cost instanceof E&&t.cost.isInvertible(),t.canMaximize?t.requirementMet=sc(t.cost,t.resource,o(t.spendResources)):t.requirementMet=w(()=>t.cost instanceof E?l.gte(t.resource.value,t.cost.evaluate()):l.gte(t.resource.value,o(t.cost))),t})}function Tl(e){return pt(()=>({requirementMet:w(()=>ht(e.visibility)),visibility:Re.None,requiresPay:!1}))}function be(e,t){return pt(()=>({requirementMet:et(e),partialDisplay:t==null?void 0:k(()=>ut(t)),display:t==null?void 0:k(()=>s(F,null,[m("Req: "),ut(t)])),visibility:t==null?Re.None:Re.Visible,requiresPay:!1}))}function tl(e){if(yn(e))return e.every(tl);const t=o(e.requirementMet);return typeof t=="boolean"?t:l.gt(t,0)}function Pa(e){if(yn(e))return e.map(Pa).reduce(l.min);const t=o(e.requirementMet);return typeof t=="boolean"?t?l.dInf:0:l.gt(t,1)&&o(e.canMaximize)!==!0?1:t}function nl(e,t=1){var n,i;if(yn(e)&&(e=e.filter(a=>ht(a.visibility)),e.length===1&&(e=e[0])),yn(e)){e=e.filter(u=>"partialDisplay"in u);const a=e.filter(u=>o(u.requiresPay)),r=e.filter(u=>!o(u.requiresPay));return s(F,null,[a.length>0?s("div",null,[m("Costs:")," ",hl(a.map(u=>u.partialDisplay(t)),s(F,null,[m(", ")]))]):null,r.length>0?s("div",null,[m("Requires:")," ",hl(r.map(u=>u.partialDisplay(t)),s(F,null,[m(", ")]))]):null])}return(i=(n=e.display)==null?void 0:n.call(e))!=null?i:s(F,null,null)}function Ta(e,t=1){var n;yn(e)?e.filter(i=>o(i.requiresPay)).forEach(i=>{var a;return(a=i.pay)==null?void 0:a.call(i,t)}):o(e.requiresPay)&&((n=e.pay)==null||n.call(e,t))}var rc=K({props:{display:{type:R(String,Object,Function),required:!0},visibility:{type:R(Number,Boolean),required:!0},style:R(String,Object,Array),classes:R(Object),requirements:{type:Object,required:!0},canPurchase:{type:R(Boolean),required:!0},bought:{type:R(Boolean),required:!0},mark:R(Boolean,String),id:{type:String,required:!0},purchase:{type:Function,required:!0}},components:{Node:Bn,MarkNode:Ii},setup(e){const{display:t,requirements:n,bought:i}=ct(e),a=St("");return Vt(()=>{const r=ot(t);if(r==null){a.value="";return}if(mn(r)){a.value=he(r);return}const u=he(r.title||"","h3"),d=he(r.description,"div"),c=he(r.effectDisplay||"");a.value=he(k(()=>s("span",null,[r.title!=null?s("div",null,[s(u,null,null)]):null,s(d,null,null),r.effectDisplay!=null?s("div",null,[m("Currently: "),s(c,null,null)]):null,i.value?null:s(F,null,[s("br",null,null),nl(n.value)])])))}),{component:a,unref:o,Visibility:Re,isVisible:ht,isHidden:Mn}}});const oc=["disabled"];function uc(e,t,n,i,a,r){var c;const u=Ft("MarkNode"),d=Ft("Node");return e.isVisible(e.visibility)?(g(),$("button",{key:0,style:Oe([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(c=e.unref(e.style))!=null?c:{}]),onClick:t[0]||(t[0]=(...p)=>e.purchase&&e.purchase(...p)),class:Me({feature:!0,upgrade:!0,can:e.unref(e.canPurchase),locked:!e.unref(e.canPurchase),bought:e.unref(e.bought),...e.unref(e.classes)}),disabled:!e.unref(e.canPurchase)},[e.unref(e.component)?(g(),U(Pe(e.unref(e.component)),{key:0})):j("",!0),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(d,{id:e.id},null,8,["id"])],14,oc)):j("",!0)}var cc=me(rc,[["render",uc],["__scopeId","data-v-9be6bac0"]]);const dc=Symbol("Upgrade");function pc(e){const t=H(!1,!1);return pt(()=>{const n=e();n.id=pn("upgrade-"),n.type=dc,n[it]=cc,n.bought=t,n.canPurchase=w(()=>tl(n.requirements)),n.purchase=function(){var r;const a=n;!o(a.canPurchase)||(Ta(n.requirements),t.value=!0,(r=a.onPurchase)==null||r.call(a))};const i=Tl(n);return yn(n.requirements)?n.requirements.unshift(i):n.requirements=[i,n.requirements],q(n,"visibility"),nt(n,"visibility",Re.Visible),q(n,"classes"),q(n,"style"),q(n,"display"),q(n,"mark"),n[Ge]=function(){const{display:a,visibility:r,style:u,classes:d,requirements:c,canPurchase:p,bought:f,mark:h,id:y,purchase:_}=this;return{display:a,visibility:r,style:o(u),classes:d,requirements:c,canPurchase:p,bought:f,mark:h,id:y,purchase:_}},n})}const mc=K({__name:"Collapsible",props:{collapsed:null,display:null,content:null},setup(e){const t=e,n=ei(tn(t,"display")),i=ei(tn(t,"content"));return(a,r)=>(g(),U(Zi,{class:"collapsible-container"},{default:se(()=>[v("button",{onClick:r[0]||(r[0]=u=>e.collapsed.value=!e.collapsed.value),class:"feature collapsible-toggle"},[(g(),U(Pe(o(n))))]),e.collapsed.value?j("",!0):(g(),U(Pe(o(i)),{key:0}))]),_:1}))}});var ai=me(mc,[["__scopeId","data-v-a72c16aa"]]),fc=K({props:{display:{type:R(Object,String,Function),required:!0},visibility:{type:R(Number,Boolean),required:!0},style:R(Object,String,Array),classes:R(Object),onClick:Function,onHold:Function,canClick:{type:R(Boolean),required:!0},small:Boolean,mark:R(Boolean,String),id:{type:String,required:!0}},components:{Node:Bn,MarkNode:Ii},setup(e){const{display:t,onClick:n,onHold:i}=ct(e),a=St("");Vt(()=>{var f;const d=ot(t);if(d==null){a.value="";return}if(mn(d)){a.value=he(d);return}const c=he((f=d.title)!=null?f:"","h3"),p=he(d.description,"div");a.value=he(k(()=>s("span",null,[d.title!=null?s("div",null,[s(c,null,null)]):null,s(p,null,null)])))});const{start:r,stop:u}=wa(n,i);return{start:r,stop:u,comp:a,Visibility:Re,isVisible:ht,isHidden:Mn,unref:o}}});function vc(e,t,n,i,a,r){var c;const u=Ft("MarkNode"),d=Ft("Node");return e.isVisible(e.visibility)?(g(),$("button",{key:0,style:Oe([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(c=e.unref(e.style))!=null?c:[]]),onClick:t[0]||(t[0]=(...p)=>e.onClick&&e.onClick(...p)),onMousedown:t[1]||(t[1]=(...p)=>e.start&&e.start(...p)),onMouseleave:t[2]||(t[2]=(...p)=>e.stop&&e.stop(...p)),onMouseup:t[3]||(t[3]=(...p)=>e.stop&&e.stop(...p)),onTouchstartPassive:t[4]||(t[4]=(...p)=>e.start&&e.start(...p)),onTouchendPassive:t[5]||(t[5]=(...p)=>e.stop&&e.stop(...p)),onTouchcancelPassive:t[6]||(t[6]=(...p)=>e.stop&&e.stop(...p)),class:Me({feature:!0,clickable:!0,can:e.unref(e.canClick),locked:!e.unref(e.canClick),small:e.small,...e.unref(e.classes)})},[e.unref(e.comp)?(g(),U(Pe(e.unref(e.comp)),{key:0})):j("",!0),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(d,{id:e.id},null,8,["id"])],38)):j("",!0)}var Si=me(fc,[["render",vc],["__scopeId","data-v-03ca8bd6"]]);const gc=Symbol("Clickable");function Ln(e){return pt(()=>{var n;const t=(n=e==null?void 0:e())!=null?n:{};if(t.id=pn("clickable-"),t.type=gc,t[it]=Si,q(t,"visibility"),nt(t,"visibility",Re.Visible),q(t,"canClick"),nt(t,"canClick",!0),q(t,"classes"),q(t,"style"),q(t,"mark"),q(t,"display"),t.onClick){const i=t.onClick.bind(t);t.onClick=function(a){o(t.canClick)!==!1&&i(a)}}if(t.onHold){const i=t.onHold.bind(t);t.onHold=function(){o(t.canClick)!==!1&&i()}}return t[Ge]=function(){const{display:i,visibility:a,style:r,classes:u,onClick:d,onHold:c,canClick:p,small:f,mark:h,id:y}=this;return{display:i,visibility:a,style:o(r),classes:u,onClick:d,onHold:c,canClick:p,small:f,mark:h,id:y}},t})}const hc=["x1","y1","x2","y2"],bc=K({__name:"Link",props:{link:null,startNode:null,endNode:null,boundingRect:null},setup(e){const n=ct(e),i=w(()=>{const r=n.startNode.value.rect,u=n.boundingRect.value,d=u?{x:r.x+r.width/2-u.x,y:r.y+r.height/2-u.y}:{x:0,y:0};return n.link.value.offsetStart&&(d.x+=n.link.value.offsetStart.x,d.y+=n.link.value.offsetStart.y),d}),a=w(()=>{const r=n.endNode.value.rect,u=n.boundingRect.value,d=u?{x:r.x+r.width/2-u.x,y:r.y+r.height/2-u.y}:{x:0,y:0};return n.link.value.offsetEnd&&(d.x+=n.link.value.offsetEnd.x,d.y+=n.link.value.offsetEnd.y),d});return(r,u)=>(g(),$("line",Jt({"stroke-width":"15px",stroke:"white"},e.link,{x1:o(i).x,y1:o(i).y,x2:o(a).x,y2:o(a).y}),null,16,hc))}});const yc=K({__name:"Links",props:{links:null},setup(e){var c;const n=tn(e,"links"),i=X(null),a=zi(xl,X({})),r=zi(Ml,X(void 0)),u=X((c=i.value)==null?void 0:c.getBoundingClientRect());tt(r,()=>{var p;return u.value=(p=i.value)==null?void 0:p.getBoundingClientRect()}),fi(()=>{var p;return u.value=(p=i.value)==null?void 0:p.getBoundingClientRect()});const d=w(()=>{var f,h;const p=a.value;return(h=(f=n.value)==null?void 0:f.filter(y=>{var _,C;return((_=p[y.startNode.id])==null?void 0:_.rect)&&((C=p[y.startNode.id])==null?void 0:C.rect)}))!=null?h:[]});return(p,f)=>(g(),$(F,null,[o(d)?(g(),$("svg",oa(Jt({key:0},p.$attrs)),[(g(!0),$(F,null,xn(o(d),(h,y)=>(g(),U(bc,{key:y,link:h,boundingRect:u.value,startNode:o(a)[h.startNode.id],endNode:o(a)[h.endNode.id]},null,8,["link","boundingRect","startNode","endNode"]))),128))],16)):j("",!0),v("div",{ref_key:"resizeListener",ref:i,class:"resize-listener"},null,512)],64))}});var wc=me(yc,[["__scopeId","data-v-063f6d6b"]]),_c=K({props:{nodes:{type:R(Array),required:!0},leftSideNodes:R(Array),rightSideNodes:R(Array),branches:R(Array)},components:{Links:wc},setup(e){const{nodes:t,leftSideNodes:n,rightSideNodes:i}=ct(e),a=St();Vt(()=>{const d=ot(t);a.value=he(k(()=>s(F,null,[d.map(c=>s("span",{class:"row tree-row",style:"margin: 50px auto;"},[c.map(ut)]))])))});const r=St();Vt(()=>{const d=ot(n);r.value=d?he(k(()=>s("span",{class:"left-side-nodes small"},[d.map(ut)]))):""});const u=St();return Vt(()=>{const d=ot(i);u.value=d?he(k(()=>s("span",{class:"side-nodes small"},[d.map(ut)]))):""}),{unref:o,nodesComp:a,leftNodesComp:r,rightNodesComp:u}}});function Cc(e,t,n,i,a,r){const u=Ft("Links");return g(),$(F,null,[(g(),U(Pe(e.nodesComp))),e.leftNodesComp?(g(),U(Pe(e.leftNodesComp),{key:0})):j("",!0),e.rightNodesComp?(g(),U(Pe(e.rightNodesComp),{key:1})):j("",!0),e.branches?(g(),U(u,{key:2,links:e.unref(e.branches)},null,8,["links"])):j("",!0)],64)}var Sc=me(_c,[["render",Cc],["__scopeId","data-v-39ca96d0"]]);const kc=K({props:{display:R(Object,String,Function),visibility:{type:R(Number,Boolean),required:!0},style:R(String,Object,Array),classes:R(Object),onClick:Function,onHold:Function,color:R(String),glowColor:R(String),canClick:{type:R(Boolean),required:!0},mark:R(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:Ii,Node:Bn},setup(e){const{onClick:t,onHold:n,display:i}=ct(e),a=Pn(i),{start:r,stop:u}=wa(t,n);return{start:r,stop:u,comp:a,unref:o,Visibility:Re,isCoercableComponent:mn,isVisible:ht,isHidden:Mn}}});function Nc(e,t,n,i,a,r){var c;const u=Ft("MarkNode"),d=Ft("Node");return e.isVisible(e.visibility)?(g(),$("div",{key:0,style:Oe({visibility:e.isHidden(e.visibility)?"hidden":void 0}),class:Me({treeNode:!0,can:e.unref(e.canClick),...e.unref(e.classes)}),onClick:t[0]||(t[0]=(...p)=>e.onClick&&e.onClick(...p)),onMousedown:t[1]||(t[1]=(...p)=>e.start&&e.start(...p)),onMouseleave:t[2]||(t[2]=(...p)=>e.stop&&e.stop(...p)),onMouseup:t[3]||(t[3]=(...p)=>e.stop&&e.stop(...p)),onTouchstartPassive:t[4]||(t[4]=(...p)=>e.start&&e.start(...p)),onTouchendPassive:t[5]||(t[5]=(...p)=>e.stop&&e.stop(...p)),onTouchcancelPassive:t[6]||(t[6]=(...p)=>e.stop&&e.stop(...p))},[v("div",{style:Oe([{backgroundColor:e.unref(e.color),boxShadow:`-4px -4px 4px rgba(0, 0, 0, 0.25) inset, 0 0 20px ${e.unref(e.glowColor)}`},(c=e.unref(e.style))!=null?c:[]])},[(g(),U(Pe(e.unref(e.comp))))],4),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(d,{id:e.id},null,8,["id"])],38)):j("",!0)}var $c=me(kc,[["render",Nc],["__scopeId","data-v-4520cd79"]]);const xc=Symbol("TreeNode"),Mc=Symbol("Tree");function Hl(e){return pt(()=>{var n;const t=(n=e==null?void 0:e())!=null?n:{};if(t.id=pn("treeNode-"),t.type=xc,t[it]=$c,q(t,"visibility"),nt(t,"visibility",Re.Visible),q(t,"canClick"),nt(t,"canClick",!0),q(t,"color"),q(t,"display"),q(t,"glowColor"),q(t,"classes"),q(t,"style"),q(t,"mark"),t.onClick){const i=t.onClick.bind(t);t.onClick=function(a){o(t.canClick)!==!1&&i(a)}}if(t.onHold){const i=t.onHold.bind(t);t.onHold=function(){o(t.canClick)!==!1&&i()}}return t[Ge]=function(){const{display:i,visibility:a,style:r,classes:u,onClick:d,onHold:c,color:p,glowColor:f,canClick:h,mark:y,id:_}=this;return{display:i,visibility:a,style:r,classes:u,onClick:d,onHold:c,color:p,glowColor:f,canClick:h,mark:y,id:_}},t})}function Pc(e){return pt(()=>{const t=e();return t.id=pn("tree-"),t.type=Mc,t[it]=Sc,t.isResetting=X(!1),t.resettingNode=St(null),t.reset=function(n){var a,r;const i=t;i.isResetting.value=!0,i.resettingNode.value=n,(a=i.resetPropagation)==null||a.call(i,i,n),(r=i.onReset)==null||r.call(i,n),i.isResetting.value=!1,i.resettingNode.value=null},t.links=w(()=>{var i;return(i=o(t.branches))!=null?i:[]}),q(t,"visibility"),nt(t,"visibility",Re.Visible),q(t,"nodes"),q(t,"leftSideNodes"),q(t,"rightSideNodes"),q(t,"branches"),t[Ge]=function(){const{nodes:n,leftSideNodes:i,rightSideNodes:a,branches:r}=this;return{nodes:n,leftSideNodes:i,rightSideNodes:a,branches:r}},t})}function Ht(e,t=!1){const n=[],i={};let a=!1;function r(){return a||(n.push(...e()),i.base=n.map(c=>et(c.base)),i.baseText=n.map(c=>et(c.baseText)),i.visible=n.map(c=>et(c.visible)),i.title=n.map(c=>et(c.title)),i.subtitle=n.map(c=>et(c.subtitle)),a=!0),n}const u=H({},!1);return[k(()=>{const c=r();let p=!0;const f=c.map((h,y)=>{var P,M,Z;if(o(i.visible[y])===!1)return null;const _=s("h3",{onClick:()=>u.value[y]=!u.value[y],style:"cursor: pointer"},[s("span",{class:"modifier-toggle"+(o(u.value[y])?" collapsed":"")},[m("\u25BC")]),o(i.title[y]),o(i.subtitle[y])!=null?s("span",{class:"subtitle"},[m(" ("),o(i.subtitle[y]),m(")")]):null]),C=o(u.value[y])?null:s(F,null,[s("div",{class:"modifier-container"},[s("span",{class:"modifier-description"},[ut((P=o(i.baseText[y]))!=null?P:"Base")]),s("span",{class:"modifier-amount"},[ze((M=o(i.base[y]))!=null?M:1),h.unit])]),ut(o(h.modifier.description))]),T=!p;p=!1;const W=(Z=o(i.base[y]))!=null?Z:1,le=h.modifier.apply(W);return s(F,null,[T?s("br",null,null):null,s("div",{style:{"--unit":Ae.alignUnits&&h.unit!=null?"'"+h.unit+"'":""}},[_,s("br",null,null),C,s("hr",null,null),s("div",{class:"modifier-container"},[s("span",{class:"modifier-description"},[m("Total")]),s("span",{class:"modifier-amount",style:(t===!0?l.gt(le,W!=null?W:1):l.lt(le,W!=null?W:1))?"color: var(--danger)":""},[Ti(le),h.unit])])])])});return s(F,null,[f])}),u]}function It(e,t="var(--accent2)"){return s("span",{style:{color:t}},[e])}const Tc=K({props:{progress:{type:R(String,Object,Number),required:!0},width:{type:R(Number),required:!0},height:{type:R(Number),required:!0},direction:{type:R(String),required:!0},display:R(Object,String,Function),visibility:{type:R(Number,Boolean),required:!0},style:R(Object,String,Array),classes:R(Object),borderStyle:R(Object,String,Array),textStyle:R(Object,String,Array),baseStyle:R(Object,String,Array),fillStyle:R(Object,String,Array),mark:R(Boolean,String),id:{type:String,required:!0}},components:{MarkNode:Ii,Node:Bn},setup(e){const{progress:t,width:n,height:i,direction:a,display:r}=ct(e),u=w(()=>{let p=t.value instanceof l?t.value.toNumber():Number(t.value);return(1-Math.min(Math.max(p,0),1))*100}),d=w(()=>{const p={width:ot(n)+.5+"px",height:ot(i)+.5+"px"};switch(o(a)){case xe.Up:p.clipPath=`inset(${u.value}% 0% 0% 0%)`,p.width=ot(n)+1+"px";break;case xe.Down:p.clipPath=`inset(0% 0% ${u.value}% 0%)`,p.width=ot(n)+1+"px";break;case xe.Right:p.clipPath=`inset(0% ${u.value}% 0% 0%)`;break;case xe.Left:p.clipPath=`inset(0% 0% 0% ${u.value} + '%)`;break;case xe.Default:p.clipPath="inset(0% 50% 0% 0%)";break}return p}),c=Pn(r);return{normalizedProgress:u,barStyle:d,component:c,unref:o,Visibility:Re,isVisible:ht,isHidden:Mn}}});function Ic(e,t,n,i,a,r){var c,p,f,h,y,_,C;const u=Ft("MarkNode"),d=Ft("Node");return e.isVisible(e.visibility)?(g(),$("div",{key:0,style:Oe([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px",visibility:e.isHidden(e.visibility)?"hidden":void 0},(c=e.unref(e.style))!=null?c:{}]),class:Me({bar:!0,...e.unref(e.classes)})},[v("div",{class:"overlayTextContainer border",style:Oe([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(p=e.unref(e.borderStyle))!=null?p:{}])},[e.component?(g(),$("span",{key:0,class:"overlayText",style:Oe(e.unref(e.textStyle))},[(g(),U(Pe(e.component)))],4)):j("",!0)],4),v("div",{class:"border",style:Oe([{width:e.unref(e.width)+"px",height:e.unref(e.height)+"px"},(f=e.unref(e.style))!=null?f:{},(h=e.unref(e.baseStyle))!=null?h:{},(y=e.unref(e.borderStyle))!=null?y:{}])},[v("div",{class:"fill",style:Oe([e.barStyle,(_=e.unref(e.style))!=null?_:{},(C=e.unref(e.fillStyle))!=null?C:{}])},null,4)],4),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(d,{id:e.id},null,8,["id"])],6)):j("",!0)}var Ec=me(Tc,[["render",Ic],["__scopeId","data-v-515dc183"]]);const Fc=Symbol("Bar");function Vi(e){return pt(()=>{const t=e();return t.id=pn("bar-"),t.type=Fc,t[it]=Ec,q(t,"visibility"),nt(t,"visibility",Re.Visible),q(t,"width"),q(t,"height"),q(t,"direction"),q(t,"style"),q(t,"classes"),q(t,"borderStyle"),q(t,"baseStyle"),q(t,"textStyle"),q(t,"fillStyle"),q(t,"progress"),q(t,"display"),q(t,"mark"),t[Ge]=function(){const{progress:n,width:i,height:a,direction:r,display:u,visibility:d,style:c,classes:p,borderStyle:f,textStyle:h,baseStyle:y,fillStyle:_,mark:C,id:T}=this;return{progress:n,width:i,height:a,direction:r,display:u,visibility:d,style:o(c),classes:p,borderStyle:f,textStyle:h,baseStyle:y,fillStyle:_,mark:C,id:T}},t})}var qc=K({props:{visibility:{type:R(Number,Boolean),required:!0},display:R(Object,String,Function),earned:{type:R(Boolean),required:!0},requirements:R(Object,Array),image:R(String),style:R(String,Object,Array),classes:R(Object),mark:R(Boolean,String),small:R(Boolean),id:{type:String,required:!0}},components:{Node:Bn,MarkNode:Ii},setup(e){const{display:t,requirements:n,earned:i}=ct(e),a=St("");return Vt(()=>{const r=ot(t);if(r==null){a.value="";return}if(mn(r)){a.value=he(r);return}const u=he(r.requirement?r.requirement:k(()=>{var p;return nl((p=ot(n))!=null?p:[])}),"h3"),d=he(r.effectDisplay||"","b"),c=ot(i)?he(r.optionsDisplay||"","span"):"";a.value=he(k(()=>s("span",null,[s(u,null,null),r.effectDisplay!=null?s("div",null,[s(d,null,null)]):null,r.optionsDisplay!=null?s("div",{class:"equal-spaced"},[s(c,null,null)]):null])))}),{comp:a,unref:o,Visibility:Re,isVisible:ht,isHidden:Mn}}});function Dc(e,t,n,i,a,r){var c;const u=Ft("MarkNode"),d=Ft("Node");return e.isVisible(e.visibility)?(g(),$("div",{key:0,style:Oe([{visibility:e.isHidden(e.visibility)?"hidden":void 0,backgroundImage:e.earned&&e.image&&`url(${e.image})`||""},(c=e.unref(e.style))!=null?c:[]]),class:Me({feature:!0,achievement:!0,locked:!e.unref(e.earned),done:e.unref(e.earned),small:e.unref(e.small),...e.unref(e.classes)})},[e.comp?(g(),U(Pe(e.comp),{key:0})):j("",!0),s(u,{mark:e.unref(e.mark)},null,8,["mark"]),s(d,{id:e.id},null,8,["id"])],6)):j("",!0)}var Lc=me(qc,[["render",Dc],["__scopeId","data-v-5673325a"]]);Ot.on("setupVue",e=>e.use(ts));function Ac(e="white",t="8px"){return{transform:"scale(1.05, 1.05)",borderColor:"rgba(0, 0, 0, 0.125)",boxShadow:`-4px -4px 4px rgba(0, 0, 0, 0.25) inset, 0 0 ${t} ${e}`,zIndex:1}}function Mi(e,t){const n=et(t),i=X(!1);return en(()=>{i.value=n.value,tt(_a(e),a=>{a||(i.value=!1)}),tt(n,a=>{i.value=a})}),i}const Oc=vi(),Rc=Symbol("Achievement");let An;(function(e){e.All="all",e.Configurable="configurable",e.Incomplete="incomplete",e.None="none"})(An||(An={}));function we(e){const t=H(!1,!1);return pt(()=>{var a;const n=(a=e==null?void 0:e())!=null?a:{};n.id=pn("achievement-"),n.type=Rc,n[it]=Lc,n.earned=t,n.complete=function(){var u,d;t.value=!0;const r=n;if((u=r.onComplete)==null||u.call(r),r.display!=null&&o(r.showPopups)===!0){const c=o(r.display);let p;mn(c)?p=he(c):c.requirement!=null?p=he(c.requirement):p=nl((d=r.requirements)!=null?d:[]),Oc.info(s("div",null,[s("h3",null,[m("Achievement earned!")]),s("div",null,[s(p,null,null)])]))}},q(n,"visibility"),nt(n,"visibility",Re.Visible);const i=n.visibility;if(n.visibility=Ga(()=>{const r=o(n.display);switch(Ae.msDisplay){default:case An.All:return o(i);case An.Configurable:return o(n.earned)&&!(r!=null&&typeof r=="object"&&"optionsDisplay"in r)?Re.None:o(i);case An.Incomplete:return o(n.earned)?Re.None:o(i);case An.None:return Re.None}}),q(n,"display"),q(n,"mark"),q(n,"small"),q(n,"image"),q(n,"style"),q(n,"classes"),q(n,"showPopups"),nt(n,"showPopups",!0),n[Ge]=function(){const{visibility:r,display:u,requirements:d,earned:c,image:p,style:f,classes:h,mark:y,small:_,id:C}=this;return{visibility:r,display:u,requirements:d,earned:c,image:p,style:o(f),classes:h,mark:y,small:_,id:C}},n.requirements){const r=n,u=[Tl(r),be(()=>!r.earned.value),...yn(n.requirements)?n.requirements:[n.requirements]];Vt(()=>{Ae.active===G.id&&tl(u)&&r.complete()})}return n})}Ot.on("loadSettings",e=>{nt(e,"msDisplay",An.All)});const jc=Object.values(An).map(e=>({label:on(e),value:e}));sr(k(()=>s(Pl,{title:k(()=>s("span",{class:"option-title"},[m("Show achievements"),s("desc",null,[m("Select which achievements to display based on criterias.")])])),options:jc,"onUpdate:modelValue":e=>Ae.msDisplay=e,modelValue:Ae.msDisplay},null)));const Bc=K({__name:"Sticky",setup(e){const t=X("0"),n=new ResizeObserver(a),i=St(null);function a(){let r=i.value;if(r==null)return;let u=0;for(;r.previousSibling;){const d=r.previousSibling;d.dataset&&"vSticky"in d.dataset&&(u+=d.offsetHeight),r=d}t.value=u+"px"}return en(a),document.fonts.ready.then(a),fi(()=>{var u;const r=(u=i.value)==null?void 0:u.parentElement;r&&n.observe(r)}),(r,u)=>(g(),$("div",{class:"sticky",style:Oe({top:t.value}),ref_key:"element",ref:i,"data-v-sticky":""},[Wt(r.$slots,"default",{},void 0,!0)],4))}});var Il=me(Bc,[["__scopeId","data-v-cccac690"]]);const bl=K({__name:"Resource",props:{resource:null,color:null},setup(e){const t=e,n=w(()=>Sn(t.resource));return(i,a)=>(g(),$("h2",{style:Oe({color:e.color,"text-shadow":"0px 0px 10px "+e.color})},ee(o(n)),5))}});const Vc={class:"main-display"},zc={key:0},Gc={key:1},Uc=m(", "),Ei=K({__name:"MainDisplay",props:{resource:null,color:null,classes:null,style:null,effectDisplay:null},setup(e){const n=ct(e),i=X(null),a=Pn(n.effectDisplay),r=w(()=>l.lt(n.resource.value,"1e1000"));return(u,d)=>(g(),U(Il,null,{default:se(()=>{var c,p,f,h;return[v("div",{class:Me(["main-display-container",(c=e.classes)!=null?c:{}]),style:Oe([{height:`${((f=(p=i.value)==null?void 0:p.$el.clientHeight)!=null?f:0)+50}px`},(h=e.style)!=null?h:{}])},[v("div",Vc,[o(r)?(g(),$("span",zc,"You have ")):j("",!0),s(bl,{resource:e.resource,color:e.color||"white"},null,8,["resource","color"]),m(" "+ee(e.resource.displayName),1),o(a)?(g(),$("span",Gc,[Uc,(g(),U(Pe(o(a)),{ref_key:"effectRef",ref:i},null,512))])):j("",!0)])],6)]}),_:1}))}}),Ia=e=>(nn("data-v-71dcf259"),e=e(),ln(),e),Xc={class:"spell-tree-container"},Hc=Ia(()=>v("div",{class:"spell-tree"},null,-1)),Jc={style:{display:"none"}},Wc=Ia(()=>v("filter",{id:"skilltreeturbulence"},[v("feTurbulence",{x:"-50vw",y:"-50vh",width:"200vw",height:"200vh",baseFrequency:"0.015",numOctaves:"10",seed:"2"}),v("feDisplacementMap",{in:"SourceGraphic",scale:"10"},[v("animate",{attributeName:"scale",values:"10;50;10",dur:"10s",repeatCount:"indefinite"})])],-1)),Qc=[Wc];var Zc=K({__name:"SpellTree",props:{spell:null},setup(e){const t=e,n=St("");Vt(()=>{n.value=Ye(t.spell.tree)});const i=Ln(()=>({display:"reset",classes:{"reset-tree":!0},onClick(){Object.values(t.spell.treeNodes).forEach(r=>r.bought.value=!1),t.spell.castingTime.value=0}})),a=Ye(i);return(r,u)=>(g(),$("div",Xc,[Hc,(g(),U(Pe(o(n)))),(g(),U(Pe(o(a)))),(g(),$("svg",Jc,Qc))]))}});var Kc=me(Zc,[["__scopeId","data-v-71dcf259"]]);const Yc=K({props:{visibility:{type:R(Number,Boolean),required:!0},display:{type:R(Object,String,Function),required:!0},style:R(String,Object,Array),classes:R(Object),glowColor:R(String),active:Boolean,floating:Boolean},emits:["selectTab"],setup(e,{emit:t}){const{display:n,glowColor:i,floating:a}=ct(e),r=ei(n),u=w(()=>{const c=ot(i);return c==null||c===""?{}:o(a)?Ac(c):{boxShadow:`0px 9px 5px -6px ${c}`}});function d(){t("selectTab")}return{selectTab:d,component:r,glowColorStyle:u,unref:o,Visibility:Re,isVisible:ht,isHidden:Mn}}});function ed(e,t,n,i,a,r){var u;return e.isVisible(e.visibility)?(g(),$("button",{key:0,onClick:t[0]||(t[0]=(...d)=>e.selectTab&&e.selectTab(...d)),class:Me(["tabButton",{active:e.active,...e.unref(e.classes)}]),style:Oe([{visibility:e.isHidden(e.visibility)?"hidden":void 0},e.glowColorStyle,(u=e.unref(e.style))!=null?u:{}])},[(g(),U(Pe(e.component)))],6)):j("",!0)}var Ea=me(Yc,[["render",ed],["__scopeId","data-v-21427abb"]]);const td=K({props:{visibility:{type:R(Number,Boolean),required:!0},activeTab:{type:R(Object),required:!0},selected:{type:Object,required:!0},tabs:{type:R(Object),required:!0},style:R(String,Object,Array),classes:R(Object),buttonContainerStyle:R(String,Object,Array),buttonContainerClasses:R(Object)},components:{Sticky:Il,TabButton:Ea},setup(e){const{activeTab:t}=ct(e),n=w(()=>gi[Ae.theme].floatingTabs),i=St("");Vt(()=>{const d=ot(t);if(d==null){i.value="";return}if(mn(d)){i.value=he(d);return}i.value=he(o(d.display))});const a=w(()=>{const d=ot(t);return mn(d)||!d?void 0:o(d.classes)}),r=w(()=>{const d=ot(t);return mn(d)||!d?void 0:o(d.style)});function u(d){const{display:c,style:p,classes:f,glowColor:h,visibility:y}=d;return{display:c,style:o(p),classes:f,glowColor:h,visibility:y}}return{floating:n,tabClasses:a,tabStyle:r,Visibility:Re,component:i,gatherButtonProps:u,unref:o,isVisible:ht,isHidden:Mn}}});function nd(e,t,n,i,a,r){var c,p;const u=Ft("TabButton"),d=Ft("Sticky");return e.isVisible(e.visibility)?(g(),$("div",{key:0,class:Me(["tab-family-container",{...e.unref(e.classes),...e.tabClasses}]),style:Oe([{visibility:e.isHidden(e.visibility)?"hidden":void 0},(c=e.unref(e.style))!=null?c:[],(p=e.tabStyle)!=null?p:[]])},[s(d,{class:Me(["tab-buttons-container",e.unref(e.buttonContainerClasses)]),style:Oe(e.unref(e.buttonContainerStyle))},{default:se(()=>[v("div",{class:Me(["tab-buttons",{floating:e.floating}])},[(g(!0),$(F,null,xn(e.unref(e.tabs),(f,h)=>(g(),U(u,Jt({onSelectTab:y=>e.selected.value=h,floating:e.floating,key:h,active:e.unref(f.tab)===e.unref(e.activeTab)},e.gatherButtonProps(f)),null,16,["onSelectTab","floating","active"]))),128))],2)]),_:1},8,["class","style"]),e.unref(e.activeTab)?(g(),U(Pe(e.unref(e.component)),{key:0})):j("",!0)],6)):j("",!0)}var id=me(td,[["render",nd],["__scopeId","data-v-58dbf83a"]]);const ld=Symbol("TabButton"),ad=Symbol("TabFamily");function $n(e,t){if(Object.keys(e).length===0)throw console.warn("Cannot create tab family with 0 tabs"),new Error("Cannot create tab family with 0 tabs");const n=H(Object.keys(e)[0],!1);return pt(()=>{var r;const i=(r=t==null?void 0:t())!=null?r:{};i.id=pn("tabFamily-"),i.type=ad,i[it]=id,i.tabs=Object.keys(e).reduce((u,d)=>{const c=e[d]();return c.type=ld,c[it]=Ea,q(c,"visibility"),nt(c,"visibility",Re.Visible),q(c,"tab"),q(c,"display"),q(c,"classes"),q(c,"style"),q(c,"glowColor"),u[d]=c,u},{}),i.selected=n,i.activeTab=w(()=>{const u=o(a.tabs);if(n.value in u&&ht(u[n.value].visibility))return o(u[n.value].tab);const d=Object.values(u).find(c=>ht(c.visibility));return d?o(d.tab):null}),q(i,"visibility"),nt(i,"visibility",Re.Visible),q(i,"classes"),q(i,"style"),q(i,"buttonContainerClasses"),q(i,"buttonContainerStyle"),i[Ge]=function(){const{visibility:u,activeTab:d,selected:c,tabs:p,style:f,classes:h,buttonContainerClasses:y,buttonContainerStyle:_}=this;return{visibility:u,activeTab:d,selected:c,tabs:p,style:o(f),classes:h,buttonContainerClasses:y,buttonContainerStyle:_}};const a=i;return a})}function yt(e){return pt(()=>{const{addend:t,description:n,enabled:i,smallerIsBetter:a}=e(),r=et(t),u=et(n),d=i==null?void 0:et(i);return{apply:c=>l.add(c,o(r)),invert:c=>l.sub(c,o(r)),getFormula:c=>E.add(c,r),enabled:d,description:n==null?void 0:k(()=>s("div",{class:"modifier-container"},[o(u)!=null?s("span",{class:"modifier-description"},[ut(o(u))]):null,s("span",{class:"modifier-amount",style:(a===!0?l.gt(o(r),0):l.lt(o(r),0))?"color: var(--danger)":""},[l.gte(o(r),0)?"+":"",Ti(o(r))])]))}})}function L(e){return pt(()=>{const{multiplier:t,description:n,enabled:i,smallerIsBetter:a}=e(),r=et(t),u=et(n),d=i==null?void 0:et(i);return{apply:c=>l.times(c,o(r)),invert:c=>l.div(c,o(r)),getFormula:c=>E.times(c,r),enabled:d,description:n==null?void 0:k(()=>s("div",{class:"modifier-container"},[o(u)!=null?s("span",{class:"modifier-description"},[ut(o(u))]):null,s("span",{class:"modifier-amount",style:(a===!0?l.gt(o(r),1):l.lt(o(r),1))?"color: var(--danger)":""},[m("\xD7"),Ti(o(r))])]))}})}function Wi(e){return pt(()=>{const{exponent:t,description:n,enabled:i,supportLowNumbers:a,smallerIsBetter:r}=e(),u=et(t),d=et(n),c=i==null?void 0:et(i);return{apply:p=>{let f=p;return a&&(f=l.add(f,1)),f=l.pow(f,o(u)),a&&(f=l.sub(f,1)),f},invert:p=>{let f=p;return a&&(f=l.add(f,1)),f=l.root(f,o(u)),a&&(f=l.sub(f,1)),f},getFormula:p=>a?E.add(p,1).pow(u).sub(1):E.pow(p,u),enabled:c,description:n==null?void 0:k(()=>s("div",{class:"modifier-container"},[o(d)!=null?s("span",{class:"modifier-description"},[ut(o(d)),a?" (+1 effective)":null]):null,s("span",{class:"modifier-amount",style:(r===!0?l.gt(o(u),1):l.lt(o(u),1))?"color: var(--danger)":""},[m("^"),Ti(o(u))])]))}})}function ne(e){return pt(()=>{const t=e();return{apply:n=>t.filter(i=>o(i.enabled)!==!1).reduce((i,a)=>a.apply(i),n),invert:t.every(n=>n.invert!=null)?n=>t.filter(i=>o(i.enabled)!==!1).reduceRight((i,a)=>a.invert(i),n):void 0,getFormula:t.every(n=>n.getFormula!=null)?n=>t.filter(i=>o(i.enabled)!==!1).reduce((i,a)=>a.getFormula(i),n):void 0,enabled:t.some(n=>n.enabled!=null)?w(()=>t.filter(n=>o(n.enabled)!==!1).length>0):void 0,description:t.some(n=>n.description!=null)?k(()=>s(F,null,[t.filter(n=>o(n.enabled)!==!1).map(n=>o(n.description)).filter(n=>n).map(ut)])):void 0}})}const sd=K({__name:"Tab",props:{display:null},setup(e){const t=e,{display:n}=ct(t),i=ei(n);return(a,r)=>(g(),U(Pe(o(i))))}}),rd=Symbol("Tab");function On(e){return pt(()=>{const t=e();return t.id=pn("tab-"),t.type=rd,t[it]=sd,t[Ge]=function(){const{display:n}=this;return{display:n}},t})}var si=["Can we skip to the good part?","I have such great expectations for myself","I'm standing on the shoulders of giants","I can feel it's power","I feel you","What other job should I start?","I wonder what comes next","I hope I'm not too late","Will I finish in time? Can I go back?","Sometimes the logic of this world surprises me","This reminds me of something...","Hello, world!","I must keep moving forward, keep progressing"],od=["Chalk? I love chalk!","It's all coming together","I'm so close now...","Everything must be so precise","Fortunately I have a penchant for rules","Careful now"];const ud=K({__name:"Ritual",setup(e){return(t,n)=>(g(),$("div",null," Ritual goes here "))}}),Li="rituals",ti=Tn(Li,function(){const e="Performing Rituals",t="#D12626",n=dn(w(()=>0),"active rituals"),i=Vn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"75%",y:"60%"},symbol:"\u238A",randomQuips(){return[...od,...si]},resource:n,layerID:Li,modifierInfo:k(()=>ut(Be)),visibility:()=>Le.milestones.jobMilestone.earned.value&&Ct.milestones.jobMilestone.earned.value}));H([]);const a=we(()=>({requirements:be(()=>l.gte(i.rawLevel.value,2)),display:{requirement:`Achieve ${i.name} Level 2`,effectDisplay:`Unlock fourth column of runes and ${re.name}`}})),r=we(()=>({requirements:be(()=>l.gte(i.rawLevel.value,4)),display:{requirement:`Achieve ${i.name} Level 4`,effectDisplay:`Unlock fourth row of runes and ${oe.name}`},visibility:a.earned})),u=we(()=>({requirements:be(()=>l.gte(i.rawLevel.value,5)),display:{requirement:`Achieve ${i.name} Level 5`,effectDisplay:"Unlock a time slot"},visibility:r.earned})),d=we(()=>({requirements:be(()=>l.gte(i.rawLevel.value,6)),display:{requirement:`Achieve ${i.name} Level 6`,effectDisplay:`Unlock fifth column of runes and ${B.name}`},visibility:u.earned})),c=we(()=>({requirements:be(()=>l.gte(i.rawLevel.value,8)),display:{requirement:`Achieve ${i.name} Level 8`,effectDisplay:`Unlock fifth row of runes and ${J.name}`},visibility:d.earned})),p=we(()=>({requirements:be(()=>l.gte(i.rawLevel.value,10)),display:{requirement:`Achieve ${i.name} Level 10`,effectDisplay:"Unlock Ritual of G\xE9nesis"},visibility:c.earned})),f={fourthColMilestone:a,fourthRowMilestone:r,timeSlotMilestone:u,fifthColMilestone:d,fifthRowMilestone:c,genesisMilestone:p},h=[p,c,d,u,r,a],y=H(!0),_=w(()=>h.filter(ye=>ye.earned.value===!1)),{firstFeature:C,collapsedContent:T,hasCollapsedContent:W}=ii(h,ye=>ye.earned.value),le=w(()=>{let ye=3;return r.earned.value&&ye++,c.earned.value&&ye++,ye}),P=w(()=>{let ye=3;return a.earned.value&&ye++,d.earned.value&&ye++,ye});function M({name:ye,visibility:V}){const z=et(V!=null?V:Re.Visible);return{name:ye,visibility:z,[it]:ud,[Ge]:function(){return{}}}}const Z=M({name:"Ritual of Doctrina"}),re=M({name:"Ritual of Emolumentum",visibility:a.earned}),oe=M({name:"Ritual of Melius",visibility:r.earned}),B=M({name:"Ritual of Collegium",visibility:d.earned}),J=M({name:"Ritual of Celeritas",visibility:c.earned}),je={doctrina:Z,emolumentum:re,melius:oe,collegium:B,celeritas:J};w(()=>l.pow(1.1,i.level.value));const Te=ne(()=>[L(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===Li})),Le.batteries.breeding.timePassing.modifier]),Se=w(()=>new l(Te.apply(1)).toNumber()),Je=ne(()=>[Le.batteries.breeding.xpGain.modifier]),ae={timePassing:Te,jobXpGain:Je},[Tt,mt]=Ht(()=>[{title:"Time Passing",modifier:Te,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||Le.milestones.timeBatteriesMilestone.earned.value},{title:`${i.name} EXP Gain`,modifier:Je,base:1}]),Be=$n({general:()=>({display:"General",glowColor(){return Be.activeTab.value===this.tab?t:""},tab:Tt,generalTabCollapsed:mt})},()=>({style:`--layer-color: ${t}`}));return this.on("preUpdate",ye=>{i.timeLoopActive.value===!1&&G.tabs[1]!==Li||(ye=l.times(ye,Se.value).toNumber())}),{name:e,color:t,minWidth:670,job:i,activeRituals:n,runeRows:le,runeCols:P,rituals:je,modifiers:ae,milestones:f,collapseMilestones:y,modifierTabs:Be,display:k(()=>{const ye=[..._.value];return C.value&&ye.push(C.value),s(F,null,[ni(...ye,k(()=>cn(s(ai,{collapsed:y,content:T,display:y.value?"Show other completed milestones":"Hide other completed milestones"},null),[[kn,o(W)]]))),s($e,null,null)])})}});const cd={width:"300",height:"300",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg"},dd={transform:"translate(50 50)"},pd=["transform"],md=["transform","fill"],fd=K({__name:"Atom",props:{speed:null},setup(e){const t=e,n=["#7E7DFF","#7290E8","#89C6FF","#72CEE8","#7DFFF9"],i=X(Math.random()*1e5);let a=null;fi(()=>{a=Ot.on("update",d=>{i.value=i.value+t.speed*d/1e3})}),Cl(()=>{a&&(a(),a=null)});function r(d){return d<=2?.168:d<=10?.333:d<=28?.5:d<=60?.667:d<=78?.833:1}function u(d){const c=d**2,p=(d%2===0?1:-1)*c,f=i.value+c;return p*f%360}return(d,c)=>(g(),$("svg",cd,[v("g",dd,[(g(),$(F,null,xn(82,p=>v("g",{key:p,transform:`scale(${r(p)})`},[v("path",{d:"M0 0L0 -40A40 40 0 0 1 3.061970113459826 -39.88263204734962",class:"electron",transform:`rotate(${u(p)} 0 0)`,fill:n[p%5]},null,8,md)],8,pd)),64))])]))}});var cl=me(fd,[["__scopeId","data-v-baafb966"]]);const vd={class:"field"},gd={key:0,class:"field-title"},hd=["min","max"],bd=K({__name:"Slider",props:{title:null,modelValue:null,min:null,max:null},emits:["update:modelValue"],setup(e,{emit:t}){const i=ct(e),a=w({get(){var r;return String((r=o(i.modelValue))!=null?r:0)},set(r){t("update:modelValue",Number(r))}});return(r,u)=>(g(),$("div",vd,[e.title?(g(),$("span",gd,ee(e.title),1)):j("",!0),s(st,{display:`${o(a)}`,class:Me({fullWidth:!e.title}),direction:o(xe).Down},{default:se(()=>[cn(v("input",{type:"range","onUpdate:modelValue":u[0]||(u[0]=d=>Et(a)?a.value=d:null),min:e.min,max:e.max},null,8,hd),[[ra,o(a)]])]),_:1},8,["display","class","direction"])]))}});var Fa=me(bd,[["__scopeId","data-v-267283ff"]]);const El=e=>(nn("data-v-0deb20fa"),e=e(),ln(),e),yd=El(()=>v("br",null,null,-1)),wd=El(()=>v("defs",null,[v("filter",{id:"glow",x:"-100%",y:"-100%",width:"300%",height:"300%"},[v("feDropShadow",{dx:"0",dy:"0",stdDeviation:3})])],-1)),_d=["d"],Cd={class:"charge-display"},Sd=El(()=>v("br",null,null,-1)),kd=m("energeia"),Nd=K({__name:"Battery",props:{charge:null,effect:null,effectDescription:null,feedAmount:null,color:null,sumFeedAmounts:null,visibility:null,setFeedAmount:null},setup(e){const t=e,n=20,i=4,a=30,r=0,u=100-r*2,d=100,c=X([]),p=X(3);let f=null,h=()=>{const y=Math.max(3,Math.floor(n*t.feedAmount.value/u));c.value=new Array(y).fill(1).map((_,C)=>{let T=C===0,W=C===y-1,le=(t.feedAmount.value-r*2)/(y-1)*C+r;return{x:T||W?d/2:(d-a)/2+Math.random()*a,y:le}}),p.value=Math.random()*(5-2)+2,f&&clearTimeout(f),f=setTimeout(h,Math.random()*200+100)};return tt(()=>t.feedAmount.value,h,{immediate:!0}),(y,_)=>o(ht)(e.visibility)?(g(),$("div",{key:0,class:"battery-container feature dontMerge",style:Oe({visibility:o(Mn)(e.visibility)?"hidden":void 0})},[v("div",null,ee(o(ze)(o(e.effect)))+"x "+ee(e.effectDescription),1),yd,v("div",{class:"battery",style:Oe({borderColor:o(e.color),width:`${d}px`})},[(g(),$("svg",{style:Oe({height:`${e.feedAmount.value}%`,borderColor:o(e.color)})},[wd,v("path",{style:Oe([{filter:"url(#glow)"},{opacity:3,strokeWidth:i}]),d:`M${c.value.map(C=>C.x+","+C.y).join(" L")}`},null,12,_d)],4)),v("div",Cd,[m(ee(o(ze)(e.charge.value)),1),Sd,kd])],4),s(Fa,{max:100-o(e.sumFeedAmounts)+o(e.feedAmount),modelValue:o(e.feedAmount),"onUpdate:modelValue":_[0]||(_[0]=C=>e.setFeedAmount(C))},null,8,["max","modelValue"])],4)):j("",!0)}});var $d=me(Nd,[["__scopeId","data-v-0deb20fa"]]),xd=["Huh, why is 82 compelling? It doesn't fit the usual patterns...","Atoms? I love atoms!","I can feel the power!","The power kinda tingles"];function Md(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!aa(e)}const Jn="generators",Le=Tn(Jn,function(){const e="Harnessing Power",t="#26D1CE",n=dn(0,"energeia"),i=H(0),a=Vn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"75%",y:"60%"},symbol:"\u269B",randomQuips(){return[...xd,...si]},resource:n,layerID:Jn,modifierInfo:k(()=>ut(Be)),visibility:Ce.milestones.jobMilestone.earned})),r=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,2)),display:{requirement:`Achieve ${a.name} Level 2`,effectDisplay:"Unlock multiple generators"}})),u=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,4)),display:{requirement:`Achieve ${a.name} Level 4`,effectDisplay:"Unlock resource gain batteries"},visibility:r.earned})),d=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,5)),display:{requirement:`Achieve ${a.name} Level 5`,effectDisplay:`Unlock buying machines in "${Ct.job.name}" Job`},visibility:u.earned})),c=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,6)),display:{requirement:`Achieve ${a.name} Level 6`,effectDisplay:"Unlock xp gain batteries"},visibility:d.earned})),p=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,8)),display:{requirement:`Achieve ${a.name} Level 8`,effectDisplay:"Unlock time passing batteries"},visibility:c.earned})),f=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,10)),display:{requirement:`Achieve ${a.name} Level 10`,effectDisplay:`Unlock 1/2 of "${ti.job.name}" Job`},visibility:p.earned,onComplete(){Ct.milestones.jobMilestone.earned.value&&wn(ti,G)}})),h={multiLoopMilestone:r,resourceBatteriesMilestone:u,machinesMilestone:d,xpBatteriesMilestone:c,timeBatteriesMilestone:p,jobMilestone:f},y=[f,p,c,d,u,r],_=H(!0),C=w(()=>y.filter(V=>V.earned.value===!1)),{firstFeature:T,collapsedContent:W,hasCollapsedContent:le}=ii(y,V=>V.earned.value);function P(V){const z=H(0),pe=H(0);return pt(()=>{const fe=V(),Ne=w(()=>o(rt.jobs[fe.job].color)),wt=fe.visibility!=null?et(fe.visibility):Re.Visible,kt=w(()=>fe.effectFormula(z.value)),Y=ne(()=>[yt(()=>({addend:()=>l.times(n.value,pe.value).div(100),description:"Battery charging"})),Wi(()=>({exponent:()=>l.div(pe.value,500).add(1),description:"Battery charging bonus",supportLowNumbers:!0})),yt(()=>({addend:()=>l.times(z.value,.1).neg(),description:"Battery discharge"}))]),lt=w(()=>Y.apply(0)),Ve=L(()=>({multiplier:kt,description:on(fe.effectDescription)+" battery",enabled:()=>ht(wt)}));return{charge:z,chargeGain:Y,computedChargeGain:lt,color:Ne,feedAmount:pe,effect:kt,effectDescription:fe.effectDescription,modifier:Ve,visibility:wt,setFeedAmount:We=>pe.value=We,[it]:$d,[Ge]:function(){const{charge:We,effect:Ue,effectDescription:ce,feedAmount:vt,color:_t,visibility:at,setFeedAmount:x}=this;return{charge:We,effect:Ue,effectDescription:ce,feedAmount:vt,color:_t,visibility:at,sumFeedAmounts:Z,setFeedAmount:x}}}})}const M=Fl.reduce((V,z)=>(V[z]={job:z,resourceGain:P(()=>({job:z,effectDescription:"resource gain",effectFormula:pe=>l.div(pe,z===Jn?10:100).add(1).log(1.3).add(1).pow(1)})),xpGain:P(()=>({job:z,effectDescription:"xp gain",effectFormula:pe=>l.div(pe,z===Jn?6:60).add(1).log(1.3).add(1),visibility:c.earned})),timePassing:P(()=>({job:z,effectDescription:"time passing",effectFormula:pe=>l.div(pe,z===Jn?10:100).add(1).log(10).add(1),visibility:u.earned}))},V),{}),Z=w(()=>Object.values(M).reduce((V,z)=>V+z.timePassing.feedAmount.value+z.resourceGain.feedAmount.value+z.xpGain.feedAmount.value,0)),re=w(()=>l.pow(1.1,a.level.value)),oe=ne(()=>[L(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===Jn})),M.generators.timePassing.modifier]),B=w(()=>new l(oe.apply(1)).toNumber()),J=ne(()=>[yt(()=>({addend:i,description:"Allocated time slots"})),yt(()=>({addend:1,description:"Bonus generator",enabled:()=>Ct.job.active.value&&Ct.milestones.bonusGeneratorMilestone.earned.value}))]),je=w(()=>J.apply(1)),Te=ne(()=>[L(()=>({multiplier:re,description:`${a.name} level (x1.1 each)`})),L(()=>({multiplier:()=>l.pow(je.value,2),description:"Allocated time slots",enabled:r.earned})),M.generators.resourceGain.modifier,Ct.plants.energeia.modifier]),Se=ne(()=>[M.generators.xpGain.modifier]),Je={timePassing:oe,timeSlotsGenerating:J,energeiaGain:Te,jobXpGain:Se},[ae,Tt]=Ht(()=>[{title:"Time Passing",modifier:oe,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||p.earned.value},{title:"Generators",modifier:J,base:1},{title:"Energeia Gain",modifier:Te,base:1},{title:`${a.name} EXP Gain`,modifier:Se,base:1,baseText:"Base (per energeia gained)"}]),mt=["resourceGain","xpGain","timePassing"].map(V=>Ht(()=>Object.values(M).map(z=>({title:on(z.job)+" Battery Charge Gain",modifier:z[V].chargeGain,enabled:()=>ht(z[V].visibility),base:0})))),Be=$n({general:()=>({display:"General",glowColor(){return Be.activeTab.value===this.tab?t:""},tab:ae,generalTabCollapsed:Tt}),...mt.reduce((V,[z,pe],fe)=>{const Ne=["timePassing","resourceGain","xpGain"][fe];return V[Ne]=()=>({display:on(Ne),glowColor(){return Be.activeTab.value===this.tab?t:""},tab:z,tabCollapsed:pe,visibility:[p,u,c][fe].earned}),V},{})},()=>({style:`--layer-color: ${t}`}));this.on("preUpdate",V=>{if(a.timeLoopActive.value===!1&&G.tabs[1]!==Jn)return;V=l.times(V,B.value).toNumber();let z=new l(0);Object.values(M).forEach(fe=>{Object.values(fe).forEach(Ne=>{typeof Ne!="string"&&(Ne.charge.value=l.add(Ne.charge.value,l.times(Ne.computedChargeGain.value,V)).clampMin(0),z=z.add(Ne.feedAmount.value))})}),n.value=l.sub(n.value,l.div(z,100).times(n.value));const pe=l.times(Te.apply(1),V);n.value=l.add(n.value,pe),a.xp.value=l.add(a.xp.value,Se.apply(pe))});const ye=$n({generation:()=>({display:"Generation",tab:On(()=>({display:k(()=>{let V;return s(F,null,[s($i,null,{default:()=>[s(cl,{speed:B.value},null),Ct.milestones.bonusGeneratorMilestone.earned.value?s(cl,{speed:B.value},null):null]}),r.earned.value?s(F,null,[s("div",null,[rt.hasTimeSlotAvailable.value?"Click to allocate or deallocate additional time loops to this job":"Free up time slots to allocate additional time loops to this job"]),s($i,null,Md(V=Array(rt.hasTimeSlotAvailable.value?i.value+1:i.value).fill(0).map((z,pe)=>s(cl,{speed:B.value,width:"100px",height:"100px",style:l.lt(i.value,pe+1)?"opacity: 0.25":"",onClick:()=>l.lt(i.value,pe+1)?i.value++:i.value--},null)))?V:{default:()=>[V]})]):null])})})),style:{borderLeft:"5px solid var(--outline)",marginLeft:"5px"}}),batteries:()=>({display:"Batteries",tab:On(()=>({display:k(()=>s(F,null,[s($e,null,null),s("div",null,[m("Allocate a percentage of "),n.displayName,m("/s to feed into each battery.")]),s("div",null,[m("Batteries discharge over time.")]),s($e,null,null),hl(Object.values(M).filter(V=>o(rt.jobs[V.job].visibility)===Re.Visible).map(V=>s(F,null,[s("h2",null,[rt.jobs[V.job].name]),ji(V.resourceGain,V.xpGain,V.timePassing)])),s($e,{height:"50px"},null))]))})),visibility:p.earned})},()=>({classes:{floating:!1},style:{borderStyle:"none",marginLeft:"-20px",marginRight:"-20px"},buttonContainerStyle:{top:"50px"}}));return{name:e,color:t,minWidth:670,energeia:n,extraTimeSlotsAllocated:i,job:a,modifiers:Je,milestones:h,collapseMilestones:_,batteries:M,modifierTabs:Be,tabs:ye,display:k(()=>{const V=[...C.value];return T.value&&V.push(T.value),s(F,null,[s(Ei,{resource:n,color:t},null),ni(...V,k(()=>cn(s(ai,{collapsed:_,content:W,display:_.value?"Show other completed milestones":"Hide other completed milestones"},null),[[kn,o(le)]]))),s($e,null,null),p.earned.value?Ye(ye):Ye(ye.activeTab.value)])})}});var Pd=["I am the petals of the flower that is my inner soul","I am the stem of the flower that is my inner mind","These flowers are powerful, I can feel it","There is so much power here. I must fulfill their potential","How will I store all these flowers?","Euch; These flowers taste terrible!","It is a mistake to do things too easily","You are my number one priority now","Flowers? I love flowers!","It's the time you have wasted for your rose that makes your rose so important","What is essential is invisible to the eye"];const Td=!1,Id=!0,Ed={min:.5,max:2},Fd=.005,qd=-1,Dd=1e3,Ld=!0,Ad={x:0,y:0},Od=[{type:"alpha",config:{alpha:{list:[{time:0,value:1},{time:1,value:0}]}}},{type:"moveSpeed",config:{speed:{list:[{time:0,value:2},{time:1,value:25}]},minMult:2}},{type:"scale",config:{scale:{list:[{time:0,value:.001},{time:1,value:1}]},minMult:.25}},{type:"color",config:{color:{list:[{time:0,value:"#EB428F"},{time:.25,value:"#F545ED"},{time:.5,value:"#B949DE"},{time:.75,value:"#9945F5"},{time:1,value:"#6442EB"}]}}},{type:"rotation",config:{accel:0,minSpeed:0,maxSpeed:20,minStart:270,maxStart:300}},{type:"textureRandom",config:{textures:["/Fire.png"]}},{type:"spawnShape",config:{type:"torus",data:{x:0,y:0,radius:75,innerRadius:75,affectRotation:!0}}}];var Jl={emit:Td,autoUpdate:Id,lifetime:Ed,frequency:Fd,emitterLifetime:qd,maxParticles:Dd,addAtBack:Ld,pos:Ad,behaviors:Od};const Wl=vi(),dl="flowers",De=Tn(dl,function(){const e="Harvesting Flowers",t="#A626D1",n=dn(0,"moly"),i=el(n),a=Vn(e,()=>({color:t,image:"/harvesting.png",imageFocus:{x:"50%",y:"65%"},symbol:"\u2698",randomQuips(){return[...Pd,...si]},resource:n,layerID:dl,modifierInfo:k(()=>ut(Gn)),modifierModalAttrs:{class:"flowers-modal"},showNotif:()=>Object.values(Ne).some(te=>te.showNotif.value)})),r=w(()=>Object.values(Ne).filter(te=>te.active.value).length),u=w(()=>1),d=Yi(()=>({fullscreen:!1,zIndex:-1,boundingRect:X(null),onContainerResized(te){this.boundingRect.value=te},onHotReload(){Object.values(Ne).forEach(te=>{te.particleEffect.value.then(jt=>jt.destroy()),te.particleEffect.value=d.addEmitter(te.particleEffectConfig),te.updateParticleEffect(te.active.value)})}})),c=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,2)),display:{requirement:`Achieve ${a.name} Level 2`,effectDisplay:"Double T\xE9chnasma potency and unlock experience for spells"}})),p=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,4)),display:{requirement:`Achieve ${a.name} Level 4`,effectDisplay:"Double T\xE9chnasma potency and unlock a new spell - Theriz\xF3"},visibility:c.earned})),f=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,6)),display:{requirement:`Achieve ${a.name} Level 6`,effectDisplay:"Double T\xE9chnasma potency and unlock a new spell - Pr\u014Dfici\u014D"},visibility:p.earned})),h=we(()=>({requirements:be(()=>l.gte(a.rawLevel.value,8)),display:{requirement:`Achieve ${a.name} Level 8`,effectDisplay:"Double T\xE9chnasma potency and unlock a new spell - Schol\u0113"},visibility:f.earned})),y={spellExpMilestone:c,flowerSpellMilestone:p,chargeSpellMilestone:f,expSpellMilestone:h},_=[h,f,p,c],C=H(!0),T=w(()=>_.filter(te=>te.earned.value===!1)),{firstFeature:W,collapsedContent:le,hasCollapsedContent:P}=ii(_,te=>te.earned.value),M=Hl(()=>({visibility:Re.Hidden}));function Z(te,jt,Ba,Ll,oi,Al){const gn=Object.keys(oi).reduce((Mt,Ze)=>{const Fn=H(!1);return Mt[Ze]=Hl(()=>({display:oi[Ze].display,classes(){return{"spell-node":!0,bought:Fn.value}},bought:Fn,canClick(){var bi;return!(gn[Ze].bought.value||l.gte(sl.value,Un.value)||(bi=oi[Ze].requirements)!=null&&bi.some(hn=>!gn[hn].bought.value))},onClick(){gn[Ze].bought.value=!0}})),Mt},{}),al=H(0),Un=w(()=>l.clampMin(al.value,1).log10().floor()),sl=w(()=>Object.values(gn).reduce((Mt,Ze)=>Mt+(Ze.bought.value?1:0),0)),Ol=w(()=>{const Mt=l.eq(Un.value,0)?0:l.pow10(Un.value),Ze=l.pow10(l.add(Un.value,1));return l.sub(al.value,Mt).div(l.sub(Ze,Mt)).times(100)}),qi=Ln(()=>({canClick(){return Bt.active.value||r.value<u.value},display(){return{title:`<h2>${te}</h2>`,description:k(()=>s(F,null,[s("br",null,null),s("i",null,[jt]),s("br",null,null),s("br",null,null),s("h3",null,[Ba]),c.earned.value?s("div",{class:"spell-level"},[s("div",{class:"spell-exp",style:`--exp: ${ze(Ol.value)}%`},null),s("span",null,[m("("),At(l.sub(Un.value,sl.value)),m("/"),At(Un.value),m(")")])]):null,Rl.value?s(Nn,null,null):null]))}},classes(){return{spellSelector:!0,activeSpell:Bt.active.value,can:o(qi.canClick)}},onClick(){Bt.active.value=!Bt.active.value,Bt.castingTime.value=0},visibility:Ll})),Rl=Mi(qi,()=>Al.some(Mt=>Mt.some(Ze=>Ze!==M&&o(gn[Ze].canClick)))),Bt={treeNodes:gn,tree:Pc(()=>({nodes:Al.map(Mt=>Mt.map(Ze=>Ze===M?M:gn[Ze])),branches:()=>Object.keys(oi).reduce((Mt,Ze)=>oi[Ze].requirements?[...Mt,...oi[Ze].requirements.map(Fn=>({startNode:gn[Ze],endNode:gn[Fn],stroke:gn[Fn].bought.value?"#B949DE":"var(--locked)","stroke-width":"4px"}))]:Mt,[])})),visibility:Ll,selector:qi,showNotif:Rl,particleEffectConfig:Jl,active:H(!1),xp:al,castingTime:H(0),level:Un,spentPoints:sl,levelProgress:Ol,particleEffectWatcher:X(null),particleEffect:X(d.addEmitter(Jl)),async updateParticleEffect(Mt){var Fn,bi;const Ze=await Bt.particleEffect.value;(bi=(Fn=Bt.particleEffectWatcher).value)==null||bi.call(Fn),Mt?Bt.particleEffectWatcher.value=tt([()=>{var hn;return(hn=De.nodes.value[qi.id])==null?void 0:hn.rect},d.boundingRect],async([hn,rl])=>{hn!=null&&rl!=null?(Ze.cleanup(),Ze.updateOwnerPos(hn.x+hn.width/2-rl.x,hn.y+hn.height/2-rl.y),Ze.resetPositionTracking(),Ze.emit=!0):Ze.emit=!1},{immediate:!0}):(Ze.emit=!1,Bt.particleEffectWatcher.value=null)}};return tt(Bt.active,Bt.updateParticleEffect),tt(Bt.level,(Mt,Ze)=>{Ae.active!==G.id||l.neq(Mt,l.add(Ze,1))||(Bt.notif!=null&&Wl.dismiss(Bt.notif),Bt.notif=Wl.info(`${te} is now level ${Mt}!`))}),Bt}const re=H(0),oe=Vi(()=>({direction:xe.Right,height:20,width:200,fillStyle:()=>`--time: ${(G.time%1e8/10).toLocaleString("fullwide",{useGrouping:!1})}px; --time-deg: ${(G.time%1e8/100).toLocaleString("fullwide",{useGrouping:!1})}deg`,classes:{chargeBar:!0},progress(){return l.div(re.value,qt.value)},visibility:f.earned})),B=w(()=>l.pow(1.1,a.level.value)),J=w(()=>l.pow(1.25,Object.values(Ne).filter(te=>ht(te.visibility.value)).length)),je=B,Te=B,Se=w(()=>l.pow(1.1,ae.level.value)),Je=B,ae=Z("T\xE9chnasma","Practice using the flowers to perform minor magical tricks.","Gain job exp.",!0,{moreJobXpFlat:{display:"x4 job exp"},moreJobXpPerSpell:{display:k(()=>s("div",null,[m("x1.25 job exp per known spell"),s("br",null,null),m("(x"),ze(J.value),m(")")])),requirements:["moreJobXpFlat"]},morePotencyPerJobLevel:{display:k(()=>s("div",null,[m("Additional x1.1 all spell potency per job level"),s("br",null,null),m("(x"),ze(je.value),m(")")])),requirements:["moreJobXpFlat"]},moreJobXpPerJobLevel:{display:k(()=>s("div",null,[m("Additional x1.1 job exp per job level"),s("br",null,null),m("(x"),ze(Te.value),m(")")])),requirements:["moreJobXpPerSpell"]},moreJobXpPerSpellLevel:{display:k(()=>s("div",null,[m("Additional x1.1 job exp per T\xE9chnasma level"),s("br",null,null),m("(x"),ze(Se.value),m(")")])),requirements:["moreJobXpPerSpell"]},morePotencyOverTime:{display:"Additional spell potency the longer it's been consecutively casted",requirements:["morePotencyPerJobLevel"]},moreSpellXpPerJobLevel:{display:k(()=>s("div",null,[m("x1.1 all spell exp per job level"),s("br",null,null),m("(x"),ze(Je.value),m(")")])),requirements:["morePotencyPerJobLevel"]}},[["moreJobXpFlat"],["moreJobXpPerSpell",M,"morePotencyPerJobLevel"],["moreJobXpPerJobLevel","moreJobXpPerSpellLevel","morePotencyOverTime","moreSpellXpPerJobLevel"]]),Tt=w(()=>Object.values(Ne).filter(te=>ht(te.visibility.value)).length*.25),mt=w(()=>l.pow(1.1,V.level.value)),Be=w(()=>l.log10(l.add(n.value,1)).pow(.777).add(1)),ye=s(F,null,[m("log"),s("sub",null,[m("2")]),m("(flowers + 1)"),s("sup",null,[m("0.777")]),m(" + 1")]),V=Z("Theriz\xF3","Use the magic of the flowers to harvest themselves. They should make my spells more potent.","Gain flowers.",p.earned,{moreFlowersFlat:{display:"x2 flowers gain"},moreFlowersPerSpell:{display:k(()=>s("div",null,[m("+.25x Theriz\xF3 potency per known spell"),s("br",null,null),m("(+"),ze(Tt.value),m(")")])),requirements:["moreFlowersFlat"]},moreFlowersPerLevel:{display:k(()=>s("div",null,[m("Additional x1.1 Theriz\xF3 potency per Theriz\xF3 level"),s("br",null,null),m("(x"),ze(mt.value),m(")")])),requirements:["moreFlowersPerSpell"]},moreJobXpPerFlower:{display:k(()=>s("div",null,[m("Flowers affect job exp"),s("br",null,null),m("(x"),ze(Be.value),m(")")])),requirements:["moreFlowersFlat"]},moreSpellXpPerFlower:{display:k(()=>s("div",null,[m("Flowers affect all spell exp"),s("br",null,null),m("(x"),ze(Be.value),m(")")])),requirements:["moreJobXpPerFlower"]},morePotencyPerFlower:{display:k(()=>s("div",null,[m("Flower's affect all spell potency twice"),s("br",null,null),m("(x"),ze(Be.value),m(")")])),requirements:["moreSpellXpPerFlower"]},passiveFlowerGain:{display:"1% of flower gain when casting other spells",requirements:["moreSpellXpPerFlower"]}},[["moreFlowersPerLevel","moreFlowersPerSpell","moreFlowersFlat"],[M,M,"moreJobXpPerFlower"],[M,"passiveFlowerGain","moreSpellXpPerFlower"],[M,M,"morePotencyPerFlower"]]),z=Z("Pr\u014Dfici\u014D","Charge up magic to cast another spell with greater potency.","Charge spell potency.",f.earned,{spellEff:{display:"x1.25 spell potency when discharging"},fasterChargeFlat:{display:"x1.5 faster charging",requirements:["spellEff"]},fasterChargeByLevel:{display:"Additional x1.1 faster charging for each Pr\u014Dfici\u014D level",requirements:["fasterChargeFlat"]},betterChargeMulti:{display:"Charge effect on spells is raised ^1.1",requirements:["fasterChargeByLevel"]},largerChargeFlat:{display:"x1.5 max charge",requirements:["spellEff"]},largerChargeByLevel:{display:"Additional x1.2 max charge for each Pr\u014Dfici\u014D level",requirements:["largerChargeFlat"]},slowerDischargeByLevel:{display:"x1.05 slower discharge for each of that spell's levels",requirements:["largerChargeByLevel"]}},[["spellEff"],["fasterChargeFlat","largerChargeFlat"],["fasterChargeByLevel","largerChargeByLevel"],["betterChargeMulti","slowerDischargeByLevel"]]),pe=w(()=>l.div(fe.level.value,10)),fe=Z("Schol\u0113","Practice a difficult routine that improves your ability at casting all spells.","Gain spell exp.",h.earned,{moreSpellXp:{display:"All spells gain double exp"},moreXpSpellXp:{display:"T\xE9chnasma spell gains double exp",requirements:["moreSpellXp"]},moreFlowerSpellXp:{display:"Theriz\xF3 spell gains double exp",requirements:["moreSpellXp"]},moreChargeSpellXp:{display:"Pr\u014Dfici\u014D spell gains double exp",requirements:["moreSpellXp"]},moreMassXpSpellXp:{display:"Schol\u0113 spell gains double exp",requirements:["moreSpellXp"]},moreXpPerLevel:{display:k(()=>s("div",null,[m("+.1x other spell exp per level of this spell"),s("br",null,null),m("(+"),ze(pe.value),m(")")])),requirements:["moreSpellXp"]},morePotency:{display:"Double potency of this spell",requirements:["moreSpellXp"]}},[["moreXpSpellXp","moreFlowerSpellXp"],["moreXpPerLevel","moreSpellXp","morePotency"],["moreChargeSpellXp","moreMassXpSpellXp"]]),Ne={xpSpell:ae,flowerSpell:V,chargeSpell:z,massXpSpell:fe},wt=ne(()=>[L(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===dl})),Le.batteries.flowers.timePassing.modifier]),kt=w(()=>wt.apply(1)),Y=ne(()=>[L(()=>({multiplier:1.25,description:"Pr\u014Dfici\u014D skill (x1.25 when discharging)",enabled:()=>z.treeNodes.spellEff.bought.value&&l.gt(re.value,0)})),Wi(()=>({exponent:1.1,description:"Pr\u014Dfici\u014D skill (flat)",enabled:z.treeNodes.betterChargeMulti.bought}))]),lt=w(()=>Y.apply(l.log10(l.add(re.value,1)).add(1))),Ve=ne(()=>[L(()=>({multiplier:B,description:`${a.name} level (x1.1 each)`})),L(()=>({multiplier:je,description:`T\xE9chnasma skill (x1.1 per ${a.name} level)`,enabled:ae.treeNodes.morePotencyPerJobLevel.bought})),L(()=>({multiplier:Be,description:k(()=>s(F,null,[m("Flowers Effect ("),ye,m(")")]))})),L(()=>({multiplier:Be,description:"Theriz\xF3 skill (Re-apply flowers effect)",enabled:V.treeNodes.morePotencyPerFlower.bought}))]),We=w(()=>Ve.apply(1)),Ue=ne(()=>[L(()=>({multiplier:Je,description:`T\xE9chnasma skill (x1.1 per ${a.name} level)`,enabled:ae.treeNodes.moreSpellXpPerJobLevel.bought})),L(()=>({multiplier:Be,description:k(()=>s(F,null,[m("Theriz\xF3 skill ("),ye,m(")")])),enabled:V.treeNodes.moreSpellXpPerFlower.bought})),L(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:fe.treeNodes.moreSpellXp.bought}))]),ce=w(()=>Ue.apply(1)),vt=ne(()=>[L(()=>({multiplier:We,description:"All Spell Potency"})),L(()=>({multiplier:2,description:"Spell EXP milestone (flat)",enabled:c.earned})),L(()=>({multiplier:2,description:"Theriz\xF3 milestone (flat)",enabled:p.earned})),L(()=>({multiplier:2,description:"Pr\u014Dfici\u014D milestone (flat)",enabled:f.earned})),L(()=>({multiplier:2,description:"Schol\u0113 milestone (flat)",enabled:h.earned})),L(()=>({multiplier:()=>l.pow(1.1,ae.level.value),description:"T\xE9chnasma level (x1.1 each)",enabled:c.earned})),L(()=>({multiplier:()=>l.log2(l.add(ae.castingTime.value,1)).div(10).add(1),description:k(()=>s(F,null,[m("T\xE9chnasma skill (log"),s("sub",null,[m("2")]),m("(casting time)/10)")])),enabled:ae.treeNodes.morePotencyOverTime.bought})),L(()=>({multiplier:lt,description:"Charge Multiplier",enabled:f.earned}))]),_t=w(()=>vt.apply(1)),at=ne(()=>[yt(()=>({addend:()=>l.div(fe.level.value,10),description:"Schol\u0113 skill (+.1 per Schol\u0113 level)",enabled:fe.treeNodes.moreXpPerLevel.bought})),L(()=>({multiplier:ce,description:"All Spell EXP Gain"})),L(()=>({multiplier:_t,description:"T\xE9chnasma potency"})),L(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:fe.treeNodes.moreXpSpellXp.bought}))]),x=ne(()=>[yt(()=>({addend:_t,description:"T\xE9chnasma potency"})),L(()=>({multiplier:B,description:`${a.name} level (x1.1 each)`})),L(()=>({multiplier:4,description:"T\xE9chnasma skill (flat)",enabled:ae.treeNodes.moreJobXpFlat.bought})),L(()=>({multiplier:J,description:"T\xE9chnasma skill (x1.25 per known spell)",enabled:ae.treeNodes.moreJobXpPerSpell.bought})),L(()=>({multiplier:Te,description:`T\xE9chnasma skill (x1.1 per ${a.name} level)`,enabled:ae.treeNodes.moreJobXpPerJobLevel.bought})),L(()=>({multiplier:Se,description:"T\xE9chnasma skill (x1.1 per T\xE9chnasma level)",enabled:ae.treeNodes.moreJobXpPerSpellLevel.bought})),L(()=>({multiplier:Be,description:k(()=>s(F,null,[m("Flowers Effect ("),ye,m(")")])),enabled:V.treeNodes.moreJobXpPerFlower.bought})),Le.batteries.study.xpGain.modifier]),A=ne(()=>[L(()=>({multiplier:()=>{var te;return l.pow(1/1.05,(te=ae.level.value)!=null?te:0)},description:"Theriz\xF3 skill (/1.05 per T\xE9chnasma level)",enabled:z.treeNodes.slowerDischargeByLevel.bought}))]),O=w(()=>A.apply(Lt.value)),ke=ne(()=>[yt(()=>({addend:Tt,description:"Theriz\xF3 skill (+.25 per known spell)",enabled:V.treeNodes.moreFlowersPerSpell.bought})),L(()=>({multiplier:We,description:"All Spell Potency"})),L(()=>({multiplier:()=>l.pow(1.1,V.level.value),description:"Theriz\xF3 level (x1.1 each)",enabled:c.earned})),L(()=>({multiplier:()=>l.log2(l.add(V.castingTime.value,1)).div(10).add(1),description:k(()=>s(F,null,[m("T\xE9chnasma skill (log"),s("sub",null,[m("2")]),m("(casting time)/10)")])),enabled:ae.treeNodes.morePotencyOverTime.bought})),L(()=>({multiplier:lt,description:"Charge Multiplier",enabled:f.earned}))]),ie=w(()=>ke.apply(1)),Xe=ne(()=>[yt(()=>({addend:pe,description:"Schol\u0113 skill (+.1 per Schol\u0113 level)",enabled:fe.treeNodes.moreXpPerLevel.bought})),L(()=>({multiplier:ce,description:"All Spell EXP Gain"})),L(()=>({multiplier:ie,description:"Theriz\xF3 potency"})),L(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:fe.treeNodes.moreFlowerSpellXp.bought}))]),Nt=ne(()=>[yt(()=>({addend:ie,description:"Theriz\xF3 potency"})),L(()=>({multiplier:2,description:"Theriz\xF3 skill (flat)",enabled:V.treeNodes.moreFlowersFlat.bought})),L(()=>({multiplier:mt,description:"Theriz\xF3 skill (x1.1 per Theriz\xF3 level)",enabled:V.treeNodes.moreFlowersPerLevel.bought})),Le.batteries.study.resourceGain.modifier,Ct.plants.moly.modifier]),gt=w(()=>Nt.apply(0)),zt=ne(()=>[yt(()=>({addend:.01,description:"Theriz\xF3 skill (flat)",enabled:V.treeNodes.passiveFlowerGain.bought})),L(()=>({multiplier:gt,description:"Flower gain"}))]),Qe=ne(()=>[L(()=>({multiplier:()=>{var te;return l.pow(1/1.05,(te=V.level.value)!=null?te:0)},description:"Theriz\xF3 skill (/1.05 per Theriz\xF3 level)",enabled:z.treeNodes.slowerDischargeByLevel.bought}))]),ue=w(()=>Qe.apply(Lt.value)),Ie=ne(()=>[L(()=>({multiplier:We,description:"All Spell Potency"})),L(()=>({multiplier:()=>l.pow(1.1,z.level.value),description:"Pr\u014Dfici\u014D level (x1.1 each)"})),L(()=>({multiplier:()=>l.log2(l.add(z.castingTime.value,1)).div(10).add(1),description:k(()=>s(F,null,[m("T\xE9chnasma skill (log"),s("sub",null,[m("2")]),m("(casting time)/10)")])),enabled:ae.treeNodes.morePotencyOverTime.bought}))]),Ee=w(()=>Ie.apply(1)),Q=ne(()=>[yt(()=>({addend:()=>l.div(fe.level.value,10),description:"Schol\u0113 skill (+.1 per Schol\u0113 level)",enabled:fe.treeNodes.moreXpPerLevel.bought})),L(()=>({multiplier:ce,description:"All Spell EXP Gain"})),L(()=>({multiplier:Ee,description:"Pr\u014Dfici\u014D potency"})),L(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:fe.treeNodes.moreChargeSpellXp.bought}))]),ft=ne(()=>[yt(()=>({addend:Ee,description:"Pr\u014Dfici\u014D potency"})),L(()=>({multiplier:1.5,description:"Pr\u014Dfici\u014D skill (flat)",enabled:z.treeNodes.largerChargeFlat.bought})),L(()=>({multiplier:()=>l.pow(1.2,z.level.value),description:"Pr\u014Dfici\u014D skill (x1.2 per Pr\u014Dfici\u014D level)",enabled:z.treeNodes.largerChargeByLevel.bought}))]),qt=w(()=>ft.apply(0)),sn=ne(()=>[yt(()=>({addend:()=>l.div(Ee.value,10),description:"Pr\u014Dfici\u014D potency (/10)"})),L(()=>({multiplier:1.5,description:"Pr\u014Dfici\u014D skill (flat)",enabled:z.treeNodes.fasterChargeFlat.bought})),L(()=>({multiplier:()=>l.pow(1.1,z.level.value),description:"Pr\u014Dfici\u014D skill (x1.1 per Pr\u014Dfici\u014D level)",enabled:z.treeNodes.fasterChargeFlat.bought}))]),Dt=w(()=>sn.apply(0)),Qt=ne(()=>[yt(()=>({addend:()=>l.div(Ee.value,10),description:"Pr\u014Dfici\u014D potency (/10)"}))]),Lt=w(()=>Qt.apply(0)),fn=ne(()=>[L(()=>({multiplier:We,description:"All Spell Potency"})),L(()=>({multiplier:()=>l.pow(1.1,fe.level.value),description:"Schol\u0113 level (x1.1 each)"})),L(()=>({multiplier:()=>l.log2(l.add(fe.castingTime.value,1)).div(10).add(1),description:k(()=>s(F,null,[m("T\xE9chnasma skill (log"),s("sub",null,[m("2")]),m("(casting time)/10)")])),enabled:ae.treeNodes.morePotencyOverTime.bought})),L(()=>({multiplier:lt,description:"Charge Multiplier",enabled:f.earned})),L(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:fe.treeNodes.morePotency.bought}))]),zn=w(()=>fn.apply(1)),Zt=ne(()=>[L(()=>({multiplier:ce,description:"All Spell EXP Gain"})),L(()=>({multiplier:zn,description:"Schol\u0113 potency"})),L(()=>({multiplier:2,description:"Schol\u0113 skill (flat)",enabled:fe.treeNodes.moreMassXpSpellXp.bought}))]),Ut=ne(()=>[yt(()=>({addend:()=>l.times(zn.value,1),description:"Schol\u0113 potency"})),Wi(()=>({exponent:.9,description:"(softcapped)"}))]),Kt=ne(()=>[L(()=>({multiplier:()=>{var te;return l.pow(1/1.05,(te=fe.level.value)!=null?te:0)},description:"Pr\u014Dfici\u014D skill (/1.05 per Schol\u0113 level)",enabled:z.treeNodes.slowerDischargeByLevel.bought}))]),$t=w(()=>Kt.apply(Lt.value)),_n={timePassing:wt,chargeMult:Y,allSpellPotency:Ve,allSpellXpGain:Ue,xpSpellPotency:vt,xpSpellXp:at,jobXpGain:x,jobXpDischargeRate:A,flowerSpellPotency:ke,flowerSpellXp:Xe,flowerGain:Nt,flowerPassiveGain:zt,flowerDischargeRate:Qe,chargeSpellPotency:Ie,chargeSpellXp:Q,chargeCap:ft,chargeRate:sn,baseDischargeRate:Qt,massXpSpellPotency:fn,massXpSpellXp:Zt,massXpGain:Ut,massXpDischargeRate:Kt},[I,de]=Ht(()=>[{title:"Time Passing",modifier:wt,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||Le.milestones.timeBatteriesMilestone.earned.value},{title:"Harvesting Flowers EXP Gain",subtitle:"When T\xE9chnasma is active",modifier:x,base:0,unit:"/sec"},{title:"All Spell Potency",modifier:Ve},{title:"All Spell EXP Gain",subtitle:"When the spell is active",modifier:Ue,unit:"/sec"},{title:"Flowers Gain",subtitle:"When Theriz\xF3 is active",modifier:Nt,base:0,unit:"/sec",visible:p.earned},{title:"Flowers Gain",subtitle:"When Theriz\xF3 is NOT active",modifier:zt,base:0,unit:"/sec",visible:()=>p.earned.value&&l.neq(zt.apply(0),0)}]),[Fe,qe]=Ht(()=>[{title:"T\xE9chnasma Potency",modifier:vt},{title:"T\xE9chnasma EXP Gain",subtitle:"When T\xE9chnasma is active",modifier:at,unit:"/sec"},{title:"Discharge Rate",subtitle:"When T\xE9chnasma is active",modifier:A,base:Lt,unit:"/sec",visible:f.earned}]),[dt,xt]=Ht(()=>[{title:"Theriz\xF3 Potency",modifier:ke},{title:"Theriz\xF3 EXP Gain",subtitle:"When Theriz\xF3 is active",modifier:Xe,base:.1,unit:"/sec"},{title:"Discharge Rate",subtitle:"When Theriz\xF3 is active",modifier:Qe,base:Lt,unit:"/sec",visible:f.earned}]),[Rt,vn]=Ht(()=>[{title:"Pr\u014Dfici\u014D Potency",modifier:Ie},{title:"Pr\u014Dfici\u014D EXP Gain",subtitle:"When Pr\u014Dfici\u014D is active",modifier:Q,base:.01,unit:"/sec"},{title:"Charge Multiplier",subtitle:"When a non-Pr\u014Dfici\u014D spell is active",modifier:Y,base:()=>l.log2(l.add(re.value,1)).add(1),unit:"x",baseText:k(()=>s(F,null,[m("Base (log"),s("sub",null,[m("2")]),m("(charge + 1) + 1)")]))},{title:"Charge Rate",subtitle:"When Pr\u014Dfici\u014D is active",modifier:sn,base:0,unit:"/sec"},{title:"Base Discharge Rate",subtitle:"When a non-Pr\u014Dfici\u014D spell is active",modifier:Qt,base:0,unit:"/sec"},{title:"Maximum Charge",modifier:ft,base:0}]),[En,ri]=Ht(()=>[{title:"Schol\u0113 Potency",modifier:fn},{title:"Schol\u0113 EXP Gain",subtitle:"When Schol\u0113 is active",modifier:Zt,base:.001,unit:"/sec"},{title:"Other Spell EXP Gain Efficiency",subtitle:"When Schol\u0113 is active",modifier:Ut,base:0,unit:"%"},{title:"Discharge Rate",subtitle:"When Schol\u0113 is active",modifier:Kt,base:Lt,unit:"/sec",visible:f.earned}]),Gn=$n({general:()=>({display:"General",glowColor(){return Gn.activeTab.value===this.tab?t:""},tab:I,generalTabCollapsed:de}),xpSpell:()=>({display:"T\xE9chnasma",glowColor(){return Gn.activeTab.value===this.tab?t:""},tab:Fe,xpSpellTabCollapsed:qe}),flowerSpell:()=>({display:"Theriz\xF3",visibility:p.earned,glowColor(){return Gn.activeTab.value===this.tab?t:""},tab:dt,flowerSpellTabCollapsed:xt}),chargeSpell:()=>({display:"Pr\u014Dfici\u014D",visibility:f.earned,glowColor(){return Gn.activeTab.value===this.tab?t:""},tab:Rt,chargeSpellTabCollapsed:vn}),massXpSpell:()=>({display:"Schol\u0113",visibility:h.earned,glowColor(){return Gn.activeTab.value===this.tab?t:""},tab:En,massXpSpellTabCollapsed:ri})},()=>({style:`--layer-color: ${t}`}));return this.on("update",te=>{if(!!a.active.value){if(te=l.times(te,kt.value).toNumber(),ae.active.value&&(a.xp.value=l.add(a.xp.value,l.times(x.apply(0),te)),c.earned.value&&(ae.xp.value=l.add(ae.xp.value,l.times(at.apply(1),te))),ae.castingTime.value+=te,re.value=l.max(l.sub(re.value,l.times(O.value,te)),0)),V.active.value)n.value=l.min(rt.chapter.value>1?l.dInf:1e7,l.add(n.value,l.times(Nt.apply(0),te))),c.earned.value&&(V.xp.value=l.add(V.xp.value,l.times(Xe.apply(.1),te))),V.castingTime.value+=te,re.value=l.max(l.sub(re.value,l.times(ue.value,te)),0);else{const jt=zt.apply(0);l.neq(jt,0)&&(n.value=l.min(rt.chapter.value>1?l.dInf:1e7,l.add(n.value,l.times(jt,te))))}if(z.active.value&&(z.xp.value=l.add(z.xp.value,l.times(Q.apply(.01),te)),z.castingTime.value+=te,re.value=l.min(l.add(re.value,l.times(Dt.value,te)),qt.value)),fe.active.value){const jt=l.div(Ut.apply(0),100);ae.xp.value=l.add(ae.xp.value,l.times(at.apply(jt),te)),V.xp.value=l.add(V.xp.value,l.times(Xe.apply(jt),te)),z.xp.value=l.add(z.xp.value,l.times(Q.apply(jt),te)),fe.xp.value=l.add(fe.xp.value,l.times(Zt.apply(.001),te)),fe.castingTime.value+=te,re.value=l.max(l.sub(re.value,l.times($t.value,te)),0)}}}),{name:e,color:t,minWidth:670,flowers:n,bestMoly:i,job:a,spells:Ne,modifiers:_n,milestones:y,collapseMilestones:C,chargeAmount:re,modifierTabs:Gn,display:k(()=>{const te=[...T.value];return W.value&&te.push(W.value),s(F,null,[cn(s(Ei,{resource:n,color:t,effectDisplay:`multiplying spell potency by x${ze(Be.value)}`},null),[[kn,p.earned.value]]),ni(...te,k(()=>cn(s(ai,{collapsed:C,content:le,display:C.value?"Show other completed milestones":"Hide other completed milestones"},null),[[kn,o(P)]]))),s($e,null,null),s("div",{style:"position: relative; z-index: 1"},[m("You can cast "),At(u.value),m(" spell"),u.value===1?"":"s",m(" at a time")]),gl(...Object.values(Ne).map(jt=>jt.selector)),f.earned.value?s($i,{style:"margin-top: 40px !important; margin-bottom: -20px;"},{default:()=>[ut(oe),s("span",{style:"margin-left: 10px"},[ze(lt.value),m("x")])]}):null,c.earned.value?Object.values(Ne).filter(jt=>jt.active.value).map(jt=>s(Kc,{spell:jt},null)):null,ut(d)])})}}),Rd={},jd={style:{"white-space":"nowrap","font-size":"larger","font-family":"initial"}},Bd=m(" \u230A\xA0"),Vd=m("\xA0\u230B ");function zd(e,t){return g(),$("span",jd,[Bd,Wt(e.$slots,"default"),Vd])}var Ql=me(Rd,[["render",zd]]);const Gd={},Ud={style:{"white-space":"nowrap"}},Xd=v("span",{style:{"font-size":"larger","font-family":"initial"}},"\u221A",-1),Hd={style:{display:"inline-block","border-top":"1px solid","padding-left":"0.2em"}};function Jd(e,t){return g(),$("span",Ud,[Xd,v("div",Hd,[Wt(e.$slots,"default")])])}var Wd=me(Gd,[["render",Jd]]);const Zl={gold:"\u2609",silver:"\u263D",mercury:"\u263F",copper:"\u2640",iron:"\u2642",tin:"\u2643",lead:"\u2644"},Qd=["leo","virgo","libra","scorpio","capricorn","pisces"],Zd=["aries","taurus","gemini","cancer","sagittarius","aquarius"],Ai={aries:"fire",taurus:"earth",gemini:"air",cancer:"water",leo:"fire",virgo:"earth",libra:"air",scorpio:"water",sagittarius:"fire",capricorn:"earth",aquarius:"air",pisces:"water"},Kd=Symbol("Card");function rn(e){const t=H(0),n=H(0);return pt(()=>{const i=e();i.id=pn("card-"),i.type=Kd,i[it]=Si,i.amount=t,i.level=n,i.startingAmount&&(t[mi]=t.value=i.startingAmount),i.display=k(()=>{var _;const f=i,h=he(typeof f.description=="function"?f.description(o(f.level)):o(f.description),"h3"),y=he((_=o(f.formula))!=null?_:"");return s(F,null,[s(h,null,null),s("div",{class:"metal"},[Zl[f.metal]]),f.formula?s("div",{class:"formula"},[s(y,null,null)]):null])});const a=he(i.display),r=Si,u=k(()=>{var _;const f=i,h=he(typeof f.description=="function"?f.description(l.add(o(f.level),1)):o(f.description),"h3"),y=he((_=o(f.formula))!=null?_:"");return s(F,null,[s(h,null,null),s("div",{class:"metal"},[Zl[f.metal]]),f.formula?s("div",{class:"formula"},[s(y,null,null)]):null])});i.renderForUpgrade=f=>s(r,Jt({id:`${i.id}-upg-${f}`},i[Ge](),{display:f?u:a,class:"big",canClick:!1}),null),i.renderForDeck={[it]:r,[Ge]:()=>({id:`${i.id}-deck`,...i[Ge](),display:k(()=>s(F,null,[s(a,null,null),s("div",{class:"badge amount"},[i.amount.value]),i.showNotif.value?s(Nn,{style:"left: 20px; top: -20px"},null):null])),onClick:i.onSelect})};const d=k(()=>s(F,null,[s(a,null,null),i.amount.value===0?s("div",{class:"badge new"},[m("NEW!")]):null]));i.renderForShop=k(()=>{const f=i;return f.price==null?s(r,Jt({id:`${i.id}-shop`},f[Ge](),{class:{shop:!0,hidden:!0},canClick:!1}),null):s(r,Jt({id:`${i.id}-shop`},f[Ge](),{class:{shop:!0},display:d,canClick:!1}),null)});const c=X(!0);let p=-1;return i.renderForPlay=f=>{const h=i,y=Si;return f.value!==p&&(c.value=!1,requestAnimationFrame(()=>c.value=!0),p=f.value),s(y,Jt({id:`${i.id}-play`},h[Ge](),{class:{big:!0,playing:!0,flipping:c.value},canClick:!1}),null)},q(i,"description"),nt(i,"actions",{}),q(i,"formula"),i.showNotif=Mi(i.renderForDeck,i.shouldNotify.bind(i)),i[Ge]=function(){const{id:f,display:h,sign:y}=this;return{id:f,display:h,visibility:Re.Visible,classes:{card:!0,dontMerge:!0,solar:Qd.includes(y),lunar:Zd.includes(y)},canClick:!0}},i})}function qa(e,t){return q(t,"display"),q(t,"classes"),q(t,"style"),q(t,"direction"),nt(t,"direction",xe.Up),q(t,"xoffset"),q(t,"yoffset"),t.pinnable&&(t.pinned=H(!1,!1)),en(()=>{t.pinnable&&("pinned"in e?(console.error("Cannot add pinnable tooltip to element that already has a property called 'pinned'"),t.pinnable=!1,Sr(t.pinned)):e.pinned=t.pinned);const n=e[it];e[it]=st;const i=e[Ge].bind(e);e[Ge]=function(){const{display:r,classes:u,style:d,direction:c,xoffset:p,yoffset:f,pinned:h}=this;return{element:{[it]:n,[Ge]:i},display:r,classes:u,style:o(d),direction:c,xoffset:p,yoffset:f,pinned:h}}.bind(t)}),t}const Yd=Symbol("Repeatable");function Da(e){const t=H(0);return pt(()=>{var c;const n=e();n.id=pn("repeatable-"),n.type=Yd,n[it]=Si,n.amount=t,n.amount[mi]=(c=n.initialAmount)!=null?c:0;const i={requirementMet:w(()=>l.sub(o(n.limit),n.amount.value)),requiresPay:!1,visibility:Re.None},a=Tl(n);yn(n.requirements)?(n.requirements.unshift(a),n.requirements.push(i)):n.requirements=[a,n.requirements,i],n.maxed=w(()=>l.gte(n.amount.value,o(n.limit))),q(n,"classes");const r=n.classes;n.classes=w(()=>{const p=o(r)||{};return n.maxed.value&&(p.bought=!0),p}),n.amountToIncrease=w(()=>o(n.maximize)?Pa(n.requirements):1),n.canClick=w(()=>tl(n.requirements));const u=n.onClick;n.onClick=function(p){const f=n;!o(f.canClick)||(Ta(n.requirements,o(n.amountToIncrease)),f.amount.value=l.add(f.amount.value,1),u==null||u(p))},q(n,"display");const d=n.display;return n.display=k(()=>{var f,h,y;const p=o(d);if(mn(p)){const _=he(p);return s(_,null,null)}if(p!=null){const _=n,C=he((f=p.title)!=null?f:"","h3"),T=he((h=p.description)!=null?h:""),W=he((y=p.effectDisplay)!=null?y:"");return s("span",null,[p.title==null?null:s("div",null,[s(C,null,null)]),p.description==null?null:s(T,null,null),p.showAmount===!1?null:s("div",null,[s("br",null,null),o(_.limit)===l.dInf?s(F,null,[m("Amount: "),ge(_.amount.value)]):s(F,null,[m("Amount: "),ge(_.amount.value),m(" /")," ",ge(o(_.limit))])]),p.effectDisplay==null?null:s("div",null,[s("br",null,null),m("Currently: "),s(W,null,null)]),_.maxed.value?null:s("div",null,[s("br",null,null),nl(_.requirements,o(n.amountToIncrease))])])}return""}),q(n,"visibility"),nt(n,"visibility",Re.Visible),q(n,"limit"),nt(n,"limit",l.dInf),q(n,"style"),q(n,"mark"),q(n,"small"),q(n,"maximize"),n[Ge]=function(){const{display:p,visibility:f,style:h,classes:y,onClick:_,canClick:C,small:T,mark:W,id:le}=this;return{display:p,visibility:f,style:o(h),classes:y,onClick:_,canClick:C,small:T,mark:W,id:le}},n})}const ep=!1,tp=!0,np={min:2,max:1.8},ip=.1,lp=-1,ap=1e3,sp=!0,rp={x:.5,y:.5},op=[{type:"alpha",config:{alpha:{list:[{time:0,value:0},{time:.2,value:.4},{time:1,value:0}]}}},{type:"moveSpeedStatic",config:{min:10,max:10}},{type:"scale",config:{scale:{list:[{time:0,value:.5},{time:1,value:.1}]},minMult:1}},{type:"rotationStatic",config:{min:0,max:360}},{type:"blendMode",config:{blendMode:"screen"}},{type:"textureRandom",config:{textures:["/smokeparticle.png","/particle.png"]}},{type:"spawnShape",config:{type:"torus",data:{x:0,y:12.5,radius:25,innerRadius:0,affectRotation:!1}}}];var Kl={emit:ep,autoUpdate:tp,lifetime:np,frequency:ip,emitterLifetime:lp,maxParticles:ap,addAtBack:sp,pos:rp,behaviors:op},up=["Now we're cooking","Alchemy's always been more of a philosophical experience for me","Transform!","The elements transform you just as much as you transform them","You cannot step twice into the same stream","Sometimes I wonder if there may be dozens of elements","Could I mix two elements to create something new? No, that wouldn't make sense","There is no intelligence where there is no need of change.","But what good is time without change?","Elements? I love elements!"];const cp=w(()=>rt.chapter.value>1);function Oi(e,t){return Object.assign({},Kl,{behaviors:[...Kl.behaviors,{type:"color",config:{color:{list:[{time:0,value:e},{time:1,value:t}]}}}]})}const pl="distill",Ke=Tn(pl,function(){const e="Purifying Flowers",t="#267BD1",n=dn(0,"essentia"),i=el(n),a=w(()=>Object.values(Te).some(Y=>{var lt;return o((lt=Y.showNotif)==null?void 0:lt.value)})),r=Vn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"25%",y:"60%"},symbol:"\u{1F76D}",randomQuips(){return[...up,...si]},resource:n,layerID:pl,modifierInfo:k(()=>ut(kt)),visibility:cp,showNotif:a})),u=we(()=>({requirements:be(()=>l.gte(r.rawLevel.value,2)),display:{requirement:`Achieve ${r.name} Level 2`,effectDisplay:"Unlock Water"}})),d=we(()=>({requirements:be(()=>l.gte(r.rawLevel.value,4)),display:{requirement:`Achieve ${r.name} Level 4`,effectDisplay:"Unlock Principles"},visibility:u.earned})),c=we(()=>({requirements:be(()=>l.gte(r.rawLevel.value,5)),display:{requirement:`Achieve ${r.name} Level 5`,effectDisplay:`Unlock "${bn.job.name}" Job`},visibility:d.earned,onComplete(){wn(bn,G)}})),p=we(()=>({requirements:be(()=>l.gte(r.rawLevel.value,6)),display:{requirement:`Achieve ${r.name} Level 6`,effectDisplay:"Unlock Air"},visibility:c.earned})),f=we(()=>({requirements:be(()=>l.gte(r.rawLevel.value,8)),display:{requirement:`Achieve ${r.name} Level 8`,effectDisplay:"Unlock Fire"},visibility:p.earned})),h=we(()=>({requirements:be(()=>l.gte(r.rawLevel.value,10)),display:{requirement:`Achieve ${r.name} Level 10`,effectDisplay:`Unlock "${Ce.job.name}" Job`},visibility:f.earned,onComplete(){wn(Ce,G)}})),y={waterMilestone:u,principlesMilestone:d,studyMilestone:c,airMilestone:p,fireMilestone:f,experimentsMilestone:h},_=[h,f,p,c,d,u],C=H(!0),T=w(()=>_.filter(Y=>Y.earned.value===!1)),{firstFeature:W,collapsedContent:le,hasCollapsedContent:P}=ii(_,Y=>Y.earned.value),M=Yi(()=>({fullscreen:!1,zIndex:-1,boundingRect:X(void 0),onContainerResized(Y){this.boundingRect.value=Y},onHotReload(){Object.values(Te).forEach(Y=>Y.refreshParticleEffect())}})),Z=w(()=>l.pow(1.1,r.level.value));function re(Y,lt,Ve=""){const We=H(0),Ue=dn(0,Y+" essence",2);let ce=[];const[vt,_t]=Ht(()=>ce);let at=null,x=null;const A=ne(()=>[yt(()=>({addend:()=>{var O;return l.times((O=at==null?void 0:at.amount.value)!=null?O:0,5)},description:k(()=>s(F,null,[on(Ve),m(" effect (5 x "),Ve,m(" amount)")]))}))]);return Ve&&(at=Da(()=>{const O=E.variable(at.amount).pow_base(10);return{display:k(()=>s("div",null,[m("Prepare "),Ve,m(" to gain a portion of "),Y,m(" whenever the above instrument is active"),s("br",null,null),m("("),ge(A.apply(0)),m("%)"),s("br",null,null),s("br",null,null),m("Cost: "),Sn(Ue,o(O.evaluate()))," ",Ue.displayName,x!=null&&x.value?s(Nn,{style:"top: -25px"},null):null])),visibility:d.earned,requirements:Ma(()=>({resource:Ue,cost:O}))}}),x=Mi(at,at.canClick)),pt(()=>{const O=Object.assign({principle:"",prevElement:null,visible:!0},lt()),ke=et(O.visible),ie=ne(()=>[]),Xe=w(()=>ie.apply(l.times(De.flowers.value,We.value).div(100).floor())),Nt=ne(()=>[L(()=>({multiplier:()=>l.div(We.value,100)})),L(()=>({multiplier:Z,description:`${r.name} level (x1.1 each)`})),Le.batteries.distill.resourceGain.modifier,...O.modifiers()]),gt=w(()=>{var Ee,Q;return l.add(Nt.apply(l.gt(Xe.value,0)?l.div(Xe.value,100).ceil().log(10):0),l.times((Q=(Ee=O.prevElement)==null?void 0:Ee.actualGain.value)!=null?Q:0,A.apply(0)).div(100))});ce=[{title:"Flowers Loss",modifier:ie,base:()=>l.times(De.flowers.value,We.value).div(100).floor(),baseText:k(()=>s(F,null,[m("Base (\u230Aflowers x conversion amount\u230B)")])),unit:"/sec"},{title:`${on(Y)} Essence Gain`,subtitle:"When cost is non-zero",modifier:Nt,base:()=>l.gt(Xe.value,0)?l.div(Xe.value,100).ceil().log(10):0,baseText:k(()=>s(F,null,[m("Base (log"),s("sub",null,[m("10")]),m("(flowers loss))")])),unit:"/sec"}],at&&O.prevElement&&ce.push({title:`${on(Y)} Essence Gain`,subtitle:`% of ${on(O.prevElement.name)} essence gain`,modifier:A,base:0,unit:"%"});const zt=k(()=>o(ke)?s("div",{class:"element-display",style:"color: "+O.color},[s(st,{display:on(Y)},{default:()=>[s("div",{class:"element-logo"},[O.symbol,s(Bn,{id:Y},null)])]}),s("div",{class:"element-amount"},[ge(Ue.value)])]):""),Qe=X(M.addEmitter(O.particlesConfig)),ue=async([Ee,Q,ft])=>{const qt=await Qe.value;qt.emit=Ee&&Q!=null&&ft!=null,Ee&&Q&&ft&&!qt.destroyed&&(qt.cleanup(),qt.updateOwnerPos(Q.x+Q.width/2-ft.x,Q.y+Q.height/2-ft.y),qt.resetPositionTracking())},Ie=()=>{Qe.value.then(Ee=>Ee.destroy()).then(()=>Qe.value=M.addEmitter(O.particlesConfig)).then(()=>{var Ee;return ue([l.gt(gt.value,0),(Ee=Ke.nodes.value[Y])==null?void 0:Ee.rect,M.boundingRect.value])})};return en(()=>tt([()=>l.gt(gt.value,0),()=>{var Ee;return(Ee=Ke.nodes.value[Y])==null?void 0:Ee.rect},M.boundingRect],ue)),{name:Y,...O,resource:Ue,conversionAmount:We,cost:ie,computedCost:Xe,gain:Nt,actualGain:gt,tab:vt,tabCollapsed:_t,display:zt,showNotif:x,visible:ke,principleClickable:at,particlesEmitter:Qe,refreshParticleEffect:Ie}})}const oe=re("earth",()=>({symbol:"\u{1F703}",color:"green",particlesConfig:Oi("#B6FF0D","#59E80C"),modifiers:()=>[Ct.plants.earthEssence.modifier]})),B=re("water",()=>({symbol:"\u{1F704}",color:"blue",particlesConfig:Oi("#0D8CFF","#0C46E8"),modifiers:()=>[Ct.plants.waterEssence.modifier],prevElement:oe,visible:u.earned}),"salt"),J=re("air",()=>({symbol:"\u{1F701}",color:"yellow",particlesConfig:Oi("#FFCE0D","#E8D20C"),modifiers:()=>[Ct.plants.airEssence.modifier],prevElement:B,visible:p.earned}),"mercury"),je=re("fire",()=>({symbol:"\u{1F702}",color:"red",particlesConfig:Oi("#FF530D","#E82C0C"),modifiers:()=>[Ct.plants.fireEssence.modifier],prevElement:J,visible:f.earned}),"sulfur"),Te={earth:oe,water:B,air:J,fire:je};function Se(Y,lt,Ve){const We=k(()=>o(Y.visible)?s("div",null,[s("div",{class:{instrument:!0,principled:Y.principleClickable&&ht(Y.principleClickable.visibility)},style:`--progress: ${Y.conversionAmount.value/100}; --foreground: ${Y.color}`},[s("div",{style:"width: 100%; display: flex"},[s("span",{class:"instrument-logo"},[Ve]),s("span",{class:"instrument-details"},[s("div",null,[on(lt)]),s("div",null,[m("-"),Sn(De.flowers,Y.computedCost.value)," ",De.flowers.displayName,m("/sec")]),s("div",null,[m("+"),Sn(Y.resource,Y.actualGain.value)," ",Y.resource.displayName,m("/sec")]),s(Fa,{max:Object.values(Be).filter(Ue=>Ue.name!==lt).reduce((Ue,ce)=>Ue-ce.element.conversionAmount.value,100),modelValue:Y.conversionAmount.value,"onUpdate:modelValue":Ue=>Y.conversionAmount.value=Ue},null)])])]),Y.principleClickable?ut(Y.principleClickable):null]):"");return{name:lt,symbol:Ve,element:Y,display:We}}const Je=Se(oe,"alembic","\u{1F76A}"),ae=Se(B,"retort","\u{1F76D}"),Tt=Se(J,"crucible","\u{1F767}"),mt=Se(je,"bainMarie","\u{1F76B}"),Be={retort:ae,alembic:Je,crucible:Tt,bainMarie:mt},ye=ne(()=>[L(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===pl})),Le.batteries.distill.timePassing.modifier]),V=w(()=>ye.apply(1)),z=ne(()=>[L(()=>({multiplier:()=>l.max(1,oe.resource.value),description:"Earth Essence"})),L(()=>({multiplier:()=>l.max(1,B.resource.value),description:"Water Essence"})),L(()=>({multiplier:()=>l.max(1,J.resource.value),description:"Air Essence"})),L(()=>({multiplier:()=>l.max(1,je.resource.value),description:"Fire Essence"})),Le.batteries.distill.xpGain.modifier]),pe=ne(()=>[yt(()=>({addend:oe.computedCost,description:"Alembic"})),yt(()=>({addend:B.computedCost,description:"Retort"})),yt(()=>({addend:J.computedCost,description:"Crucible"})),yt(()=>({addend:je.computedCost,description:"Bain-Marie"}))]),fe={timePassing:ye,jobXp:z,totalFlowerLoss:pe},[Ne,wt]=Ht(()=>[{title:"Time Passing",modifier:ye,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||Le.milestones.timeBatteriesMilestone.earned.value},{title:"Essentia",subtitle:`Also ${r.name} EXP Amount`,modifier:z,base:1},{title:"Flowers Loss",modifier:pe,base:0,unit:"/sec"}]),kt=$n({general:()=>({display:"General",glowColor(){return kt.activeTab.value===this.tab?t:""},tab:Ne,generalTabCollapsed:wt}),...Object.entries(Te).reduce((Y,[lt,Ve])=>({...Y,[lt]:()=>({display:on(Ve.name),glowColor(){return kt.activeTab.value===this.tab?t:""},tab:Ve.tab,tabCollapsed:Ve.tabCollapsed})}),{})});return this.on("preUpdate",Y=>{if(n.value=Object.values(Te).reduce((Ve,We)=>Ve.times(l.max(1,We.resource.value)),new l(1)),l.gt(n.value,r.xp.value)&&(r.xp.value=n.value),!r.active.value)return;Y=l.times(Y,V.value).toNumber();const lt=pe.apply(0);Object.values(Te).forEach(Ve=>{Ve.resource.value=l.add(Ve.resource.value,l.times(Ve.actualGain.value,Y))}),De.flowers.value=l.sub(De.flowers.value,lt).max(0)}),{name:e,color:t,minWidth:670,essentia:n,bestEssentia:i,elements:Te,instruments:Be,job:r,milestones:y,modifiers:fe,modifierTabs:kt,collapseMilestones:C,display:k(()=>{const Y=[...T.value];return W.value&&Y.push(W.value),s(F,null,[s(Ei,{resource:n,color:t},null),ni(...Y,k(()=>cn(s(ai,{collapsed:C,content:le,display:C.value?"Show other completed milestones":"Hide other completed milestones"},null),[[kn,o(P)]]))),gl(oe.display,B.display,J.display,je.display),s($e,null,null),gl(Je.display,ae.display,Tt.display,mt.display),Ye(M)])})}});var dp=["I've always had an affinity for lead","When I'm near lead I feel in my element","Sometimes I wonder if there may be more planets","I have to believe in the heart of the cards","My deck has no bad cards","Honestly, cards are pretty abstract","Cards? I love cards!"];const pp={min:.5,max:1},mp=[{s:0,cp:.329,e:.548},{s:.548,cp:.767,e:.876},{s:.876,cp:.985,e:1}],fp=.001,vp=.1,gp=100,hp=!0,bp={x:0,y:0},yp=!1,wp=[{type:"alpha",config:{alpha:{list:[{time:0,value:.74},{time:1,value:0}]}}},{type:"moveSpeed",config:{speed:{list:[{time:0,value:700},{time:1,value:0}]},minMult:1}},{type:"scale",config:{scale:{list:[{time:0,value:5},{time:1,value:1.2}]},minMult:1}},{type:"color",config:{color:{list:[{time:0,value:"#ffdfa0"},{time:1,value:"#100f0c"}]}}},{type:"rotation",config:{accel:0,minSpeed:0,maxSpeed:200,minStart:0,maxStart:360}},{type:"textureRandom",config:{textures:["/particle.png"]}},{type:"spawnShape",config:{type:"rect",data:{x:-300,y:-125,w:600,h:250}}}];var _p={lifetime:pp,ease:mp,frequency:fp,emitterLifetime:vp,maxParticles:gp,addAtBack:hp,pos:bp,emit:yp,behaviors:wp};const ui=vi(),ml="study",bn=Tn(ml,function(){const e="Studying",t="#D16726",n=dn(0,"properties"),i=dn(0,"insights"),a=el(i),r=H(0),u=H(0),d=w(()=>f.earned.value&&Object.values(Q).some(I=>I.showNotif.value)),c=Vn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"25%",y:"20%"},symbol:"\u{1F56E}",randomQuips(){return[...dp,...si]},resource:n,layerID:ml,modifierInfo:k(()=>ut(lt)),visibility:Ke.milestones.studyMilestone.earned,showNotif:d})),p=we(()=>({requirements:be(()=>l.gte(c.rawLevel.value,2)),display:{requirement:`Achieve ${c.name} Level 2`,effectDisplay:"Unlock drawing cards manually"}})),f=we(()=>({requirements:be(()=>l.gte(c.rawLevel.value,4)),display:{requirement:`Achieve ${c.name} Level 4`,effectDisplay:"Unlock purchasing and selling cards"},visibility:p.earned})),h=we(()=>({requirements:be(()=>l.gte(c.rawLevel.value,5)),display:{requirement:`Achieve ${c.name} Level 5`,effectDisplay:"Unlock a time slot"},visibility:f.earned})),y=we(()=>({requirements:be(()=>l.gte(c.rawLevel.value,6)),display:{requirement:`Achieve ${c.name} Level 6`,effectDisplay:"Unlock optimizations"},visibility:h.earned})),_=we(()=>({requirements:be(()=>l.gte(c.rawLevel.value,8)),display:{requirement:`Achieve ${c.name} Level 8`,effectDisplay:"Unlock upgrading cards"},visibility:y.earned})),C=we(()=>({requirements:be(()=>l.gte(c.rawLevel.value,10)),display:{requirement:`Achieve ${c.name} Level 10`,effectDisplay:`Unlock "${Ct.job.name}" Job`},visibility:_.earned,onComplete(){wn(Ct,G)}})),T={manualMilestone:p,shopMilestone:f,timeSlotMilestone:h,optimizationsMilestone:y,upgradingMilestone:_,jobMilestone:C},W=[C,_,y,h,f,p],le=H(!0),P=w(()=>W.filter(I=>I.earned.value===!1)),{firstFeature:M,collapsedContent:Z,hasCollapsedContent:re}=ii(W,I=>I.earned.value),oe=w(()=>y.earned.value?l.pow(1.1,l.max(De.bestMoly.value,1).log10().floor()):1);let B=null;tt(()=>ge(l.times(oe.value,100).sub(100)),I=>{Ae.active===G.id&&(B!=null&&ui.dismiss(B),B=ui.info(s(F,null,[s("h3",null,[m("Experience Optimized!")]),s("div",null,[m("Experience optimization is now "),I,m("%")])])))});const J=Vi(()=>({direction:xe.Right,width:500,height:25,progress:()=>l.sub(1,l.add(De.bestMoly.value,1).log10().ceil().sub(l.max(De.bestMoly.value,1).log10())),display:k(()=>s(F,null,[ze(De.bestMoly.value),m(" best moly")])),borderStyle:{borderColor:De.color,color:"#FFF"},fillStyle:{backgroundColor:De.color}})),je=w(()=>y.earned.value?l.pow(1.1,l.max(Ke.bestEssentia.value,1).log10().floor()):1);let Te=null;tt(()=>ge(l.times(je.value,100).sub(100)),I=>{Ae.active===G.id&&(Te!=null&&ui.dismiss(Te),Te=ui.info(s(F,null,[s("h3",null,[c.name,m(" Optimized!")]),s("div",null,[c.name,m(" optimization is now "),I,m("%")])])))});const Se=Vi(()=>({direction:xe.Right,width:500,height:25,progress:()=>l.sub(1,l.add(Ke.bestEssentia.value,1).log10().ceil().sub(l.max(Ke.bestEssentia.value,1).log10())),display:k(()=>s(F,null,[ze(Ke.bestEssentia.value),m(" best essentia")])),borderStyle:{borderColor:Ke.color,color:"#FFF"},fillStyle:{backgroundColor:Ke.color}})),Je=w(()=>y.earned.value?l.pow(1.1,l.max(a.value,1).log10().floor()):1);let ae=null;tt(()=>ge(l.times(Je.value,100).sub(100)),I=>{Ae.active===G.id&&(ae!=null&&ui.dismiss(ae),ae=ui.info(s(F,null,[s("h3",null,[m("Draw Time Optimized!")]),s("div",null,[m("Draw time optimization is now "),I,m("%")])])))});const Tt=Vi(()=>({direction:xe.Right,width:500,height:25,progress:()=>l.sub(1,l.add(a.value,1).log10().ceil().sub(l.max(a.value,1).log10())),display:k(()=>s(F,null,[ze(a.value),m(" best insights")])),borderStyle:{borderColor:t,color:"#FFF"},fillStyle:{backgroundColor:t}})),mt=w(()=>l.pow(1.1,c.level.value)),Be=ne(()=>[L(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===ml})),Le.batteries.study.timePassing.modifier]),ye=w(()=>Be.apply(1)),V=ne(()=>[L(()=>({multiplier:mt,description:`${c.name} level (x1.1 each)`})),L(()=>({multiplier:je,description:`${c.name} optimization`,enabled:y.earned})),Le.batteries.study.resourceGain.modifier,Ct.plants.properties.modifier]),z=w(()=>V.apply(10)),pe=ne(()=>[L(()=>({multiplier:()=>l.times(.01,u.value).add(1),description:"Drawn cards (+.01x each)"})),L(()=>({multiplier:oe,description:"Experience optimization",enabled:y.earned})),Le.batteries.study.xpGain.modifier]),fe=ne(()=>[L(()=>({multiplier:()=>l.div(1,Je.value),description:"Draw speed optimization",enabled:y.earned})),L(()=>({multiplier:.5,description:"Faster draw card",enabled:()=>gt.value>0}))]),Ne=w(()=>fe.apply(10)),wt=ne(()=>[L(()=>({multiplier:.5,description:"Manual bonus"}))]),kt=w(()=>wt.apply(Ne.value)),Y={timePassing:Be,propertiesGain:V,jobXpGain:pe,drawTime:fe,manualDrawTime:wt},[lt,Ve]=Ht(()=>[{title:"Time Passing",modifier:Be,base:1,visible:()=>Ce.milestones.appliedTimeMilestone.earned.value||Le.milestones.timeBatteriesMilestone.earned.value},{title:"Properties Gain",modifier:V,base:10},{title:`${c.name} EXP Gain`,modifier:pe,base:1,baseText:"Base (per property gained)"},{title:"Automatic Card Draw",modifier:fe,base:10,unit:"s"},{title:"Manual Card Draw",modifier:wt,base:Ne,unit:"s"}]),We=Yi(()=>({fullscreen:!1,zIndex:-1,boundingRect:X(null),onContainerResized(I){this.boundingRect.value=I}})),Ue=w(()=>Object.values(Q).reduce((I,de)=>I+de.amount.value,0)),ce=H(""),vt=H(["","",""]),_t=H("nothing"),at=X(0),x=rn(()=>({description:"Do nothing.",metal:"mercury",sign:"gemini",startingAmount:4,onSelect:()=>ce.value="nothing",shouldNotify:function(){return $t(this)}})),A=rn(()=>({description:I=>k(()=>s("h3",null,[m("Record")," ",It(ge(l.times(z.value,l.add(I,1))))," ",m("properties and job exp.")])),metal:"gold",sign:"leo",actions:{onPlay:I=>{const de=l.times(z.value,l.add(I,1));n.value=l.add(n.value,de),c.xp.value=l.add(c.xp.value,pe.apply(de))}},formula:k(()=>It("properties gain x level")),price:1,startingAmount:4,onSelect:()=>ce.value="gainPoints",shouldNotify:function(){return $t(this)}})),O=rn(()=>({description:I=>k(()=>s("h3",null,[m("Record")," ",It(ge(l.times(z.value,l.add(I,1)).times(10).pow(1.2)))," ",m("properties and job exp. Destroy this card.")])),metal:"tin",sign:"sagittarius",actions:{onPlay:(I,de)=>{const Fe=l.times(z.value,l.add(I,1)).times(10).pow(1.2);n.value=l.add(n.value,Fe),c.xp.value=l.add(c.xp.value,pe.apply(Fe)),de||(O.amount.value=Math.max(O.amount.value-1,0),O.amount.value<=0&&ce.value==="gainBigPoints"&&(ce.value=""))}},formula:k(()=>s("span",{style:"color: var(--accent2)"},[m("(properties gain x 10 x level)"),s("sup",null,[m("1.2")])])),price:8,onSelect:()=>ce.value="gainBigPoints",shouldNotify:function(){return $t(this)}})),ke=rn(()=>({description:I=>l.eq(I,0)?k(()=>s("h3",null,[m("Gain "),It("1"),m(" key insight.")])):k(()=>s("h3",null,[m("Gain "),It(ge(l.add(I,1))),m(" key insights.")])),metal:"copper",sign:"libra",actions:{onPlay:I=>{i.value=l.add(i.value,I).add(1)}},formula:k(()=>It("level")),price:0,startingAmount:2,onSelect:()=>ce.value="gainInsight",shouldNotify:function(){return $t(this)}})),ie=rn(()=>({description:I=>k(()=>s("h3",null,[m("Use the size of your deck to gain")," ",It(ge(l.times(Ue.value,l.add(I,1))))," ",m("key insights.")])),metal:"silver",sign:"cancer",actions:{onPlay:I=>{const de=l.times(Ue.value,l.add(I,1));i.value=l.add(i.value,de)}},formula:k(()=>s("span",{style:"color: var(--accent2)"},[m("cards x level")])),price:13,onSelect:()=>ce.value="gainBigInsight",shouldNotify:function(){return $t(this)}})),Xe=rn(()=>({description:I=>l.eq(I,0)?"Play the next card an extra time (does not stack)":k(()=>s("h3",null,[m("Play the next card an extra time, with")," ",It(ze(l.div(I,4))),m(" bonus levels (does not stack)")])),metal:"iron",sign:"scorpio",actions:{onNextCardPlay:I=>{const de=I.actions.onPlay;return de&&de(l.add(I.level.value,l.div(Xe.level.value,4)),!0),u.value++,!0}},formula:k(()=>It("(level - 1) / 4")),price:32,onSelect:()=>ce.value="playTwice",shouldNotify:function(){return $t(this)}})),Nt=rn(()=>({description:I=>k(()=>s("h3",null,[m("Gain xp equal to "),It(ze(l.div(l.add(I,1),10),1)),m("x times your number of properties.")])),metal:"tin",sign:"pisces",actions:{onPlay:I=>{c.xp.value=l.add(c.xp.value,pe.apply(l.add(I,1).div(10).times(n.value)))}},formula:k(()=>It("properties x level / 10")),price:25,onSelect:()=>ce.value="gainXp",shouldNotify:function(){return $t(this)}})),gt=H(0),zt=rn(()=>({description:I=>k(()=>s("h3",null,[m("Drawing cards is 2x faster for the next")," ",It(ge(l.times(yl.value,l.add(I,1))))," ",m("seconds (doesn't stack)")])),metal:"mercury",sign:"virgo",actions:{onPlay:I=>gt.value=l.times(yl.value,l.add(I,1)).toNumber()},formula:k(()=>It("number of jobs x level")),price:48,onSelect:()=>ce.value="fasterDraws",shouldNotify:function(){return $t(this)}})),Qe=rn(()=>({description:I=>k(()=>s("h3",null,[m("Gain")," ",It(ge(Object.values(rt.jobs).reduce((de,Fe)=>de.add(Fe.level.value),new l(0)).sqrt().floor().times(l.add(I,1))))," ",m("of a random elemental essence")])),metal:"iron",sign:"aries",actions:{onPlay:I=>{const de=Object.values(Ke.elements).filter(qe=>o(qe.visible)),Fe=de[Math.floor(Math.random()*de.length)];Fe.resource.value=l.add(Fe.resource.value,rt.sumJobLevels.value.times(l.add(I,1).sqrt().floor()))}},formula:k(()=>s("span",{style:"color: var(--accent2)"},[s(Ql,null,{default:()=>[s(Wd,null,{default:()=>[m("sum job levels")]})]})," ",m("x level")])),price:16,onSelect:()=>ce.value="gainElementalEssence",shouldNotify:function(){return $t(this)}})),ue=rn(()=>({description:I=>k(()=>s("h3",null,[m("Gain")," ",It(ge(l.times(Object.values(rt.jobs).reduce((de,Fe)=>de.add(Fe.level.value),new l(0)),l.add(I,1)).floor()))," ",m("key insights")])),metal:"lead",sign:"capricorn",actions:{onPlay:I=>{const de=l.times(Object.values(rt.jobs).reduce((Fe,qe)=>Fe.add(qe.level.value),new l(0)),l.add(I,1)).floor();i.value=l.add(i.value,de)}},formula:k(()=>s("span",{style:"color: var(--accent2)"},[m("sum job levels x level")])),price:14,onSelect:()=>ce.value="gainInsightFromJobs",shouldNotify:function(){return $t(this)}})),Ie=rn(()=>({description:I=>k(()=>s("h3",null,[m("Gain "),It(ge(l.add(I,1).times(5))),m("s of moly production")])),metal:"lead",sign:"aquarius",actions:{onPlay:I=>{De.flowers.value=l.add(De.flowers.value,l.times(De.modifiers.flowerGain.apply(0),l.add(1,I).times(5)))}},formula:k(()=>It("5 x level")),price:9,onSelect:()=>ce.value="gainMolyFromEssentia",shouldNotify:function(){return $t(this)}})),Ee=rn(()=>({description:I=>k(()=>s("h3",null,[m("Convert half your moly into")," ",It(ge(l.div(De.flowers.value,2).max(1).ln().floor().times(l.add(1,I)).times(z.value)))," ",m("properties and job exp")])),metal:"copper",sign:"taurus",actions:{onPlay:I=>{const de=l.div(De.flowers.value,2).max(1).ln().floor().times(l.add(1,I)).times(z.value);De.flowers.value=l.div(De.flowers.value,2).floor(),n.value=l.add(n.value,de),c.xp.value=l.add(c.xp.value,pe.apply(de))}},formula:k(()=>s("span",{style:"color: var(--accent2)"},[m("properties gain x "),s(Ql,null,{default:()=>[m("ln(spent moly)")]}),m(" x level")])),price:8,onSelect:()=>ce.value="gainPropertiesFromFlowers",shouldNotify:function(){return $t(this)}})),Q={nothing:x,gainPoints:A,gainBigPoints:O,gainInsight:ke,gainBigInsight:ie,playTwice:Xe,gainXp:Nt,fasterDraws:zt,gainElementalEssence:Qe,gainInsightFromJobs:ue,gainMolyFromEssentia:Ie,gainPropertiesFromFlowers:Ee},ft=w(()=>{if(ce.value in Q){const I=Q[ce.value];return new l(10).pow(l.add(I.level.value,2))}return 0}),qt=Ln(()=>({display:{title:"+1 Level",description:k(()=>{if(ce.value in Q){const I=Q[ce.value];return s(F,null,[m("Current level: "),ge(l.add(I.level.value,1)),s("br",null,null),ce.value==="nothing"?s("span",null,[m("Max level!")]):s("span",null,[m("Cost: "),ze(ft.value),m(" "),i.displayName])])}return""})},canClick(){return ce.value!=="nothing"&&ce.value in Q&&l.gte(i.value,ft.value)},onClick(){if(ce.value in Q){const I=Q[ce.value];i.value=l.sub(i.value,ft.value),I.level.value=l.add(I.level.value,1)}},style:{height:"120px",alignSelf:"center"}})),sn=w(()=>l.gte(r.value,kt.value)),Dt=Ln(()=>({display:{title:"Draw",description:k(()=>s(F,null,[s("div",null,[m("Focus harder in order to discover the next card faster.")]),sn.value?s("div",null,[m("Available Now!")]):s("div",null,[m("Available in")," ",Rn(l.sub(kt.value,r.value))])]))},canClick:sn,onClick:Kt,style:{minHeight:"50px",width:"200px"}})),Qt=H(0),Lt=w(()=>l.pow(2,Qt.value).times(100)),fn=Ln(()=>({display:{title:"Purge card",description:k(()=>s(F,null,[m("Remove card from deck"),s("br",null,null),m("Cost: "),ze(Lt.value),m(" "),i.displayName]))},canClick(){return l.gte(i.value,Lt.value)},async onClick(){var I;if(ce.value in Q){const de=Q[ce.value];i.value=l.sub(i.value,Lt.value),Qt.value++,de.amount.value--;const Fe=We.boundingRect.value,qe=(I=bn.nodes.value.deck)==null?void 0:I.rect;Fe&&qe&&(await en(),We.addEmitter(_p).then(dt=>{dt.updateOwnerPos(qe.x+qe.width/2-Fe.x,qe.y+qe.height/2-Fe.y),dt.playOnceAndDestroy()})),de.amount.value<=0&&(ce.value="")}},style:{"--layer-color":"var(--danger)",minHeight:"50px",width:"200px"}})),zn=new Array(3).fill(0).map((I,de)=>{const Fe=Ln(()=>({display:{title:"Purchase Card",description:k(()=>{const qe=vt.value[de];if(qe==="")return s(F,null,[m("Out of Stock!"),s("div",{class:"element-cost"},null)]);const dt=Q[qe],xt=Ai[dt.sign];return s(F,null,[ge(dt.price),m(" "),xt,m(" essence"),s("div",{class:"element-cost",style:{color:Ke.elements[xt].color}},[Ke.elements[xt].symbol])])})},canClick(){const qe=vt.value[de];if(qe==="")return!1;const dt=Q[qe],xt=Ai[dt.sign],Rt=Ke.elements[xt].resource;return l.gte(Rt.value,dt.price)},onClick(){const qe=vt.value[de];if(qe==="")return!1;const dt=Q[qe],xt=Ai[dt.sign],Rt=Ke.elements[xt].resource;dt.amount.value+=1,Rt.value=l.sub(Rt.value,dt.price),vt.value[de]=""},style:{width:"165px",margin:"20px 7.5px",minHeight:"50px",paddingLeft:"55px",borderTopLeftRadius:"25px",borderBottomLeftRadius:"25px"}}));return qa(Fe,{display:k(()=>{const qe=vt.value[de];if(qe==="")return s(F,null,null);const dt=Q[qe],xt=Ai[dt.sign],Rt=Ke.elements[xt].resource;return s(F,null,[m("You have "),Sn(Rt),m(" "),Rt.displayName])}),direction:xe.Down}),Fe}),Zt=H(0),Ut=w(()=>7);function Kt(){var Fe,qe,dt,xt,Rt;r.value=0,at.value++,Zt.value++,u.value++;const I=_t.value;let de=Math.floor(Math.random()*Ue.value);if(_t.value=Object.keys(Q).find(vn=>de<=Q[vn].amount.value?!0:(de-=Q[vn].amount.value,!1)),((dt=(qe=(Fe=Q[I].actions).onNextCardPlay)==null?void 0:qe.call(Fe,Q[_t.value],!1))==null||dt)&&((Rt=(xt=Q[_t.value].actions).onPlay)==null||Rt.call(xt,Q[_t.value].level.value,!1)),Zt.value>=Ut.value){Zt.value=0;const vn=Object.keys(Q).filter(En=>"price"in Q[En]);vt.value=new Array(3).fill(0).map(()=>vn[Math.floor(Math.random()*vn.length)])}}function $t(I){return f.earned.value&&I.amount.value>0&&l.gte(i.value,new l(10).pow(l.add(I.level.value,2)))}this.on("preUpdate",I=>{!c.active.value||(I=l.times(I,ye.value).toNumber(),r.value+=I,gt.value=Math.max(0,gt.value-I),l.gte(r.value,Ne.value)&&Kt())});const _n=$n({play:()=>({display:"Play",tab:On(()=>({display:k(()=>s(F,null,[s($e,null,null),Q[_t.value].renderForPlay(at),s($e,null,null),p.earned.value?ji(Dt):null,s($e,null,null),f.earned.value?s("div",null,[m("Shop will refresh in")," ",Ut.value-Zt.value,m(" draws")]):null,s("div",null,[m("Card will be drawn automatically in")," ",Rn(l.sub(Ne.value,r.value))])]))})),style:{borderLeft:"5px solid var(--outline)",marginLeft:"5px"}}),deck:()=>({display:k(()=>s("span",{style:"position: relative;"},[m("Cards"),d.value?s(Nn,{style:"left: -15px; top: -10px"},null):null])),tab:On(()=>({display:k(()=>{const I=Object.values(Q).filter(Fe=>Fe.amount.value>0),de=Math.ceil(I.length/5);return s(F,null,[s($e,null,null),f.earned.value?s(F,null,[s("h2",null,[m("Shop")]),s($e,null,null),vt.value.map(Fe=>Fe===""?Q.nothing.renderForShop():Q[Fe].renderForShop()),ji(...zn),s("div",null,[m("Shop will refresh in")," ",Ut.value-Zt.value," ",m("draws")]),s($e,{height:"50px"},null)]):null,s("h2",null,[m("Deck")]),s($e,null,null),s("div",{class:"cardDeck-container"},[s(Bn,{id:"deck"},null),...new Array(de).fill(0).map((Fe,qe)=>ji(...I.slice(qe*Math.ceil(I.length/de),(qe+1)*Math.ceil(I.length/de)).map(dt=>dt.renderForDeck)))]),s($e,null,null),ce.value?s(F,null,[_.earned.value?s("div",{style:"display: flex; justify-content: center;"},[Q[ce.value].renderForUpgrade(!1),s("div",{style:"display: flex; flex-direction: column; color: var(--layer-color); font-size: xxx-large; margin-left: -30px; margin-right: -30px"},[s("span",{style:"margin-bottom: 20px"},[m(">>>")]),Ye(qt),s("span",{style:"margin-top: 20px"},[m(">>>")])]),Q[ce.value].renderForUpgrade(!0)]):Q[ce.value].renderForUpgrade(!1),f.earned.value?Ye(fn):null]):null])})}))}),optimizations:()=>({display:"Optimizations",visibility:y.earned,tab:On(()=>({display:k(()=>s(F,null,[s($e,null,null),s("h2",null,[m("Experience Optimization")]),s("div",{style:"margin: 20px"},[m("The magnitude of your best moly amount has allowed you to optimize your exp gain by")," ",ge(l.times(oe.value,100).sub(100)),m("%."),s("br",null,null),m("Each additional order of magnitude gives a compounding 10% optimization.")]),Ye(J),s($e,{height:"50px"},null),s("h2",null,[c.name,m(" Optimization")]),s("div",{style:"margin: 20px"},[m("The magnitude of your best essentia amount has allowed you to optimize your properties gain by")," ",ge(l.times(je.value,100).sub(100)),m("%."),s("br",null,null),m("Each additional order of magnitude gives a compounding 10% optimization.")]),Ye(Se),s($e,{height:"50px"},null),s("h2",null,[m("Draw Speed Optimization")]),s("div",{style:"margin: 20px"},[m("The magnitude of your best insights amount has allowed you to optimize your drawing speed by")," ",ge(l.times(Je.value,100).sub(100)),m("%."),s("br",null,null),m("Each additional order of magnitude gives a compounding 10% optimization.")]),Ye(Tt)]))}))})},()=>({classes:{floating:!1},style:{borderStyle:"none",marginLeft:"-20px",marginRight:"-20px"},buttonContainerStyle:{top:"50px"}}));return{name:e,color:t,minWidth:670,properties:n,insights:i,bestInsights:a,timeDrawing:r,job:c,cards:Q,modifiers:Y,milestones:T,collapseMilestones:le,generalTabCollapsed:Ve,tabs:_n,selectedCard:ce,drawnCard:_t,soldCards:Qt,cardShop:vt,cardsDrawnToShop:Zt,fasterDrawTime:gt,totalCardsDrawn:u,display:k(()=>{const I=[...P.value];return M.value&&I.push(M.value),s(F,null,[s(Il,null,{default:()=>[s("div",{style:"height: 50px; line-height: 50px; margin-bottom: 20px"},[m("You have "),s(bl,{resource:n,color:t},null),m(" properties studied and "),s(bl,{resource:i,color:"darkcyan"},null),m(" key insights")])]}),ni(...I,k(()=>cn(s(ai,{collapsed:le,content:Z,display:le.value?"Show other completed milestones":"Hide other completed milestones"},null),[[kn,o(re)]]))),s($e,null,null),Ye(_n),Ye(We)])})}});const Cp={class:"applied-time-selectors-container"},Sp=["onClick"],kp={key:0,class:"applied-time-symbol"},Np={key:1,class:"applied-time-symbol material-icons"},$p={class:"applied-time-effect"},xp=K({__name:"AppliedTimeSelectors",props:{jobs:null,selectedJob:null,effect:null},emits:["selectJob"],setup(e,{emit:t}){const n=e,{jobs:i,selectedJob:a,effect:r}=ct(n),u=w(()=>Object.keys(i.value).filter(c=>ht(i.value[c].visibility)).reduce((c,p)=>({...c,[p]:i.value[p]}),{})),d=w(()=>Math.PI*2/Object.keys(u.value).length);return(c,p)=>(g(),$("div",Cp,[(g(!0),$(F,null,xn(o(u),(f,h,y)=>(g(),$("div",{key:h,class:Me(["feature can dontMerge applied-time-selector",o(a)===h?"selected":""]),style:Oe({backgroundColor:o(f.color),top:`${Math.sin(y*o(d)+o(G).time/1e4)*200+300}px`,left:`${Math.cos(y*o(d)+o(G).time/1e4)*200+300}px`}),onClick:_=>t("selectJob",h)},[o(f.symbol).length<=2?(g(),$("div",kp,ee(f.symbol),1)):(g(),$("span",Np,ee(f.symbol),1))],14,Sp))),128)),v("div",$p,ee(o(ze)(o(r)))+"x",1)]))}});var Mp=me(xp,[["__scopeId","data-v-0bbe577e"]]);const Pp={key:1,class:"grain complete"},Tp=K({__name:"Grain",props:{index:null,chippingProgress:null,chippingIndex:null},setup(e){const t=e,{index:n,chippingProgress:i,chippingIndex:a}=ct(t);return(r,u)=>o(a)<o(n)?(g(),$("div",{key:0,class:Me(["grain not-started",{}])})):(g(),$("div",Pp,[o(a)===o(n)?(g(),$("div",{key:0,class:"grain",style:Oe({clipPath:`polygon(0 0, 100% 0, 100% ${(1-o(i))*100}%, 0 ${(1-o(i))*100}%)`})},null,4)):j("",!0)]))}});var Yl=me(Tp,[["__scopeId","data-v-63857638"]]);const Ip=e=>(nn("data-v-e8dadcb2"),e=e(),ln(),e),Ep={class:"single-grain-label"},Fp={style:{display:"none"}},qp={id:"grain-filter"},Dp=["seed"],Lp=Ip(()=>v("feDisplacementMap",{in:"SourceGraphic",scale:"20"},null,-1)),Ap=K({__name:"Grains",props:{baseGrains:null,chippingProgress:null},setup(e){const t=e,{baseGrains:n,chippingProgress:i}=ct(t),a=w(()=>l.pow(2,new l(n.value).log2().floor()).round().toNumber()),r=w(()=>l.pow(2,new l(a.value).log2().div(2).floor()).round().toNumber()),u=w(()=>l.div(a.value,r.value).round().toNumber()),d=w(()=>l.sub(n.value,a.value).add(1).round().toNumber());return(c,p)=>(g(),$(F,null,[o(l).lt(o(n),1024)?(g(),$("div",{key:0,class:"grains-container",style:Oe({gridTemplateColumns:`repeat(${o(u)}, 1fr)`,columnGap:o(u)===o(r)?"var(--feature-margin)":`calc(var(--feature-margin) + ${150/(o(u)-1)}px)`,maxWidth:o(u)===o(r)?"300px":"600px"})},[(g(!0),$(F,null,xn(o(a),f=>(g(),U(Yl,{key:f,index:f,chippingProgress:o(i),chippingIndex:o(d)},null,8,["index","chippingProgress","chippingIndex"]))),128))],4)):(g(),$(F,{key:1},[s(Yl,{index:0,chippingProgress:o(i),chippingIndex:0,class:"single-grain"},null,8,["chippingProgress"]),v("div",Ep,ee(o(ge)(o(d)))+"/"+ee(o(ge)(o(a))),1)],64)),(g(),$("svg",Fp,[v("filter",qp,[v("feTurbulence",{x:"0",y:"0",width:"700px",height:"700px",baseFrequency:"0.005",numOctaves:"10",seed:o(l).lt(o(n),1024)?o(a):new o(l)(o(n)).toNumber()},null,8,Dp),Lp])]))],64))}});var Op=me(Ap,[["__scopeId","data-v-e8dadcb2"]]);const La=e=>(nn("data-v-93b37faa"),e=e(),ln(),e),Rp=La(()=>v("clipPath",{id:"glass-mask"},[v("path",{d:"M204 -2.82683e-05L10 -2.83344e-05C-38 50 103 95.3005 103 175C103 254.699 -38 300 10 350H204C252 300 111 254.699 111 175C111 95.3005 252 50 204 -2.82683e-05Z",fill:"black"})],-1)),jp={id:"sand-top-mask"},Bp=["transform"],Vp={id:"sand-bottom-mask"},zp=["transform"],Gp={id:"flipping-mask"},Up=["transform"],Xp=Ua('<g id="sand" transform="translate(42, 20)" clip-path="url(#glass-mask)" data-v-93b37faa><g clip-path="url(#flipping-mask)" data-v-93b37faa><path id="sand-top" d="M204 -2.82683e-05L10 -2.83344e-05C-38 50 103 95.3005 103 175V350H111V175C111 95.3005 252 50 204 -2.82683e-05Z" fill="white" clip-path="url(#sand-top-mask)" data-v-93b37faa></path></g><rect id="sand-bottom" width="300" height="390" fill="white" clip-path="url(#sand-bottom-mask)" data-v-93b37faa></rect></g><path id="glass" transform="translate(38, 20)" d="M212 -2.82683e-05L10 -2.83344e-05C-38 50 103 95.3005 103 175C103 254.699 -38 300 10 350H212C260 300 119 254.699 119 175C119 95.3005 260 50 212 -2.82683e-05Z" fill="#0003" data-v-93b37faa></path><path id="frame" fill-rule="evenodd" clip-rule="evenodd" d="M300 0H0V20H300V0ZM300 370H0V390H300V370Z" fill="#9E9169" data-v-93b37faa></path><path id="sides" transform="translate(15, 20)" d="M20 0H0V350H20V0ZM270 0H250V350H270V0Z" fill="#817654" data-v-93b37faa></path>',4),Hp={key:1,class:"remainingGrains"},Jp={key:2,class:"flip-request"},Wp=m(" Press to "),Qp=La(()=>v("br",null,null,-1)),Zp=m(" flip "),Kp=[Wp,Qp,Zp],Yp={class:"fallenGrains"},em=K({__name:"Hourglass",props:{totalGrains:null,grainsFallen:null,flippingProgress:null,showHourglassNotif:{type:Boolean}},emits:["flip"],setup(e,{emit:t}){return(n,i)=>(g(),$("div",{class:Me(["hourglass-container",{flipping:e.flippingProgress<1}]),onClick:i[0]||(i[0]=a=>t("flip"))},[e.showHourglassNotif?(g(),U(Nn,{key:0})):j("",!0),(g(),$("svg",{width:"240",height:"312",viewBox:"0 0 300 390",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:Oe({transform:`rotateZ(${(1-e.flippingProgress)*180}deg)`})},[v("defs",null,[Rp,v("clipPath",jp,[v("path",{d:"M149.25 19.5C89.9195 19.5 0.5 0.5 0.5 0.5V390H299.5V0.5C299.5 0.5 208.581 19.5 149.25 19.5Z",transform:e.flippingProgress<1?`translate(0, ${-40+e.flippingProgress*40})`:`translate(0, ${o(l).div(e.grainsFallen,e.totalGrains).sqr().times(190).toNumber()})`,fill:"black"},null,8,Bp)]),v("clipPath",Vp,[v("path",{d:"M148.75 0C89.4195 0 0 19 0 19V389.5H299V19C299 19 208.081 0 148.75 0Z",transform:`translate(-40, ${o(l).sub(350,o(l).div(e.grainsFallen,e.totalGrains).sqr().times(150)).toNumber()})`,fill:"black"},null,8,zp)]),v("clipPath",Gp,[v("path",{d:"M150.25 389.5C209.581 389.5 300 370.5 300 370.5L300 3.05176e-05L1.87924e-05 4.37817e-06L-1.35978e-05 370.5C-1.35978e-05 370.5 90.9194 389.5 150.25 389.5Z",fill:"black",transform:`translate(0, ${Math.max(e.flippingProgress,.5)*420-445})`},null,8,Up)])]),Xp],4)),o(l).sub(e.totalGrains,e.grainsFallen).gt(0)?(g(),$("div",Hp,ee(o(ge)(o(l).sub(e.totalGrains,e.grainsFallen))),1)):(g(),$("div",Jp,Kp)),v("div",Yp,ee(o(ge)(e.grainsFallen)),1)],2))}});var tm=me(em,[["__scopeId","data-v-93b37faa"]]),nm=["Time? I love time!","I don't like sand. It's coarse and rough and irritating - and it gets everywhere","Those who make the worst use of their time are the first to complain of its brevity","Oh, how the time has flown","Time is an illusion","Time does not pass, it continues","This, too, shall pass","The hourglass mesmerizes me","Each grain split makes my measurements more precise"];const ea=vi(),ta={additive:"+",multiplicative:"x",exponential:"^"},im={additive:(e,t)=>()=>l.times(o(e),t.value),multiplicative:(e,t)=>()=>l.pow(o(e),t.value),exponential:(e,t)=>()=>l.tetrate(o(e),new l(t.value).toNumber())},fl="experiments",Ce=Tn(fl,function(){const e="Measuring",t="#D1C926",n=dn(0,"potentia"),i=H(1),a=H(0),r=H(1),u=H(0),d=H("experiments"),c=w(()=>h.earned.value?Object.values(Se).some(ue=>ue.showNotif.value)?!0:_.earned.value?!!Object.values(Be).some(ue=>ue.showNotif.value):!1:!1),p=Vn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"85%",y:"60%"},symbol:"\u29D6",randomQuips(){return[...nm,...si]},resource:n,layerID:fl,modifierInfo:k(()=>ut(ie)),visibility:Ke.milestones.experimentsMilestone.earned,showNotif:()=>Qe.value||c.value})),f=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,2)),display:{requirement:`Achieve ${p.name} Level 2`,effectDisplay:"Unlock grinding grains"}})),h=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,4)),display:{requirement:`Achieve ${p.name} Level 4`,effectDisplay:"Unlock potentials"},visibility:f.earned})),y=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,5)),display:{requirement:`Achieve ${p.name} Level 5`,effectDisplay:"Unlock a time slot"},visibility:h.earned})),_=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,6)),display:{requirement:`Achieve ${p.name} Level 6`,effectDisplay:"Unlock advanced potentials"},visibility:y.earned})),C=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,8)),display:{requirement:`Achieve ${p.name} Level 8`,effectDisplay:"Unlock applied time"},visibility:_.earned})),T=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,10)),display:{requirement:`Achieve ${p.name} Level 10`,effectDisplay:`Unlock "${Le.job.name}" Job`},visibility:C.earned,onComplete(){wn(Le,G)}})),W={chippingMilestone:f,potentialsMilestone:h,timeSlotMilestone:y,advancedPotentialsMilestone:_,appliedTimeMilestone:C,jobMilestone:T},le=[T,C,_,y,h,f],P=H(!0),M=w(()=>le.filter(ue=>ue.earned.value===!1)),{firstFeature:Z,collapsedContent:re,hasCollapsedContent:oe}=ii(le,ue=>ue.earned.value);function B({name:ue,precision:Ie,effectRatio:Ee,xpReqRatio:Q,baseBoostCost:ft,boostCostRatio:qt,boostCostResource:sn,modifierType:Dt,isAdvanced:Qt}){const Lt=et(Ee),fn=et(Q),zn=et(ft),Zt=et(qt),Ut=et(sn),Kt=H(0),$t=H(0),_n=w(()=>l.pow(o(fn),Kt.value).times(100)),I=im[Dt!=null?Dt:"multiplicative"](Lt,Kt);let de;Dt==="exponential"?de=Wi(()=>({exponent:I,description:ue+" potential",enabled:Qt?_.earned:h.earned})):Dt==="additive"?de=yt(()=>({addend:I,description:ue+" potential",enabled:Qt?_.earned:h.earned})):de=L(()=>({multiplier:I,description:ue+" potential",enabled:Qt?_.earned:h.earned}));const Fe=H(0),qe=w(()=>l.times(o(zn),l.pow(o(Zt),Fe.value))),dt=w(()=>l.gte(yi(Ut).value,qe.value)),xt=Ln(()=>({display:k(()=>s(F,null,[m("x2 boost for"),s("br",null,null),At(qe.value),s("br",null,null),yi(Ut).displayName,vn.value?s(Nn,{style:"top: -15px"},null):null])),canClick:dt,onClick(){const En=yi(Ut);En.value=l.sub(En.value,qe.value),Fe.value++}}));qa(xt,{display:k(()=>s(F,null,[m("You have "),Sn(yi(Ut))," ",yi(Ut).displayName]))});let Rt=null;tt(Kt,()=>{Ae.active===G.id&&(Rt!=null&&ea.dismiss(Rt),Rt=ea.info(s(F,null,[s("h3",null,[m("Potential increased!")]),s("div",null,[ta[Dt!=null?Dt:"multiplicative"],ze(o(Lt),Ie!=null?Ie:2),m(" "),ue])])))});const vn=Mi(xt,dt);return{level:Kt,xp:$t,xpRequired:_n,effect:I,modifier:de,boosts:Fe,cost:qe,clickable:xt,showNotif:vn,effectRatio:Lt,xpReqRatio:fn,baseBoostCost:zn,boostCostRatio:Zt,boostCostResource:Ut,update(En){let ri=l.add($t.value,l.pow(2,Fe.value).times(_t.apply(En)));for(;l.gte(ri,_n.value);)ri=ri.sub(_n.value),Kt.value++;$t.value=ri.toNumber()},display:k(()=>s("div",{class:"potential feature dontMerge"},[Ye(xt),s("div",{class:"potential-details"},[m("Lv "),At(Kt.value),m(" "),ue,m(" ("),ta[Dt!=null?Dt:"multiplicative"],ze(o(Lt),Ie!=null?Ie:2),m(" each)")]),s("div",{class:"potential-xp"},[s("div",{class:"potential-xp-fill",style:{width:`${l.div($t.value,_n.value).times(100).toNumber()}%`}},null)])]))}}const J=B({name:"Grinding duration",effectRatio:.9,precision:1,xpReqRatio:1.3,baseBoostCost:100,boostCostRatio:2,boostCostResource:n}),je=B({name:"Potentia gain",effectRatio:1.05,xpReqRatio:1.08,baseBoostCost:100,boostCostRatio:10,boostCostResource:n}),Te=B({name:"Grains fall speed",effectRatio:1.025,precision:3,xpReqRatio:1.1,baseBoostCost:100,boostCostRatio:4,boostCostResource:n}),Se={grindingSpeedPotential:J,potentiaGainPotential:je,fallSpeedPotential:Te},Je=B({name:"Potentials speed",effectRatio:1.1,precision:1,xpReqRatio:1.5,baseBoostCost:1e4,boostCostRatio:10,boostCostResource:n,isAdvanced:!0}),ae=B({name:"Bonus grains",effectRatio:1.05,xpReqRatio:2,baseBoostCost:100,boostCostRatio:1.25,boostCostResource:()=>Object.values(Ke.elements)[ae.boosts.value%4].resource,isAdvanced:!0}),Tt=B({name:"Job EXP gain",effectRatio:1.1,precision:1,xpReqRatio:1.25,baseBoostCost:1e6,boostCostRatio:8,boostCostResource:De.flowers,isAdvanced:!0}),mt=B({name:"Passive grinding",effectRatio:1,precision:0,xpReqRatio:1.2,baseBoostCost:1e3,boostCostRatio:5,boostCostResource:bn.insights,modifierType:"additive",isAdvanced:!0}),Be={potentialsSpeedPotential:Je,effectiveGrainsPotential:ae,jobXPPotential:Tt,passiveGrindingPotential:mt},ye=w(()=>l.pow(1.1,p.level.value)),V=w(()=>new l(i.value).log2().floor()),z=w(()=>l.pow(1.1,p.level.value)),pe=ne(()=>[L(()=>({multiplier:z,description:"Applied time",enabled:()=>p.active.value&&C.earned.value&&d.value===fl})),Le.batteries.experiments.timePassing.modifier]),fe=w(()=>pe.apply(1)),Ne=ne(()=>[Tt.modifier,Le.batteries.experiments.xpGain.modifier]),wt=ne(()=>[ae.modifier]),kt=w(()=>wt.apply(i.value)),Y=ne(()=>[L(()=>({multiplier:()=>l.pow(1.1,V.value),description:"Grain size (x1.1 each split)",enabled:f.earned})),Te.modifier]),lt=w(()=>Y.apply(1)),Ve=ne(()=>[L(()=>({multiplier:()=>l.pow(2,V.value),description:"Grain size (x2 each split)"})),J.modifier]),We=w(()=>Ve.apply(1)),Ue=ne(()=>[mt.modifier]),ce=w(()=>Ue.apply(0)),vt=ne(()=>[L(()=>({multiplier:ye,description:`${p.name} level (x1.1 each)`})),je.modifier,Le.batteries.experiments.resourceGain.modifier,Ct.plants.potentia.modifier]),_t=ne(()=>[Je.modifier]),at={timePassing:pe,jobXpGain:Ne,totalGrains:wt,grainsFallRate:Y,chippingDuration:Ve,potentiaGain:vt,potentialsSpeed:_t,passiveGrinding:Ue},[x,A]=Ht(()=>[{title:"Time Passing",modifier:pe,base:1,visible:()=>C.earned.value||Le.milestones.timeBatteriesMilestone.earned.value},{title:`${p.name} EXP Gain`,modifier:Ne,base:1},{title:"Potentia Gain",modifier:vt,base:1},{title:"Potentials speed",modifier:_t,base:1,visible:_.earned}]),[O,ke]=Ht(()=>[{title:"Total Grains",modifier:wt,base:i},{title:"Grains Fall Speed",modifier:Y,base:1,unit:"/s"},{title:"Grinding duration",modifier:Ve,base:1,unit:"s",visible:f.earned},{title:"Passive grinding",modifier:Ue,base:0,unit:"%",visible:_.earned}]),ie=$n({general:()=>({display:"General",glowColor(){return ie.activeTab.value===this.tab?t:""},tab:x,generalTabCollapsed:A}),grains:()=>({display:"Grains",glowColor(){return ie.activeTab.value===this.tab?t:""},tab:O,grainsTabCollapsed:ke})},()=>({style:`--layer-color: ${t}`})),Xe=Ln(()=>({display:{title:"Grind",description:"Hover to grind grains apart, to create new grains"}})),Nt=_a(Xe);this.on("preUpdate",ue=>{if(!!p.active.value){if(ue=l.times(ue,fe.value).toNumber(),h.earned.value&&Object.values(Se).forEach(Ie=>Ie.update(ue)),_.earned.value&&(Object.values(Be).forEach(Ie=>Ie.update(ue)),u.value=l.add(u.value,l.times(ue,ce.value).div(100)).toNumber()),l.lt(r.value,1))r.value=l.add(r.value,ue).min(1).toNumber();else if(l.lt(a.value,kt.value)){const Ie=l.add(a.value,l.times(lt.value,ue)).min(kt.value),Ee=vt.apply(l.sub(Ie,a.value));n.value=l.add(n.value,Ee),p.xp.value=l.add(p.xp.value,Ne.apply(Ee)),a.value=Ie}for(Nt.value&&(u.value=u.value+ue);l.gt(u.value,We.value);){const Ie=l.div(u.value,We.value).floor().min(new l(2).pow(new l(i.value).add(1).log2().floor().add(1)).sub(i.value));u.value=u.value-Ie.times(We.value).toNumber(),i.value=l.add(i.value,Ie)}}});const gt=$n({grains:()=>({display:"Grains",tab:On(()=>({display:k(()=>s(F,null,[s($e,null,null),s(Op,{baseGrains:i.value,chippingProgress:l.div(u.value,We.value).toNumber()},null),s($e,null,null),Ye(Xe)]))})),style:{borderLeft:"5px solid var(--outline)",marginLeft:"5px"}}),potentials:()=>({display:k(()=>s("span",{style:"position: relative;"},[m("Potentials"),c.value?s(Nn,{style:"left: -15px; top: -10px"},null):null])),tab:On(()=>({display:k(()=>s(F,null,[s($e,null,null),s("h2",null,[m("Basic Potentials")]),s($e,null,null),xi(...Object.values(Se).map(ue=>ue.display)),_.earned.value?s(F,null,[s($e,null,null),s("h2",null,[m("Advanced Potentials")]),s($e,null,null),xi(...Object.values(Be).map(ue=>ue.display))]):null]))})),visibility:h.earned}),appliedTime:()=>({display:"Applied Time",tab:On(()=>({display:k(()=>s(F,null,[s($e,null,null),s("div",null,[m("Focus your potential towards speeding up an entire job's time loop."),s("br",null,null),m("Strength increases with "),p.name,m(" level.")]),s($e,null,null),s(Mp,{effect:z.value,jobs:rt.jobs,selectedJob:d.value,onSelectJob:ue=>d.value=ue},null)]))})),visibility:C.earned})},()=>({classes:{floating:!1},style:{borderStyle:"none",marginLeft:"-20px",marginRight:"-20px"},buttonContainerStyle:{top:"50px"}})),zt={[it]:tm,[Ge]:()=>({totalGrains:kt.value,grainsFallen:a.value,flippingProgress:r.value,onFlip:()=>{r.value=r.value>=1?0:r.value,a.value=0},showHourglassNotif:Qe.value})},Qe=Mi(zt,()=>l.sub(kt.value,a.value).lte(0));return{name:e,color:t,minWidth:670,potentia:n,baseTotalGrains:i,grainsFallen:a,flippingProgress:r,chippingProgress:u,basicPotentials:Se,advancedPotentials:Be,job:p,selectedJob:d,modifiers:at,milestones:W,collapseMilestones:P,modifierTabs:ie,tabs:gt,appliedTimeEffect:z,display:k(()=>{const ue=[...M.value];return Z.value&&ue.push(Z.value),s(F,null,[s(Ei,{resource:n,color:t},null),ni(...ue,k(()=>cn(s(ai,{collapsed:P,content:re,display:P.value?"Show other completed milestones":"Hide other completed milestones"},null),[[kn,o(oe)]]))),s($e,null,null),Ye(zt),s($e,{height:"50px"},null),f.earned.value?Ye(gt):null])})}});var lm=["Seeds? I love seeds!","They can still be improved, I'm sure of it","Together we'll both grow to our full potentials","Progress moves ever forward, generation by generation","Grow!","They require meticulous care"];const am={key:2,class:"analyzed"};var ci=K({__name:"SeedSlot",props:{selected:{type:Boolean},seed:null,onClick:null},setup(e){const t=e,n=Pn(w(()=>k(()=>t.seed==="none"?"":ut(Ct.plants[t.seed.type].seed)))),i=he(k(()=>t.seed==="none"||!t.seed.analyzed?"":s(F,null,[m("Speed: "),ge(t.seed.speed),s("br",null,null),m("Harvest Size: "),ge(t.seed.harvest),s("br",null,null),m("Mutability: "),ge(t.seed.mutability)])));return(a,r)=>(g(),$("div",{class:Me(["seed feature can",{selected:e.selected}]),onClick:r[0]||(r[0]=u=>e.onClick(e.seed))},[e.seed!=="none"&&e.seed.analyzed?(g(),U(st,{key:0,display:o(i)},{default:se(()=>[o(n)?(g(),U(Pe(o(n)),{key:0})):j("",!0),Wt(a.$slots,"default")]),_:3},8,["display"])):(g(),$(F,{key:1},[o(n)?(g(),U(Pe(o(n)),{key:0})):j("",!0),Wt(a.$slots,"default")],64)),e.seed!=="none"&&e.seed.analyzed?(g(),$("div",am,"*")):j("",!0)],2))}});const sm={class:"inputs"},rm=v("path",{d:"M4 29C15.1929 16.5 26.3858 4 54 4C109.228 4 98.7715 54 154 54C181.614 54 192.807 41.5 204 29",stroke:"grey","stroke-width":"7","stroke-linecap":"round"},null,-1),om=K({__name:"Machine",props:{index:null,numInputs:null,inputs:null,timer:null,poweredUp:{type:Boolean},canPowerUp:null,duration:null,outputDisplay:null,setInput:null},emits:["setPoweredUp"],setup(e,{emit:t}){const n=e,i=St();Vt(()=>{i.value=he(n.outputDisplay(n.inputs,n.index))});const a=w(()=>n.numInputs!==n.inputs.filter(r=>r!=null&&r!=="none").length);return(r,u)=>(g(),$("div",{class:Me(["machine feature",{poweredUp:e.poweredUp,canPowerUp:!e.poweredUp&&o(e.canPowerUp)}])},[v("div",sm,[(g(!0),$(F,null,xn(e.numInputs,d=>{var c;return g(),U(ci,{key:d-1,seed:(c=e.inputs[d-1])!=null?c:"none",onClick:()=>e.setInput(e.index,d-1)},null,8,["seed","onClick"])}),128))]),(g(),$("svg",{width:"208",height:"58",viewBox:"0 0 208 58",fill:"none",xmlns:"http://www.w3.org/2000/svg",onClick:u[0]||(u[0]=d=>t("setPoweredUp"))},[rm,v("path",{d:"M4 29C15.1929 16.5 26.3858 4 54 4C109.228 4 98.7715 54 154 54C181.614 54 192.807 41.5 204 29",stroke:"black","stroke-width":"7","stroke-linecap":"round",class:"progress",style:Oe({strokeDashoffset:`calc(var(--dash-length) * ${o(l).sub(.33,o(l).div(e.timer,e.duration(e.inputs)).times(1.33)).toNumber()})`})},null,4)])),o(i)?(g(),U(Pe(o(i)),{key:0})):j("",!0),o(a)?(g(),U(Nn,{key:1})):j("",!0)],2))}});const um={key:0},cm=v("span",{class:"toggle"},"\u25BC",-1),dm=K({__name:"MachineType",props:{id:null,name:null,enabled:null,numInputs:null,inputs:null,timers:null,collapsed:null,machines:null,poweredUpMachine:null,canPowerUp:null,duration:null,outputDisplay:null,setInput:null,setPoweredUpMachine:null},setup(e){return(t,n)=>o(e.enabled)?(g(),$("div",um,[v("h2",{onClick:n[0]||(n[0]=i=>e.collapsed.value=!e.collapsed.value),class:Me(["breeding-collapsible",{collapsed:e.collapsed.value}])},[cm,m(ee(e.name),1)],2),e.collapsed.value?j("",!0):(g(),U(Zi,{key:0},{default:se(()=>[(g(!0),$(F,null,xn(new o(l)(e.machines.amount.value).toNumber(),i=>{var a,r;return g(),U(om,{key:i-1,index:i-1,numInputs:e.numInputs,inputs:(a=o(e.inputs)[i-1])!=null?a:[],timer:(r=o(e.timers)[i-1])!=null?r:0,duration:e.duration,outputDisplay:e.outputDisplay,setInput:e.setInput,canPowerUp:e.canPowerUp,poweredUp:e.poweredUpMachine.value.type===e.id&&i-1===e.poweredUpMachine.value.index,onSetPoweredUp:()=>e.setPoweredUpMachine(i-1)},null,8,["index","numInputs","inputs","timer","duration","outputDisplay","setInput","canPowerUp","poweredUp","onSetPoweredUp"])}),128)),(g(),U(Pe(e.machines[o(it)]),oa(Xa(e.machines[o(Ge)]())),null,16))]),_:1}))])):j("",!0)}});const pm={class:"plant feature"},mm={class:"plant-symbol"},fm={class:"plant-details"},vm=v("div",{style:{"flex-grow":"1"}},null,-1),gm=v("h3",null,"Consume",-1),hm=v("br",null,null,-1),bm={key:0},ym=K({__name:"Plant",props:{name:null,symbol:null,color:null,effectDescription:null,amount:null,consumedTimeRemaining:null,multiplier:null,consume:null},setup(e){const t=e,n=w(()=>`${ze(l.add(t.amount.value,1).log10().add(1))}x ${t.effectDescription} for ${Rn(l.pow(t.amount.value,2).add(1).log2())}`);return(i,a)=>(g(),$("div",pm,[v("div",{class:"plant-info",style:Oe({color:e.color})},[v("span",mm,ee(e.symbol),1),v("div",fm,[v("span",null,ee(e.name),1),v("span",null,"Stored: "+ee(o(ge)(o(e.amount))),1)]),vm,v("button",{class:"button",onClick:a[0]||(a[0]=(...r)=>e.consume&&e.consume(...r))},[gm,hm,m(ee(o(n)),1)])],4),o(e.consumedTimeRemaining)>0?(g(),$("div",bm," Current bonus: "+ee(o(ze)(o(e.multiplier)))+"x "+ee(e.effectDescription)+" for "+ee(o(Rn)(o(e.consumedTimeRemaining))),1)):j("",!0)]))}}),wi="breeding",Ct=Tn(wi,function(){const e="Breeding Plants",t="#51D126",n=dn(0,"mutagens"),i=H([{type:"moly",analyzed:!1,speed:1,mutability:1,harvest:1}]),a=H("none"),r=H("none"),u=H({type:"none",index:-1}),d=H(!1),c=H(!1),p=Vn(e,()=>({color:t,image:"https://dummyimage.com/512x288/000/fff.png",imageFocus:{x:"75%",y:"60%"},symbol:"emoji_nature",randomQuips(){return[...lm,...si]},resource:n,layerID:wi,modifierInfo:k(()=>ut(at)),visibility:bn.milestones.jobMilestone.earned,showNotif:()=>Object.values(wt).some(x=>o(x.machines.canClick)||i.value.length!==0&&x.inputs.value.some(A=>x.numInputs!==A.filter(O=>O!==null&&O!=="none").length))})),f=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,2)),display:{requirement:`Achieve ${p.name} Level 2`,effectDisplay:"Unlock breeding and analyzing machines"}})),h=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,4)),display:{requirement:`Achieve ${p.name} Level 4`,effectDisplay:"Unlock powering up machines"},visibility:f.earned})),y=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,5)),display:{requirement:`Achieve ${p.name} Level 5`,effectDisplay:`Unlock bonus generator in "${Le.job.name}" job`},visibility:h.earned})),_=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,6)),display:{requirement:`Achieve ${p.name} Level 6`,effectDisplay:"Unlock recycling machine"},visibility:y.earned})),C=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,8)),display:{requirement:`Achieve ${p.name} Level 8`,effectDisplay:"Unlock mutating machine"},visibility:_.earned})),T=we(()=>({requirements:be(()=>l.gte(p.rawLevel.value,10)),display:{requirement:`Achieve ${p.name} Level 10`,effectDisplay:`Unlock 1/2 of "${ti.job.name}" Job`},visibility:C.earned,onComplete(){Le.milestones.jobMilestone.earned.value&&wn(ti,G)}})),W={breedingAnalyzingMilestone:f,powerupMilestone:h,bonusGeneratorMilestone:y,recyclingMilestone:_,mutatingMilestone:C,jobMilestone:T},le=[T,C,_,y,h,f],P=H(!0),M=w(()=>le.filter(x=>x.earned.value===!1)),{firstFeature:Z,collapsedContent:re,hasCollapsedContent:oe}=ii(le,x=>x.earned.value);function B(x){const A=H(0),O=H(0),ke=H(0),ie=H(!1);return pt(()=>{const Xe=x(),Nt=w(()=>l.add(O.value,1).log10().add(1));return{...Xe,amount:A,consumedAmount:O,consumedTimeRemaining:ke,discovered:ie,multiplier:Nt,modifier:L(()=>({multiplier:Nt,description:`${Xe.name} consumption`,enabled:()=>ke.value>0})),consume:function(){O.value=A.value,ke.value=l.pow(A.value,2).add(1).log2().toNumber(),A.value=0,ie.value=!0},seed:{[it]:he(`\u{1F331}<sub><span class="material-icons" style="color: ${Xe.color}">${Xe.symbol}</span></sub>`),[Ge]:()=>({})},[it]:ym,[Ge]:function(){const{name:gt,symbol:zt,color:Qe,effectDescription:ue,amount:Ie,consumedTimeRemaining:Ee,multiplier:Q,consume:ft}=this;return{name:gt,symbol:zt,color:Qe,effectDescription:ue,amount:Ie,consumedTimeRemaining:Ee,multiplier:Q,consume:ft}}}})}const J={moly:B(()=>({name:"Tempus Largitatis",symbol:De.job.symbol,color:De.job.color,effectDescription:"Moly gain"})),earthEssence:B(()=>({name:"Terra Lupulus",symbol:Ke.elements.earth.symbol,color:Ke.elements.earth.color,effectDescription:"Earth essence gain"})),waterEssence:B(()=>({name:"Aqua Lupulus",symbol:Ke.elements.water.symbol,color:Ke.elements.water.color,effectDescription:"Water essence gain"})),airEssence:B(()=>({name:"Aer Lupulus",symbol:Ke.elements.air.symbol,color:Ke.elements.air.color,effectDescription:"Air essence gain"})),fireEssence:B(()=>({name:"Ignis Lupulus",symbol:Ke.elements.fire.symbol,color:Ke.elements.fire.color,effectDescription:"Fire essence gain"})),properties:B(()=>({name:"Discipulo Scriptor",symbol:bn.job.symbol,color:bn.job.color,effectDescription:"Properties gain"})),potentia:B(()=>({name:"Glarea Fovea",symbol:Ce.job.symbol,color:Ce.job.color,effectDescription:"Potentia gain"})),energeia:B(()=>({name:"Vis Salutarias",symbol:Le.job.symbol,color:Le.job.color,effectDescription:"Energeia gain"}))};function je(x,A,O){const ke=H([]),ie=H([]),Xe=H(!1),Nt=Da(()=>({initialValue:1,visibility:Le.milestones.machinesMilestone.earned,requirements:Ma(()=>({cost:E.variable(Nt.amount).pow_base(A),resource:Le.energeia})),display:{description:`Additional ${x.slice(0,-1)}`,showAmount:!1},style:{width:"600px",minHeight:"unset"}}));return pt(()=>{const gt=O(),zt=et(gt.enabled);return tt(Nt.amount,Qe=>{for(;ke.value.length<Qe;)ke.value.push([]);for(;ie.value.length<Qe;)ie.value.push(0)}),{...gt,name:x,priceRatio:A,enabled:zt,inputs:ke,timers:ie,collapsed:Xe,machines:Nt,setInput:function(Qe,ue){var Q,ft,qt;const Ie=(ft=(Q=ke.value[Qe])==null?void 0:Q[ue])!=null?ft:"none";Ie&&Ie!=="none"&&i.value.push(Ie);const Ee=(qt=ke.value[Qe])!=null?qt:[];Ee[ue]=a.value,ke.value[Qe]=Ee,i.value=i.value.filter(sn=>sn!==a.value),a.value="none"},duration:function(Qe){const ue=Qe.filter(Q=>Q!=="none");if(ue.length===0)return 1/0;const Ie=ue.map(Q=>Q.speed).reduce((Q,ft)=>Q+ft)/ue.length,Ee=l.times(gt.baseDuration,l.pow(.99,l.sqrt(Ie)));return new l(gt.durationModifier.apply(Ee)).toNumber()},setPoweredUpMachine(Qe){kt(gt.id,Qe)},[it]:dm,[Ge]:function(){const{id:Qe,name:ue,enabled:Ie,numInputs:Ee,inputs:Q,timers:ft,collapsed:qt,machines:sn,duration:Dt,outputDisplay:Qt,setInput:Lt,setPoweredUpMachine:fn}=this;return{id:Qe,name:ue,enabled:Ie,numInputs:Ee,inputs:Q,timers:ft,collapsed:qt,machines:sn,poweredUpMachine:u,canPowerUp:h.earned,duration:Dt,outputDisplay:Qt,setInput:Lt,setPoweredUpMachine:fn}}}})}const Te=je("Growing Machines",50,()=>({id:"growMachines",enabled:!0,numInputs:1,baseDuration:100,durationModifier:ne(()=>[]),isRunning:x=>Object.keys(x).length===1&&x[0]!=="none",onActivate:x=>{if(Object.keys(x).length===0||x[0]==="none")return;J[x[0].type].amount.value=l.add(J[x[0].type].amount.value,x[0].harvest);const A=x[0].mutability;n.value=l.add(n.value,A),p.xp.value=l.add(p.xp.value,Ue.apply(A))},outputDisplay:x=>k(()=>Object.keys(x).length===0||x[0]==="none"?s("div",null,[s("div",{style:"font-size: xx-large"},[m("?")]),s("div",null,[m("+1 mutations")])]):s("div",null,[s("div",{style:{fontSize:"xx-large",color:J[x[0].type].color}},[ge(J[x[0].type].amount.value)," ",J[x[0].type].symbol]),s("div",null,[m("+ mutations")])]))})),Se=H([]);function Je(x){return l.times(x.speed,x.harvest).pow(2).div(x.mutability).ceil()}function ae(x,A){return l.max(1,l.add(x,l.sqrt(A).times(Math.random()-.4).ceil())).toNumber()}const Tt=je("Breeding Machines",80,()=>({id:"breedingMachines",enabled:f.earned,numInputs:1,baseDuration:600,durationModifier:ne(()=>[]),isRunning:(x,A)=>{var O;return((O=Se.value[A])!=null?O:"none")==="none"&&Object.keys(x).length===1&&x[0]!=="none"&&l.gte(n.value,Je(x[0]))},onActivate:(x,A)=>{if(Object.keys(x).length!==1||x[0]==="none"||Se.value[A]!=null&&Se.value[A]!=="none")return;n.value=l.sub(n.value,Je(x[0]));let{speed:O,harvest:ke,mutability:ie}=x[0],Xe=x[0].type;l.sub(1,l.add(ie,1).log(1e6).pow(1.3).add(1).recip()).toNumber()>Math.random()&&(Xe=Object.keys(J)[Math.floor(Math.random()*Object.keys(J).length)],O=Math.sqrt(O),ke=Math.sqrt(ke),ie=Math.sqrt(ie)),O=ae(O,ie),ke=ae(ke,ie),ie=ae(ie,ie),Se.value[A]={type:Xe,speed:O,harvest:ke,mutability:ie,analyzed:!1}},outputDisplay:(x,A)=>k(()=>{var O;return s("div",null,[s(ci,{seed:(O=Se.value[A])!=null?O:"none",onClick:ke=>{const ie=Se.value[A];ke!=="none"&&ie!=null&&ie!=="none"&&(i.value.push(ie),Se.value[A]="none")}},null),Tt.isRunning(x,A)?s("div",null,[m("-"),ge(Je(x[0]))," ",n.displayName]):null])})})),mt=H([]);function Be(x){return l.times(x.speed,x.harvest).times(x.mutability).ceil()}const ye=je("Analyzing Machines",100,()=>({id:"analyzingMachines",enabled:f.earned,numInputs:1,baseDuration:1200,durationModifier:ne(()=>[]),isRunning:(x,A)=>{var O;return((O=mt.value[A])!=null?O:"none")==="none"&&Object.keys(x).length===1&&x[0]!=="none"&&x[0].analyzed===!1&&l.gte(De.flowers.value,Be(x[0]))},onActivate:(x,A)=>{Object.keys(x).length!==1||x[0]==="none"||x[0].analyzed||mt.value[A]!=null&&mt.value[A]!=="none"||(De.flowers.value=l.sub(De.flowers.value,Be(x[0])),mt.value[A]={...x[0],analyzed:!0},ye.inputs.value[A]=[])},outputDisplay:(x,A)=>k(()=>{var O;return s("div",null,[s(ci,{seed:(O=mt.value[A])!=null?O:"none",onClick:ke=>{const ie=mt.value[A];ke!=="none"&&ie!=null&&ie!=="none"&&(i.value.push(ie),mt.value[A]="none")}},null),ye.isRunning(x,A)?s("div",null,[m("-"),ge(Be(x[0]))," ",De.flowers.displayName]):null])})}));function V(x){return l.times(x.speed,x.harvest).times(x.mutability).ceil()}const z=je("Recycling Machines",90,()=>({id:"recyclingMachines",enabled:_.earned,numInputs:1,baseDuration:900,durationModifier:ne(()=>[]),isRunning:x=>Object.keys(x).length===1&&x[0]!=="none",onActivate:(x,A)=>{if(Object.keys(x).length!==1||x[0]==="none")return;const O=V(x[0]);n.value=l.add(n.value,O),p.xp.value=l.add(p.xp.value,Ue.apply(O.times(10))),z.inputs.value[A]=[]},outputDisplay:(x,A)=>k(()=>s("div",null,[z.isRunning(x,A)&&x[0].analyzed?s("div",null,[m("+"),ge(V(x[0]))," ",n.displayName,s("br",null,null),m("x10 exp gained")]):s("div",null,[m("+ mutations"),s("br",null,null),m("x10 exp gained")])]))})),pe=H([]);function fe(x){return l.times(x.mutability,2).pow(2).ceil()}const Ne=je("Mutating Machines",150,()=>({id:"mutatingMachines",enabled:C.earned,numInputs:1,baseDuration:1800,durationModifier:ne(()=>[]),isRunning:(x,A)=>{var O;return((O=pe.value[A])!=null?O:"none")==="none"&&Object.keys(x).length===1&&x[0]!=="none"&&l.gte(n.value,fe(x[0]))},onActivate:(x,A)=>{Object.keys(x).length!==1||x[0]==="none"||pe.value[A]!=null&&pe.value[A]!=="none"||(n.value=l.sub(n.value,fe(x[0])),pe.value[A]={...x[0],mutability:x[0].mutability*2},Ne.inputs.value[A]=[])},outputDisplay:(x,A)=>k(()=>{var O;return s("div",null,[s(ci,{seed:(O=pe.value[A])!=null?O:"none",onClick:ke=>{const ie=pe.value[A];ke!=="none"&&ie!=null&&ie!=="none"&&(i.value.push(ie),pe.value[A]="none")}},null),Ne.isRunning(x,A)?s("div",null,[m("-"),ge(fe(x[0])),m(" "),n.displayName]):null])})})),wt={growMachines:Te,breedingMachines:Tt,analyzingMachines:ye,recyclingMachines:z,mutatingMachines:Ne};function kt(x,A){u.value={type:x,index:A}}const Y=w(()=>l.pow(1.1,p.level.value)),lt=w(()=>Object.values(J).filter(x=>x.discovered.value).length),Ve=ne(()=>[L(()=>({multiplier:Ce.appliedTimeEffect,description:"Applied time",enabled:()=>Ce.job.active.value&&Ce.milestones.appliedTimeMilestone.earned.value&&Ce.selectedJob.value===wi})),L(()=>({multiplier:()=>l.pow(1.1,lt.value),description:"Unique plants eaten (x1.1 each)"})),L(()=>({multiplier:Y,description:`${p.name} level (x1.1 each)`})),Le.batteries.breeding.timePassing.modifier]),We=w(()=>new l(Ve.apply(1)).toNumber()),Ue=ne(()=>[Le.batteries.breeding.xpGain.modifier,L(()=>({multiplier:Y,description:`${p.name} level (x1.1 each)`}))]),ce={timePassing:Ve,jobXpGain:Ue},[vt,_t]=Ht(()=>[{title:"Time Passing",modifier:Ve,base:1},{title:`${p.name} EXP Gain`,modifier:Ue,base:1}]),at=$n({general:()=>({display:"General",glowColor(){return at.activeTab.value===this.tab?t:""},tab:vt,generalTabCollapsed:_t})},()=>({style:`--layer-color: ${t}`}));return this.on("preUpdate",x=>{p.timeLoopActive.value===!1&&G.tabs[1]!==wi||(x=l.times(x,We.value).toNumber(),Object.values(wt).forEach(A=>{var ke;const O=A.timers.value;for(let ie=0;ie<A.machines.amount.value;ie++){const Xe=(ke=A.inputs.value[ie])!=null?ke:[];A.isRunning(Xe,ie)?(O[ie]+=u.value.type===A.id&&u.value.index===ie?x*2:x,l.gte(O[ie],A.duration(Xe))&&(A.onActivate(A.inputs.value[ie],ie),O[ie]=0)):O[ie]=0}A.timers.value=O}))}),Ot.on("update",(x,A)=>{p.timeLoopActive.value===!1&&G.tabs[1]!==wi||Object.values(J).forEach(O=>{O.consumedTimeRemaining.value!==0&&(O.consumedTimeRemaining.value=Math.max(0,O.consumedTimeRemaining.value-A))})}),{name:e,color:t,minWidth:670,job:p,modifiers:ce,milestones:W,collapseMilestones:P,modifierTabs:at,machines:wt,seeds:i,selectedSeed:a,recycling:r,plants:J,breedingOutputs:Se,analyzingOutputs:mt,mutatingOutputs:pe,poweredUpMachine:u,plantsCollapsed:d,seedsCollapsed:c,display:k(()=>{const x=[...M.value];Z.value&&x.push(Z.value);const A=Object.keys(J).filter(O=>J[O].discovered.value||l.gt(J[O].amount.value,0));return s(F,null,[s(Ei,{resource:n,color:t},null),ni(...x,k(()=>cn(s(ai,{collapsed:P,content:re,display:P.value?"Show other completed milestones":"Hide other completed milestones"},null),[[kn,o(oe)]]))),s($e,null,null),h.earned.value?s(F,null,[s("div",null,[m("Select a machine by clicking on its progress bar to make it work 2x faster")]),s($e,null,null)]):null,Ye(Te),Ye(Tt),Ye(ye),Ye(z),Ye(Ne),A.length>0?s(F,null,[s($e,null,null),s("h2",{class:{"breeding-collapsible":!0,collapsed:d.value},onClick:()=>d.value=!d.value},[s("span",{class:"toggle"},[m("\u25BC")]),m("Plants")]),d.value?null:xi(...A.map(O=>J[O]))]):null,s($e,null,null),s("h2",{class:{"breeding-collapsible":!0,collapsed:c.value},onClick:()=>c.value=!c.value},[s("span",{class:"toggle"},[m("\u25BC")]),m("Seeds")]),c.value?null:s("div",{style:"width: 600px"},[i.value.map(O=>s(ci,{seed:O,selected:a.value===O,onClick:()=>{a.value=a.value===O?"none":O}},null)),s("hr",null,null),s("div",{style:"display: flex; align-items: center; text-align: left"},[s(ci,{seed:r.value,onClick:()=>{a.value==="none"?r.value!=="none"&&(i.value.push(r.value),r.value="none"):(r.value=a.value,i.value=i.value.filter(O=>O!==a.value),a.value="none")}},{default:()=>[r.value==="none"?s("div",{class:"material-icons",style:"font-size: xxx-large; color: var(--outline); position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);z-index: -1;"},[m("delete")]):null]}),s("span",{style:"margin-left: 10px"},[m("Click here to trash your selected seed, or restore your most recently trashed seed.")])])])])})}}),wm={min:.5,max:1},_m=[{s:0,cp:.329,e:.548},{s:.548,cp:.767,e:.876},{s:.876,cp:.985,e:1}],Cm=.001,Sm=.1,km=100,Nm=!0,$m={x:0,y:0},xm=!1,Mm=[{type:"alpha",config:{alpha:{list:[{time:0,value:.74},{time:1,value:0}]}}},{type:"moveSpeed",config:{speed:{list:[{time:0,value:700},{time:1,value:0}]},minMult:1}},{type:"scale",config:{scale:{list:[{time:0,value:5},{time:1,value:1.2}]},minMult:1}},{type:"color",config:{color:{list:[{time:0,value:"#ffdfa0"},{time:1,value:"#100f0c"}]}}},{type:"rotation",config:{accel:0,minSpeed:0,maxSpeed:200,minStart:0,maxStart:360}},{type:"textureRandom",config:{textures:["/particle.png"]}},{type:"spawnShape",config:{type:"rect",data:{x:0,y:0,w:200,h:100}}}];var na={lifetime:wm,ease:_m,frequency:Cm,emitterLifetime:Sm,maxParticles:km,addAtBack:Nm,pos:$m,emit:xm,behaviors:Mm};const Aa=e=>(nn("data-v-22f08ee0"),e=e(),ln(),e),Pm={class:"modal-mask",style:{"z-index":"10","background-color":"var(--raised-background)",top:"50px"}},Tm={class:"cutscene-positioner"},Im={class:"modal-container cutscene-container"},Em=Aa(()=>v("div",{class:"paper-background"},null,-1)),Fm={class:"content"},qm={key:0,class:"caption"},Dm={style:{display:"none"}},Lm={id:"wavy2"},Am=["seed"],Om=Aa(()=>v("feDisplacementMap",{in:"SourceGraphic",scale:"20"},null,-1)),Rm=K({__name:"Cutscene",props:{stage:null,caption:null},emits:["next"],setup(e,{emit:t}){const n=e,i=tn(n,"stage"),a=tn(n,"caption"),r=X(1);tt([i,a],()=>r.value++);const u=ei(i),d=Pn(a);return(c,p)=>(g(),U(sa,{to:"#modal-root"},[s(Qi,{name:"cutscene-modal"},{default:se(()=>[v("div",Pm,[v("div",Tm,[v("div",Im,[Em,v("div",Fm,[(g(),U(Pe(o(u)))),o(d)?(g(),$("div",qm,[(g(),U(Pe(o(d))))])):j("",!0)]),v("button",{onClick:p[0]||(p[0]=f=>t("next")),class:"button next"},"Next")]),(g(),$("svg",Dm,[v("filter",Lm,[v("feTurbulence",{x:"-50vw",y:"-50vh",width:"200vw",height:"200vh",baseFrequency:"0.015",numOctaves:"10",seed:r.value},null,8,Am),Om])]))])])]),_:1})]))}});var jm=me(Rm,[["__scopeId","data-v-22f08ee0"]]);const ia=vi(),Fl=["flowers","distill","study","experiments","generators","breeding","rituals"],Bm="main",rt=Tn(Bm,function(){const e=H(0),t={flowers:De.job,distill:Ke.job,study:bn.job,experiments:Ce.job,generators:Le.job,breeding:Ct.job,rituals:ti.job},n=w(()=>{let C=0;return e.value>1&&(C=1,bn.milestones.timeSlotMilestone.earned.value&&C++,Ce.milestones.timeSlotMilestone.earned.value&&C++,ti.milestones.timeSlotMilestone.earned.value&&C++),C}),i=w(()=>Object.values(t).filter(C=>C.timeLoopActive.value).length+Le.extraTimeSlotsAllocated.value),a=w(()=>n.value>i.value),r=H([0,0,0,0,0]);Object.values(t).forEach(C=>{let T=0;tt(C.rawLevel,(W,le)=>{var P;if(!(Ae.active!==G.id||l.neq(W,l.add(le,1)))&&(C.notif!=null&&ia.dismiss(C.notif),C.notif=ia.info(`${C.name} is now level ${W}!`),Date.now()-T>500)){const M=(P=rt.nodes.value[C.id])==null?void 0:P.rect,Z=f.boundingRect.value;if(M&&Z){T=Date.now();const re=Object.assign({},na,{behaviors:[...na.behaviors.slice(0,-1),{type:"spawnShape",config:{type:"rect",data:{x:M.x-Z.x,y:M.y-Z.y,w:M.width,h:M.height}}}]});f.addEmitter(re).then(oe=>oe.playOnceAndDestroy())}}})});const u=dn(w(()=>Object.values(t).reduce((C,T)=>C.add(T.level.value),new l(0))),"Sum of all job levels"),d=Mo(u),c=el(u),p=pc(()=>({display:{title:"<h1>Close the time loop</h1>",description:"<br/><i>The flowers are collected, and I have just enough. It's time to get started.</i>"},requirements:[],style:`width: 150px; height: 150px; --layer-color: ${De.color}`,visibility:()=>e.value==1&&l.gte(De.flowers.value,1e7)})),f=Yi(()=>({boundingRect:X(null),onContainerResized(C){this.boundingRect.value=C},style:"z-index: -1"})),h=X(null);Vt(()=>{if(Ae.active===G.id){if(e.value===0){h.value={pages:[{stage:k(()=>s("img",{style:"max-width: 100%; flex-grow: 1",src:"https://upload.wikimedia.org/wikipedia/commons/7/71/Serpiente_alquimica.jpg"},null))},{stage:k(()=>s("img",{style:"max-width: 100%; flex-grow: 1",src:"https://dummyimage.com/720x320/000/fff.png"},null)),caption:"Test"},{stage:k(()=>s("div",{style:"display: flex"},[s("img",{style:"max-width: 100%; flex-grow: 1; margin-right: -20%",src:"https://dummyimage.com/386x320/000/fff.png"},null),s("img",{style:"max-width: 100%; flex-grow: 1; margin-left: -20%",src:"https://dummyimage.com/386x320/000/fff.png"},null)])),caption:"Other test"}],page:0,onFinished(){e.value=1,wn(De,G)}};return}else if(e.value===1&&p.bought.value){h.value={pages:[{stage:k(()=>s("img",{style:"max-width: 100%; flex-grow: 1",src:"https://dummyimage.com/720x320/000/fff.png"},null)),caption:"I can wrap this field in a time loop and reset it whenever the field is empty. If I take the flowers out of the loop before hand I will have a perfectly sustainable source of moly."},{stage:k(()=>s("img",{style:"max-width: 100%; flex-grow: 1",src:"https://dummyimage.com/720x320/000/fff.png"},null)),caption:"Now my focus will be transforming the flowers, and determining how best to utilize their power. I'll start by distilling the flowers into their component elements."}],page:0,onFinished(){e.value=2,wn(Ke,G)}};return}h.value=null}});const y=w(()=>e.value===1?s("h2",null,[m("Current Goal: Harvest all the moly"),s("br",null,null),m("("),ge(l.sub(1e7,De.flowers.value).clampMin(0))," ",m("remaining)")]):e.value==2?s("h2",null,[m("Current Goal: Perform Ritual of G\xE9nesis")]):s(F,null,null)),_=Vn("???",()=>({color:"black",image:"https://dummyimage.com/720x320/000/fff.png",imageFocus:{x:"50%",y:"50%"},layerID:"unknown",symbol:"",loopable:!1,visibility:()=>Le.milestones.jobMilestone.earned.value!==Ct.milestones.jobMilestone.earned.value?Re.Visible:Re.None,classes:{broken:!0},open:()=>{}}));return{name:"Jobs",chapter:e,timeSlots:n,hasTimeSlotAvailable:a,resetTimes:r,closeTimeLoop:p,activeCutscene:h,classes:{nigredo:!0},jobs:t,partialJob:_,sumJobLevels:u,bestJobLevelsSum:c,totalJobLevelsSum:d,display:k(()=>h.value?s(jm,{stage:h.value.pages[h.value.page].stage,caption:h.value.pages[h.value.page].caption,onNext:()=>{var C,T;h.value&&(h.value.page==h.value.pages.length-1?(T=(C=h.value).onFinished)==null||T.call(C):h.value.page++)}},null):s(F,null,[G.devSpeed===0?s("div",null,[m("Game Paused")]):null,G.devSpeed&&G.devSpeed!==1?s("div",null,[m("Dev Speed: "),ze(G.devSpeed),m("x")]):null,G.offlineTime?s("div",null,[m("Offline Time: "),Rn(G.offlineTime)]):null,G.devSpeed!=null||G.offlineTime!=null?s($e,null,null):null,o(y),s($e,null,null),l.gt(n.value,0)?s("div",null,[n.value-i.value,m(" Time Slot"),n.value-i.value===1?"":"s",m(" Available")]):null,xi(...Object.values(t),_),Ye(p),Ye(f)]))}});Ot.on("update",e=>{rt.chapter.value>-1&&rt.activeCutscene.value!=null&&(rt.resetTimes.value[rt.chapter.value-1]+=e)});const yl=w(()=>Fl.filter(e=>ht(rt.jobs[e].visibility)).length),Vm=e=>{var n,i,a,r,u,d,c,p,f,h,y,_,C,T,W,le,P,M,Z,re,oe,B,J,je,Te,Se,Je;const t=(a=(i=(n=e.layers)==null?void 0:n.main)==null?void 0:i.chapter)!=null?a:0;if(t===0)return[rt];if(t===1)return[rt,De];if(t===2){const ae=[rt,De,Ke];return((c=(d=(u=(r=e.layers)==null?void 0:r.distill)==null?void 0:u.milestones)==null?void 0:d.studyMilestone)==null?void 0:c.earned)===!0&&ae.push(bn),((y=(h=(f=(p=e.layers)==null?void 0:p.distill)==null?void 0:f.milestones)==null?void 0:h.experimentsMilestone)==null?void 0:y.earned)===!0&&ae.push(Ce),((W=(T=(C=(_=e.layers)==null?void 0:_.experiments)==null?void 0:C.milestones)==null?void 0:T.jobMilestone)==null?void 0:W.earned)===!0&&ae.push(Le),((Z=(M=(P=(le=e.layers)==null?void 0:le.study)==null?void 0:P.milestones)==null?void 0:M.jobMilestone)==null?void 0:Z.earned)===!0&&ae.push(Ct),((J=(B=(oe=(re=e.layers)==null?void 0:re.generators)==null?void 0:oe.milestones)==null?void 0:B.jobMilestone)==null?void 0:J.earned)===!0&&((Je=(Se=(Te=(je=e.layers)==null?void 0:je.breeding)==null?void 0:Te.milestones)==null?void 0:Se.jobMilestone)==null?void 0:Je.earned)===!0&&ae.push(ti),ae}throw`Chapter ${t} not supported`},Oa=w(()=>!1);function zm(e,t){}var Gm=Object.freeze(Object.defineProperty({__proto__:null,jobKeys:Fl,main:rt,numJobs:yl,getInitialLayers:Vm,hasWon:Oa,fixOldSave:zm},Symbol.toStringTag,{value:"Module"}));const Um={class:"modifier-info-toggle"},Xm=K({__name:"ModifierInfo",props:{display:null,name:null},setup(e){const n=tn(e,"display"),i=X(!1),a=St();let r=null;return tt(i,u=>{r==null||r(),u?r=Vt(()=>{a.value=he(ot(n))}):r=null}),Cl(()=>r==null?void 0:r()),(u,d)=>(g(),$(F,null,[s(st,{direction:o(xe).Left,display:"Open Modifiers",xoffset:"10px"},{default:se(()=>[v("div",Um,[v("button",{onClick:d[0]||(d[0]=Yn(c=>i.value=!0,["stop"]))},"?")])]),_:1},8,["direction"]),s(jn,Jt({modelValue:i.value,"onUpdate:modelValue":d[1]||(d[1]=c=>i.value=c),class:"modifiers-modal"},u.$attrs),{header:se(()=>[v("h2",null,ee(e.name)+" Modifiers",1)]),body:se(({shown:c})=>[c?(g(),U(Pe(o(a)),{key:0})):j("",!0)]),_:1},16,["modelValue"])],64))}});var Hm=me(Xm,[["__scopeId","data-v-19951ae7"]]),Jm=K({props:{visibility:{type:R(Number),required:!0},style:R(String,Object,Array),classes:R(Object),xp:{type:Object,required:!0},level:{type:Object,required:!0},levelProgress:{type:Object,required:!0},timeLoopActive:{type:Object,required:!0},name:{type:String,required:!0},color:{type:R(String),required:!0},image:{type:R(String),required:!0},imageFocus:{type:R(Object),required:!0},resource:[Object,Array],layerID:{type:String,required:!0},currentQuip:{type:Object,required:!0},randomQuips:{type:R(Array)},modifierInfo:R(String,Object,Function),id:{type:String,required:!0},modifierModalAttrs:Object,showNotif:R(Boolean),loopable:R(Boolean),open:{type:Function,required:!0}},components:{Node:Bn,ModifierInfo:Hm,Tooltip:st,Notif:Nn},setup(e){const{layerID:t,currentQuip:n,randomQuips:i,resource:a}=ct(e),r=w(()=>G.tabs[1]==t.value),u=w(()=>rt.chapter.value>1),d=rt.hasTimeSlotAvailable;let c;Vt(()=>{var y;clearInterval(c);const h=(y=ot(i))!=null?y:[];n.value?c=setTimeout(()=>{n.value=null},15e3):c=setTimeout(()=>{n.value=h[Math.floor(Math.random()*h.length)]},Math.random()*15e3+15e3)}),wl(()=>clearInterval(c));const p=X(!1);tt(r,()=>{p.value=!0,setTimeout(()=>p.value=!1,250)});const f=w(()=>{if("displayName"in a)return[a];const h=o(a);return Array.isArray(h)?h:[]});return{selected:r,animating:p,finishedFirstChapter:u,hasTimeSlotAvailable:d,formatWhole:ge,unref:o,displayResource:Sn,resourceArray:f,Visibility:Re,Direction:xe,isVisible:ht,isHidden:Mn}}});const il=e=>(nn("data-v-244765c3"),e=e(),ln(),e),Wm=["src"],Qm={class:"job-contents"},Zm={class:"job-resource"},Km=il(()=>v("br",null,null,-1)),Ym=il(()=>v("br",null,null,-1)),ef={class:"job-title"},tf={style:{"margin-bottom":"0"}},nf=il(()=>v("span",{style:{"flex-grow":"1"}},null,-1)),lf={key:0,class:"job-quip"},af=il(()=>v("div",{class:"job-clipping-container"},[v("div",{class:"job-progress-container"},[v("div",{class:"job-progress"})])],-1)),sf=["disabled"];function rf(e,t,n,i,a,r){var f,h;const u=Ft("ModifierInfo"),d=Ft("Tooltip"),c=Ft("Node"),p=Ft("Notif");return e.isVisible(e.visibility)?(g(),$("span",{key:0,style:Oe([{visibility:e.isHidden(e.visibility)?"hidden":void 0,"--posx":e.unref(e.imageFocus).x,"--posy":e.unref(e.imageFocus).y,"--progress":`${(1-e.unref(e.levelProgress))*100}%`,"--foreground":e.unref(e.color)},(f=e.unref(e.style))!=null?f:{}]),class:Me(["feature dontMerge job",[{selected:e.selected,active:e.selected||e.unref(e.timeLoopActive),animating:e.animating},(h=e.unref(e.classes))!=null?h:{}]]),onClick:t[1]||(t[1]=(...y)=>e.open&&e.open(...y))},[v("img",{src:e.unref(e.image)},null,8,Wm),v("div",Qm,[(g(!0),$(F,null,xn(e.resourceArray,(y,_)=>(g(),$(F,{key:_},[v("div",Zm,[m(ee(e.displayResource(y))+" "+ee(y.displayName),1),Km]),Ym],64))),128)),v("div",ef,[v("h2",null,ee(e.name),1),v("span",tf,"Lv. "+ee(e.formatWhole(e.level.value)),1),nf,e.modifierInfo?(g(),U(u,Jt({key:0,display:e.modifierInfo,name:e.name},e.modifierModalAttrs),null,16,["display","name"])):j("",!0)])]),e.selected&&e.unref(e.currentQuip)?(g(),$("div",lf,'"'+ee(e.unref(e.currentQuip))+'"',1)):j("",!0),af,e.unref(e.loopable)!==!1?(g(),U(d,{key:1,direction:e.Direction.Left,display:"Toggle Time Loop",class:"job-loop-toggle"},{default:se(()=>[e.finishedFirstChapter?(g(),$("button",{key:0,class:Me(["material-icons",{active:e.unref(e.timeLoopActive)}]),onClick:t[0]||(t[0]=Yn(y=>e.timeLoopActive.value=!e.unref(e.timeLoopActive),["stop"])),disabled:!e.hasTimeSlotAvailable&&!e.unref(e.timeLoopActive)}," all_inclusive ",10,sf)):j("",!0)]),_:1},8,["direction"])):j("",!0),s(c,{id:e.id},null,8,["id"]),e.unref(e.showNotif)?(g(),U(p,{key:2})):j("",!0)],6)):j("",!0)}var of=me(Jm,[["render",rf],["__scopeId","data-v-244765c3"]]);const uf=Symbol("Job"),ql=.7643;function Vn(e,t){const n=dn(0,e+" XP"),i=H(!1);return pt(()=>{const a=t();return a.id=pn("job-"),a.type=uf,a[it]=of,a.name=e,a.xp=n,a.timeLoopActive=i,a.rawLevel=w(()=>{const r=a;if(l.eq(r.xp.value,0))return 1;let u=l.clampMin(r.xp.value,1).log10().add(1);return u.gt(25)&&(u=u.sub(25).pow(ql).add(25)),u.floor()}),a.level=dn(w(()=>a.rawLevel.value),a.name+" Levels"),a.levelProgress=w(()=>{const r=a,u=r.rawLevel.value,d=la(u),c=la(l.add(u,1));let p;return l.lt(u,25)?p=l.sub(r.xp.value,d).div(l.sub(c,d)).toNumber():p=l.log10(r.xp.value).sub(l.log10(d)).div(l.log10(c).sub(l.log10(d))).toNumber(),p}),a.active=w(()=>ht(a.visibility)&&(a.timeLoopActive.value||G.tabs[1]===a.layerID)),a.currentQuip=X(null),nt(a,"open",function(){G.tabs.splice(1,1,a.layerID)}),a.setQuip=function(r){const u=a;if(u.currentQuip.value){u.currentQuip.value=null,en(u.setQuip);return}if(r)u.currentQuip.value=r;else if(o(u.randomQuips)){const d=o(u.randomQuips);u.currentQuip.value=d[Math.floor(Math.random()*d.length)]}},q(a,"visibility"),nt(a,"visibility",Re.Visible),q(a,"classes"),q(a,"style"),q(a,"color"),q(a,"image"),q(a,"imageFocus"),q(a,"randomQuips"),q(a,"modifierInfo"),q(a,"showNotif"),q(a,"loopable"),a[Ge]=function(){const{id:r,xp:u,level:d,levelProgress:c,timeLoopActive:p,name:f,visibility:h,color:y,image:_,imageFocus:C,resource:T,layerID:W,classes:le,style:P,currentQuip:M,randomQuips:Z,modifierInfo:re,modifierModalAttrs:oe,showNotif:B,loopable:J,open:je}=this;return{id:r,xp:u,level:d,levelProgress:c,timeLoopActive:p,name:f,visibility:h,color:y,image:_,imageFocus:C,resource:T,layerID:W,classes:le,style:o(P),currentQuip:M,randomQuips:Z,modifierInfo:re,modifierModalAttrs:oe,showNotif:B,loopable:J,open:je}},a})}function la(e){return l.eq(e,1)?0:(l.gt(e,25)&&(e=l.sub(e,25).pow(1/ql).add(25)),l.sub(e,1).pow10())}const cf={key:0},df=["onClick","disabled"],pf={key:0},mf=["onClick"],ff=K({__name:"DangerButton",props:{disabled:{type:Boolean},skipConfirm:{type:Boolean}},emits:["click","confirmingChanged"],setup(e,{emit:t}){const i=ct(e),a=X(!1);tt(a,d=>{t("confirmingChanged",d)});function r(){if(o(i.skipConfirm)){t("click");return}a.value&&t("click"),a.value=!a.value}function u(){a.value=!1}return(d,c)=>(g(),$("span",{class:Me(["container",{confirming:a.value}])},[a.value?(g(),$("span",cf,"Are you sure?")):j("",!0),v("button",{onClick:Yn(r,["stop"]),class:"button danger",disabled:e.disabled},[a.value?(g(),$("span",pf,"Yes")):Wt(d.$slots,"default",{key:1},void 0,!0)],8,df),a.value?(g(),$("button",{key:1,class:"button",onClick:Yn(u,["stop"])},"No",8,mf)):j("",!0)],2))}});var vf=me(ff,[["__scopeId","data-v-2f8ef34c"]]);const In=e=>(nn("data-v-469c499e"),e=e(),ln(),e),gf=In(()=>v("div",{class:"handle material-icons"},"drag_handle",-1)),hf={key:0,class:"actions"},bf=In(()=>v("span",{class:"material-icons"},"content_paste",-1)),yf=In(()=>v("span",{class:"material-icons"},"content_copy",-1)),wf=In(()=>v("span",{class:"material-icons"},"edit",-1)),_f=In(()=>v("span",{class:"material-icons",style:{margin:"-2px"}},"delete",-1)),Cf={key:1,class:"actions"},Sf=In(()=>v("span",{class:"material-icons"},"check",-1)),kf=In(()=>v("span",{class:"material-icons"},"close",-1)),Nf={key:2,class:"details"},$f={class:"save-version"},xf=In(()=>v("br",null,null,-1)),Mf={key:0},Pf={key:1},Tf={key:3,class:"details"},If={key:4,class:"details error"},Ef=In(()=>v("br",null,null,-1)),Ff=K({__name:"Save",props:{save:null},emits:["export","open","duplicate","delete","editName"],setup(e,{emit:t}){const n=e,{save:i}=ct(n),a=new Intl.DateTimeFormat("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),r=X(!1),u=X(!1),d=X("");tt(r,()=>{var y;return d.value=(y=i.value.name)!=null?y:""});const c=w(()=>i.value!=null&&i.value.id===G.id),p=w(()=>{var y;return c.value?G.time:(y=i.value!=null&&i.value.time)!=null?y:0}),f=ei(w(()=>{var _,C,T,W,le,P,M,Z,re,oe,B,J,je;const y=(W=(T=(C=(_=i.value)==null?void 0:_.layers)==null?void 0:C.main)==null?void 0:T.chapter)!=null?W:0;if(y==0)return"Just started";if(y==1){const Te=(Z=(M=(P=(le=i.value)==null?void 0:le.layers)==null?void 0:P.flowers)==null?void 0:M.flowers)!=null?Z:0;return`Chapter 1; ${ge(Te)} flowers`}else if(y==2){const Te=(je=Object.values((J=(B=(oe=(re=i.value)==null?void 0:re.layers)==null?void 0:oe.main)==null?void 0:B.jobs)!=null?J:{}).reduce((Se,Je)=>{if(Je.xp==null)return Se;if(l.eq(Je.xp,0))return Se.add(1);let ae=l.clampMin(Je.xp,1).log10().add(1);return ae.gt(25)&&(ae=ae.sub(25).pow(ql).add(25)),ae.floor().add(Se)},new l(0)))!=null?je:new l(0);return`Chapter 2; ${ge(Te)} total job levels`}else return`Chapter ${y}`}));function h(){t("editName",d.value),r.value=!1}return(y,_)=>(g(),$("div",{class:Me(["save",{active:o(c)}])},[gf,r.value?(g(),$("div",Cf,[v("button",{onClick:h,class:"button"},[s(st,{display:"Save",direction:o(xe).Left,class:"info"},{default:se(()=>[Sf]),_:1},8,["direction"])]),v("button",{onClick:_[5]||(_[5]=C=>r.value=!r.value),class:"button"},[s(st,{display:"Cancel",direction:o(xe).Left,class:"info"},{default:se(()=>[kf]),_:1},8,["direction"])])])):(g(),$("div",hf,[o(i).error==null&&!u.value?(g(),U(Na,{key:0,onClick:_[0]||(_[0]=C=>t("export")),class:"button",left:""},{default:se(()=>[s(st,{display:"Export",direction:o(xe).Left,class:"info"},{default:se(()=>[bf]),_:1},8,["direction"])]),_:1})):j("",!0),o(i).error==null&&!u.value?(g(),$("button",{key:1,onClick:_[1]||(_[1]=C=>t("duplicate")),class:"button"},[s(st,{display:"Duplicate",direction:o(xe).Left,class:"info"},{default:se(()=>[yf]),_:1},8,["direction"])])):j("",!0),o(i).error==null&&!u.value?(g(),$("button",{key:2,onClick:_[2]||(_[2]=C=>r.value=!r.value),class:"button"},[s(st,{display:"Edit Name",direction:o(xe).Left,class:"info"},{default:se(()=>[wf]),_:1},8,["direction"])])):j("",!0),s(vf,{disabled:o(c),onClick:_[3]||(_[3]=C=>t("delete")),onConfirmingChanged:_[4]||(_[4]=C=>u.value=C)},{default:se(()=>[s(st,{display:"Delete",direction:o(xe).Left,class:"info"},{default:se(()=>[_f]),_:1},8,["direction"])]),_:1},8,["disabled"])])),o(i).error==null&&!r.value?(g(),$("div",Nf,[v("button",{class:"button open",onClick:_[6]||(_[6]=C=>t("open"))},[v("h3",null,ee(o(i).name),1)]),v("span",$f,"v"+ee(o(i).modVersion),1),xf,o(p)?(g(),$("div",Mf,"Last played "+ee(o(a).format(o(p))),1)):j("",!0),o(f)?(g(),$("div",Pf,[(g(),U(Pe(o(f))))])):j("",!0)])):o(i).error==null&&r.value?(g(),$("div",Tf,[s($a,{modelValue:d.value,"onUpdate:modelValue":_[7]||(_[7]=C=>d.value=C),class:"editname",onSubmit:h},null,8,["modelValue"])])):(g(),$("div",If,[m(" Error: Failed to load save with id "+ee(o(i).id),1),Ef,m(ee(o(i).error),1)]))],2))}});var qf=me(Ff,[["__scopeId","data-v-469c499e"]]);const Dl=e=>(nn("data-v-5b5b1604"),e=e(),ln(),e),Df=Dl(()=>v("h2",null,"Saves Manager",-1)),Lf={class:"modal-footer"},Af={class:"field"},Of=Dl(()=>v("span",{class:"field-title"},"Create Save",-1)),Rf={class:"field-buttons"},jf={class:"footer"},Bf=Dl(()=>v("div",{style:{"flex-grow":"1"}},null,-1)),Vf=K({__name:"SavesManager",setup(e,{expose:t}){const n=X(!1),i=X(null);t({open(){n.value=!0}});const a=X(!1),r=X(""),u=X(null);tt(r,P=>{P?en(()=>{try{if(P[0]!=="{")if(P[0]==="e")P=decodeURIComponent(escape(atob(P)));else if(P[0]==="\u1BE1")P=Dn.decompressFromUTF16(P);else{console.warn("Unable to determine preset encoding",P),a.value=!0;return}const M=JSON.parse(P);if(typeof M!="object"){a.value=!0;return}const Z=Ri();M.id=Z,Yt(M),r.value="",a.value=!1,Ae.saves.push(Z)}catch{a.value=!0}}):a.value=!1});let d={},c=X(Object.keys(d).reduce((P,M)=>(P.push({label:M.split("/").slice(-1)[0].slice(0,-4),value:d[M]}),P),[]));const p=_l({});function f(P){if(p[P]==null){let M=localStorage.getItem(P);if(M==null)p[P]={error:"Save doesn't exist in localStorage",id:P};else if(M==="dW5kZWZpbmVk")p[P]={error:"Save is undefined",id:P};else try{if(M[0]!=="{")if(M[0]==="e")M=decodeURIComponent(escape(atob(M)));else if(M[0]==="\u1BE1")M=Dn.decompressFromUTF16(M);else return console.warn("Unable to determine preset encoding",M),a.value=!0,p[P]={error:"Unable to determine preset encoding",id:P},p[P];p[P]={...JSON.parse(M),id:P}}catch(Z){p[P]={error:Z,id:P},console.warn(`SavesManager: Failed to load info about save with id ${P}:
${Z}
${M}`)}}return p[P]}tt(n,P=>{P&&Object.keys(p).forEach(M=>delete p[M])});const h=w(()=>Ae.saves.reduce((P,M)=>(P[M]=f(M),P),{}));function y(P){let M;switch(G.id===P?M=ha(G):M=JSON.stringify(h.value[P]),He.exportEncoding){default:console.warn(`Unknown save encoding: ${He.exportEncoding}. Defaulting to lz`);case"lz":M=Dn.compressToUTF16(M);break;case"base64":M=btoa(unescape(encodeURIComponent(M)));break;case"plain":break}const Z=document.createElement("textarea");Z.value=M,document.body.appendChild(Z),Z.select(),Z.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(Z)}function _(P){G.id===P&&Yt();const M={...h.value[P],id:Ri()};Yt(M),Ae.saves.push(M.id)}function C(P){Ae.saves=Ae.saves.filter(M=>M!==P),localStorage.removeItem(P),p[P]=void 0}function T(P){h.value[G.id].time=G.time,Yt(),p[G.id]=void 0,Qn(h.value[P]),p[P]=void 0}function W(P){if(u.value=P,en(()=>{u.value=null}),P[0]!=="{")if(P[0]==="e")P=decodeURIComponent(escape(atob(P)));else if(P[0]==="\u1BE1")P=Dn.decompressFromUTF16(P);else{console.warn("Unable to determine preset encoding",P);return}const M=JSON.parse(P);M.id=Ri(),Yt(M),Ae.saves.push(M.id),T(M.id)}function le(P,M){const Z=h.value[P];Z!=null&&(Z.name=M,G.id===P?(G.name=M,Yt()):(Yt(Z),p[P]=void 0))}return(P,M)=>(g(),U(jn,{modelValue:n.value,"onUpdate:modelValue":M[4]||(M[4]=Z=>n.value=Z),ref_key:"modal",ref:i},{header:se(()=>[Df]),body:se(({shown:Z})=>[Z?(g(),U(o(Wa),{key:0,list:o(Ae).saves,handle:".handle",itemKey:re=>re},{item:se(({element:re})=>[s(qf,{save:o(h)[re],onOpen:oe=>T(re),onExport:oe=>y(re),onEditName:oe=>le(re,oe),onDuplicate:oe=>_(re),onDelete:oe=>C(re)},null,8,["save","onOpen","onExport","onEditName","onDuplicate","onDelete"])]),_:1},8,["list","itemKey"])):j("",!0)]),footer:se(()=>[v("div",Lf,[s($a,{modelValue:r.value,"onUpdate:modelValue":M[0]||(M[0]=Z=>r.value=Z),title:"Import Save",placeholder:"Paste your save here!",class:Me({importingFailed:a.value})},null,8,["modelValue","class"]),v("div",Af,[Of,v("div",Rf,[v("button",{class:"button",onClick:M[1]||(M[1]=Z=>T(o(di)().id))},"New Game"),Object.keys(o(c)).length>0?(g(),U(Pl,{key:0,options:o(c),modelValue:u.value,"onUpdate:modelValue":M[2]||(M[2]=Z=>W(Z)),closeOnSelect:"",placeholder:"Select preset",class:"presets"},null,8,["options","modelValue"])):j("",!0)])]),v("div",jf,[Bf,v("button",{class:"button modal-default-button",onClick:M[3]||(M[3]=Z=>n.value=!1)}," Close ")])])]),_:1},8,["modelValue"]))}});var Ra=me(Vf,[["__scopeId","data-v-5b5b1604"]]);const an=e=>(nn("data-v-2ba32660"),e=e(),ln(),e),zf=["src","alt"],Gf={key:1,class:"title"},Uf=an(()=>v("div",{style:{"flex-grow":"1",cursor:"unset"}},null,-1)),Xf={class:"discord"},Hf={class:"discord-links"},Jf={key:0},Wf=["href"],Qf=an(()=>v("li",null,[v("a",{href:"https://discord.gg/WzejVAx",target:"_blank"},"The Paper Pilot Community")],-1)),Zf=an(()=>v("li",null,[v("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),Kf={href:"https://forums.moddingtree.com/",target:"_blank"},Yf=an(()=>v("span",{class:"material-icons"},"forum",-1)),ev=an(()=>v("span",{class:"material-icons"},"info",-1)),tv=an(()=>v("span",{class:"material-icons"},"library_books",-1)),nv=an(()=>v("span",{class:"material-icons"},"settings",-1)),iv=an(()=>v("span",{class:"material-icons"},"library_books",-1)),lv=an(()=>v("span",{class:"material-icons"},"settings",-1)),av=an(()=>v("span",{class:"material-icons"},"info",-1)),sv={href:"https://forums.moddingtree.com/",target:"_blank"},rv=an(()=>v("span",{class:"material-icons"},"forum",-1)),ov={class:"discord"},uv={class:"discord-links"},cv={key:0},dv=["href"],pv=an(()=>v("li",null,[v("a",{href:"https://discord.gg/WzejVAx",target:"_blank"},"The Paper Pilot Community")],-1)),mv=an(()=>v("li",null,[v("a",{href:"https://discord.gg/F3xveHV",target:"_blank"},"The Modding Tree")],-1)),fv=K({__name:"Nav",setup(e){const t=X(null),n=X(null),i=X(null),a=X(null),{useHeader:r,banner:u,title:d,discordName:c,discordLink:p,versionNumber:f}=He;function h(){window.open(p,"mywindow")}return(y,_)=>(g(),$(F,null,[o(r)?(g(),$("div",Jt({key:0,class:"nav"},y.$attrs),[o(u)?(g(),$("img",{key:0,src:o(u),class:"banner",alt:o(d),style:{"margin-left":"10px"}},null,8,zf)):(g(),$("div",Gf,ee(o(d)),1)),v("div",{onClick:_[0]||(_[0]=C=>{var T;return(T=a.value)==null?void 0:T.open()}),class:"version-container"},[s(st,{display:"Changelog",direction:o(xe).Down,class:"version"},{default:se(()=>[v("span",null,"v"+ee(o(f)),1)]),_:1},8,["direction"])]),Uf,v("div",Xf,[v("span",{onClick:h,class:"material-icons"},"discord"),v("ul",Hf,[o(p)?(g(),$("li",Jf,[v("a",{href:o(p),target:"_blank"},ee(o(c)),9,Wf)])):j("",!0),Qf,Zf])]),v("div",null,[v("a",Kf,[s(st,{display:"Forums",direction:o(xe).Down,yoffset:"5px"},{default:se(()=>[Yf]),_:1},8,["direction"])])]),v("div",{onClick:_[1]||(_[1]=C=>{var T;return(T=t.value)==null?void 0:T.open()})},[s(st,{display:"Info",direction:o(xe).Down,class:"info"},{default:se(()=>[ev]),_:1},8,["direction"])]),v("div",{onClick:_[2]||(_[2]=C=>{var T;return(T=n.value)==null?void 0:T.open()})},[s(st,{display:"Saves",direction:o(xe).Down,xoffset:"-20px"},{default:se(()=>[tv]),_:1},8,["direction"])]),v("div",{onClick:_[3]||(_[3]=C=>{var T;return(T=i.value)==null?void 0:T.open()})},[s(st,{display:"Settings",direction:o(xe).Down,xoffset:"-66px"},{default:se(()=>[nv]),_:1},8,["direction"])])],16)):(g(),$("div",Jt({key:1,class:"overlay-nav"},y.$attrs),[v("div",{onClick:_[4]||(_[4]=C=>{var T;return(T=a.value)==null?void 0:T.open()}),class:"version-container"},[s(st,{display:"Changelog",direction:o(xe).Right,xoffset:"25%",class:"version"},{default:se(()=>[v("span",null,"v"+ee(o(f)),1)]),_:1},8,["direction"])]),v("div",{onClick:_[5]||(_[5]=C=>{var T;return(T=n.value)==null?void 0:T.open()})},[s(st,{display:"Saves",direction:o(xe).Right},{default:se(()=>[iv]),_:1},8,["direction"])]),v("div",{onClick:_[6]||(_[6]=C=>{var T;return(T=i.value)==null?void 0:T.open()})},[s(st,{display:"Settings",direction:o(xe).Right},{default:se(()=>[lv]),_:1},8,["direction"])]),v("div",{onClick:_[7]||(_[7]=C=>{var T;return(T=t.value)==null?void 0:T.open()})},[s(st,{display:"Info",direction:o(xe).Right},{default:se(()=>[av]),_:1},8,["direction"])]),v("div",null,[v("a",sv,[s(st,{display:"Forums",direction:o(xe).Right,xoffset:"7px"},{default:se(()=>[rv]),_:1},8,["direction"])])]),v("div",ov,[v("span",{onClick:h,class:"material-icons"},"discord"),v("ul",uv,[o(p)?(g(),$("li",cv,[v("a",{href:o(p),target:"_blank"},ee(o(c)),9,dv)])):j("",!0),pv,mv])])],16)),s(eo,{ref_key:"info",ref:t,changelog:a.value},null,8,["changelog"]),s(Ra,{ref_key:"savesManager",ref:n},null,512),s(fo,{ref_key:"options",ref:i},null,512),s(Dr,{ref_key:"changelog",ref:a},null,512)],64))}});var ja=me(fv,[["__scopeId","data-v-2ba32660"]]);const vv={class:"inner-tab"},gv=K({__name:"Game",setup(e){const t=tn(G,"tabs"),n=w(()=>Object.keys(Gt)),i=He.useHeader;function a(r){const{display:u,minimized:d,name:c,color:p,minimizable:f,nodes:h,minimizedDisplay:y}=r;return{display:u,minimized:d,name:c,color:p,minimizable:f,nodes:h,minimizedDisplay:y}}return(r,u)=>(g(),$("div",{class:Me(["tabs-container",{useHeader:o(i)}])},[(g(!0),$(F,null,xn(o(t),(d,c)=>{var p,f;return g(),$("div",{key:c,class:Me(["tab",o((p=o(Gt)[d])==null?void 0:p.classes)]),style:Oe(o((f=o(Gt)[d])==null?void 0:f.style))},[c===0&&!o(i)?(g(),U(ja,{key:0})):j("",!0),v("div",vv,[o(n).includes(d)?(g(),U(Ir,Jt({key:0},a(o(Gt)[d]),{index:c,onSetMinimized:h=>o(Gt)[d].minimized.value=h}),null,16,["index","onSetMinimized"])):(g(),U(Pe(d),{key:1,index:c},null,8,["index"]))])],6)}),128))],2))}});var hv=me(gv,[["__scopeId","data-v-3e0f1aab"]]);const Fi=e=>(nn("data-v-4a50ce42"),e=e(),ln(),e),bv={class:"game-over-modal-header"},yv=["src","alt"],wv={class:"game-over-modal-title"},_v=Fi(()=>v("h2",null,"Congratulations!",-1)),Cv={key:0},Sv=Fi(()=>v("br",null,null,-1)),kv=Fi(()=>v("div",null," Please check the Discord to discuss the game or to check for new content updates! ",-1)),Nv=Fi(()=>v("br",null,null,-1)),$v=["href"],xv=Fi(()=>v("span",{class:"material-icons game-over-modal-discord"},"discord",-1)),Mv=K({__name:"GameOverScreen",setup(e){const{title:t,logo:n,discordName:i,discordLink:a,versionNumber:r,versionTitle:u}=He,d=w(()=>Rn(G.timePlayed)),c=w(()=>Oa.value&&!G.keepGoing),p=tn(G,"autosave");function f(){G.keepGoing=!0}function h(){Qn(di())}return(y,_)=>(g(),U(jn,{"model-value":o(c)},{header:se(()=>[v("div",bv,[o(n)?(g(),$("img",{key:0,class:"game-over-modal-logo",src:o(n),alt:o(t)},null,8,yv)):j("",!0),v("div",wv,[_v,v("h4",null,"You've beaten "+ee(o(t))+" v"+ee(o(r))+": "+ee(o(u)),1)])])]),body:se(({shown:C})=>[C?(g(),$("div",Cv,[v("div",null,"It took you "+ee(o(d))+" to beat the game.",1),Sv,kv,Nv,v("div",null,[v("a",{href:o(a),class:"game-over-modal-discord-link"},[xv,m(" "+ee(o(i)),1)],8,$v)]),s(Cn,{title:"Autosave",modelValue:o(p),"onUpdate:modelValue":_[0]||(_[0]=T=>Et(p)?p.value=T:null)},null,8,["modelValue"])])):j("",!0)]),footer:se(()=>[v("div",{class:"game-over-footer"},[v("button",{onClick:f,class:"button"},"Keep Going"),v("button",{onClick:h,class:"button danger"},"Play Again")])]),_:1},8,["model-value"]))}});var Pv=me(Mv,[["__scopeId","data-v-4a50ce42"]]);const ll=e=>(nn("data-v-336bf74f"),e=e(),ln(),e),Tv=ll(()=>v("div",{class:"nan-modal-header"},[v("h2",null,"NaN value detected!")],-1)),Iv={key:0},Ev=ll(()=>v("br",null,null,-1)),Fv=["href"],qv=ll(()=>v("span",{class:"material-icons nan-modal-discord"},"discord",-1)),Dv=ll(()=>v("br",null,null,-1)),Lv={class:"nan-footer"},Av=K({__name:"NaNScreen",setup(e){const{discordName:t,discordLink:n}=He,i=X(!0),a=X(!0),r=tn(Pt,"hasNaN"),u=X(null);tt(r,y=>{y?(i.value=G.autosave,a.value=G.devSpeed===0):(G.autosave=i.value,G.devSpeed=a.value?0:null)});const d=w(()=>{var y;return(y=Pt.NaNPath)==null?void 0:y.join(".")}),c=w(()=>Pt.NaNPersistent!=null?Pt.NaNPersistent.value:null);function p(){Pt.NaNPersistent!=null&&(Pt.NaNPersistent.value=new l(0),Pt.hasNaN=!1)}function f(){Pt.NaNPersistent&&(Pt.NaNPersistent.value=new l(1),Pt.hasNaN=!1)}function h(){Pt.NaNPersistent&&(Pt.NaNPersistent.value=new l(NaN),Pt.hasNaN=!1)}return(y,_)=>(g(),$(F,null,[s(jn,Jt({modelValue:o(r),"onUpdate:modelValue":_[4]||(_[4]=C=>Et(r)?r.value=C:null)},y.$attrs),{header:se(()=>[Tv]),body:se(()=>[v("div",null,[m(' Attempted to assign "'+ee(o(d))+'" to NaN',1),o(c)?(g(),$("span",Iv,ee(" ")+"(previously "+ee(o(ze)(o(c)))+")",1)):j("",!0),m(". Auto-saving has been "+ee(i.value?"enabled":"disabled")+". Check the console for more details, and consider sharing it with the developers on discord. ",1)]),Ev,v("div",null,[v("a",{href:o(n)||"https://discord.gg/WzejVAx",class:"nan-modal-discord-link"},[qv,m(" "+ee(o(t)||"The Paper Pilot Community"),1)],8,Fv)]),Dv,s(Cn,{title:"Autosave",modelValue:i.value,"onUpdate:modelValue":_[0]||(_[0]=C=>i.value=C)},null,8,["modelValue"]),o(He).enablePausing?(g(),U(Cn,{key:0,title:"Pause game",modelValue:a.value,"onUpdate:modelValue":_[1]||(_[1]=C=>a.value=C)},null,8,["modelValue"])):j("",!0)]),footer:se(()=>[v("div",Lv,[v("button",{onClick:_[2]||(_[2]=C=>{var T;return(T=u.value)==null?void 0:T.open()}),class:"button"},"Open Saves Manager"),v("button",{onClick:p,class:"button"},"Set to 0"),v("button",{onClick:f,class:"button"},"Set to 1"),o(c)&&o(l).neq(o(c),0)&&o(l).neq(o(c),1)?(g(),$("button",{key:0,onClick:_[3]||(_[3]=C=>r.value=!1),class:"button"}," Set to previous ")):j("",!0),v("button",{onClick:h,class:"button danger"},"Ignore")])]),_:1},16,["modelValue"]),s(Ra,{ref_key:"savesManager",ref:u},null,512)],64))}});var Ov=me(Av,[["__scopeId","data-v-336bf74f"]]);const Rv={key:0,class:"tpsDisplay"},jv={key:0,class:"low"},Bv=K({__name:"TPS",setup(e){const t=w(()=>l.div(Pt.lastTenTicks.length,Pt.lastTenTicks.reduce((r,u)=>r+u,0))),n=X([]);Vt(()=>{n.value.push(Math.round(t.value.toNumber())),n.value.length>10&&(n.value=n.value.slice(1))});const i=w(()=>n.value.reduce((r,u)=>l.max(r,u),0)),a=w(()=>l.sub(t.value,i.value).gt(1));return(r,u)=>o(t).isNan()?j("",!0):(g(),$("div",Rv,[m(" TPS: "+ee(o(ge)(o(t)))+" ",1),s(Qi,{name:"fade"},{default:se(()=>[o(a)?(g(),$("span",jv,ee(o(ge)(o(i))),1)):j("",!0)]),_:1})]))}});var Vv=me(Bv,[["__scopeId","data-v-46a3ed5b"]]);var zv=K({__name:"App",setup(e){const t=He.useHeader,n=w(()=>gi[Ae.theme].variables),i=tn(Ae,"showTPS"),a=w(()=>he(k(()=>s(F,null,[or.map(Ye)]))));return(r,u)=>(g(),$(F,null,[v("div",{id:"modal-root",style:Oe(o(n))},null,4),v("div",{class:Me(["app",{useHeader:o(t)}]),style:Oe(o(n))},[o(t)?(g(),U(ja,{key:0})):j("",!0),s(hv),o(o(i))?(g(),U(Vv,{key:1})):j("",!0),s(Pv),s(Ov),(g(),U(Pe(o(a))))],6)],64))}});var Gv=me(zv,[["__scopeId","data-v-41d15e5e"]]);function Uv(e={}){const{immediate:t=!1,onNeedRefresh:n,onOfflineReady:i,onRegistered:a,onRegisterError:r}=e;let u,d;const c=async(p=!0)=>{p&&(u==null||u.addEventListener("controlling",f=>{f.isUpdate&&window.location.reload()})),d&&d.waiting&&await is(d.waiting,{type:"SKIP_WAITING"})};if("serviceWorker"in navigator){u=new ns("./sw.js",{scope:"./",type:"classic"}),u.addEventListener("activated",p=>{p.isUpdate||i==null||i()});{const p=()=>{n==null||n()};u.addEventListener("waiting",p),u.addEventListener("externalwaiting",p)}u.register({immediate:t}).then(p=>{d=p,a==null||a(p)}).catch(p=>{r==null||r(p)})}return c}function Xv(e={}){const{immediate:t=!0,onNeedRefresh:n,onOfflineReady:i,onRegistered:a,onRegisterError:r}=e,u=X(!1),d=X(!1);return{updateServiceWorker:Uv({immediate:t,onNeedRefresh(){u.value=!0,n==null||n()},onOfflineReady(){d.value=!0,i==null||i()},onRegistered:a,onRegisterError:r}),offlineReady:d,needRefresh:u}}document.title=He.title;window.projInfo=He;if(He.id==="")throw new Error("Project ID is empty! Please select a unique ID for this project in /src/data/projInfo.json");requestAnimationFrame(async()=>{console.log(`%cMade in Profectus%c
Learn more at www.moddingtree.com`,"font-weight: bold; font-size: 24px; color: #A3BE8C; background: #2E3440; padding: 4px 8px; border-radius: 8px;","padding: 4px;"),await ir();const{globalBus:e}=await Gi(()=>Promise.resolve().then(function(){return tr}),void 0),{startGameLoop:t}=await Gi(()=>import("./gameLoop.71aec5fd.js"),["assets/gameLoop.71aec5fd.js","assets/@fontsource.f66d05e7.css","assets/vue.0b1ef07e.js","assets/earcut.b6f90e68.js","assets/@vue.a5783f16.js","assets/nanoevents.1080beb7.js","assets/lz-string.f2f3b7cf.js","assets/vue-next-select.348eb514.js","assets/vue-next-select.9e6f4164.css","assets/vuedraggable.3773156d.js","assets/sortablejs.a68aa018.js","assets/vue-textarea-autosize.35804eaf.js","assets/@pixi.d7e055ca.js","assets/ismobilejs.5c6954b9.js","assets/eventemitter3.dc5195d7.js","assets/url.832c6d94.js","assets/querystring.ed407679.js","assets/vue-toastification.e4040407.js","assets/vue-toastification.4b5f8ac8.css","assets/workbox-window.8d14e8b7.js"]),n=window.vue=Ha(Gv);e.emit("setupVue",n),n.mount("#app"),en(()=>{const i=vi(),{updateServiceWorker:a}=Xv({onNeedRefresh(){i.info("New content available, click here to update.",{timeout:!1,closeOnClick:!1,draggable:!1,icon:{iconClass:"material-icons",iconChildren:"refresh",iconTag:"i"},rtl:!1,onClick(){a()}})},onOfflineReady(){i.info("App ready to work offline")},onRegisterError:console.warn,onRegistered(r){r&&setInterval(()=>r.update(),60*60*1e3)}})}),t()});export{l as D,Gi as _,Pt as a,He as b,Gm as c,Ot as g,kl as l,G as p,Ae as s};
